{
    "text": "ecve : CVE-2018-0966 ， title : Microsoft Windows - 'CiSetFileCache' TOCTOU Incomplete Fix - Windows dos Exploit ， verified : Verified ， exploit_detail : Windows : CiSetFileCache TOCTOU CVE-2017-11830 Incomplete Fix ， Platform : Windows 10 1709 ( including Win10S )  ， Class : Security Feature Bypass ， Summary :  ， The fix for CVE-2017-11830 is insufficient to prevent a normal user application adding a cached signing level to an unsigned file by exploiting a TOCTOU in CI leading to circumventing Device Guard policies. ， Description :  ， The previous issue I reported was due to not checking for write access on the target file handle when setting the cache. This allows a user application to abuse a TOCTOU and rewrite the file after the hash has been generated for the file. The only changed code seems to be below :  ， FILE_OBJECT target_file ;  ， Ob ， The fix was to add a check that the target file passed isnt writable. This combined with the check for FILE_SHARE_WRITE should mean the user cant hold on to a writable file handle. However , when the file handle is converted to a file object with Ob ， 1. Open the file for write access. ， 2. Reopen another handle to the file for SYNCHRONIZE access. This works as this access right can be used regardless of the sharing mode. ， 3. Set cached signing level through the handle opened in 2. ， 4. Wait for oplock , rewrite file using handle opened in 1. Release oplock.",
    "time": "2018-04-16"
}