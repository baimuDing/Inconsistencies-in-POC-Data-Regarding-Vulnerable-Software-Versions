{
    "text": "published_time: 2018-03-20 ， id: 37885 ， eid: 44315 ， cve: CVE-2018-0882 ， title: Microsoft Windows - Desktop Bridge Virtual Registry NtLoadKey Arbitrary File Read/Write Privilege Escalation - Windows local Exploit ， author: Google Security Research ， published_time: 2018-03-20 ， verified: Verified ， platform: Windows ， exploit_type: local ， exploit_url: /download/44315 ， exploit_detail: Windows: Desktop Bridge Virtual Registry NtLoadKey Arbitrary File Read/Write EoP\r ， Platform: Windows 1703 (version 1709 seems to have fixed this bug)\r ， Class: Elevation of Privilege\r ， Summary: The handling of the virtual registry NtLoadKey callback reloads registry hives insecurely leading to arbitrary file creation resulting in EoP.\r ， Description:\r ， NOTE: This bug seems to have been fixed in 1709, but the fix hasnt been backported to 1703 (Ive not checked 1607). I dont know if the fix was intentional or not, however as (according to  1703 should be supported until at least September 2018 this should be something youd consider fixing.\r ， The desktop bridge functionality introduced in Anniversary edition allows an application to set up a virtual registry to add changes to system hives and user hives without actually modifying the real hives. This is implemented through the normal registry callback functionality. One of the callbacks implemented is to handle the NtLoadKey system call (VrpPreLoadKey). On 1703 it doesnt check for the Application Key flag, but then recalls ZwLoadKey with the arguments passed by the user mode caller. This effectively allows you to circumvent the requirement for SeRestorePrivilege as will also create a new hive file with kernel privileges in the context of the current user. This is a trivial EoP by dropping a arbitrary file to disk then getting system privileges."
}