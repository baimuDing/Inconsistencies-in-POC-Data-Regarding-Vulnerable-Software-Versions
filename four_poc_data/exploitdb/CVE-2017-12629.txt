{
    "text": "ecve : CVE-2017-12629 ， title : Apache Solr 7.0.1 - XML External Entity Expansion / Remote Code Execution - XML webapps Exploit ， verified : Verified ， exploit_detail : First Vulnerability : XML External Entity Expansion ( deftype=xmlparser )  ， Lucene includes a query parser that is able to create the full-spectrum of Lucene queries , using an XML data structure. Starting from version 5.1 Solr supports \"xml\" query parser in the search query. ， The problem is that lucene xml parser does not explicitly prohibit doctype declaration and expansion of external entities. It is possible to include special entities in the xml document , that point to external files ( via file : // ) or external urls ( via ， Example usage : v='< ! DOCTYPE a SYSTEM \" ， When Solr is parsing this request , it makes a HTTP request to and treats its content as DOCTYPE definition. ， Considering that we can define parser type in the search query , which is very often comes from untrusted user input , e.g. search fields on websites. It allows to an external attacker to make arbitrary HTTP requests to the local SOLR instance and to bypass all firewall restrictions. ， For example , this vulnerability could be user to send malicious data to the '/upload' handler :  ， v='< ! DOCTYPE a SYSTEM \" ， This vulnerability can also be exploited as Blind XXE using ftp wrapper in order to read arbitrary local files from the solrserver. ， Vulnerable code location :  ， /solr/src/lucene/queryparser/src/java/org/apache/lucene/queryparser/xml/CoreParser.java ， static Document parseXML ( InputStream pXmlFile ) throws ParserException { ， DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance (  )  ;  ， DocumentBuilder db = null ;  ， db = dbf.newDocumentBuilder (  )  ;  ， catch ( Exception se ) { ， throw new ParserException ( \"XML Parser configuration error\" , se )  ;  ， org.w3c.dom.Document doc = null ;  ， doc = db.parse ( pXmlFile )  ;  ， Steps to",
    "time": "2017-10-17"
}