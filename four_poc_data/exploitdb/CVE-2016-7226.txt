{
    "text": "ecve : CVE-2016-7226 ， title : Microsoft Windows - VHDMP Arbitrary File Creation Privilege Escalation ( MS16-138 ) - Windows local Exploit ， verified : Verified ， exploit_detail : / *  ， Source :  ， Windows : VHDMP Arbitrary File Creation EoP ， Platform : Windows 10 10586 and 14393. Unlikely to work on 7 or 8.1 as I think its new functionality ， Class : Elevation of Privilege ， Summary :  ， The VHDMP driver doesnt safely create files related to Resilient Change Tracking leading to arbitrary file overwrites under user control leading to EoP. ， Description :  ， The VHDMP driver is used to mount VHD and ISO files so that they can be accessed as a normal mounted volume. In Windows 10 support was introduced for Resilient Change Tracking which adds a few new files ending with .rct and .mrt next to the root vhd. When you enable RCT on an existing VHD it creates the files if theyre not already present. Unfortunately it does it using ZwCreateFile ( in VhdmpiCreateFileWithSameSecurity ) and doesnt specify the OBJ_FORCE_ACCESS_CHECK flag. As the location is entirely controlled by the user we can exploit this to get an arbitrary file create/overwrite , and the code as its name suggests will copy across the DACL from the parent VHD meaning well always be able to access it. ， Note this doesnt need admin rights as we never mount the VHD , just set RCT. However you cant use it in a sandbox as opening the drive goes through multiple access checks.",
    "time": "2016-11-15"
}