{
    "text": "ecve : CVE-2000-0052 ， title : Mandrake 6.x / RedHat 6.x / Turbolinux 3.5 b2/4.x/6.0.2 userhelper/PAM - Path ( 1 ) - Linux local Exploit ， verified : Verified ， exploit_detail : Mandrake 6.0/6.1 , RedHat 6.0/6.1 , Turbolinux 3.5 b2/4.2/4.4/6.0.2 userhelper/PAM Path Vulnerability ( 1 )  ， source :  ， Because of double path vulnerabilities in the binary userhelper and PAM , it is possible to get root locally on RedHat 6.0 and 6.1 systems. Both userhelper and PAM follow \"..\" paths and userhelper allows you to specifiy a program to execute as an argument to the -w parameter ( which is expected to have an entry in /etc/security/console.apps ) . Because of this , it's possible to specifiy a program such as \"../../../tmp/myprog\" , which would ( to userhelper ) be \"/etc/security/console.apps/../../../tmp/myprog\". If \"myprog\" exists , PAM will then try to execute it ( with the same filename ) . PAM first does a check to see if the configuration file for \"../../../tmp/myprog\" is in /etc/pam.d/ but also follows \"..\" directories -- to an attacker's custom pam configuration file. Specified inside the malicious configuration file ( /tmp/myprog ) would be arbitrary shared libraries to be opened with setuid privileges. The arbitrary libraries can be created by an attacker specifically to compromise superuser access , activating upon dlopen (  ) by PAM. ， This vulnerability also affects Mandrake Linux versions 6.0 and 6.1 , as well as versions of TurboLinux Linux , version 6.0.2 and prior. ，  #  ! /bin/sh ，  # pamslam - vulnerability in Redhat Linux 6.1 and PAM pam_start ，  # found by dildog @ l0pht.com ，  # synopsis :  ，  # both 'pam' and 'userhelper' ( a setuid binary that comes with the ，  # 'usermode-1.15' rpm ) follow .. paths. Since pam_start calls down to ，  # _pam_add_handler (  )  , we can get it to dlopen any file on disk. 'userhelper' ，  # being setuid means we can get root. ，  # fix :  ，  # No fuckin idea for a good fix. Get rid of the .. paths in userhelper ，  # for a quick fix. Remember 'strcat' isn't a very good way of confining ，  # a path to a particular subdirectory. ，  # props to my mommy and daddy , cuz they made me drink my milk.",
    "time": "2000-01-04"
}