{
    "text": "ecve : CVE-2006-1127 CVE-2006-1128 ， title : Gallery 2 < 2.0.2 - Multiple Vulnerabilities - PHP webapps Exploit ， verified : Not Verified ， exploit_detail : Gallery 2 Multiple Vulnerabilities ， Vendor : Bharat Mediratta ， Product : Gallery 2 ， Version : <= 2.0.2 ， Website :  ， BID : 16940 ， CVE : CVE-2006-1127 CVE-2006-1128 ， OSVDB : 23596 23597 ， SECUNIA : 19104 ， PACKETSTORM : 44358 ， Description :  ， Gallery2 , the open source web based photo album organizer is one of the most popular php web applications available today. Gallery2 suffers from a number of vulnerabilities including IP Spoofing via X_FORWARDED_FOR that may allow a malicious user to hide their identity , script injection via the faulty X_FORWARDED_FOR implementation , and also arbitrary file access which could ultimately lead to the deletion of arbitrary files on the webserver. A new version of Gallery 2 has been released and users should upgrade their Gallery 2 installations. ， IP Spoofing :  ， There is an issue with Gallery2 that allows for users to perform actions anonymously by spoofing their identity with a bogus X_FORWARDED_FOR HTTP Header. ，  $ ip = $ _SERVER [ 'HTTP_X_FORWARDED_FOR' ]  ;  ， } else if ( isset (  $ _SERVER [ 'HTTP_CLIENT_IP' ]  )  ) { ，  $ ip = $ _SERVER [ 'HTTP_CLIENT_IP' ]  ;  ， } else if ( isset (  $ _SERVER [ 'REMOTE_ADDR' ]  )  ) { ，  $ ip = $ _SERVER [ 'REMOTE_ADDR' ]  ;  ， } else { ， The above code is responsible for the previously mentioned problem because it allows the possibly user supplied header X_FORWARDED_FOR to take precedence over REMOTE_ADDR. Unfortunately this same issues can be levereged to carry out more sinister attacks. ， Script Injection :  ， Because the IP Address returned by Gallery2 is thought to be safe there are a number of other issues that can be exploited by sending a bogus X_FORWARDED_FOR header. For example , when adding comments in an album the user's IP is logged and displayed along with said comment. This could be used to execute arbitrary client side code such as JavaScript in the context of a user's ( admin , maybe? ) browser. ， Arbitrary File Access :  ， Gallery2 is vulnerable to an arbitrary file access issue within it's session handling",
    "time": "2016-03-02"
}