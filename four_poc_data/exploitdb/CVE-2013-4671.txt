{
    "text": "published_time: 2013-07-27 ， id: 24158 ， eid: 27136 ， cve: CVE-2013-1616 ， title: Symantec Web Gateway 5.1.0.x - Multiple Vulnerabilities - PHP webapps Exploit ， author: SEC Consult ， published_time: 2013-07-27 ， verified: Verified ， platform: PHP ， exploit_type: webapps ， exploit_url: /download/27136 ， exploit_detail: SEC Consult Vulnerability Lab Security Advisory < 20130726-0 >\r ，               title: Multiple vulnerabilities - Surveillance via Symantec Web\r ，                      Gateway \r ，             product: Symantec Web Gateway\r ，  vulnerable version: <= 5.1.0.*\r ，       fixed version: 5.1.1\r ，          CVE number: CVE-2013-1616, CVE-2013-1617, CVE-2013-4670, \r ，                      CVE-2013-4671, CVE-2013-4672\r ，              impact: Critical\r ，            homepage: \r ，               found: 2012-12-18\r ，                  by: Wolfgang Ettlinger\r ，                      SEC Consult Vulnerability Lab \r ， Vendor/product description:\r ， \"Symantec Web Gateway protects organizations against multiple types of Web-borne\r ， malware and gives organizations the flexibility of deploying it as either a \r ， virtual appliance or on physical hardware. Powered by Insight, Symantecs \r ， innovative reputation based malware filtering technology, Web Gateway relies on \r ， a global network of greater than 210 million systems to identify new threats \r ， before they cause disruption in organizations.\"\r ， URL: \r ， Business recommendation:\r ， SEC Consult has identified several vulnerabilities within the components of\r ， Symantec Web Gateway in the course of a short crash test. Some components have\r ， been spot-checked, while others have not been tested at all.\r ， Several of the discovered vulnerabilities below can be chained together in\r ， order to run arbitrary commands with the privileges of the \"root\" user on the\r ， appliance.\r ， An attacker can get unauthorized access to the appliance and plant backdoors or\r ， access configuration files containing credentials for other systems (eg. Active\r ， Directory/LDAP credentials) which can be used in further attacks.\r ， Since all web traffic passes through the appliance, interception of HTTP as\r ， well as the plaintext form of HTTPS traffic (if SSL Deep Inspection feature in\r ， use), including sensitive information like passwords and session cookies is\r ， possible.\r ， If SSL Deep Inspection is enabled, the appliance holds a private key for a\r ， Certificate Authority (CA) certificate that is installed/trusted on all\r ， workstations in the company. If this private key is compromised by an attacker,\r ， arbitrary certificates can be signed. These certificates will then pass\r ， validation on the client machines, enabling in various attacks targeting\r ， clients (further MITM attacks, phishing, evilgrade, ...).\r ， The recommendation of SEC Consult is to switch off the product until a\r ， comprehensive security audit based on a security source code review has been\r ， performed and all identified security deficiencies have been resolved by the\r ， vendor.\r ， Vulnerability overview/description:\r ， 1) Reflected Cross Site Scripting (XSS) (CVE-2013-4670)\r ， A reflected cross site scripting vulnerability was found. This allows\r ， effective session hijacking attacks of administrator session cookies. \r ， 2) Persistent Cross Site Scripting (XSS) (CVE-2013-4670)\r ， Moreover a persistent cross site scripting vulnerability allows an \r ， unauthenticated user to inject script code into the administration interface.\r ， This script code will be executed once an administrator visits the\r ， administration interface.\r ， 3) OS Command Injection (CVE-2013-1616)\r ， Multiple OS command injection vulnerabilities were discovered. Authenticated\r ， users can execute arbitrary commands on the underlying operating system with\r ， the privileges of the \"apache\" operating system user.\r ， This can be used to get persistent access to the affected system (eg. by\r ， planting backdoors), accessing all kinds of locally stored information or\r ， interception of web traffic that passes through the appliance.\r ， 4) Security Misconfiguration (CVE-2013-4672)\r ， Unprivileged operating system users (eg. apache) can gain root privileges\r ， due to a misconfiguration of the sudo program.\r ， 5) SQL Injection (CVE-2013-1617)\r ， Several SQL injection vulnerabilities were identified that allow an \r ， authenticated administrator to issue manipulated SQL commands.\r ， 6) Cross Site Request Forgery (CVE-2013-4671)\r ， The cross site request forgery protection implemented can be bypassed easily.\r ， Using this vulnerability, an attacker can issue requests in the context of\r ， administrative user sessions.\r ， Several of the vulnerabilities above can be chained together by an\r ， unauthenticated attacker in order to run arbitrary commands with the\r ， privileges of the \"root\" operating system user on the appliance.\r ， Proof of concept:\r ， 1) Reflected Cross Site Scripting (XSS) (CVE-2013-4670)\r ， The following URL demonstrates a reflected cross site scripting vulnerability:\r ， 2) Persistent Cross Site Scripting (XSS) (CVE-2013-4670)\r ， The \"blocked.php\" page which is accessible without authentication allows to\r ， inject script code to the \"Blocking Feedback\" functionality on the \r ， administration interface. The following URL demonstrates this issue. The\r ， payload of the parameter \"u\" will be stored permanently:\r ， 3) OS Command Injection (CVE-2013-1616)\r ， The functionality to change the hostname as well as the \"Test Ping\" \r ， functionality allow to inject commands enclosed in backticks (`). These commands\r ， are run as the system user \"apache\".\r ， Affected scripts: /spywall/nameConfig.php\r ，                   /spywall/networkConfig.php\r ， Detailed proof of concept exploits have beem removed for this vulnerability.\r ， 4) Security Misconfiguration (CVE-2013-4672)\r ， The /etc/sudoers file allows the users \"apache\" and \"admin\" to run several \r ， critical commands with root privileges. As the user \"apache\" is able to run\r ， commands  like \"chmod\", \"chown\" and \"insmod\" without the need of a password,\r ， an attacker that is able to issue commands as this user (see 3) can effectively\r ， gain root privileges.\r ， 5) SQL Injection (CVE-2013-1617)\r ， The following URLs demonstrate the SQL injection flaws found by"
}