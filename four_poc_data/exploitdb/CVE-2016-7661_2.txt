{
    "text": "ecve : CVE-2016-7661 ， title : Apple macOS 10.12.1 / iOS < 10.2 - powerd Arbitrary Port Replacement - Multiple dos Exploit ， verified : Verified ， exploit_detail : / *  ， Source :  ， powerd ( running as root ) hosts the com.apple.PowerManagement.control mach service. ， It checks in with launchd to get a server port and then wraps that in a CFPort :  ， pmServerMachPort = _SC_CFMachPortCreateWithPort (  ， \"PowerManagement\" ,  ， serverPort ,  ， mig_server_callback ,  ， &context )  ;  ， It also asks to receive dead name notifications for other ports on that same server port :  ， mach_port_request_notification (  ， mach_task_self (  )  , // task ， notify_port_in , // port that will die ， MACH_NOTIFY_DEAD_NAME , // msgid ， 1 , // make-send count ， CFMachPortGetPort ( pmServerMachPort )  , // notify port ， MACH_MSG_TYPE_MAKE_SEND_ONCE , // notifyPoly ， &oldNotify )  ; // previous ， mig_server_callback is called off of the mach port run loop source to handle new messages on pmServerMachPort :  ， static void ， mig_server_callback ( CFMachPortRef port , void * msg , CFIndex size , void * info )  ， mig_reply_error_t * bufRequest = msg ;  ， mig_reply_error_t * bufReply = CFAllocatorAllocate (  ， NULL , _powermanagement_subsystem.maxsize , 0 )  ;  ， mach_msg_return_t mr ;  ， int options ;  ， __MACH_PORT_DEBUG ( true , \"mig_server_callback\" , serverPort )  ;  ， / * we have a request message * / ，  ( void ) pm_mig_demux ( &bufRequest->Head , &bufReply->Head )  ;  ， This passes the raw message to pm_mig_demux :  ， static boolean_t ， pm_mig_demux (  ， mach_msg_header_t * request ,  ， mach_msg_header_t * reply )  ， mach_dead_name_notification_t * deadRequest = ，  ( mach_dead_name_notification_t *  ) request ;  ， boolean_t processed = FALSE ;  ， processed = powermanagement_server ( request , reply )  ;  ， __MACH_PORT_DEBUG ( true , \"pm_mig_demux : Dead name port should have 1+ send right ( s ) \" , deadRequest->not_port )  ;  ， PMConnectionHandleDeadName ( deadRequest->not_port )  ;  ， __MACH_PORT_DEBUG ( true , \"pm_mig_demux : Deallocating dead name port\" , deadRequest->not_port )  ;  ， mach_port_deallocate ( mach_task_self (  )  , deadRequest->not_port )  ;  ， reply->msgh_bits = 0 ;  ， reply->msgh_remote_port = MACH_PORT_NULL ;  ， This passes the message to the MIG-generated code for the powermanagement subsystem , if that fails ( because the msgh_id doesn't ， match the subsystem for example ) then this compares the message's msgh_id field to MACH_NOTIFY_DEAD_NAME. ， deadRequest is the message cast to a mach_dead_name_notification_t which is defined like this in mach/notify.h :  ， type",
    "time": "2016-12-22"
}