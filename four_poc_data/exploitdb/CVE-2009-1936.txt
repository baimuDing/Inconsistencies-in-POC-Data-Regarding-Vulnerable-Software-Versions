{
    "text": "ecve : CVE-2009-1936 ， title : CPCommerce 1.2.x - 'GLOBALS [ prefix ] ' Arbitrary File Inclusion - PHP webapps Exploit ， verified : Verified ， exploit_detail :  #  ! /usr/bin/perl ，  # cpCommerce 1.2.x GLOBALS [ prefix ] Arbitrary File Inclusion Exploit ，  # by staker ，  # mail : staker [ at ] hotmail [ dot ] it ，  # url :  ，  # it works with register_globals=on ，  # if you wanna carry out a LFI -> mq=off ，  # short explanation :  ，  # cpCommerce contains one flaw that allows an ，  # attacker to include a remote or local file ，  # because of require_once (  ) in _functions.php ，  # File _functions.php ，  #  [ begin block code ]  ，  # ------------------ ，  # define ( \"CPCOMMERCE_LOADED\" , true )  ;  ，  # ini_set ( \"register_globals\" , 0 )  ; <------ {1} totally useless ，  # error_reporting ( E_ALL ^ E_NOTICE )  ;  ，  # // Older PHP Versions ，  # if ( phpversion (  ) < \"4.0.6\" isset (  $ HTTP_POST_VARS )  )  ，  #  $ _POST = (  $ HTTP_POST_VARS )  ;  ，  # if ( phpversion (  ) < \"4.0.6\" isset (  $ HTTP_GET_VARS )  )  ，  #  $ _GET = (  $ HTTP_GET_VARS )  ;  ，  # if ( phpversion (  ) < \"4.0.6\" isset (  $ HTTP_COOKIE_VARS )  )  ，  #  $ _COOKIE = (  $ HTTP_COOKIE_VARS )  ;  ，  # if ( phpversion (  ) < \"4.0.6\" isset (  $ HTTP_SERVER_VARS )  )  ，  #  $ _SERVER = (  $ HTTP_SERVER_VARS )  ;  ，  # if ( phpversion (  ) < \"4.0.6\" isset (  $ HTTP_POST_FILES )  )  ，  #  $ _FILES = (  $ HTTP_POST_FILES )  ;  ，  # if ( phpversion (  ) < \"4.0.6\" isset (  $ HTTP_SESSION_VARS )  )  ，  #  $ _SESSION = (  $ HTTP_SESSION_VARS )  ;  ，  # // Start MySQL and Sessions ，  # session_start (  )  ;  ，  # // Resolve PHP running under fcgi ，  # if ( empty (  $ _SERVER [ 'PHP_SELF' ]  )  )  ，  #  $ _SERVER [ 'PHP_SELF' ] = $ _SERVER [ 'SCRIPT_NAME' ]  ;  ，  # Protect prefix vulnerability ，  # if ( strpos (  $ _SERVER [ 'PHP_SELF' ]  , \"_functions.php\" )  ! == false )  ，  # header ( \"Location : { $ _SERVER [ 'HTTP_HOST' ] }\" )  ; <------ {2} exit or die function? ，  # if (  ! isset (  $ prefix )  |  | isset (  $ _REQUEST [ 'prefix' ]  )  )  $ prefix = \"\" ; <--- {3} this is interesting ，  # Include Configuration Files ，  # require_once ( \"{ $ prefix}_config.php\" )  ; <-------- {4} include $ prefix variable + _config.php ，  # ---------------- ，  #  [ end block code ]  ，  # Explanation ( code snippet above [ points ]  )  ，  # 1. actually ini_set (  ) doesn't work..so doesn't change anything ，  # 2. header (  ) needs an exit or die function otherwise is useless ，  # 2. because of header (  ) without die we bypass the direct access ，  # 3. all REQUEST variables are not allowed , what about GLOBALS [  ] ? ，  # 4. require_once (  ) include $ prefix variable. ，  # It's not possible to include a remote/local file using a web ，  # browser because you will be automatically redirected in another ，  # page (  $ _SERVER [ 'HTTP_HOST' ]  ) . What about scripts or curl? yeah ，  # Various :  ，  # They didn't help me but i wanna give a thanks to girex , str0ke ，  # Gianluka_95 , p3ri0d , mrdoktom , Aquilo & ，  # Don't contact me on messenger , i'm bored of stupid questions !  ，  # so if you wanna help about exploit usage. kill yourself ok? ，  # I didn't contact anyone to fix this bug , at least not yet ,  ，  # but i release a possible fix here :  ，  # _functions.php line : 36 Replace it with the following",
    "time": "2009-05-26"
}