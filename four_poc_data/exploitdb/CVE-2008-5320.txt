{
    "text": "ecve : CVE-2008-5320 ， title : e107 < 0.7.13 - 'usersettings.php' Blind SQL Injection - PHP webapps Exploit ， verified : Verified ， exploit_detail :  # Author : __GiReX__ ，  # Homepage :  ，  # Date : 19/10/2008 ，  # CMS : e107 ，  # URL :  ，  # Note : Works regardless of php.ini settings ( magic_quotes , register_globals.. )  ，  # Attenction : This exploit was written for educational purpose. ，  # Use it at your own risk. Author will be not responsible for any damage. ，  # Description : e107 is a content management system written in PHP ，  # and using the popular open source MySQL database system for content storage. ，  # It's completely free , totally customisable and in constant development. ，  # Bug description :  ，  # e107 presents a vuln in userssettings.php ( line 363-395 )  , a POST array (  $ _POST [ 'ue' ]  )  ，  # goes into an update query , it cleans the values of this array but not the keys name... ，  # File : usersettings.php ( line 363-395 )  ， foreach (  $ _POST [ 'ue' ] as $ key => $ val )  ，  $ err = $ ue->user_extended_validate_entry (  $ val ,  $ extList [  $ key ]  )  ;  ，  $ val = $ tp->toDB (  $ val )  ; <= = Cleans values ，  $ ue_fields .= $ key.\"='\". $ val.\"'\" ; <= = Here our $ _POST [ 'ue' ] keys and values ，  # Lines : 496-500 ， // Next line creates a record which presumably should be there anyway , so could generate an error ，  $ sql->db_Select_gen ( \"INSERT INTO # user_extended ( user_extended_id , user_hidden_fields ) values ( '\".intval (  $ inp ) .\"' , '' ) \" )  ;  ，  $ sql->db_Update ( \"user_extended\" ,  $ ue_fields.\" WHERE user_extended_id = '\".intval (  $ inp ) .\"'\" )  ; <= = Here vulnearable query ，  # As you can see the return value of the update query isn't checked so we have to use a blind benchmark (  ) method ，  #  ! /usr/bin/perl ，  # e107 <= 0.7.13 Blind SQL Injection Exploit ，  # Admin/User's Password Retrieve Exploit ，  # Works regardless of php.ini settings ，  # Coded by __GiReX__ ， use POSIX ;  ， use LWP :  : UserAgent ;  ， use HTTP :  : Cookies ;  ， use Digest :  : MD5 qw ( md5 md5_hex md5_base64 )  ;  ， banner (  )  ; ",
    "time": "2008-10-19"
}