{
    "text": "ecve : CVE-2023-1998 ， title : Linux Kernel 6.2 - Userspace Processes To Enable Mitigation - Linux local Exploit ， verified : Not Verified ， exploit_detail : Exploit Title : Linux Kernel 6.2 - Userspace Processes To Enable Mitigation ， Exploit Author : nu11secur1ty ， CVE ID : CVE-2023-1998 ， Description ， Summary ， The Linux kernel allows userspace processes to enable mitigations by ， calling prctl with ，  [ PR_SET_SPECULATION_CTRL ]  (  ， which disables the speculation feature as well as by using seccomp. We ， had noticed that on VMs of at least one major cloud provider , the ， kernel still left the victim process exposed to attacks in some cases ， even after enabling the spectre-BTI mitigation with prctl. The same ， beahaviour can be observed on a bare-metal machine when forcing the ， mitigation to IBRS on boot comand line. ， This happened because when plain IBRS was enabled ( not enhanced IBRS )  ,  ， the kernel had some logic that determined that ，  [ STIBP ]  (  ， was not needed. The IBRS bit implicitly protects against cross-thread ， branch target injection. However , with legacy ，  [ IBRS ]  (  ， the IBRS bit was cleared on returning to userspace , due to performance ， reasons , which disabled the implicit STIBP and left userspace threads ， vulnerable to cross-thread branch target injection against which STIBP ， protects. ， Severity ， Medium - The kernel failed to protect applications that attempted to ， protect against Spectre v2 leaving them open to attack from other ， processes running on the same physical core in another hyperthread. ， Vulnerable code ， The Bug present on Kernel 6.2 ， implements an optimization that disables STIBP if the mitgation is ， IBRS or eIBRS. However IBRS doesn't mitigate SMT attacks on userspace ， as eIBRS does. Setting spectre_v2=ibrs on kernel boot parameters for ， bare metal machines without eIBRS support also triggers the bug. ， ```c ， / *  ，  * If no STIBP , IBRS or enhanced IBRS is enabled , or SMT impossible ,  ，  * STIBP is not required. ，  * / ，  ! smt_possible |  |  ， spectre_v2_in_ibrs_mode ( spectre_v2_enabled )  ) ",
    "time": "2023-04-20"
}