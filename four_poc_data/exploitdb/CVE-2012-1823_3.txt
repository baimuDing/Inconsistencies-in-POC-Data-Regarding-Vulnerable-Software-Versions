{
    "text": "ecve : CVE-2012-2336 CVE-2012-2311 CVE-2012-1823 ， title : Apache + PHP < 5.3.12 / < 5.4.2 - cgi-bin Remote Code Execution - PHP remote Exploit ， verified : Verified ， exploit_detail : / * Apache Magica by Kingcope * / ， / * gcc apache-magika.c -o apache-magika -lssl * / ， / * This is a code execution bug in the combination of Apache and PHP. ， On Debian and Ubuntu the vulnerability is present in the default install ， of the php5-cgi package. When the php5-cgi package is installed on Debian and ， Ubuntu or php-cgi is installed manually the php-cgi binary is accessible under ， /cgi-bin/php5 and /cgi-bin/php. The vulnerability makes it possible to execute ， the binary because this binary has a security check enabled when installed with ， Apache http server and this security check is circumvented by the exploit. ， When accessing the php-cgi binary the security check will block the request and ， will not execute the binary. ， In the source code file sapi/cgi/cgi_main.c of PHP we can see that the security ， check is done when the php.ini configuration setting cgi.force_redirect is set ， and the php.ini configuration setting cgi.redirect_status_env is set to no. ， This makes it possible to execute the binary bypassing the Security check by ， setting these two php.ini settings. ， Prior to this code for the Security check getopt is called and it is possible ， to set cgi.force_redirect to zero and cgi.redirect_status_env to zero using the ， -d switch. If both values are set to zero and the request is sent to the server ， php-cgi gets fully executed and we can use the payload in the POST data field ， to execute arbitrary php and therefore we can execute programs on the system. ， apache-magika.c is an exploit that does exactly the prior described. It does ， support SSL. ， / * Affected and tested versions ， PHP 5.3.10 ， PHP 5.3.8-1 ， PHP 5.3.6-13 ， PHP 5.3.3 ， PHP 5.2.17 ， PHP 5.2.11 ， PHP 5.2.6-3 ， PHP 5.2.6+lenny16 with Suhosin-Patch ， Affected versions ， PHP prior to 5.3.12 ， PHP prior to 5.4.2 ， Unaffected versions ， PHP 4 - getopt parser unexploitable ， PHP 5.3.12 and up ， PHP 5.4.2 and up ， Unaffected versions are patched by CVE-2012-1823. ，  * / ， / * . ， /'\\rrq rk ， . // \\\\ . ， .x.//fco\\- | - ， '//cmtco\\zt ， //6meqrg.\\tq ， //_________\\' ， EJPGQO ， apache-magica.c by Kingcope ，  * /",
    "time": "2013-10-29"
}