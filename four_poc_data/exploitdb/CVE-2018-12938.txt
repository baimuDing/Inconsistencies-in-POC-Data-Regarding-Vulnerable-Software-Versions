{
    "text": "ecve : CVE-2018-12938 ， title : OpenSLP 2.0.0 - Double-Free - Linux dos Exploit ， verified : Not Verified ， exploit_detail : ''' ， _ _ _ _ _ ___ ， ___ |  | ___ _ |  | _ |  | ___ _ _ |  | _ |  | ___ | _ | ___ ___ ___ ，  | _ - |  | . | . |  | . | . |  |  | . |  | -_ |  | _ | _ | -_ | -_ |  ，  | ___ | _ | _ | ___ |  | ___ | ___ | ___ | ___ | _ | ___ |  | _ |  | _ |  | ___ | ___ |  ，  | _ |  ， 2018-06-28 ， SLPD DOUBLE FREE ， CVE-2018-12938 ， An issue was found in openslp-2.0.0 that can be used to induce a double free bug or memory corruption by ， corrupting glibc's doubly-linked memory chunk list. At the time of writing , no patch has been made available. ， The issue was discovered by Magnus Klaaborg Stubman. ， On line 409 of slpd_process.c , the * sendbuf pointer is copied to result. ， On line 251 , the first reallocation takes place , potentially free (  ) ing the memory if ， it was moved as part of the reallocation. ， On line 547 , the second reallocation is done , again potentially free (  ) ing the memory ， Code snippets from openslp-2.0.0/slpd/slpd_process.c :  ， 237 static int ProcessDASrvRqst ( SLPMessage * message , SLPBuffer * sendbuf , int errorcode )  ， 238 { ， 243 size_t initial_buffer_size = 4096 ;  ， 246 / * Special case for when libslp asks slpd ( through the loopback ) about ， 247 * a known DAs. Fill sendbuf with DAAdverts from all known DAs. ， 248 * / ， 249 if ( SLPNetIsLoopback ( &message->peer )  )  ， 250 { ， 251 * sendbuf = SLPBufferRealloc (  * sendbuf , initial_buffer_size )  ; <-- first reallocation ， 402 static int ProcessSrvRqst ( SLPMessage * message , SLPBuffer * sendbuf ,  ， 403 int errorcode )  ， 404 { ， 405 int i ;  ， 406 SLPUrlEntry * urlentry ;  ， 407 SLPDDatabaseSrvRqstResult * db = 0 ;  ， 408 size_t size = 0 ;  ， 409 SLPBuffer result = * sendbuf ; <-- pointer is copied ， 460 / * check to to see if a this is a special SrvRqst * / ， 461 if ( SLPCompareString ( message->body.srvrqst.srvtypelen ,  ， 462 message->body.srvrqst.srvtype , 23 , SLP_DA_SERVICE_TYPE ) == 0 )  ， 463 { ， 464 errorcode = ProcessDASrvRqst ( message , sendbuf , errorcode )  ; <-- sendbuf passed to function ， 546 / * reallocate the result buffer * / ， 547 result = SLPBufferRealloc ( result , size )  ; <-- second reallocation ， PROOF OF CONCEPT ， The following patch can be used to understand the reallocation behavior :  ， diff -git a/common/slp_buffer.c b/common/slp_buffer.c ， index 1cab3f5..b3e3ff1 100644 ， --- a/common/slp_buffer.c ， +++ b/common/slp_buffer.c ， -104 , 7 +104 , 9 SLPBuffer SLPBufferRealloc ( SLPBuffer buf , size_t size )  ， / * Allocate one extra byte for null terminating strings that ，  * occupy the last field of the buffer. ，  * /",
    "time": "2018-07-03"
}