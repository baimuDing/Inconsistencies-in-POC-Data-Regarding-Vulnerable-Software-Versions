{
    "text": "ecve : CVE-2010-3709 ， title : PHP 5.3.3/5.2.14 - ZipArchive :  : getArchiveComment Null Pointer Dereference - PHP dos Exploit ， verified : Not Verified ， exploit_detail :  [ PHP 5.3.3/5.2.14 ZipArchive :  : getArchiveComment NULL Pointer Deference ]  ， Author : Maksymilian Arciemowicz ， Date :  ， - Dis. : 14.09.2010 ， - Pub. : 05.11.2010 ， CVE : CVE-2010-3709 ， CWE : CWE-476 ， Status : Fixed in CVS ， Affected Software :  ， - PHP 5.3.3 ， - PHP 5.2.14 ， Original URL :  ， --- 0.Description --- ， ZipArchive enables you to transparently read or write ZIP compressed ， archives and the files inside them. ， ZipArchive :  : getArchiveComment Returns the Zip archive comment ， string ZipArchive :  : getArchiveComment ( void )  ， --- 1. PHP 5.3.3/5.2.14 ZipArchive :  : getArchiveComment ( CWE-476 ) --- ， As we can see in ， vision=303622&view=markup ， 1945 static ZIPARCHIVE_METHOD ( getArchiveComment )  ， 1946 { ， 1947 struct zip * intern ;  ， 1948 zval * this = getThis (  )  ;  ， 1949 long flags = 0 ;  ， 1950 const char * comment ;  ， 1951 int comment_len = 0 ;  ， 1952 ， 1953 if (  ! this ) { ， 1954 RETURN_FALSE ;  ， 1955 } ， 1956 ， 1957 ZIP_FROM_OBJECT ( intern , this )  ;  ， 1958 ， 1959 if ( zend_parse_parameters ( ZEND_NUM_ARGS (  ) TSRMLS_CC , \" | l\" , &flags ) == ， FAILURE ) { ， 1960 return ;  ， 1961 } ， 1962 ， 1963 comment = zip_get_archive_comment ( intern , &comment_len ,  ( int ) flags )  ;  ， <= === RETURN NULL AND -1 ， 1964 RETURN_STRINGL (  ( char *  ) comment ,  ( long ) comment_len , 1 )  ; <= ==== NULL ， POINTER DEFERENCE HERE ， 1965 } ， this method return string from zip_get_archive_comment (  ) function. Now we ， need see this function ,  ， archive_comment.c?revision=284361&view=markup ， 40 ZIP_EXTERN ( const char *  )  ， 41 zip_get_archive_comment ( struct zip * za , int * lenp , int flags )  ， 42 { ， 43 if (  ( flags & ZIP_FL_UNCHANGED )  ， 44 |  |  ( za->ch_comment_len == -1 )  ) { ， 45 if ( za->cdir ) { ， 46 if ( lenp ! = NULL )  ， 47 * lenp = za->cdir->comment_len ;  ， 48 return za->cdir->comment ;  ， 49 } ， 50 else { ， 51 if ( lenp ! = NULL )  ， 52 * lenp = -1 ; <= ==================== -1 ， 53 return NULL ; <= =================== NULL ， 54 } ， 55 } ， 56 ， 57 if ( lenp ! = NULL )  ， 58 * lenp = za->ch_comment_len ;  ， 59 return za->ch_comment ;  ， 60 } ， line 52 and 53 should return NULL pointer and ( int ) -1. In result ， RETURN_STRINGL (  ) will be executed with :  ， RETURN_STRINGL ( NULL , -1 , 1 )  ;  ， and crash in memcpy ( 3 ) . ， --- 2.",
    "time": "2010-11-05"
}