{
    "text": "ecve : CVE-2008-7107 ， title : ESET Smart Security 3.0.667.0 - Privilege Escalation ( PoC ) - Windows dos Exploit ， verified : Verified ， exploit_detail : -BEGIN PGP SIGNED MESSAGE- ， Hash : SHA1 ， - - Orange Bat advisory - ， Name : ESET Smart Security 3.0.667.0 ， Class : Privilage escalation ， Published : 2008-08-14 ， Credit : g_ ( g_ # orange-bat # com )  ， - - Details - ， File : easdrv.sys ， .text : 00012B92 loc_12B92 :  ， .text : 00012B92 push [ ebp+InputBuf ]  ， .text : 00012B95 call ds : off_1A200 [ eax ]  ， .text : 00012B9B mov ecx ,  [ ebp+OutputBuffer ]  ， .text : 00012B9E mov [ ecx ]  , eax ， Although this piece of code is wrapped with exception handler ,  ， input and output pointers are not checked with ProbeForRead/Write. ， This will cause BSOD when input/output will point to kernel mode ， memory ( above 0x80000000 ) . ， This code can be reached by sending IoControlCode = 0x222003 to ， device \\\\.\\easdrv ( see POC ) . In order to exploit this , we need ， to take a look at ， .text : 00012B95 call ds : off_1A200 [ eax ]  ， off_1A200 is :  ， .rdata : 0001A200 off_1A200 dd offset HookNtClose ， .rdata : 0001A204 dd offset sub_12838 ， .rdata : 0001A208 dd offset sub_12874 ， .rdata : 0001A20C dd offset sub_128A8 ， .rdata : 0001A210 dd offset sub_128E4 ， .rdata : 0001A214 dd offset sub_1290A ， .rdata : 0001A218 dd offset sub_1292C ， These are wrappers for hooked syscalls. First one is NtClose , so ， there aren't many possible values that this API returns in eax. ， We will use :  ， C0000008 STATUS_INVALID_HANDLE An invalid HANDLE was specified. ， Because it's the simplest status to get. ， Attack scenario :  ， 1. Get address of some rarely used syscall , like NtShutdownSystem. ， I will refer to this address as X : p ， 2. Send signal to easdrv , with output buffer = X-1. This will result ， in overwriting two highest bytes with zeros and will damage 1 byte ， at X-1 : p. ， 3. Send signal with output buffer = X+2. This will set two lower bytes ， to 0x0800. ， 4. Allocate memory at 0x80000 and copy shellcode there ， 5. Call NtShutdownSystem to jump to shellcode in r0 mode. ， See",
    "time": "2008-08-16"
}