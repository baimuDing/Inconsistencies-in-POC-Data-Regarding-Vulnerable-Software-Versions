{
    "text": "published_time: 2014-12-23 ， id: 29502 ， eid: 35594 ， cve: CVE-2014-9412 CVE-2014-5216 ， title: NetIQ Access Manager 4.0 SP1 - Multiple Vulnerabilities - JSP webapps Exploit ， author: SEC Consult ， published_time: 2014-12-23 ， verified: Not Verified ， platform: JSP ， exploit_type: webapps ， exploit_url: /download/35594 ， exploit_detail: SEC Consult Vulnerability Lab Security Advisory < 20141218-2 >\r ，              title: Multiple high risk vulnerabilities\r ，            product: NetIQ Access Manager\r ， vulnerable version: 4.0 SP1\r ，      fixed version: 4.0 SP1 Hot Fix 3\r ，         CVE number: CVE-2014-5214, CVE-2014-5215, CVE-2014-5216,\r ，                     CVE-2014-5217\r ，             impact: High\r ，           homepage: \r ，              found: 2014-10-29\r ，                 by: W. Ettlinger\r ，                     SEC Consult Vulnerability Lab\r ， Vendor/product description:\r ， \"As demands for secure web access expand and delivery becomes increasingly\r ， complex, organizations face some formidable challenges. Access Manager\r ， provides a simple yet secure and scalable solution that can handle all your\r ， web access needsboth internal as well as in the cloud.\"\r ， URL: \r ， Business recommendation:\r ， An attacker without an account on the NetIQ Access Manager is be able to gain\r ， administrative access by combining different attack vectors. Though this host\r ， may not always be accessible from a public network, an attacker is still able\r ， to compromise the system when directly targeting administrative users.\r ， Because the NetIQ Access Manager is used for authentication, an attacker\r ， compromising the system can use it to gain access to other systems.\r ， SEC Consult highly recommends that this software is not used until a full\r ， security review has been performed and all issues have been resolved.\r ， Vulnerability overview/description:\r ， 1) XML eXternal Entity Injection (XXE, CVE-2014-5214)\r ， Authenticated administrative users can download arbitrary files from the Access\r ， Manager administration interface as the user \"novlwww\".\r ， The vendor provided the following KB link:\r ， 2) Reflected Cross Site Scripting (XSS, CVE-2014-5216)\r ， Multiple reflected cross site scripting vulnerabilities were found. These\r ， allow effective attacks of administrative and SSLVPN sessions.\r ， The vendor provided the following KB link:\r ， 3) Persistent Site Scripting (XSS, CVE-2014-5216)\r ， A persistent cross site scripting vulnerability was found. This allows\r ， effective attacks of administrative and SSLVPN sessions.\r ， The vendor provided the following KB link:\r ， 4) Cross Site Request Forgery (CVE-2014-5217)\r ， The Access Manager administration interface does not have CSRF protection.\r ， The vendor provided the following KB link:\r ， 5) Information Disclosure (CVE-2014-5215)\r ， Authenticated users of the administration interface can gain authentication\r ， information of internal administrative users.\r ， The vendor provided the following KB link:\r ， By combining all of the above vulnerabilities (CSRF, XSS, XXE) an\r ， unauthenticated, non-admin user may gain full access to the system!\r ， Proof of concept:\r ， 1) XML eXternal Entity Injection (XXE)\r ， As an example, the following URL demonstrates the retrieval of the /etc/passwd\r ， file as an authenticated administrative user:\r ， 2) Reflected Cross Site Scripting (XSS)\r ， The following URLs demonstrate different reflected XSS flaws in the\r ， administration interface and the user interface.\r ， 3) Persistent Site Scripting (XSS)\r ， The following URL injects a stored script on the auditing page:\r ， 4) Cross Site Request Forgery\r ， As an example, an attacker is able to change the administration password to\r ， '12345' by issuing a GET request in the context of an authenticated\r ， administrator. The old password is not necessary for this attack!\r ， 5) Information Disclosure\r ， The following URLs disclose several useful information to an authenticated\r ， account:\r ， The disclosed system properties:\r ， com.volera.vcdn.monitor.password\r ， com.volera.vcdn.alert.password\r ， com.volera.vcdn.sync.password\r ， com.volera.vcdn.scheduler.password\r ， com.volera.vcdn.publisher.password\r ， com.volera.vcdn.application.sc.scheduler.password\r ， com.volera.vcdn.health.password\r ， The static string \"k~jd)*L2;93=Gjs\" is XORed with these values in order\r ， to decrypt passwords of internally used service accounts.\r ， By combining all of the above vulnerabilities (CSRF, XSS, XXE) an\r ， unauthenticated, non-admin user may gain full access to the system!\r ， Vulnerable / tested versions:\r ， The vulnerabilities have been verified to exist in the NetIQ Access Manager\r ， version 4.0 SP1, which was the most recent version at the time of discovery.\r ， Vendor contact timeline:\r ， 2014-10-29: Contacting security@netiq.com, sending responsible disclosure\r ，            policy and PGP keys\r ， 2014-10-29: Vendor redirects to security@novell.com, providing PGP keys\r ，            through Novell support page\r ， 2014-10-30: Sending encrypted security advisory to Novell\r ， 2014-10-30: Novell acknowledges the receipt of the advisory\r ， 2014-12-16: Novell: the vulnerability fixes will be released tomorrow;\r ，            The CSRF vulnerability will not be fixed immediately\r ，            (\"Since this can be done only after an authorized login\");\r ，            two XSS vulnerabilities can not be exploited (\"We could not\r ，            take advantage or retrieve any cookie info on the server\r ，            side - it looks like it's a client side cross scripting\r ，            attack.\")\r ， 2014-12-16: Explaining why those vulnerabilities can be exploited\r ， 2014-12-17: Novell: Fix will be released tomorrow\r ， 2014-12-17: Verifying release of advisory tomorrow\r ， 2014-12-18: Novell: Advisory can be released\r ， 2014-12-18: Coordinated release of security advisory\r ， Solution:\r ， Update to the latest available of Access Manager and implement workarounds\r ， mentioned in the KB articles by Novell linked above.\r ， Workaround:\r ， For some vulnerabilities, Novell provides best practice recommendations in the\r ， URLs linked above.\r ， Advisory URL:\r ， SEC Consult Vulnerability Lab\r ， SEC Consult\r ， Vienna - Bangkok - Frankfurt/Main - Montreal - Singapore - Vilnius - Zurich\r ， Headquarter:\r ， Mooslackengasse 17, 1190 Vienna, Austria\r ， Phone:   +43 1 8903043 0\r ， Fax:     +43 1 8903043 15\r ， Mail: research at sec-consult dot com\r ， Web: \r ， Blog: \r ， Twitter: \r ， Interested to work with the experts of SEC Consult?\r ， Write to career@sec-consult.com\r ， EOF W. Ettlinger / @2014"
}