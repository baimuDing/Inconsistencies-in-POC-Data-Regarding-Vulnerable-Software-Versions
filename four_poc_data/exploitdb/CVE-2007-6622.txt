{
    "text": "ecve : CVE-2007-6623 CVE-2007-6622 ， title : ZeusCMS 0.3 - Blind SQL Injection - PHP webapps Exploit ， verified : Verified ， exploit_detail : <? ， / *  ， ZeusCMS <= 0.3 Remote Blind SQL Injection Exploit ， author... : EgiX ， mail..... : n0b0d13s [ at ] gmail [ dot ] com ， link..... :  ， details.. : works with magic_quotes_gpc = off ( if magic quotes affects also $ _SERVER array )  ，  [ - ] Blind SQL Injection in /index.php :  ， 129. $ blockedRefCheck=security :  : checkRef (  $ _SERVER [ \"HTTP_REFERER\" ]  )  ; <= = ， 130. ， 131. if (  @ in_array (  $ _SERVER [ 'REMOTE_ADDR' ]  ,  $ blockedips )  |  |  $ blockedRefCheck=TRUE ) { ， 132. include \"html_files/denied.html\" ;  ， 133. } ， 134. else ，  [ - ] checkRef (  ) function defined in /security.php :  ， 130. function checkref (  $ ref ) { ， 131. if (  $ ref ) { ， 132. $ res=eregi_replace ( \" ， 133. include \"dbase.php\" ;  ， 134. $ table= $ prefix.\"referers\" ;  ， 135. $ res= $ db->query ( \"SELECT * FROM $ table WHERE url like '% $ ref%' AND status='BLOCKED'\" )  ; <= = ， 136. if (  $ res->numRows (  ) >0 ) { ， 137. return true ;  ， 138. } ， 139. else{ ， 140. return false ;  ， 141. } ， 142. }else{ ， 143. return false ;  ， 144. } ， an attacker can inject sql code through http referer header , that isn't properly checked... ，  [  *  ] Possible bug fix in /index.php :  ， 128. $ ref = security :  : safeGet (  $ _SERVER [ \"HTTP_REFERER\" ]  )  ;  ， 129. $ blockedRefCheck = security :  : checkRef (  $ ref )  ;  ，  [ - ] there is also a possible file system browsing through /image_viewer.php , p.o.c. :  ，  * / ， error_reporting ( 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， set_time_limit ( 0 )  ;  ，  $ sock = fsockopen (  $ host , 80 )  ; ",
    "time": "2007-12-27"
}