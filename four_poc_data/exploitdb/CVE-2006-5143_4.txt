{
    "text": "ecve : CVE-2006-5143 ， title : Computer Associates Products Message Engine RPC Server - Multiple Buffer Overflow Vulnerabilities ( 2 ) - Windows remote Exploit ， verified : Verified ， exploit_detail : source :  ， Multiple Computer Associates products are prone to multiple buffer-overflow vulnerabilities because the applications using an affected library fail to properly bounds-check user-supplied input before copying it to an insufficiently sized memory buffer. ， Exploiting these issues allows attackers to execute arbitrary machine code within the context of the affected application. ，  #  ! /usr/bin/python ，  # Computer Associates ( CA ) Brightstor Backup Mediasvr.exe Remote Code Exploit ，  #  ( Previously Unknown )  ，  # There seems to be an design error in the handling of RPC data with xdr procedures ，  # across several .dll's imported by Mediasvr.exe. Four bytes from an RPC packet are ，  # processed as a particular address ( xdr_handle_t data which is run through multiple bit ，  # shifts , and reversing of bytes )  , and eventually loaded into ECX. ，  # The 191 ( 0xbf ) procedure , followed by nulls ( at least 8 bytes of nulls , which may ，  # be Null Credentials and Auth? ) leads to an exploitable condition. ，  # .text : 0040AACD 008 mov ecx ,  [ esp+8 ]  ，  # .text : 0040AAD1 008 mov dword_418820 , esi ，  # .text : 0040AAD7 008 push offset dword_418820 ，  # .text : 0040AADC 00C mov eax ,  [ ecx ]  ，  # .text : 0040AADE 00C call dword ptr [ eax+2Ch ]  ，  # At this point , you have control of ECX ( esp+8 is your address data ) . The data from the packet ，  # is stored in memory and is relatively static ( see NOTE ) . ，  # The address is then loaded into EAX , and then called as EAX+2Ch , which is ，  # controllable data from the packet. In this code , I just jump ahead to ，  # the portbinding shellcode. ，  # NOTE : The only issue I have found is when the system is rebooted , the packet data ，  # appears at a higher memory location when Mediasvr.exe crashes ，  # and is restarted. I have accounted for this in the code , when the port that ，  # Mediasvr.exe is listening on is below TCP port 1100 , which is usually only after ，  # a reboot ，  # This was tested on BrightStor ARCserve Backup 11.5.2.0 ( SP2 ) with the latest ，  # CA patches on Windows XP SP2 ( I believe there is some issue with SP1 , which ，  # is more then likely the memory locations )  ，  # The patches include the following updates to Mediasvr.exe ，  # CA has been notified ，  # Author : M. Shirk ，  # Tester : Tebodell ，  #  ( c ) Copyright 2007 ( Shirkdog Security ) shirkdog_list $ at % hotmail dot com ，  # Use at your own Risk : You have been warned ，  # ------------------------------------------------------------------------",
    "time": "2006-10-05"
}