{
    "text": "ecve : CVE-2017-5227 ， title : QNAP QTS < 4.2.4 - Domain Privilege Escalation - Hardware local Exploit ， verified : Verified ， exploit_detail : QNAP QTS Domain Privilege Escalation Vulnerability ， Name Sensitive Data Exposure in QNAP QTS ， Systems Affected QNAP QTS ( NAS ) all model and all versions < 4.2.4 ， Severity High 7.9/10 ， Impact CVSS : 3.0/AV : L/AC : L/PR : L/UI : N/S : C/C : H/I : L/A : L ， Vendor ， Advisory ， Authors Pasquale \"sid\" Fiorillo ( sid AT ush DOT it )  ， Guido \"go\" Oricchio ( g.oricchio AT pcego DOT com )  ， Date 20170322 ， I. BACKGROUND ， QNAP Systems , founded in 2004 , provides network attached storage ( NAS )  ， and network video recorder ( NVR ) solutions for home and business use to ， the global market. ， QNAP also delivers a cloud service , called myQNAPcloud , that allows ， users to access and manage the devices from anywhere. ， QTS is a QNAP devices proprietary firmware based on Linux. ， ISGroup ( is an Italian Information Security ， boutique , we found this 0day issue while supporting Guido Oricchio ， of PCego , a System Integrator , to secure a QNAP product for one of his ， customer. ， Responsible disclosure with Qnap : we contacted qnap on public security @  ， contact and we escalate fast to their Security Researcher Myron Su on ， PGP emails. ， Prior vulnerabilities in QNAP :  ， Information to customers of the vulnerability is shown in their bulletin ， ID NAS-201703-21 (  ， QTS 4.2.4 Build 20170313 includes security fixes for the following ， vulnerabilities : Configuration file vulnerability ( CVE-2017-5227 )  ， reported by Pasquale Fiorillo of the cyber security company ISGroup ，  ( www.isgroup.biz )  , a cyber security company , and Guido Oricchio of ， PCego ( www.pcego.com )  , a system integrator. ， The latest version of the software at the time of writing can be ， obtained from :  ， II. DESCRIPTION ， The vulnerability allows a local QTS admin user , or other low privileged ， user , to access configuration file that includes a bad crypted Microsoft ， Domain Administrator password if the NAS was joined to a Microsoft ， Active Directory domain. ， The affected component is the \"uLinux.conf\" configuration file ,  ， created with a world-readable permission used to store a Domain ， Administrator password. ， Admin user can access the file using ssh that is enabled by default. ， Other users are not allowed to login , so they have to exploit a ， component , such as a web application , to run arbitrary command or ， arbitrary file read. ， TLDR : Anyone is able to read uLinux.conf file , world readable by ， default , can escalate to Domain Administrator if a NAS is a domain ， member. ， III. ANALYSIS ， QNAP QTS stores \"uLinux.conf\" configuration file in a directory ， accessible by \"nobody\" and with permission that make them readable by ， \"nobody\". ， If the NAS was joined to an Active Directory , such file contain a Domain ， Administrator user and password in an easily decrypt format. ， In older versions of QTS the Domain Admin's password was stored in ， plaintext. ， A ) Config file readable by \"nobody\" ，  [  ~  ]  # ls -l /etc/config/uLinux.conf ， -rw-r-r- 1 admin administ 7312 Dec 10 06 : 39 /etc/config/uLinux.conf ， Our evidence is for QTS 4.2.0 and QTS 4.2.2 running on a TS-451U ,  ， TS-469L , and TS-221. Access to the needed file are guaranteed to ， all the local users , such as httpdusr used to running web sites and ， web application hosted on the NAS. ， This expose all the information contained in the configuration file at ， risk and this is a violation of the principle of least privilege. ， B ) Weak encrypted password in the configuration file ， The Microsoft Active Directory Admin username and password are stored ， in the file obfuscated by a simple XOR cypher and base64 encoded. ， In this scenario , a Local File Read vulnerability could lead to full ， domain compromise given the fact that an attacker can re-use such ， credentials to authenticate against a Domain Controller with maximum ， privileges. ， The password field in the uLinux.conf has the following format :  ， User = <username> ， Password = <base64> ， eg :  ， User = Administrator ， Password = AwMAAAEBBgYHBwQEIyMgICEhJiYnJyQkQw= ， The \"<base64>\" decoded is :  ， sid @ zen :  ~  $ ",
    "time": "2017-03-27"
}