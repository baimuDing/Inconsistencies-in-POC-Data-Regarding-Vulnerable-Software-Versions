{
    "text": "ecve : CVE-2017-0313 ， title : NVIDIA Driver 375.70 - Buffer Overflow in Command Buffer Submission - Windows dos Exploit ， verified : Verified ， exploit_detail : Source :  ， DxgkDdiSubmitCommandVirtual is the function implemented by the kernel mode driver ， responsible for submitting a command buffer to the GPU. One of the arguments passed ， contains vendor specific data from the user mode driver. The kernel allocates a single ， buffer for this purpose for all submit calls for the same context. ， NVIDIA implements this data as :  ， struct NvPrivateHeader { ， DWORD magic ;  ， WORD unknown_4 ;  ， WORD unknown_6 ;  ， DWORD unknown_8 ;  ， DWORD size ;  ， } ;  ， struct NvPrivateData { ， NvPrivateHeader header ;  ， DWORD unknown_0 ;  ， DWORD unknown_1 ;  ， DWORD some_size ;  ， DWORD unknown_2 ;  ， PVOID a_gpu_address_maybe ;  ， BYTE unknown [ 1220 ]  ;  ， } ;  ， In one of the functions that process this data , there appears to be code to ， shift around the contents of this user private data. ， // | len | is controlled by the user. can come from the | some_size | field if the ，  | a_gpu_address_maybe | field is 0. ， do_debug_thingo (  )  ; // doesn't stop the memcpy ， priv_data = ( NvSubmitPrivateData *  ) pCommand_->pDmaBufferPrivateData ;  ， src = ( char *  ) priv_data + priv_data->header.size ; // unchecked length ， priv_data = ( NvSubmitPrivateData *  )  (  ( char *  ) priv_data + 1256 )  ;  ，  *  ( _QWORD *  ) &v4->unknown_0 [ 256 ] = priv_data ;  ， // potential bad memcpy ， memcpy ( priv_data , src , 8 * len )  ;  ， There are two main problems here : the | len | value is checked , but that appears ， to only call a debug logging function and not actually stop the memcpy that ， occurs afterwards. ， Also , the | size | field from the header is not properly ， checked to be smaller than the actual size of the data ( this is also checked in ， the calling function but once again only calls do_debug_thingo (  )  ) . ， This lets an attacker specify an arbitrary length for the copy , as well as ， specify an arbitrary 32-bit offset to copy from , leading to pool memory corruption. ， Crashing context with",
    "time": "2017-02-15"
}