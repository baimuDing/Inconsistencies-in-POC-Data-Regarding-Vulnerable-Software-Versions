{
    "text": "ecve : CVE-2005-2002 ， title : Mambo 4.5.2.1 - Fetch Password Hash - PHP webapps Exploit ， verified : Verified ， exploit_detail :  #  ! /usr/bin/php -q ， Mambo 4.5.2.1 + mysql 4.1 > fetch password hash by pokleyzz <pokleyzz at scan-associates.net> ， <?php ， / *  ， Mambo 4.5.2.1 + mysql 4.1 > fetch password hash by pokleyzz <pokleyzz at scan-associates.net> ，  * content rating using sub query to select from mos_users ， Requirement :  ， PHP 4.x with curl extension ， Description :  ， The problem occur because $ user_rating variable is not properly sanitize when for use in SQL query ， >From content.php ( components\\com_content\\content.php )  ，  $ cid = intval (  $ cid )  ;  ，  $ currip = getenv ( 'REMOTE_ADDR' )  ;  ，  $ query = \"SELECT * FROM # __content_rating WHERE content_id = $ cid\" ;  ，  $ database->setQuery (  $ query )  ;  ，  $ votesdb = NULL ;  ，  $ query = \"INSERT INTO # __content_rating ( content_id , lastip , rating_sum , rating_count ) \" ， . \"\\n VALUES ( ' $ cid' , ' $ currip' , ' $ user_rating' , '1' ) \" ;  ，  $ database->setQuery (  $ query )  ;  ，  $ database->query (  ) or die (  $ database->stderr (  )  )  ;  ;  ， } else { ，  $ query = \"UPDATE # __content_rating\" ， . \"\\n SET rating_count = rating_count + 1 , \" ， . \"\\n rating_sum = rating_sum + $ user_rating , \" <--- PROBLEM ， . \"\\n lastip = ' $ currip'\" ， . \"\\n WHERE content_id = \". $ cid ，  $ database->setQuery (  $ query )  ;  ，  $ database->query (  ) or die (  $ database->stderr (  )  )  ;  ， } else { ， mosRedirect (  $ url , _ALREADY_VOTE )  ;  ， mosRedirect (  $ url , _THANKS )  ;  ， User may escape 1st checkpoint by passing ( 1-5 )  ( string ) value to $ user_rating .In PHP beginning ， number in string will be use when comparing number with string. ， The 2nd checkpoint will check previous user's ip rated the content. Update statement will only ， execute when previous ip is different from current ip. This proof of concept will use cgi proxy from ， to make it possible. ， In mySQL 4.1 and above it is possible to use \"sub select\" in any SQL statement. We will using ， \"blind fishing\" with sub select to fetch password hash ( md5 ) for supplied user id. ， Exploiting step :  ， 1 ) rate from different ip ， 2 ) check time for standard page loading ， 3 ) check time for page loading when benchmark executed. ，  * If error occur mysql version is < 4.1 ( no support for sub select )  ， 4 ) double the benchmark value. Blind fishing will use this value to do the query. ， 5 ) blind fishing with sub select. ， Special thanks :  ， al3ndaleeb at hotmail.com ，  * /",
    "time": "2005-06-15"
}