{
    "text": "ecve : CVE-2018-5511 ， title : VMware Workstation 14.1.5 / VMware Player 15.0.2 - Host VMX Process Impersonation Hijack Privilege Escalation - Windows local Exploit ， verified : Verified ， exploit_detail : VMware : Host VMX Process Impersonation Hijack EoP ， Platform : VMware Workstation Windows v14.1.5 ( on Windows 10 ) . Also tested VMware Player 15.0.2. ， Class : Elevation of Privilege ， Summary : The creation of the VMX process on a Windows host can be hijacked leading to elevation of privilege. ， Description : The VMX process ( vmware-vmx.exe ) process configures and hosts an instance of VM. As is common with desktop virtualization platforms the VM host usually has privileged access into the OS such as mapping physical memory which represents a security risk. To mitigate this the VMX process is created with an elevated integrity level by the authentication daemon ( vmware-authd.exe ) which runs at SYSTEM. This prevents a non-administrator user opening the process and abusing its elevated access. ， Unfortunately the process is created as the desktop user and follows the common pattern of impersonating the user while calling CreateProcessAsUser. This is an issue as the user has the ability to replace any drive letter for themselves , which allows a non-admin user to hijack the path to the VMX executable , allowing the user to get arbitrary code running as a trusted VMX process. While having an elevated integrity level isnt especially dangerous , the fact that arbitrary code is running as a trusted VMX process means you can access all the facilities for setting up VMs , such as the opensecurable command which allows the process to open almost any file as SYSTEM for arbitrary read/write access which could easily be used to get administrator privileges. Write file write access you could perform an attack similar to ， I reported the technique of hijacking process creation to Microsoft over 3 years ago ( see Unfortunately Microsoft declined to fix it at the time. This makes fixing this issue more difficult than it should be. You might think a a quick fix would be to not impersonate the user over the call to CreateProcessAsUser. However you can end up with other issues such as ( Also even if the user didnt hijack the main process creation they could instead hijack DLLs loaded by the VMX process once started. ， A more comprehensive fix would to not create the process as the desktop user , instead using another user identity , however that in itself has risks and makes things considerably more complex.",
    "time": "2019-03-25"
}