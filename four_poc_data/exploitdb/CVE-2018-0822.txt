{
    "text": "ecve : CVE-2018-0822 ， title : Microsoft Windows - Global Reparse Point Security Feature Bypass/Elevation of Privilege - Windows local Exploit ， verified : Verified ， exploit_detail : Windows : Global Reparse Point Security Feature Bypass/Elevation of Privilege ， Platform : Windows 10 1709 ( functionality not present prior to this version )  ， Class : Security Feature Bypass/Elevation of Privilege ， Summary : Its possible to use the new Global Reparse Point functionality introduced in Windows 10 1709 to bypass the existing sandbox limitations of creating arbitrary file symbolic links. ， Description :  ， Windows 10 introduced mitigations to prevent the abuse of various types of symbolic links when a process is running in a sandbox. This is a combination of outright blocking of the functionality ( such as in the case of Registry Key symlinks ) to doing checks on the target location so that the sandbox user can write to the location ( in the case of Mount Points ) . ， Fall Creators Update has introduced a new defined reparse tag , the Global Reparse Point ( value 0xA0000019 ) which I assume is for Silos where a symlink can be added into the Silos visible namespaces which actually redirects to the global namespace. One user of this is the named pipe file system. It seems that nothing prevents you creating this type of reparse point on an NTFS volume , it doesnt get checked by the kernel for the sandbox mitigation and because the NTFS driver ignores anything which isnt a mount point or a ntfs symbolic link it will also not check for the SeCreateSymbolicLinkPrivilege. This symbolic link type works to reparse to any file type so you can create either a file or directory symbolic link. The reparse buffer is basically the same as the normal symbolic link one , but with a different tag. In fact strangely the named pipe file system passes back a buffer with the normal symbolic link tag but with the global reparse tag in the data structure passed back to IopParseDevice. ， Outside of the behavior in sandboxes you might want to check that the reparse buffer is correctly verified. Normally the NTFS driver checks the structure of a reparse buffer using FsRtlValidateReparsePointBuffer but that function doesnt know about the new reparse tag , so you could end up with completely untrusted data being passed into the object manager ( NPFS synthesizes the reparse buffer so normally it would be trusted ) . Ive not checked if you could trivially BSoD the machine through this approach. ， Note that while NTFS symbolic links can be created without privileges in developer mode this bypass also allows a normal user to create them without developer mode being enabled so also acts as an EoP.",
    "time": "2018-02-20"
}