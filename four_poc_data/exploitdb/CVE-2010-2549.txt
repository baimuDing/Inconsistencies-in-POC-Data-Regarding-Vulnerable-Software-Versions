{
    "text": "ecve : CVE-2010-2549 ， title : Microsoft Windows Vista/2008 - NtUserCheckAccessForIntegrityLevel Use-After-Free - Windows dos Exploit ， verified : Verified ， exploit_detail : Windows Vista/Server 2008 NtUserCheckAccessForIntegrityLevel Use-after-free Vulnerability ， Intro :  ， Due to hostility toward security researchers , the most recent example being of Tavis Ormandy , a number of us from the industry ( and some not from the industry ) have come together to form MSRC : the Microsoft-Spurned Researcher Collective. MSRC will fully disclose vulnerability information discovered in our free time , free from retaliation against us or any inferred employer. ， Vulnerability report :  ， win32k ! NtUserCheckAccessForIntegrityLevel in Vista/Server 2008 calls LockProcessByClientId (  ) on the specified ClientID. When this call fails , the refcount will be first decremented by nt ! ObfDereferenceObject and then by win32k ! NtUserCheckAccessForIntegrityLevel again , resulting in a refcount leak. The refcount leak can be abused to have an in-use process object deleted. ( use-after-free )  ， Some debugging info :  ， kd> vertarget ， Windows Server 2008 Kernel Version 6002 ( SP2 )  ， kd> LM m win32k ， start end module name ， 8d460000 8d663000 win32k ， kd> BA e 1 8d58d710 \\\"dt nt ! _OBJECT_HEADER @ edx PointerCount ; g\\\" ， kd> g ， +0x000 PointerCount : 145 ， +0x000 PointerCount : 144 ， +0x000 PointerCount : 143 ， +0x000 PointerCount : 3 ， +0x000 PointerCount : 2 ， +0x000 PointerCount : 1 ， Fatal System Error : 0x00000018 ， kd> kc ， nt ! KeBugCheck2 ， nt ! ObfDereferenceObject ， win32k ! NtUserCheckAccessForIntegrityLevel ， nt ! KiFastCallEntry ， The vulnerability can be triggered in one line below , where 4 is just the PID of PsInitialSystemProcess. ， Since there's no exported stub for this system call , you'll have to craft the call manually. sysenter is your friend.",
    "time": "2010-07-01"
}