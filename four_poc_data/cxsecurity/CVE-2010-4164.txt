{
    "text": "vul_name : linux kernel 2.6.36.1 bad parsing X.25 ， vul_cve : CVE-2010-4164 ， vul_poc :  ， Sorry I didn't catch this at the same time as my previous report so it ， could be included in one patch. ， On parsing malformed X.25 facilities , decrementing the remaining length ， may cause it to underflow. Since the length is an unsigned integer ,  ， this will result in the loop continuing until the kernel crashes. ， This patch adds checks to ensure decrementing the remaining length does ， not cause it to wrap around. ， Signed-off-by : Dan Rosenberg <drosenberg @ vsecurity.com> ， CC : stable <stable @ kernel.org> ， net/x25/x25_facilities.c | 8 + ， 1 files changed , 8 insertions ( + )  , 0 deletions ( - )  ， diff -git a/net/x25/x25_facilities.c b/net/x25/x25_facilities.c ， index 3a8c4c4.bef8330 100644 ， - a/net/x25/x25_facilities.c ， + b/net/x25/x25_facilities.c ， -61 , 6 +61 , 8 int x25_parse_facilities ( struct sk_buff * skb , struct x25_facilities * facilities ,  ， switch (  * p & X25_FAC_CLASS_MASK ) { ， case X25_FAC_CLASS_A :  ， + if ( len < 2 )  ， + return 0 ;  ， switch (  * p ) { ， case X25_FAC_REVERSE :  ， -104 , 6 +106 , 8 int x25_parse_facilities ( struct sk_buff * skb , struct x25_facilities * facilities ,  ， len -= 2 ;  ， case X25_FAC_CLASS_B :  ， + if ( len < 3 )  ， + return 0 ;  ， switch (  * p ) { ， case X25_FAC_PACKET_SIZE :  ， facilities->pacsize_in = p [ 1 ]  ;  ， -125 , 6 +129 , 8 int x25_parse_facilities ( struct sk_buff * skb , struct x25_facilities * facilities ,  ， len -= 3 ;  ， case X25_FAC_CLASS_C :  ， + if ( len < 4 )  ， + return 0 ;  ， printk ( KERN_DEBUG \"X.25 : unknown facility %02X , \" ， \"values %02X , %02X , %02X\\n\" ,  ， p<A NAME=\"-0\"></A> [ 0 ]  , p [ 1 ]  , p<A NAME=\"-2\"></A> [ 2 ]  , p<A NAME=\"-3\"></A> [ 3 ]  )  ;  ， -132 , 6 +138 , 8 int x25_parse_facilities ( struct sk_buff * skb , struct x25_facilities * facilities ,  ， len -= 4 ;  ， case X25_FAC_CLASS_D :  ， + if ( len < p [ 1 ] + 2 )  ， + return 0 ;  ， switch (  * p ) { ， case X25_FAC_CALLING_AE :  ， To unsubscribe from this list : send the line \"unsubscribe netdev\" in ， the body of a message to majordomo @ vger.kernel.org ， More majordomo info at",
    "time": "2011.01.09"
}