{
    "text": "vul_name : PHP 7.0.6 imagescale out-of-bounds read ， vul_cve : CVE-2013-7456 ， vul_poc : Description :  ， Tested on PHP 7 on 32 bits with ASAN and using USE_ZEND_ALLOC=0. ， user @ Xenial32-2 :  ~ /crashes/gd $ USE_ZEND_ALLOC=0 gdb -q -args /home/user/php-7.0/sapi/cli/php -n phuzz4.php ， Reading symbols from /home/user/php-7.0/sapi/cli/php.done. ，  ( gdb ) b gd_interpolation.c : 890 ， Breakpoint 1 at 0x81925a9 : file /home/user/php-7.0/ext/gd/libgd/gd_interpolation.c , line 890. ，  ( gdb ) b gd_interpolation.c : 982 if i = 12 ， Breakpoint 2 at 0x81929fc : file /home/user/php-7.0/ext/gd/libgd/gd_interpolation.c , line 982. ，  ( gdb ) r ， Starting program : /home/user/php-7.0/sapi/cli/php -n phuzz4.php ， Breakpoint 1 , _gdContributionsAlloc ( line_length=13 , windows_size=9 ) at /home/user/php-7.0/ext/gd/libgd/gd_interpolation.c : 890 ， 890 res->ContribRow = ( ContributionType *  ) gdMalloc ( line_length * sizeof ( ContributionType )  ;  ，  # windows_size is 9 ，  ( gdb ) c ， Continuing. ， Breakpoint 2 , _gdScaleRow ( pSrc=0x8c71c38 , src_width=100 , dst=0x8c7f5f0 , dst_width=13 , row=0 , contrib=0x8c5c2d8 )  ， at /home/user/php-7.0/ext/gd/libgd/gd_interpolation.c : 982 ， 982 r += ( unsigned char )  ( contrib->ContribRow [ x ] .Weights [ left_channel ]  *  ( double )  ( gdTrueColorGetRed ( p_src_row [ i ]  )  ;  ，  ( gdb ) p left_channel ，  $ 1 = 9 ， contrib->ContribRow [ x ] .Weights [ left_channel ] tries to access 10th element but the size is 9. ， As you can see here , this was fixed in 2013 on upstream libgd :  ， While PHP's libgd is still wrong :  ， Fix is just moving those two lines below the if condition. Attached a patch. ， Test script : ",
    "time": "2016.08.08"
}