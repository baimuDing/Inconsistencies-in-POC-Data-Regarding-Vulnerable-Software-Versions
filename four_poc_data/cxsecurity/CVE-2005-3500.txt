{
    "text": "vul_name : Clam AntiVirus tnef_attachment (  ) DoS Vulnerability ， vul_cve : CVE-2005-3500 ， vul_poc : Clam AntiVirus tnef_attachment (  ) DoS Vulnerability ， iDEFENSE Security Advisory 11.04.05 ， November 4 , 2005 ， I. BACKGROUND ， Clam AntiVirus is a GPL anti-virus toolkit for Unix. ， II. DESCRIPTION ， Remote exploitation of a design error in Clam AntiVirus ClamAV allows ， attackers to cause a denial of service ( DoS ) condition. ， The vulnerability specifically exists in the tnef_attachment function ， within tnef.c. A user controlled value is used to fseek into the file ， that is being processed ; this allows a user to specify the same block ， one line code snippet from the tnef processor demonstrates the flaw :  ， fseek ( fp ,  ( long )  ( offset + length )  , SEEK_SET )  ; / * shouldn't be needed * / ， When this code is reached , length is supplied by the file being ， processed. This makes it possible to seek back to the previous header ,  ， causing the infinite loop to begin. Furthermore , if the block is marked ， as an attachment , the data that is repeatedly read will be added to a ， dynamically allocated memory buffer , making memory exhaustion trivial. ， III. ANALYSIS ， Successful exploitation requires an attacker to send a specially ， constructed CAB file through a mail gateway or personal anti-virus ， client utilizing the ClamAV scanning engine. ， The infinite loop will cause the ClamAV software to use all available ， processor resources , resulting in a DoS or severe degradation of system ， performance. Ultimately , the OOM handler will terminate a task to ， alleviate the stress on the system. ， IV. DETECTION ， iDEFENSE has confirmed this vulnerability on ClamAV 0.86.1. All previous ， versions are suspected vulnerable to this issue. ， V. WORKAROUND ， Archive file analysis can be disabled ( -no-archive ) but this can have ， severe impacts on the virus detection functionality. ， VI. VENDOR RESPONSE ， The vendor has released clamav 0.87.1 to address this vulnerability. It ， is available for download at :  ， VII. CVE INFORMATION ， A Mitre Corp. Common Vulnerabilities and Exposures ( CVE ) number has not ， been assigned yet.",
    "time": "2005.11.06"
}