{
    "text": "vul_url : ， vul_name : libtasn1 Stack Write Overflow ， vul_date : 2015-03-31 / 2015-04-12 ， vul_credit_name : Hanno B ， vul_risk : Medium ， vul_local : ， vul_remote : ， vul_cve : CVE-2015-2806 ， vul_cwe : CWE-119 ， vul_poc : From ， libtasn1 is a library to parse ASN.1 data structures. Its most ， prominent user is GnuTLS. ， Fuzzing libtasn1 led to the discovery of a stack write overflow in the ， buffer variable on certain inputs. This issue has been reported to the ， developers on 2015-03-26. A fix was released on 2015-03-29. ， The issue can be exposed with Valgrind or Address Sanitizer. The ， Address Sanitizer output with detailed info is given below. ， Git commit / fix ， Release notes libtasn1 4.4 ， Sample input for stack overflow (to be used with examples/pkix.asn from ， libtasn1 source, e.g. src/asn1Decoding examples/pkix.asn ， TFPA-2015-002-libtasn1-4.3-stack-overflow.crt ， PKIX1Implicit88.Certificate) ， An earlier fuzzing effort led to the discovery of a null pointer ， derefenence error in the ASN.1 definition parser. This is unlikely to ， have any security impact. Null pointer errors are usually not ， exploitable and there are probably no scenarios where ASN.1 definitions ， are attacker controlled. This issue has been reported to the libtasn1 ， developers on 2015-01-25 and was fixed on 2015-02-05. The fix was ， delivered with the 4.3 release of libtasn1. ， Report on mailing list ， Git commit / fix ， Sample input for null ptr (can be tested with asn1Decoding ， TFPA-2015-002-libtasn1-4.2-null-ptr.asn x x) ， I want to thank libtasn1 developer Nikos Mavrogiannopoulos for the ， quick fixes. Both issues were found with american fuzzy lop. ， =4372=ERROR: AddressSanitizer: stack-buffer-overflow on address ， 0x7fff85a08084 at pc 0x43c180 bp 0x7fff85a07d10 sp 0x7fff85a07d00 WRITE ， of size 1 at 0x7fff85a08084 thread T0 #0 0x43c17f in ， _asn1_ltostr /data/libtasn1/libtasn1-4.3/lib/parser_aux.c:574 #1 ， 0x41ee31 in ， _asn1_get_objectid_der /data/libtasn1/libtasn1-4.3/lib/decoding.c:397 ， #2 0x41ee31 in ， asn1_der_decoding2 /data/libtasn1/libtasn1-4.3/lib/decoding.c:1225 #3 ， 0x423b0e in ， asn1_der_decoding /data/libtasn1/libtasn1-4.3/lib/decoding.c:1602 #4 ， 0x403692 in ， simple_decode /data/libtasn1/libtasn1-4.3/src/asn1Decoding.c:251 #5 ， 0x403692 in decode /data/libtasn1/libtasn1-4.3/src/asn1Decoding.c:280 ， #6 0x403692 in main /data/libtasn1/libtasn1-4.3/src/asn1Decoding.c:205 ， #7 0x7f94cb39af9f in _libc_start_main (/lib64/libc.so.6+0x1ff9f) #8 ， 0x4046a1 (/data/libtasn1/libtasn1-4.3/src/asn1Decoding+0x4046a1) ， Address 0x7fff85a08084 is located in stack of thread T0 at offset 564 ， in frame #0 0x419bdf in ， asn1_der_decoding2 /data/libtasn1/libtasn1-4.3/lib/decoding.c:980 ， This frame has 10 object(s): ， [32, 36) 'len2' ， [96, 100) 'tag_len' ， [160, 164) 'len2' ， [224, 232) 'p' ， [288, 296) 'p2' ， [352, 360) 'ptail' ， [416, 424) 'p' ， [480, 489) 'temp' ， [544, 564) 'temp' <= Memory access at offset 564 overflows this ， variable [608, 736) 'temp' ， Hanno Bck ， mail/jabber: hanno@hboeck.de ， GPG: BBB51E42"
}