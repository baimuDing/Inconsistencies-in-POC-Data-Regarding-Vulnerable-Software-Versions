{
    "text": "vul_name : Tomcat packaging on Debian-based distros - Local Root Privilege Escalation ， vul_cve : CVE-2016-1240 ， vul_poc : = ， - Discovered by : Dawid Golunski ， - dawid ( at ) legalhackers.com ， - CVE-2016-1240 ， - Release date : 30.09.2016 ， - Revision : 1 ， - Severity : High ， I. VULNERABILITY ， Tomcat packaging on Debian-based distros - Local Root Privilege Escalation ， Affected debian packages :  ， Tomcat 8 <= 8.0.36-2 ， Tomcat 7 <= 7.0.70-2 ， Tomcat 6 <= 6.0.45+dfsg-1 ~ deb8u1 ， Ubuntu systems are also affected. See section VII. for details. ， Other systems using the affected debian packages may also be affected. ， II. BACKGROUND ， \"The Apache Tomcat software is an open source implementation of the ， Java Servlet , JavaServer Pages , Java Expression Language and Java WebSocket ， technologies. The Java Servlet , JavaServer Pages , Java Expression Language ， and Java WebSocket specifications are developed under the Java Community ， Process. ， The Apache Tomcat software is developed in an open and participatory ， environment and released under the Apache License version 2. ， The Apache Tomcat project is intended to be a collaboration of the ， best-of-breed developers from around the world. ， Apache Tomcat software powers numerous large-scale , mission-critical web ， applications across a diverse range of industries and organizations. ， Some of these users and their stories are listed on the PoweredBy wiki page. ， \" ， III. INTRODUCTION ， Tomcat ( 6 , 7 , 8 ) packages provided by default repositories on Debian-based ， distributions ( including Debian , Ubuntu etc. ) provide a vulnerable ， tomcat init script that allows local attackers who have already gained access ， to the tomcat account ( for example , by exploiting an RCE vulnerability ， in a java web application hosted on Tomcat , uploading a webshell etc. ) to ， escalate their privileges from tomcat user to root and fully compromise the ， target system. ， IV. DESCRIPTION ， The vulnerability is located in the tomcat init script provided by affected ， packages , normally installed at /etc/init.d/tomcatN. ， The script for tomcat7 contains the following lines :  ， - [ tomcat7 ] - ，  # Run the catalina.sh script as a daemon ， set +e ， touch \" $ CATALINA_PID\" \" $ CATALINA_BASE\"/logs/catalina.out ， chown $ TOMCAT7_USER \" $ CATALINA_PID\" \" $ CATALINA_BASE\"/logs/catalina.out ， - [ eof ] - ， Local attackers who have gained access to the server in the context of the ， tomcat user ( for example , through a vulnerability in a web application ) would ， be able to replace the log file with a symlink to an arbitrary system file ， and escalate their privileges to root once Tomcat init script ( running as root )  ， re-opens the catalina.out file after a service restart , reboot etc. ， As attackers would already have a tomcat account at the time of exploitation ,  ， they could also kill the tomcat processes to introduce the need for a restart. ， V. PROOF OF CONCEPT EXPLOIT ， - [ tomcat-rootprivesc-deb.sh ] - ，  #  ! /bin/bash ，  # Tomcat 6/7/8 on Debian-based distros - Local Root Privilege Escalation Exploit ，  # CVE-2016-1240 ，  # Discovered and coded by :  ，  # Dawid Golunski ，  # This exploit targets Tomcat ( versions 6 , 7 and 8 ) packaging on ，  # Debian-based distros including Debian , Ubuntu etc. ，  # It allows attackers with a tomcat shell ( e.g. obtained remotely through a ，  # vulnerable java webapp , or locally via weak permissions on webapps in the ，  # Tomcat webroot directories etc. ) to escalate their privileges to root. ，  # Usage :  ，  # ./tomcat-rootprivesc-deb.sh path_to_catalina.out [ -deferred ]  ，  # The exploit can used in two ways :  ，  # -active ( assumed by default ) - which waits for a Tomcat restart in a loop and instantly ，  # gains/executes a rootshell via ld.so.preload as soon as Tomcat service is restarted. ，  # It also gives attacker a chance to execute : kill [ tomcat-pid ] command to force/speed up ，  # a Tomcat restart ( done manually by an admin , or potentially by some tomcat service watchdog etc. )  ，  # -deferred ( requires the -deferred switch on argv [ 2 ]  ) - this mode symlinks the logfile to ，  # /etc/default/locale and exits. It removes the need for the exploit to run in a loop waiting. ，  # Attackers can come back at a later time and check on the /etc/default/locale file. Upon a ，  # Tomcat restart / server reboot , the file should be owned by tomcat user. The attackers can ，  # then add arbitrary commands to the file which will be executed with root privileges by ，  # the /etc/cron.daily/tomcatN logrotation cronjob ( run daily around 6 : 25am on default ，  # Ubuntu/Debian Tomcat installations ) . ，  # See full advisory for details at : ",
    "time": "2016.10.01"
}