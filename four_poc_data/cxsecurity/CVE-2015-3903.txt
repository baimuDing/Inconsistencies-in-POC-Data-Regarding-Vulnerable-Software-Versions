{
    "text": "vul_name : phpMyAdmin 4.4.6 Man-In-the-Middle to API Github ， vul_cve : CVE-2015-3903 ， vul_poc : phpMyAdmin 4.4.6 Man-In-the-Middle to API Github ( CVE-2015-3903 )  ， Author : Maksymilian Arciemowicz from ， Issue type : CWE-295 ， - Description - ， As we can read ， CURLOPT_SSL_VERIFYPEER option. ， WARNING : disabling verification of the certificate allows bad guys to man-in-the-middle the communication without you knowing it. Disabling verification makes the communication insecure. Just having encryption on a transfer is not enough as you cannot be sure that you are communicating with the correct end-point. ， CURLOPT_SSL_VERIFYHOST option. ， When the verify value is 0 , the connection succeeds regardless of the names in the certificate. Use that ability with caution !  ， - MItM in libraries/Config.class.php - ， Let's see libraries/Config.class.php file ， . ， / check if commit exists in Github ， isset (  $ _SESSION [ 'PMA_VERSION_REMOTECOMMIT_' . $ hash ]  )  ，  ) { ，  $ is_remote_commit = $ _SESSION [ 'PMA_VERSION_REMOTECOMMIT_' . $ hash ]  ;  ， } else { ，  $ link = ' ， . $ hash ;  ，  $ is_found = $ this->checkHTTP (  $ link ,  !  $ commit )  ;  ， . ，  $ link = ' ， . '/git/trees/' . $ branch ;  ，  $ is_found = $ this->checkHTTP (  $ link )  ;  ， . ， where checkHTTP (  ) is vulnerable for MItM attack ， . ， { ， } ，  $ ch = curl_init (  $ link )  ;  ， curl_setopt (  $ ch , CURLOPT_FOLLOWLOCATION , 0 )  ;  ， curl_setopt (  $ ch , CURLOPT_HEADER , 1 )  ;  ， curl_setopt (  $ ch , CURLOPT_RETURNTRANSFER , 1 )  ;  ， curl_setopt (  $ ch , CURLOPT_SSL_VERIFYHOST , 0 )  ; <= MItM ， curl_setopt (  $ ch , CURLOPT_SSL_VERIFYPEER , 0 )  ; <= MItM ， curl_setopt (  $ ch , CURLOPT_CONNECTTIMEOUT , 5 )  ;  ， curl_setopt (  $ ch , CURLOPT_USERAGENT , 'phpMyAdmin/' . PMA_VERSION )  ;  ， curl_setopt (  $ ch , CURLOPT_TIMEOUT , 5 )  ;  ， session_write_close (  )  ;  ， } ，  $ data = @ curl_exec (  $ ch )  ;  ， ini_set ( 'session.use_only_cookies' , '0' )  ;  ， ini_set ( 'session.use_cookies' , '0' )  ;  ， ini_set ( 'session.use_trans_sid' , '0' )  ;  ， ini_set ( 'session.cache_limiter' , 'nocache' )  ;  ， session_start (  )  ;  ， } ， } ，  $ httpOk = 'HTTP/1.1 200 OK' ;  ，  $ httpNotFound = 'HTTP/1.1 404 Not Found' ;  ， . ， Example target URL :  ， - Credit - ， Issue discovered by Maksymilian Arciemowicz from by using cIFrex ( static code analysis tool ) . ， - Patch -",
    "time": "2015.05.14"
}