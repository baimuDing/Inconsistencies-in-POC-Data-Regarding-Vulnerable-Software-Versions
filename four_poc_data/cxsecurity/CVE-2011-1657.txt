{
    "text": "vul_name : PHP 5.3.6 ZipArchive invalid use glob ( 3 )  ， vul_cve : CVE-2011-1657 ， vul_poc :  [ PHP 5.3.6 ZipArchive invalid use glob ( 3 )  ]  ， Author : Maksymilian Arciemowicz ， Date :  ， - Dis. : 01.04.2011 ， - Pub. : 19.08.2011 ， CVE : CVE-2011-1657 ， Affected Software ( verified )  :  ， PHP 5.3.6 and prior ， Fixed :  ， PHP 5.3.7 ， - 0.Description - ， PHP is a general-purpose scripting language originally designed for web development to produce dynamic web pages. For this purpose , PHP code is embedded into the HTML source document and interpreted by a web server with a PHP processor module , which generates the web page document. It also has evolved to include a command-line interface capability and can be used in standalone graphical applications. ， ZipArchive ， This extension enables you to transparently read or write ZIP compressed archives and the files inside them. ， - 1. PHP 5.3.6 ZipArchive invalid use glob ( 3 ) - ， Functions like addGlob and addPattern are not described in documentation. Anyway we can call to ZipArchive : addGlob and ZipArchive : addPattern in PHP 5.3.6 ， let's see ext/zip/php_zip.c ， 531 if ( 0 ! = ( ret = glob ( pattern , flags & GLOB_FLAGMASK , NULL , &globbuf ) { ， . ， 1629 / * 1 = glob , 2=pcre * / ， 1630 if ( type = 1 ) { ， 1631 if ( zend_parse_parameters ( ZEND_NUM_ARGS (  ) TSRMLS_CC , \"s | la\" ,  ， 1632 &pattern , &pattern_len , &flags , &options ) = FAILURE ) { ， 1633 return ;  ， 1634 } ， 1635 } else { ， 1636 if ( zend_parse_parameters ( ZEND_NUM_ARGS (  ) TSRMLS_CC , \"s | sa\" ,  ， 1637 &pattern , &pattern_len , &path , &path_len , &options ) = FAILURE ) { ， 1638 return ;  ， 1639 } ， 1640 } ， 1641 ， invalid &flags may provide to crash. To use flags like GLOB_ALTDIRFUNC , we should first declare gl_opendir , gl_closedir , gl_lstat , gl_stat. In PHP we only have ， 508 glob_t globbuf ;  ， . ， 530 globbuf.gl_offs = 0 ;  ， 531 if ( 0 ! = ( ret = glob ( pattern , flags & GLOB_FLAGMASK , NULL , &globbuf ) { ， - GLOB_MARK - Adds a slash to each directory returned ， - GLOB_NOSORT - Return files as they appear in the directory ( no sorting )  ， - GLOB_NOCHECK - Return the search pattern if no files matching it were found ， - GLOB_NOESCAPE - Backslashes do not quote metacharacters ， - GLOB_BRACE - Expands {a , b , c} to match 'a' , 'b' , or 'c' ， - GLOB_ONLYDIR - Return only directory entries which match the pattern ， - GLOB_ERR - Stop on read errors ( like unreadable directories )  , by default errors are ignored. ， -linux/ubuntu- ， cx @ cx64 :  ~  $ php -v ， PHP 5.3.3-1ubuntu9.3 with Suhosin-Patch ( cli )  ( built : Jan 12 2011 16 : 07 : 38 )  ， Copyright ( c ) 1997-2009 The PHP Group ， Zend Engine v2.3.0 , Copyright ( c ) 1998-2010 Zend Technologies ， cx @ cx64 :  ~  $ uname -a ， Linux cx64 2.6.35-28-generic # 49-Ubuntu SMP Tue Mar 1 14 : 39 : 03 UTC 2011 x86_64 GNU/Linux ， cx @ cx64 : /www $ cat zip.php",
    "time": "2011-08-19 / 2012-03-12"
}