{
    "text": "vul_name : phpBB 2.0.19 Cross Site Request Forgeries and XSS Admin ， vul_cve : CVE-2006-0437 , CVE-2006-0438 ， vul_poc :  [ phpBB 2.0.19 Cross Site Request Forgeries and XSS Admin ]  ， Author : Maksymilian Arciemowicz ， Date : 3.2.2006 ， CVE-2006-0437 for the XSS issues ， CVE-2006-0438 for the CSRF issues ， - - 0.Description - ， phpBB is a high powered , fully scalable , and highly customizable Open Source bulletin board package. phpBB has a ， user-friendly interface , simple and straightforward administration panel , and helpful FAQ. Based on the powerful PHP ， server language and your choice of MySQL , MS-SQL , PostgreSQL or Access/ODBC database servers , phpBB is the ideal ， free community solution for all web sites. ， Contact with author ， - - 1. XSS admin - ， In admin/admin_smilies.php you can create , modifcate smille. So nothing special but phpBB don't check what is going to db. ， case savenew ， - -448-473- ，  $ smile_code = ( isset (  $ HTTP_POST_VARS [ 'smile_code' ]  )  ) ? $ HTTP_POST_VARS [ 'smile_code' ]  :  ，  $ HTTP_GET_VARS [ 'smile_code' ]  ;  ，  $ smile_url = ( isset (  $ HTTP_POST_VARS [ 'smile_url' ]  )  ) ? $ HTTP_POST_VARS [ 'smile_url' ]  :  ，  $ HTTP_GET_VARS [ 'smile_url' ]  ;  ，  $ smile_url = phpbb_ltrim ( basename (  $ smile_url )  , \"'\" )  ;  ，  $ smile_emotion = ( isset (  $ HTTP_POST_VARS [ 'smile_emotion' ]  )  ) ? ，  $ HTTP_POST_VARS [ 'smile_emotion' ]  :  $ HTTP_GET_VARS [ 'smile_emotion' ]  ;  ，  $ smile_code = trim (  $ smile_code )  ;  ，  $ smile_url = trim (  $ smile_url )  ;  ，  $ smile_emotion = trim (  $ smile_emotion )  ;  ， / If no code was entered complain . ， { ， message_die ( GENERAL_MESSAGE ,  $ lang [ 'Fields_empty' ]  )  ;  ， } ， / Convert < and > to proper htmlentities for parsing. ，  $ smile_code = str_replace ( '<' , '&lt ; ' ,  $ smile_code )  ;  ，  $ smile_code = str_replace ( '>' , '&gt ; ' ,  $ smile_code )  ;  ， / Save the data to the smiley table. ，  $ sql = \"INSERT INTO \" . SMILIES_TABLE . \" ( code , smile_url , emoticon )  ， VALUES ( '\" . str_replace ( \"\\'\" , \"'\" ,  $ smile_code ) . \"' , '\" . str_replace ( \"\\'\" , \"'\" ,  ，  $ smile_url ) . \"' , '\" . str_replace ( \"\\'\" , \"'\" ,  $ smile_emotion ) . \"' ) \" ;  ，  $ result = $ db->sql_query (  $ sql )  ;  ， - -448-473- ， Only \"<\" and \">\" are restricted. ， onmouseover=\"alert ( 'cxsecurity.Com' ) \" &sid=SIDofADMIN ， and you have new smile. Ofcourse you can better do exploit. For IE and etc. ， - - 2. Cross Site Request Forgeries - ， phpBB admin in Administration Panel have SID in url. Ok. Example if you want see user profil or split , lock someone ， post etc. ， Like :  ， etc. ， If this user have \"Link to off-site Avatar\" ON or is bbcode ( IMG ) ON then you can create url to script with referer for admin.So when admin open profil the url will be executed. Need be referer in request. ， Next problem is :  ， 103 # if (  ! preg_match ( \" # ^ ( ht | f ) tp : / )  (  [ ^ \\?&=\\ # \\\"\\n\\r\\t< ]  * ? ( \\. ( jpg | jpeg | gif | png )  $  )  # is\" ,  $ avatar_filename )  )  ， in includes/unsercp_avatar.php. ， Why? Because this preg (  ) don't have limit of chars. ， In mysql phpbb DB you have (  * _users )  ， user_avatar varchar ( 100 )  ， only 100 chars will go to db. ， So you can post url like ， chars ] .jpg ， Sent :  ， and in db is :  ， or in bbcode ( IMG )  ， Nothing special. Ok. ， You need create new user ( nick name can be \"FUCKmeADMIN\" etc ) . And upload one script. Doesn't need be in serverwhere is phpbb. ， - -script.php-",
    "time": "2006.02.03"
}