{
    "text": "vul_name : 4images <= 1.7.1 remote code execution ， vul_cve : CVE-2006-0899 ， vul_poc : - 4images <= 1.7.1 remote code execution - ， software :  ， site :  ， i )  ， vulnerable code in index.php at line 35-54 :  ， . ，  $ template = ( isset (  $ HTTP_GET_VARS [ 'template' ]  ) ? stripslashes ( trim (  $ HTTP_GET_VARS [ 'template' ]  )  : stripslashes ( trim (  $ HTTP_POST_VARS [ 'template' ]  )  ;  ， xtension ) { ，  $ template = \" ;  ， } ，  $ main_template = $ template ;  ， } ， } ，  $ template = \" ;  ， } ， include ( ROOT_PATH.'includes/page_header.php' )  ;  ，  $ clickstream = \"<a href=\". $ site_sess->url ( ROOT_PATH.\"index.php\" ) .\">\". $ lang [ 'home' ] .\"</a ， >\". $ config [ 'category_separator' ] .str_replace ( \"_\" , \" \" , ucfirst (  $ template )  ;  ，  $ site_template->register_vars ( \"clickstream\" ,  $ clickstream )  ;  ，  $ site_template->print_template (  $ site_template->parse_template (  $ main_temp ， late )  ;  ， include ( ROOT_PATH.'includes/page_footer.php' )  ;  ， } ， . ， poc :  ， ./etc/passwd%00 ， This is regardless of magic_quotes_gpc settings because we have stripslashes on ， \"template\" argument ( this is exploitable on PHP 4 , because file_exists (  )  ， function suffers of null char injection. )  ， File comptemt is passed to an eval (  ) in includes/template.php , so it is ， evaluated as php code. ， Also we can upload malicious php code through 4images functionalities inside a ， .jpg file with well crafted EXIF metadata comtempt. ， Example of remote code execution :  ， ia/suntzu1293.jpg%00 ， a php exploit tool availiable here :  ， still a note about :  ， Secunia wrote : \"Input passed to the \"template\" parameter in \"index.php\" isn't ， properly verified , before it is used to include files. This can be exploited to ， include files having the template file extension ( \".html\" ) from local resources ， via directory traversal attacks\" ， and classified it as low risk. this is true on PHP5 but not on PHP4 where you ， can break the .html extension by a null char ， rgod ， site :  ， mail : rgod at autistici.org ， original advisory : ",
    "time": "2006.03.02"
}