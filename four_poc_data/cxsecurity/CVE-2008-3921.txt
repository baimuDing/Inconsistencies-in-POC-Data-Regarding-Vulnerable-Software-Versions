{
    "text": "vul_name : Multiple Vulnerabilities in AWStats Totals ， vul_cve : CVE-2008-3921 , CVE-2008-3922 ， vul_poc : Emory University UTS Security Advisory EMORY-2008-01 ， Topic : Multiple Vulnerabilities in AWStats Totals ， Original release date : August 26 , 2008 ， SUMMARY ， Telartis's AWStats Totals program is vulnerable to command execution ， and cross site scripting attacks. A remote attacker could exploit ， these vulnerabilities to run arbitrary commands on the system with the ， permissions of the web server. ， AFFECTED SOFTWARE ，  * AWStats Totals 1.0 - 1.14 ， UNAFFECTED ，  * AWStats Totals >= 1.15 ， IMPACT ， A remote attacker could exploit these vulnerabilities to run arbitrary ， commands on the web server's host operating system. ， DETAILS ， AWStats Totals takes three URL parameters , \"month , \" \"year , \" and ， \"sort , \" and uses them without checking them for validity. ， The program uses the month and year parameters in output it displays ， to the user. It will display any HTML or Javascript code included in ， these parameters , which the user's browser will then render. ， The program uses the sort parameter to build an anonymous PHP function ， with the create_function (  ) function. ， > function multisort ( & $ array ,  $ key ) { ， > $ cmp = create_function ( ' $ a ,  $ b' ,  ， > 'if (  $ a [ \"'. $ key.'\" ] = $ b [ \"'. $ key.'\" ]  ) return 0 ; '. ， > 'return (  $ a [ \"'. $ key.'\" ] > $ b [ \"'. $ key.'\" ]  ) ? -1 : 1 ; ' )  ;  ， > usort (  $ array ,  $ cmp )  ;  ， > } ， > ， > if (  $ sort = 'config' ) sort (  $ rows )  ; else multisort (  $ rows ,  $ sort )  ;  ， Taking care to match properly the quotes and angle brackets , it is ， possible to insert PHP expressions into the code for the function. For ， example , to run the phpinfo (  ) function , one might set sort to this ， value :  ， \" ] .phpinfo (  ) . $ a [ \" ， Since any code one injects gets run multiple times , however , it may be ， useful to exit the program after a single invocation :  ， \" ] .phpinfo (  ) .exit (  ) . $ a [ \" ， It is also possible to insert PHP expressions through the use of ， variable expansion within strings on newer versions of PHP :  ， { $ {phpinfo (  ) }{ $ {exit (  ) } ， SOLUTION ， Upgrade to AWStats Totals 1.15. ， EXPLOIT",
    "time": "2008.09.06"
}