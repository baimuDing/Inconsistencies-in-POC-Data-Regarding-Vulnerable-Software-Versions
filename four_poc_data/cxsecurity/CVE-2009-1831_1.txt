{
    "text": "vul_name : Winamp 5.551 MAKI Parsing Integer Overflow PoC ， vul_cve : CVE-2009-1831 ， vul_poc : / *  ， Winamp 5.551 MAKI Parsing Integer Overflow Vulnerability ， This is just a simple poc code to show how to ， exploit the recent MAKI file parsing vulnerability. ， Tested on : Vista sp1 and Xpsp3 ， Release Date : May 22 2009 ， Venders web site :  ， Version Teasted : Winamp 5.551 ， Not vulnerable : Winamp 5.552 ， Im not going into any real detail as this is just ， a poc code and i think the guy who wrote the article ， explains where and why the integer overflow happens. ， Im sure if you are that interested have a look through ， the dll your self and you will also see the vulnerable memove :  ) . ， Credits to the guys down at vrt-sourcefire for the overflow. ， We are able to overwrite the exception handlers and gain full ， control of the application the vendors released a patch for this ， but older versions are still vulnerable. !  ， Below is and explanation of the overflow which i took ， from the web site from the url above. ，  [ -Snip- ]  ， .text : 12094DAB var_10144= byte ptr -10144h ， .text : 12094DAB MultiByteStr= byte ptr -13ch ， If a string size is greater than or equal to 0x8000 , edi will be 0xFFFFhhhh ，  ( where , 0xhhhh is the two byte input )  ， .text : 12094F62 loc_12094F62 :  ， .text : 12094F62 mov ax ,  [ ebx ]  ， .text : 12094F65 movsx edi , ax ; sign extension ， .text : 12094F68 inc ebx ， .text : 12094F69 push edi ; Size ， .text : 12094F6A inc ebx ， .text : 12094F6B lea eax ,  [ ebp+MultiByteStr ]  ， .text : 12094F71 push ebx ; Src ， .text : 12094F72 push eax ; Dst , buffer is located in the stack ， .text : 12094F73 call memmove ， .text : 120951E5 loc_120951E5 :  ， .text : 120951E5 mov edi ,  [ ebx ]  ， .text : 120951E7 add ebx , 4 ， .text : 120951EA mov ax ,  [ ebx ]  ， .text : 120951ED movsx esi , ax ; sign extension ， .text : 120951F0 inc ebx ， .text : 120951F1 push esi ; Size ， .text : 120951F2 inc ebx ， .text : 120951F3 lea eax ,  [ ebp+var_10144 ]  ， .text : 120951F9 push ebx ; Src ， .text : 120951FA push eax ; Dst , buffer is located in the stack ， .text : 120951FB call memmove ，  [ -Snip- ]  ， And once the file is created then we need to place the ， mcvcore.maki file inside ./Winamp/Skins/Bento/Scripts/. ， And then open winamp with olldbg.And step through the ， execution. ， Credits to n00b for writing simple poc code !  ， Progression is always a good thing. ， Disclaimer ， The information in this advisory and any of its ， demonstrations is provided \"as is\" without any ， warranty of any kind. ， I am not liable for any direct or indirect damages ， caused as a result of using the information or ， demonstrations provided in any part of this advisory. ， Educational use only. ! ",
    "time": "2009.06.02"
}