{
    "text": "vul_url : ， vul_name : systemd-journald Memory Corruption / Information Leak ， vul_date : 2019.01.10 ， vul_credit_name : Qualys ， vul_risk : Medium ， vul_local : ， vul_remote : ， vul_cve : CVE-2018-16864, CVE-2018-16865, CVE-2018-16866, CVE-2018-14634 ， vul_cwe : ， vul_poc : Qualys Security Advisory ， System Down: A systemd-journald exploit ， Contents ， Summary ， CVE-2018-16864 ， - Analysis ， - Exploitation ， CVE-2018-16865 ， - Analysis ， - Exploitation ， CVE-2018-16866 ， - Analysis ， - Exploitation ， Combined Exploitation of CVE-2018-16865 and CVE-2018-16866 ， - amd64 Exploitation ， - i386 Exploitation ， Acknowledgments ， Timeline ， Conversion, software version 7.0 ， - System of a Down, \"Toxicity\" ， Summary ， We discovered three vulnerabilities in systemd-journald ， - CVE-2018-16864 and CVE-2018-16865, two memory corruptions ， (attacker-controlled alloca()s); ， - CVE-2018-16866, an information leak (an out-of-bounds read). ， CVE-2018-16864 was introduced in April 2013 (systemd v203) and became ， exploitable in February 2016 (systemd v230). We developed a proof of ， concept for CVE-2018-16864 that gains eip control on i386. ， CVE-2018-16865 was introduced in December 2011 (systemd v38) and became ， exploitable in April 2013 (systemd v201). CVE-2018-16866 was introduced ， in June 2015 (systemd v221) and was inadvertently fixed in August 2018. ， We developed an exploit for CVE-2018-16865 and CVE-2018-16866 that ， obtains a local root shell in 10 minutes on i386 and 70 minutes on ， amd64, on average. We will publish our exploit in the near future. ， To the best of our knowledge, all systemd-based Linux distributions are ， vulnerable, but SUSE Linux Enterprise 15, openSUSE Leap 15.0, and Fedora ， 28 and 29 are not exploitable because their user space is compiled with ， GCC's -fstack-clash-protection. ， This confirms ， \"It should be clear that kernel-only attempts to solve [the Stack Clash] ， will necessarily always be incomplete, as the real issue lies in the ， lack of stack probing.\" ， CVE-2018-16864 ， Analysis ， The waves all keep on crashing by ， - System of a Down, \"Suggestions\" ， We accidentally discovered CVE-2018-16864 while working on the exploit ， command-line arguments to a program that calls syslog(), then journald ， crashes: ， systemd-journal[472]: segfault at 7ffe9a077420 ip 00007f45f6174877 sp 00007ffe9a0773f0 error 6 in systemd-journald[7f45f6169000+3f000] ， (gdb) disassemble 0x7f45f6174877 - 0x7f45f6169000 ， Dump of assembler code for function dispatch_message_real.4064: ， . ， 0x000000000000b82c <+988>: callq 0x2bd10 <get_process_cmdline.constprop.96> ， 0x000000000000b831 <+993>: test %eax,%eax ， 0x000000000000b833 <+995>: js 0xb8ea <dispatch_message_real.4064+1178> ， 0x000000000000b839 <+1001>: mov -0x218(%rbp),%rbx ， 0x000000000000b840 <+1008>: test %rbx,%rbx ， 0x000000000000b843 <+1011>: je 0xd31b <dispatch_message_real.4064+7883> ， 0x000000000000b849 <+1017>: mov %rbx,%rdi ， 0x000000000000b84c <+1020>: callq 0x5360 <strlen@plt> ， 0x000000000000b851 <+1025>: add $0xa,%eax ， 0x000000000000b854 <+1028>: cltq ， 0x000000000000b856 <+1030>: add $0x1e,%rax ， 0x000000000000b85a <+1034>: and $0xfffffffffffffff0,%rax ， 0x000000000000b85e <+1038>: sub %rax,%rsp ， 0x000000000000b861 <+1041>: movabs $0x454e494c444d435f,%rax ， 0x000000000000b86b <+1051>: lea 0x37(%rsp),%r15 ， 0x000000000000b870 <+1056>: and $0xfffffffffffffff0,%r15 ， 0x000000000000b874 <+1060>: test %rbx,%rbx ， 0x000000000000b877 <+1063>: mov %rax,(%r15) ， 0x000000000000b87a <+1066>: mov $0x3d,%eax ， 0x000000000000b87f <+1071>: mov %ax,0x8(%r15) ， 0x000000000000b884 <+1076>: lea 0x9(%r15),%rax ， 0x000000000000b888 <+1080>: je 0xb895 <dispatch_message_real.4064+1093> ， 0x000000000000b88a <+1082>: mov %rbx,%rsi ， 0x000000000000b88d <+1085>: mov %rax,%rdi ， 0x000000000000b890 <+1088>: callq 0x5370 <stpcpy@plt> ， 538 static void dispatch_message_real( ， . ， 604 r = get_process_cmdline(ucred->pid, 0, false, &t); ， 605 if (r >= 0) { ， 606 x = strjoina(\"_CMDLINE=\", t);"
}