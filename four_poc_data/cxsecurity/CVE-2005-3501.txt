{
    "text": "vul_name : Clam AntiVirus Cabinet-file handling Denial of Service Vulnerability ， vul_cve : CVE-2005-3501 ， vul_poc : Clam AntiVirus Cabinet-file handling Denial of Service Vulnerability ， iDEFENSE Security Advisory 11.04.05 ， November 4 , 2005 ， I. BACKGROUND ， Clam AntiVirus is a GPL anti-virus toolkit for Unix. ， II. DESCRIPTION ， Remote exploitation of a design error in Clam AntiVirus ClamAV allows ， attackers to cause a denial of service ( DoS ) condition. ， The vulnerability specifically exists with the libmspack library , which ， is included in ClamAV. The vulnerability can be found in the cabd_find ， function within mspack/cabd.c :  ， length = flen - offset ;  ，  [ . read length from file . ]  ， switch ( state ) { ，  [ . ]  ， case 19 :  ， => header has been completely read , cablen has been read from bytes 8-11 ，  [ . ]  ， / * likely cabinet found - try reading it * / ， cab = sys->alloc ( sys , sizeof ( struct mscabd_cabinet_p )  ; => an ， mscabd_cabinet_p entry will be allocated each time ， / * cabinet read correctly !  * / ， offset = caboff + cablen ;  ， => if cablen ( and caboff ) = 0 , offset will be equal to 0 ，  [ . ]  ， / * restart search * / ，  [ . ]  ， length = 0 ;  ， p = pend ;  ， state = 0 ;  ， => if offset = 0 , we will restart at the beginning of the file => ，  ( because length = 0 , so offset will still be zero in the next ， iteration )  ， } ， } ， } ， If this function is called with a length value of zero , an infinite loop ， occurs. The comments above explain the scenario. ， III. ANALYSIS ， Successful exploitation requires an attacker to send a specially ， constructed CAB file through a mail gateway or personal anti-virus ， client utilizing the ClamAV scanning engine. ， The infinite loop will cause the ClamAV software to use all available ， processor resources , resulting in a denial of service or severe ， degradation of system performance. Ultimately , the OOM handler will ， terminate a task in order to alleviate the stress on the system. ， IV. DETECTION ， iDEFENSE has confirmed this vulnerability on ClamAV 0.86.1. All previous ， versions are suspected vulnerable to this issue. ， V. WORKAROUND ， Archive file analysis can be disabled ( -no-archive ) but this can have ， severe impacts on the virus detection functionality. ， VI. VENDOR RESPONSE ， The vendor has released clamav 0.87.1 to address this vulnerability. It ， is available for download at :  ， VII. CVE INFORMATION ， A Mitre Corp. Common Vulnerabilities and Exposures ( CVE ) number has not ， been assigned yet.",
    "time": "2005.11.06"
}