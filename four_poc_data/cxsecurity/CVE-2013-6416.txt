{
    "text": "vul_name : simple_format helper XSS Vulnerability ， vul_cve : CVE-2013-6416 ， vul_poc : XSS Vulnerability in simple_format helper ， There is a vulnerability in the simple_format helper in Ruby on Rails. This vulnerability has been assigned the CVE identifier CVE-2013-6416. ， Versions Affected : 4.0.0 & 4.0.1 ， Not affected : Versions prior to 4.0 ， Fixed Versions : 4.0.2 ， Impact ， The simple_format helper converts user supplied text into html text which is intended to be safe for display. A change made to the implementation of this helper means that any user provided HTML attributes will not be escaped correctly. As a result of this error , applications which pass user-controlled data to be included as html attributes will be vulnerable to an XSS attack. ， All users running an affected release and passing user-controlled html attributes to simple_format should either upgrade or use one of the work arounds immediately. ， Releases ， The 4.0.2 release is available at the normal locations. ， Workarounds ， To work around this issue , take care to escape any user provided data before passing it to simple_format. For example , instead of :  ， simple_format ( some_text , class : params [  : class ]  )  ， You should use ， simple_format ( some_text , class : h ( params [  : class ]  )  ， Patches ， To aid users who aren't able to upgrade immediately we have provided a patch for the 4.0 release series. It is in git-am format and consists of a single changeset. ，  * 4-0-simple_format_xss.patch - Patch for 4.0 series ， Please note that only the 4.0.x and 3.2.x series are supported at present. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases. ， Credits ， Thanks to Kevin Reintjes for reporting the vulnerability to us and helping us work on a fix. ， - Aaron Patterson ， 4-0-simple_format_xss.patch ， From 97b811b7f8d3750635bea7e4f816d1ad71b5f9a1 Mon Sep 17 00 : 00 : 00 2001 ， From : Michael Koziarski <michael @ koziarski.com> ， Date : Tue , 19 Nov 2013 09 : 00 : 08 +1300 ， Subject :  [ PATCH ] Ensure simple_format escapes its html attributes ， The previous behavior equated the sanitize option for simple_format with the ， escape option of content_tag , however these are two distinct concepts. ， This fixes CVE-2013-6416 ， actionpack/lib/action_view/helpers/text_helper.rb | 2 +- ， 1 file changed , 1 insertion ( + )  , 1 deletion ( - )  ， diff -git a/actionpack/lib/action_view/helpers/text_helper.rb b/actionpack/lib/action_view/helpers/text_helper.rb ， index 2ed825e.285d27d 100644 ， - a/actionpack/lib/action_view/helpers/text_helper.rb ， + b/actionpack/lib/action_view/helpers/text_helper.rb ， -266 , 7 +266 , 7 module ActionView ， content_tag ( wrapper_tag , nil , html_options )  ， paragraphs.map { | paragraph |  ， - content_tag ( wrapper_tag , paragraph , html_options , options [  : sanitize ]  )  ， + content_tag ( wrapper_tag , raw ( paragraph )  , html_options )  ， }.join ( \"\\n\\n\" ) .html_safe ， end ， end ， - 1.8.3.4",
    "time": "2013.12.04"
}