{
    "text": "vul_name : Oracle Solaris UCODE_GET_VERSION IOCTL Kernel NULL Pointer Deref ， vul_cve : CVE-2010-0453 ， vul_poc :  ， -BEGIN PGP SIGNED MESSAGE- ， Hash : SHA1 ， Advisory : Oracle Solaris UCODE_GET_VERSION IOCTL Kernel NULL ， Pointer Dereference ， Advisory ID : TKADV2010-001 ， Revision : 1.0 ， Release Date : 2010/01/31 ， Last Modified : 2010/01/31 ， Date Reported : 2009/11/29 ， Author : Tobias Klein ( tk at trapkit.de )  ， Affected Software : Solaris 10 with 127128-11 and w/o 143913-01 ( x86 )  ， OpenSolaris build snv_69 through snv_133 ( x86 )  ， Remotely Exploitable : No ， Locally Exploitable : Yes ， Vendor URL :  ， Vendor Status : Vendor has released an updated version ， Patch development time : 61 days ， CVE-ID : CVE-2010-0453 ， Vulnerability Details :  ， The kernel of Oracle Solaris contains a vulnerability in the code that ， handles UCODE_GET_VERSION IOCTL requests. ， The vulnerability allows a local unprivileged user the ability to panic a ， Solaris x86 Intel-based system ( 32-bit/64-bit mode ) due to a NULL pointer ， dereference. The ability to panic a system is a type of Denial of Service ，  ( DoS ) . ， The issue can be triggered by sending a specially crafted IOCTL request to ， the kernel. ， Technical Details :  ， The following source code references are based on the kernel source code ， available from ， intel/io/ucode_drv.c :  ，  [ . ]  ， static int ， ucode_ioctl ( dev_t dev , int cmd , intptr_t arg , int mode , cred_t * cr , int ，  * rval )  ， { ， . ， switch ( cmd ) { ， case UCODE_GET_VERSION : { ， int size ;  ， uint32_t * revp ,  * rev_array ;  ， ucode_errno_t rc = EM_OK ;  ， STRUCT_DECL ( ucode_get_rev_struct , h )  ;  ， STRUCT_INIT ( h , mode )  ;  ，  [ 1 ] if ( ddi_copyin ( void *  ) arg ,  ， STRUCT_BUF ( h )  , STRUCT_SIZE ( h )  , mode )  ，  [ 2 ] if ( size = STRUCT_FGET ( h , ugv_size ) > NCPU )  ， size * = sizeof ( uint32_t )  ;  ，  [ 3 ] revp = kmem_zalloc ( size , KM_SLEEP )  ;  ， kmem_free ( revp , size )  ;  ， } ，  [ 4 ] rc = ucode_get_rev ( revp )  ;  ，  [ . ]  ，  [ 1 ] The struct 'h' is filled with user controlled IOCTL input data. ，  [ 2 ] The value of 'size' derives from user controlled data. ，  [ 3 ] If 'size' has a value of 0 , kmem_zalloc (  ) will return NULL. This ， results in revp pointing to NULL. ，  [ 4 ] 'revp' is used as a function parameter for ucode_get_rev (  ) . ， i86pc/os/microcode.c :  ，  [ . ]  ，  * Returns microcode revision from the machcpu structure. ， ucode_errno_t ， ucode_get_rev ( uint32_t * revp )  ， { ， int i ;  ， ASSERT ( ucode )  ;  ， ASSERT ( revp )  ;  ， mutex_enter ( &cpu_lock )  ;  ， cpu_t * cpu ;  ，  [ 5 ] revp [ i ] = cpu->cpu_m.mcpu_ucode_info->cui_rev ;  ，  [ . ]  ，  [ 5 ] This assignment leads to a NULL pointer dereference as 'revp = NULL'.",
    "time": "2010.02.06"
}