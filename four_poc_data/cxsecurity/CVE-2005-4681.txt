{
    "text": "vul_name : mIRC buffer overflow ， vul_cve : CVE-2005-4681 ， vul_poc : - 1 - Introduction ， Written by Khaled Mardam-Bey , mIRC is a friendly IRC client that is ， well equipped with options and tools. ， - 2 - Vulnerability description ， Tested on mIRC 6.16 , 6.12 , 6.03 and 5.91 , all result vulnerable. ， Possibly all mIRC versions are vulnerable. ， The code executed are with current user privileges , anyway this bug ， could be dangerous in universities ,  ， cyber coffees , schools and any location with restrictions. ， Adding/editing filters to locate the specified folder for the files ， transfered by DCC if insert a string greater ， or equal to 981 bytes the application crash showing an memory error 0x0000. ， This 0x0000 error it's because shows the value of the second edit ， field and it's empty , if write AAAA in this field ,  ， the error it's 0x41414141 , overwrite the eip and can take the control ， to execute arbitrary code. ， To execute code appears a little problem , only can write 39chars in ， the second edit , this problem imposibilite insert ， a good shellcode , to fix this , can put jmp esp + sub esp 0x74 + jmp ， esp , with this , the EIP it's overwrited by the text ， in the first edit field , and in this have 980bytes for the shellcode. ， - 3 - How to exploit it ， This PoC open a cmd.exe , also it's possible execute any other code. ， - CUT HERE - ， mIRCexploitXPSP2eng.c ， Vulnerability tested on Windows XP SP1 , SP2 Spanish ， and Windows XP SP2 English ， This PoC it's for XP SP2 English , for spanish readers :  ， XP SP1 ， system : 0x77bf8044 ， jmp esp : 0x77E29BBB ( advapi32.dll )  ， XP SP2 ， system : 0x77bf93c7 ， jmp esp : 0x77E37BBB ( advapi32.dll )  ， Special thanks to rojodos ( very great your tutorial )  ,  ， jocanor , otromasf , crazyking and gandalfj.",
    "time": "2005.12.22"
}