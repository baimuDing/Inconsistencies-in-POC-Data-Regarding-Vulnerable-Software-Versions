{
    "text": "vul_name : Original Photo Gallery Remote Command Execution ， vul_cve : CVE-2007-5224 ， vul_poc : Original Photo Gallery Remote Command Execution ， Name Original Photo Gallery Remote Command Execution ， Systems Affected Original 0.11.2 version and below ， Severity High ， Vendor ， Advisory ， Author Francesco `ascii` Ongaro , Antonio `s4tan` Parata ， Date 20070919 ， I. BACKGROUND ， \"Original is a set of scripts to get your digital photos on the web. It ， aims to be as simple to maintain as possible.\" ， The systems consist of two parts : \"a client side script to scale your ， images to different sizes , create archives of an album , attach optional ， metadata\" and a \"php script to render html pages of the picture ， gallery\". ， II. DESCRIPTION ， It's possible to execute arbitrary code on remote systems which have ， installed a vulnerable software version. ， III. ANALYSIS ， The file \"inc/exif.inc.php\" contains the following vulnerable statement :  ， exec ( \" $ exif_prog \\\" $ gallery_dir/ $ galerie/lq/img- $ snimek.jpg\\\" ,  ，  $ exif_data ,  $ exif_status )  ; \". ， If PHP is configured with the \"globals on\" option , an attacker can ， execute arbitrary code doing a direct request to the file and sending ， shell commands in the parameter/value $ exif_prog. ， IV. DETECTION ， mp/p0wn3d.txt ;  ， The request should create a file in the /tmp directory ( on Unix systems )  ， named p0wn3d.txt. If this happens than you have a vulnerable version of ， the software ( and a really risky PHP setup ) . ， A rapid measurement show that ~ 10% systems are vulnerable of about ， 17'000 listed on Google ( using the dork : \"Generated by Original ver\" ) . ， V. WORKAROUND ， Upgrade to the new version 0.11.3 witch fix this vulnerability. ， Or if unable to upgrade :  ， 1 ) Disable access to the directory using Limit ( vhosts/.htaccess ) . ， 2 ) Disable execution using disable_functions in php.ini. ， The result is :  ， Warning : exec (  ) has been disabled for security reasons in ， /home/XX/inc/exif.inc.php on line 157 ， 3 ) Deny direct access to the file in the PHP code by checking for a ， define or requested url. ， VI. VENDOR RESPONSE ， The vendor has promptly replied and addressed the problem issuing a ， new release. ， Original version 0.11.3 is available here :  ， VII. CVE INFORMATION ， No CVE at this time.",
    "time": "2007.10.05"
}