{
    "text": "vul_name : OpenSSL 0.9.8y/1.x/1.0.1e man-in-the-middle attack 0day ， vul_cve : CVE-2013-6450 ， vul_poc : For DTLS we might need to retransmit messages from the previous session ， so keep a copy of write context in DTLS retransmission buffers instead ， of replacing it after sending CCS. CVE-2013-6450. ， diff -git a/CHANGES b/CHANGES ， index cfaebba.173be24 100644 ( file )  ， - a/CHANGES ， + b/CHANGES ， -4 , 6 +4 , 11 ， Changes between 1.0.1e and 1.0.1f [ xx XX xx ]  ， + *  ) Keep original DTLS digest and encryption contexts in retransmission ， + structures so we can use the previous session parameters if they need ， + to be resent. ( CVE-2013-6450 )  ， + [ Steve Henson ]  ， + ，  *  ) Add option SSL_OP_SAFARI_ECDHE_ECDSA_BUG ( part of SSL_OP_ALL ) which ， avoids preferring ECDHE-ECDSA ciphers when the client appears to be ， Safari on OS X. Safari on OS X 10.8.10.8.3 advertises support for ， diff -git a/ssl/d1_both.c b/ssl/d1_both.c ， index 65ec001.7a5596a 100644 ( file )  ， - a/ssl/d1_both.c ， + b/ssl/d1_both.c ， -214 , 6 +214 , 12 dtls1_hm_fragment_new ( unsigned long frag_len , int reassembly )  ， static void ， dtls1_hm_fragment_free ( hm_fragment * frag )  ， { ， + ， + if ( frag->msg_header.is_ccs )  ， + { ， + EVP_CIPHER_CTX_free ( frag->msg_header.saved_retransmit_state.enc_write_ctx )  ;  ， + EVP_MD_CTX_destroy ( frag->msg_header.saved_retransmit_state.write_hash )  ;  ， + } ， OPENSSL_free ( frag )  ;  ， diff -git a/ssl/ssl_locl.h b/ssl/ssl_locl.h ， index 96ce9a7.e485907 100644 ( file )  ， - a/ssl/ssl_locl.h ， + b/ssl/ssl_locl.h ， -621 , 6 +621 , 8 extern SSL3_ENC_METHOD TLSv1_enc_data ;  ， extern SSL3_ENC_METHOD SSLv3_enc_data ;  ， extern SSL3_ENC_METHOD DTLSv1_enc_data ; ",
    "time": "2014-01-05 / 2014-01-06"
}