{
    "text": "vul_url : ， vul_name : Advisory: Remote command execution in planetGallery ， vul_date : 2006.07.26 ， vul_credit_name : RedTeam Pentesting (release redteam-pentesting de) ， vul_risk : Low ， vul_local : No ， vul_remote : Yes ， vul_cve : CVE-2006-3676 ， vul_cwe : CWE-Other ， vul_poc : Advisory: Remote command execution in planetGallery ， An admin of planetGallery is allowed to create new galleries and upload ， images. Because of a vulnerable regular expression, he may also upload ， PHP scripts and thereby execute arbitrary commands with the privileges ， of PHP. ， Details ， Product: planetGallery ， Affected Versions: <= 22.05.2006 ， Fixed Versions: 14.07.2006 ， Vulnerability Type: Remote command execution ， Security-Risk: low ， Vendor-URL: ， Vendor-Status: informed, fixed version released ， Advisory-URL: ， Advisory-Status: public ， CVE: CVE-2006-3676 ， CVE-URL: ， Introduction ， PlanetGallery is a commercial PHP script which is used to publish image ， galleries, show image descriptions and send picture postcards generated ， from the galleries. ， More Details ， The faulty regular expression is in admin/gallery_admin.php: ， 193 $allow_file_types = 'gif|jpg|jpeg|png|bmp'; ， [.] ， 197 if (preg_match('#.'.$allow_file_types.'?#i', ， $_FILES['grafik']['name'][$i]) { ， [.] ， Each variable $_FILES['grafik']['name'][$i] contains the filename of an ， uploaded file. Only images with filename extensions supplied in ， $allow_file_types are allowed, but the regular expression also matches ， files like 'example.png.php'. Webservers interprete this as a PHP script. ， Proof of Concept ， Create a gallery and upload a PHP script named 'evil.png.php'"
}