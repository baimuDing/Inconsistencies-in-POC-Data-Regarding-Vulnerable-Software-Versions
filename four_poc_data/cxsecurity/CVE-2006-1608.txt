{
    "text": "vul_name : copy (  ) Safe Mode Bypass PHP 4.4.2 and 5.1.2 ， vul_cve : CVE-2006-1608 ， vul_poc : -BEGIN PGP SIGNED MESSAGE- ， Hash : SHA1 ，  [ copy (  ) Safe Mode Bypass PHP 4.4.2 and 5.1.2 ]  ， Author : Maksymilian Arciemowicz ( cXIb8O3 )  ， Date :  ， - -Written : 2.4.2006 ， - -Public : 8.4.2006 ， from SECURITYREASON.COM ， CVE-2006-1608 ， - - 0.Description - ， PHP is an HTML-embedded scripting language. Much of its syntax is borrowed from C , Java and Perl with a couple of unique PHP-specific features thrown in. The goal of the language is to allow web developers to write dynamically generated pages quickly. ， A nice introduction to PHP by Stig S& # 230 ; ther Bakken can be found at on the Zend website. Also , much of the PHP Conference Material is freely available. ， The PHP safe mode is an attempt to solve the shared-server security problem. It is architecturally incorrect to try to solve this problem at the PHP level , but since the alternatives at the web server and OS levels aren't very realistic , many people , especially ISP's , use safe mode for now. ， - - 1. Safe Mode Bypass - ， General problem exists in safe mode function , because safe mode accept path like \"compress.zlib : /\". ， PHP442 File \"main/safe_mode.c\" ， - -78-80- ， wrapper = php_stream_locate_url_wrapper ( filename , NULL , STREAM_LOCATE_WRAPPERS_ONLY TSRMLS_CC )  ;  ， - -78-80- ， Let`s see the function php_stream_locate_url_wrapper (  ) . ， PHP442 File \"main/streams.c\" ， - -2522-2588- ， PHPAPI php_stream_wrapper * php_stream_locate_url_wrapper ( const char * path , char path_for_open , int options TSRMLS_DC )  ， { ， HashTable * wrapper_hash = ( FG ( stream_wrappers ) ? FG ( stream_wrappers )  : &url_stream_wrappers_hash )  ;  ， php_stream_wrapper * wrapper = NULL ;  ， const char * p ,  * protocol = NULL ;  ， int n = 0 ;  ，  * path_for_open = ( char *  ) path ;  ， n+ ;  ， } ， protocol = path ;  ， } else if ( strncasecmp ( path , \"zlib : \" , 5 ) = 0 ) { ， / * BC with older php scripts and zlib wrapper * / ， protocol = \"compress.zlib\" ;  ， n = 13 ;  ， php_error_docref ( NULL TSRMLS_CC , E_WARNING , \"Use of \\\"zlib : \\\" wrapper is deprecated ; please use \\\"compress.zlib : /\\\" instead.\" )  ;  ， } ， } ， char wrapper_name [ 32 ]  ;  ， n = sizeof ( wrapper_name ) - 1 ;  ， PHP_STRLCPY ( wrapper_name , protocol , sizeof ( wrapper_name )  , n )  ;  ， php_error_docref ( NULL TSRMLS_CC , E_NOTICE , \"Unable to find the wrapper \\\"%s\\\" - did you forget to enable it when you configured PHP?\" ,  ， wrapper_name )  ;  ， } ， wrapper = NULL ;  ， protocol = NULL ;  ， } ， } ， / * TODO : curl based streams probably support file : / properly * / ， php_error_docref ( NULL TSRMLS_CC , E_WARNING , \"remote host file access not supported , %s\" , path )  ;  ， } ，  * path_for_open = ( char *  ) path + n + 1 ;  ， / * fall back on regular file access * / ， } ， php_error_docref ( NULL TSRMLS_CC , E_WARNING , \"URL file-access is disabled in the server configuration\" )  ;  ， } ， } ， - -2522-2588- ， So if you use in your path ( for example \"compress.zlib : /\" )  , function php_stream_locate_url_wrapper (  ) return something variable and safe mode return 1. ， Let's see now the source of function copy (  ) . ， PHP442 : ext/standard/file.c ， - -2114-2138- ， PHP_FUNCTION ( copy )  ， { ， zval source , target ;  ， WRONG_PARAM_COUNT ;  ， } ， convert_to_string_ex ( source )  ;  ， convert_to_string_ex ( target )  ;  ， RETURN_FALSE ;  ， } ， RETURN_FALSE ;  ， } ， RETURN_TRUE ;  ， } else { ， RETURN_FALSE ;  ， } ， } ， - -2114-2138- ， Description ， bool copy ( string source , string dest )  ， example :  ， copy ( \"compress.zlib : /etc/passwd\" , \"/home/cxib/to/bandyta/passwd.txt\" )  ;  ， safe mode return 1 and skip security. ， RETURN_FALSE ;  ， } ， Rest functions have checking safe_mode without path and safe mode works. I don't have tested all functions in php ;  ] . ， - - 2. How to fix - ， CVS ， - - 3. Exploit - ， - - 4. Greets - ， For : sp3x ， and ， p_e_a , eax , Infospec ， - - 5. Contact - ， Author : SecurityReason.Com [ Maksymilian Arciemowicz ( cXIb8O3 )  ]  ， Email : max [ at ] jestsuper [ dot ] pl or cxib [ at ] securityreason [ dot ] com ， GPG :  ， SecurityReason.Com",
    "time": "2006.04.08"
}