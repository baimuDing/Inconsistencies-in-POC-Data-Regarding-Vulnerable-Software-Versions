{
    "text": "vul_name : Half-Life AMX-Mod remote ( root ) hole ， vul_cve : CVE-2003-1381 ， vul_poc :  [ void.at Security Advisory VSA0308 - mailto : crew at void dot at ]  ， AMX [ 1 ] is a plugin for the \"Half-Life Server\" , hosting ， the most popular online game today , \"Counter-Strike\" , among ， others. ， Overview ， Due to a format string bug in AMX , it is possible ， remotely exploit the gameserver. Since most game-server- ， admins I've seen are not very security-aware , the server ， generally runs as root. ， The rcon-password can be obtained using social engineering ， or sniffing-techniques , since it is being transmitted ， in plaintext. It is needed because the vulnerable function ， can only be called via rcon. ， Affected Versions ， All AMX versions <= 0.9.2 on Windows and Linux. ， Successfully tested with AMX 0.9.2 running on ， hlds 3.1.1.0 on Linux. ， Impact ， High. Remote-shell and very likely remote-root. ， Details ， This is a format string bug in the \"amx_say\"-command. ， I can't provide a code snipplet since this plugin is ， closed source. A word to the AMX-Team : closed source ， doesn't protect you against security bugs !  ， rcon-output :  ， log on ， amx_say %08x.%08x ，  ( ALL ) hoschLAN CS 1.5 Public : %08x.%08x ， L 02/26/2003 - 18 : 39 : 09 : Chat : \"hoschLAN CS 1.5 Public ， <0><><>\" say \"%08x.%08x\" ， L 02/26/2003 - 18 : 39 : 09 : \"hoschLAN CS 1.5 Public ， <0><><>\" triggered \"amx_say\" ( text \"00000006.bffff258\" )  ， Solution ， Disable AMX until a patched version becomes available. ， Change the rcon-password. ， Exploit ， Please find attached a demonstration exploit. Note that it will ， only work against a Linux-server due to the exploitation technique. ， This does NOT mean that Windows-servers are not vulnerable , they ， still suffer from the same hole. ， Sample exploitation session ， greuff @ saturn :  ~  $ ./hoagie_amx localhost 27015 myprecious ， hoagie_amx - remote exploit for hlds servers using the amx plugin ， by greuff ( at ) void ( dot ) at [ email concealed ]  ， Getting stackpop count. ， Stackpops found : 118 , Padding : 1 ， Writing shellcode. ， Connecting to the shell. ， Connect to the shell ， id ， uid=0 ( root ) gid=0 ( root ) groups=0 ( root )  , 101 ( lpadmin )  ， exit ， Discovered by ， greuff <greuff ( at ) void ( dot ) at [ email concealed ] > ， Timeline ， 02-11-2003 : informed djeyl ( at ) djeyl ( dot ) net [ email concealed ] about the issue ( AMX-developer )  ， gave 14 days to release patched version to the public ， 02-16-2003 : olo ( at ) counter-strike ( dot ) pl [ email concealed ] sent me a patched AMX version ， 02-20-2003 : confirmed that patched AMX version closes the hole ， 02-25-2003 : 14 days over : AMX-developers still didn't release a ， fixed version ， 02-26-2003 : public disclosure ， Credits ， void.at ， everyone who was at 19c3 ，  [ 1 ]  ，  * hoagie_amx.c ，  * Remote exploit for Halflife-Servers running the AMX-Plugin ，  *  ( rcon-password required )  ，  * Binds a shell to port 30464/tcp and connects to it. ，  * Author : greuff ( at ) void ( dot ) at [ email concealed ]  ，  * Tested with HL-Server v3.1.1.0 and AMX 0.9.2 on Linux",
    "time": "2007.10.20"
}