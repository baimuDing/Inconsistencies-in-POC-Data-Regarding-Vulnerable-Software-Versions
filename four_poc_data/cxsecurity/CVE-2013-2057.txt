{
    "text": "vul_name : YaBB 2.5.2 and earlier arbitrary code execution ， vul_cve : CVE-2013-2057 ， vul_poc : Yet another Bulletin Board ( YaBB ) 2.5.2 and earlier allow arbitrary ， code execution through a combination of file uploads with ， predictable locations and unsanitized use of the \"guestlanguage\" ， cookie in file paths. ， This problem is similar to CVE-2007-3295. ， In Load.pl find :  ， CodeSelect All ，  $ language = $ guestLang = $ yyCookies{'guestlanguage'} ;  ， } ， replace with :  ， CodeSelect All ，  !  $ FORM{'guestlang'} ，  $ enable_guestlanguage )  ， { opendir DIR ,  $ langdir ;  ， my @ langDir = readdir DIR ;  ， closedir DIR ;  ，  @ lang = (  )  ;  ， foreach my $ langitems ( sort { lc (  $ a ) cmp lc $ b } @ langDir ) { ， chomp $ langitems ;  ，  (  $ langitems ne q{.} )  ，  (  $ langitems ne q{.htaccess} )  ，  (  $ langitems ne q{index.html} )  )  ， { ， push @ lang ,  $ langitems ;  ， } ， } ，  $ ccheck = 0 ;  ，  $ clang = q{} ;  ，  $ clang = $ lng ;  ，  $ ccheck = 1 ; last ;  ， } ， } ，  $ language = $ guestLang = $ clang ;  ， } ， } ， And I'm sure Carsten will have a much neater way of doing this. ， While I can't confirm that the security vulnerability has ever been exploited against a YaBB Forum , I'm pretty sure that the original code allows for the possibility of bad stuff being passed into the $ language variable - which is a very bad thing. ， The new code compares what's in the guestlanguage cookie against the possible valid options - the Languages in the Language folder on the server. If it's not a valid value , it doesn't get passed along. ( At least that's how it should work. ) ",
    "time": "2013.05.05"
}