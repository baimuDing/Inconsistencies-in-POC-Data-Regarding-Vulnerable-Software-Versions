{
    "text": "vul_name : Punbb SQL Injection Vulnerability ， vul_cve : CVE-2005-3518 ， vul_poc :  [ KAPDA :  # 6 ] Punbb SQL Injection Vulnerability ， Punbb search.php SQL Injection Vulnerability ， KAPDA New advisory ， Vulnerable products : Punbb ( V 1.2.8 and 1.2.7 are tested , Hopefully all other versions )  ， Vendor :  ， Vulnerability : Sql injection ， About Punbb ， PunBB is a fast and lightweight PHP-powered discussion board. It is released under the GNU ， General Public License. Its primary goals are to be faster , smaller and less graphically intensive ， as compared to other discussion boards. PunBB has fewer features than many other discussion ， boards , but is generally faster and outputs smaller , semantically correct XHTML-compliant pages. ， Vendor`s description :  ， Discussion :  ， Scripts in page \"Search.php\" do not properly validate user-supplied input. A remote user can ， create specially crafted parameter values that will execute SQL commands on the underlying ， database. ， While \"Global_register\" of php.ini is set ON , Remote user can poison local variables ， of PHP pages to take control of web application or change its logical flow. ， Vulnerabilities :  ， In Search.php :  ， . start . ， { ，  $ old_searches [  ] = '. $ db->escape (  $ row [ 0 ]  ) .' ;  ，  $ db->query ( 'DELETE FROM '. $ db->prefix.'search_cache WHERE ident NOT IN ( ' ， .implode ( ' , ' ,  $ old_searches ) .' ) ' ) or error ( 'Unable to delete search results' ，  , _FILE_ , _LINE_ ,  $ db->error (  )  ;  ， } ， . end . ， The 4th line of pasted code sets old_searches [  ]  ( array ) to carefully validated data ,  ， returned from database and then at next line it sends another query containing ， old_searches [  ] . ， If \"Global_register\" of php.ini is set ON and there is no SQL injection filters ( or magic_quotes )  ， then poisoning old_searches can let remote users directly execute SQL commands. ， Proof of Concepts :  ， forum=-1&search_in=all&sort_by=0&sort_dir=DESC&show_as=topics ， &search=Submit&old_searches [  ] = [ sql injection ] ",
    "time": "2005.10.15"
}