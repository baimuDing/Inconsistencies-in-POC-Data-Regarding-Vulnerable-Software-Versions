{
    "text": "vul_name : ContentNow CMS 1.39 Sql Injection + Path Disclosure Vulnerabilities ， vul_cve : CVE-2006-6157 ， vul_poc : -BEGIN PGP SIGNED MESSAGE- ， Hash : SHA1 ， ContentNow CMS 1.39 'pageid' Sql Injection + Path Disclosure ， Severity : Medium Risk ， Vendor :  ， Author : Revenge ，  [ - ]  ，  [  #  ] Description ， ContentNow is a PHP Content Management System web 2.0 compliant , more ， info can be found at vendor site. ， ContentNow v1.39 is vulnerable to a sql injection and path disclosure. ，  [ - ]  ， Vuln # 1 : Sql Injection ， Impact : Admin credentials disclosure ， Exploit :  ，  ( Works regardless of magic quotes )  ， The \"pageid\" parameter in \"index.php\" isn't properly sanitised before ， being used in a sql query , this can be exploited to manipulate existing ， SQL query by inserting arbitrary SQL code , which can disclose sensitive ， information like admin credentials. ， The problem is due to :  ，  [ index.php ]  ， . ， . ， / get/set id or startpageid from config ， -> $ pid = $ _GET [ 'pageid' ]  ;  ，  $ cnEngine->configArray [ 0 ]  [ 'startpageid' ]  ;  ， -> if ( false = $ cnEngine->checkPid (  $ pid ) die ( '<span ， style=\"font : 13px sans-serif ; \">Error loading site. No pid found.</span>' )  ;  ，  $ cnEngine->setId (  $ pid )  ;  ， . ， . ，  [ function checkPid (  $ pid ) and getActualContent (  $ param ) from ， /cn/library/class.engine.php ]  ， . ， . ，  $ cnDatabase = NewADOConnection ( ADODB_DB_TYPE )  ;  ，  $ cnDatabase->Connect ( CN_DB_HOST , CN_DB_USER ,  ， CN_DB_PASSWORD , CN_DB_NAME )  ;  ，  $ sql = \"SELECT pageid FROM \".CN_TBL_SECTIONS.\" WHERE ， pageid = \". $ pid ;  ，  $ res = $ cnDatabase->Execute (  $ sql )  ;  ， } else { ， } ， } ， . ， . ，  $ cnDatabase = NewADOConnection ( ADODB_DB_TYPE )  ;  ，  $ cnDatabase->Connect ( CN_DB_HOST , CN_DB_USER ,  ， CN_DB_PASSWORD , CN_DB_NAME )  ;  ，  $ sql = \"SELECT \".TABLE_FIELDS_CONTENT.\" FROM ， \".CN_TBL_CONTENT. $ this->contentLanguageSuffix.\" WHERE pid = ， \". $ this->pageid.\" AND deleted = 0 \". $ param.\" ORDER by sort ASC\" ;  ，  $ res = $ cnDatabase->Execute (  $ sql )  ;  ，  $ row [ 'contenttitle' ] = ， stripslashes (  $ row [ 'contenttitle' ]  )  ;  ，  $ row [ 'contentsyskey' ] = ， stripslashes (  $ row [ 'contentsyskey' ]  )  ;  ，  $ row [ 'contentsubtitle' ] = ， stripslashes (  $ row [ 'contentsubtitle' ]  )  ;  ，  $ row [ 'content' ] = ， str_replace ( '\"' , '\"' ,  $ row [ 'content' ]  )  ;  ，  $ contentArray [  ] = $ row ;  ， } ， } ，  $ this->contentArray = $ contentArray ;  ， } ， As you can see there's no input validation on \"pageid\" parameter. ， Vuln # 2 : It is also possible to disclose the full path to index.php by ， requesting index.php?pageid=' ，  [ - ]  ，  [  #  ] Solution ， Download 1.40 version. ，  [  #  ] Disclosure timeline ， 2006/11/20 Bug discovered ， 2006/11/20 Vendor contacted ， 2006/11/21 Vendor response ， 2006/11/21 New version 1.40 released ， 2006/11/21 Public Disclosure ， Revenge",
    "time": "2006.11.30"
}