{
    "text": "vul_name : PHP 5.2.10/5.3.0 ( zend_ini.c ) Memory Disclosure ， vul_cve : CVE-2009-2626 ， vul_poc :  [ PHP 5.2.10/5.3.0 ( zend_ini.c ) Memory Disclosure ]  ， Author : Maksymilian Arciemowicz ， Date :  ， - - Dis. : 10.07.2009 ， - - Pub. : 06.08.2009 ， Risk : High ， Affected Software :  ， - - PHP 5.3.0 ， - - PHP 5.2.10 ， - - 0.Description - ， PHP is an HTML-embedded scripting language. Much of its syntax is borrowed from C , Java and Perl with a couple of unique PHP-specific features thrown in. The goal of the language is to allow web developers to write dynamically generated pages quickly. ， ini_restore ? Restores the value of a configuration option ， ini_restore ( string $ varname )  ， - - 1. PHP 5.2.10/5.3.0 ( zend_ini.c ) Memory Disclosure - ， The main problem exist in restoring php config environments. To demonstrate the problem , we need to declare variables via ini_set (  ) function. When we try use ini_restore (  )  , variables in class PG (  ) will indicate any part of memory. ， - -zend_ini.c- ， static int zend_restore_ini_entry_cb ( zend_ini_entry * ini_entry , int stage TSRMLS_DC ) / * { * / ， { ， zend_try { ， / * even if on_modify bails out , we have to continue on with restoring ,  ， since there can be allocated variables that would be freed on MM shutdown ， and would lead to memory corruption later ini entry is modified again * / ， ini_entry->on_modify ( ini_entry , ini_entry->orig_value , ini_entry->orig_value_length , ini_entry->mh_arg1 , ini_entry->mh_arg2 , ini_entry->mh_arg3 , stage TSRMLS_CC )  ;  ， } zend_end_try (  )  ;  ， } ， efree ( ini_entry->value )  ;  ， } ， ini_entry->value = ini_entry->orig_value ;  ， ini_entry->value_length = ini_entry->orig_value_length ;  ， ini_entry->modified = 0 ;  ， ini_entry->orig_value = NULL ;  ， ini_entry->orig_value_length = 0 ;  ， ini_entry->modifiable = 3 ;  ， } ， } ， } ， - -zend_ini.c- ， Flag modified will be reset , and we can not considered modified variable. ， We don't check value of ini_entry->on_modify (  ) and PG (  ) will be now out of memory range. ， To demonstrate this issue ， - -example0 ( 5.2.10/5.3.0 ) - ， 127 # uname -a php -v ， OpenBSD 127.cxib 4.6 GENERIC # 0 i386 ， PHP 5.2.10 with Suhosin-Patch 0.9.7 ( cli )  ( built : Jul 5 2009 21 : 43 : 12 )  ， Copyright ( c ) 1997-2009 The PHP Group ， Zend Engine v2.2.0 , Copyright ( c ) 1998-2009 Zend Technologies ， with Suhosin v0.9.27 , Copyright ( c ) 2007 , by SektionEins GmbH ， 127 # cat /var/www/www/sess.php",
    "time": "2009.08.08"
}