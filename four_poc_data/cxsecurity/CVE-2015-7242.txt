{
    "text": "vul_url : ， vul_name : AVM FRITZ!OS HTML Injection ， vul_date : 2016.01.08 ， vul_credit_name : Dr. Daniel Schliebner ， vul_risk : Low ， vul_local : No ， vul_remote : Yes ， vul_cve : CVE-2015-7242 ， vul_cwe : CWE-79 ， vul_poc : ， -BEGIN PGP SIGNED MESSAGE- ， Hash: SHA1 ， Security Advisory ， Title: HTML Injection Vulnerability ， Product: AVM FRITZ!OS ， Vulnerable Version: All versions prior to 6.30 ， Fixed Version: 6.30 ， CVE-ID: CVE-2015-7242 ， Impact: medium ， found: 2015-06-02 ， by: Dr. Daniel Schliebner <mail@ds-develop.de> ， Vendor Description: ， \"AVM offers a wide range of products for high-speed broadband ， connectivity and smart home networking. With the FRITZ! product family, ， AVM is a leading manufacturer of broadband devices for ADSL, cable, and ， LTE as well as Smart Home products for wireless LAN, DECT, and Powerline ， in Germany and Europe. The FRITZ!Box is the best known brand for ， wireless routers in Germany. In 2014 the communications specialist had ， 500 employees and generated a turnover of 340 million euros.\" ， Vulnerability Description: ， Current FRITZ!Box router with supported VoIP functionality have open ， port 5060 in order to send and receive SIP messages for ip telephony. In ， order to get noticed for incoming calls in absence, many such FRITZ!Box ， can be set up to send notice e-mails to a user with the callers phone ， number and its display-name (if given) inserted into the e-mail. ， Due to intrinsic problems with SIP communication, a user agent client ， (UAC), however, needs not to perform a VoIP call by using registrars but ， can simply initiate an SIP call to another UAC which then has the role ， of a user agent server (UAS). ， When the UAC sends an INVITE message to the UAS coming with a valid ， phone number, it initiates a ringing on the UAS. In this case, the ， FRITZ!Box will send a notification e-mail as described above. It uses ， the display-name and the phone number specified in the From: header for ， the \"who has called\" information in the notification e-mail. However, ， these information are not properly escaped so forged display-names will ， be inserted invalidated into the e-mail. ， This vulnerability can be exploited to perform e.g. CSRF attacks on the ， client or similar by embedding <img> or <a> tags into the display-name ， with an src attribute pointing to some malicious destination. ， However, the good news is that attackers need to be creative here since ， the length of the display-name is limited to 20 characters so the ， embedded HTML code needs to be very short. Using appropriate, very short ， URLs, however, can still be used to exploit this vulnerability in a ， serious manner. ， Informally, a possible attack would look as follows. ， We start by finding a valid user's phone number by trying SIP OPTIONS ， messages on the FRITZ!Box until we receive a ， SIP/2.0 200 OK ， response. We thus obtain the phone number and can send the forged INVITE ， SIP message to the FRITZ!Box. As a result, the notification e-mail to ， the end user will contain the unescaped sender's FROM display-name and ， hence possibly embedded HTML code."
}