{
    "text": "vul_name : Apple Safari 10.0.3 ( 12602.4.8 ) Editor : Command : execute Universal Cross-Site Scripting ， vul_cve : CVE-2017-2504 ， vul_poc : < ! - ， Here's a snippet of Editor : Command : execute used to handle | document.execCommand | . ， bool Editor : Command : execute ( const String& parameter , Event * triggeringEvent ) const ， { ， / Let certain commands be executed when performed explicitly even if they are disabled. ， } ， m_frame->document (  ) ->updateLayoutIgnorePendingStylesheets (  )  ;  ， } ， This method is invoked under an | EventQueueScope | . But | updateLayoutIgnorePendingStylesheets | invokes | MediaQueryMatcher : styleResolverChanged | that directly calls | handleEvent | not affected by | EventQueueScope | . So it may end up to fire javascript handlers (  | listener | in PoC ) . If we replace the document in that handler ,  | m_command | will be executed on the new document's focused element. We can use # in URL to give a focus. ， Note 1 : The PoC also trigger a UAF. So I recommend to test it on a release build. ， Note 2 : If the PoC doesn't work , adjust sleep (  ) . ， Tested on Safari 10.0.3 ( 12602.4.8 ) . ， PoC :  ， ->",
    "time": "2017.05.25"
}