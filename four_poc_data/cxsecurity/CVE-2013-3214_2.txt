{
    "text": "vul_name : vtiger CRM 5.4.0 PHP Code Injection ， vul_cve : CVE-2013-3214 ， vul_poc : - ， vtiger CRM <= 5.4.0 ( vtigerolservice.php ) PHP Code Injection Vulnerability ，  [ - ] Software Link :  ，  [ - ] Affected Versions :  ， All versions from 5.0.0 to 5.4.0. ，  [ - ] Vulnerability Description :  ， The vulnerable code is located in the AddEmailAttachment SOAP method defined in /soap/vtigerolservice.php :  ， 458. function AddEmailAttachment (  $ emailid ,  $ filedata ,  $ filename ,  $ filesize ,  $ filetype ,  $ username ,  $ session )  ， 459. { ， 460. if (  ! validateSession (  $ username ,  $ session )  ， 461. return null ;  ， 462. global $ adb ;  ， 463. require_once ( 'modules/Users/Users.php' )  ;  ， 464. require_once ( 'include/utils/utils.php' )  ;  ， 465. $ filename = preg_replace ( '/\\s+/' , '_' ,  $ filename )  ; /replace space with _ in filename ， 466. $ date_var = date ( 'Y-m-d H : i : s' )  ;  ， 467. ， 468. $ seed_user = new Users (  )  ;  ， 469. $ user_id = $ seed_user->retrieve_user_id (  $ username )  ;  ， 470. ， 471. $ crmid = $ adb->getUniqueID ( \"vtiger_crmentity\" )  ;  ， 472. ， 473. $ upload_file_path = decideFilePath (  )  ;  ， 474. ， 475. $ handle = fopen (  $ upload_file_path. $ crmid.\"_\". $ filename , \"wb\" )  ;  ， 476. fwrite (  $ handle , base64_decode (  $ filedata )  ,  $ filesize )  ;  ， 477. fclose (  $ handle )  ;  ， The vulnerability exists because this method fails to properly validate input passed through the \"filedata\" and ， \"filename\" parameters , which are used to write an \"email attachment\" in the storage directory ( lines 475-477 ) . ， This can be exploited to write ( or overwrite ) files with any content , resulting in execution of arbitrary PHP code.",
    "time": "2013.08.02"
}