{
    "text": "vul_name : Windows x86 afd.sys Privilege Escalation ， vul_cve : CVE-2011-1249 ， vul_poc : / *  ，  # Exploit Title : Windows x86 ( all versions ) AFD privilege escalation ( MS11-046 )  ，  # Date : 2016-10-16 ，  # Exploit Author : Tomislav Paskalev ，  # Vulnerable Software :  ，  # Windows XP SP3 x86 ，  # Windows XP Pro SP2 x64 ，  # Windows Server 2003 SP2 x86 ，  # Windows Server 2003 SP2 x64 ，  # Windows Server 2003 SP2 Itanium-based Systems ，  # Windows Vista SP1 x86 ，  # Windows Vista SP2 x86 ，  # Windows Vista SP1 x64 ，  # Windows Vista SP2 x64 ，  # Windows Server 2008 x86 ，  # Windows Server 2008 SP2 x86 ，  # Windows Server 2008 x64 ，  # Windows Server 2008 SP2 x64 ，  # Windows Server 2008 Itanium-based Systems ，  # Windows Server 2008 SP2 Itanium-based Systems ，  # Windows 7 x86 ，  # Windows 7 SP1 x86 ，  # Windows 7 x64 ，  # Windows 7 SP1 x64 ，  # Windows Server 2008 R2 x64 ，  # Windows Server 2008 R2 SP1 x64 ，  # Windows Server 2008 R2 Itanium-based Systems ，  # Windows Server 2008 R2 SP1 Itanium-based Systems ，  # Supported Vulnerable Software :  ，  # Windows XP SP3 x86 ，  # Windows Server 2003 SP2 x86 ，  # Windows Vista SP1 x86 ，  # Windows Vista SP2 x86 ，  # Windows Server 2008 x86 ，  # Windows Server 2008 SP2 x86 ，  # Windows 7 x86 ，  # Windows 7 SP1 x86 ，  # Tested Software :  ，  # Windows XP Pro SP3 x86 EN [ 5.1.2600 ]  ，  # Windows Server 2003 Ent SP2 EN [ 5.2.3790 ]  ，  # Windows Vista Ult SP1 x86 EN [ 6.0.6001 ]  ，  # Windows Vista Ult SP2 x86 EN [ 6.0.6002 ]  ，  # Windows Server 2008 Dat SP1 x86 EN [ 6.0.6001 ]  ，  # Windows Server 2008 Ent SP2 x86 EN [ 6.0.6002 ]  ，  # Windows 7 HB x86 EN [ 6.1.7600 ]  ，  # Windows 7 Ent SP1 x86 EN [ 6.1.7601 ]  ，  # CVE ID : 2011-1249 ，  # Vulnerability description :  ，  # The Ancillary Function Driver ( AFD ) supports Windows sockets ，  # applications and is contained in the afd.sys file. The afd.sys ，  # driver runs in kernel mode and manages the Winsock TCP/IP ，  # communications protocol. ，  # An elevation of privilege vulnerability exists where the AFD ，  # improperly validates input passed from user mode to the kernel. ，  # An attacker must have valid logon credentials and be able to ，  # log on locally to exploit the vulnerability. ，  # An attacker who successfully exploited this vulnerability could ，  # run arbitrary code in kernel mode ( i.e. with NT AUTHORITY\\SYSTEM ，  # privileges ) . ，  # Exploit notes :  ，  # Privileged shell execution :  ，  # - the SYSTEM shell will spawn within the invoking shell/process ，  # Exploit compiling ( Kali GNU/Linux Rolling 64-bit )  :  ，  # - # i686-w64-mingw32-gcc MS11-046.c -o MS11-046.exe -lws2_32 ，  # Exploit prerequisites :  ，  # - low privilege access to the target OS ，  # - target OS not patched ( KB2503665 , or any other related ，  # patch , if applicable , not installed - check \"Related security ，  # vulnerabilities/patches\" )  ，  # Exploit test notes :  ，  # - let the target OS boot properly ( if applicable )  ，  # - Windows 7 ( SP0 and SP1 ) will BSOD on shutdown/reset ，  # Patches :  ，  # Windows XP SP3 x86 ，  # WindowsXP-KB2503665-x86-enu.exe ，  #  ( not available - EoL )  ，  # Windows Server 2003 SP2 x86 ，  # WindowsServer2003-KB2503665-x86-enu.exe ，  # Windows Vista SP1 , SP2 x86 ; Windows Server 2008 ( SP1 )  , SP2 x86 ，  # Windows6.0-KB2503665-x86.msu ，  # Windows 7 ( SP0 )  , SP1 x86 ，  # Windows6.1-KB2503665-x86.msu ，  # Related security vulnerabilities/patches :  ，  # MS11-046 KB2503665 ，  # MS11-080 KB2592799 ，  # MS12-009 KB2645640 ，  # MS13-093 KB2875783 ，  # MS14-040 KB2975684 ，  # Table of patch replacements :  ，  #  | MS11-046 | MS11-080 | MS12-009 | MS13-093 | MS14-040 |  ，  #  | KB2503665 | KB2592799 | KB2645640 | KB2875783 | KB2975684 |  ，  # Windows x86 XP SP3 | Installed | <-Replaces | - | - | - |  ，  # Windows x86 Server 2003 SP2 | Installed | <-Replaces | <-Replaces | - | <-Replaces |  ，  # Windows x86 Vista SP1 | Installed | - | - | - | - |  ，  # Windows x86 Vista SP2 | Installed | - | - | - | <-Replaces |  ，  # Windows x86 Server 2008 | Installed | - | - | - | - |  ，  # Windows x86 Server 2008 SP2 | Installed | - | - | - | <-Replaces |  ，  # Windows x86 7 | Installed | - | - | - | - |  ，  # Windows x86 7 SP1 | Installed | - | - | - | <-Replaces |  ，  # Thanks to :  ，  # azy ( XP , 2k3 exploit )  ，  # Rahul Sasi ( PoC ) ",
    "time": "2016.10.19"
}