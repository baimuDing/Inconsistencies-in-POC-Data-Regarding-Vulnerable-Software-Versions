{
    "text": "vul_url : ， vul_name : PHP File-Upload $GLOBALS Overwrite Vulnerability ， vul_date : 2005.11.01 ， vul_credit_name : Stefan Esser ， vul_risk : High ， vul_local : No ， vul_remote : Yes ， vul_cve : CVE-2005-3390 ， vul_cwe : CWE-Other ， vul_poc : -BEGIN PGP SIGNED MESSAGE- ， Hash: SHA1 ， Hardened-PHP Project ， www.hardened-php.net ， -= Security Advisory =- ， Advisory: PHP File-Upload $GLOBALS Overwrite Vulnerability ， Release Date: 2005/10/31 ， Last Modified: 2005/10/31 ， Author: Stefan Esser [sesser (at) hardened-php (dot) net [email concealed] ， Application: PHP4 <= 4.4.0 ， PHP5 <= 5.0.5 ， Severity: $GLOBALS overwrite can lead to unexpected behaviour ， of PHP applications, which can lead to execution of ， remote PHP code in many situations ， Risk: Critical ， Vendor Status: Vendor has released a bugfixed PHP 4 version ， Overview: ， PHP is a widely-used general-purpose scripting language that is ， especially suited for Web development and can be embedded into HTML. ， During the development of the Hardening-Patch which adds security ， hardening features to the PHP codebase, several vulnerabilities ， within PHP were discovered. This advisory describes one of these ， flaws concerning a weakness in the file upload code, that allows ， overwriting the GLOBALS array when register_globals is turned on. ， Overwriting this array can lead to unexpected security holes in ， code assumed secure. ， This vulnerability has consequences for a lot of PHP applications ， f.e. everything based on PEAR.php and vBulletin. And can lead to ， remote PHP code execution. ， For a detailed explanation of the $GLOBALS overwrite problem, have ， a look at the following article which describes it in more detail: ， Details: ， In PHP 4.3.11 some code was added to disallow overwriting the ， $GLOBALS array when register_globals is turned on. Unfortunately ， there was a hole in this protection. The introduced code did only ， affect the globalisation of the GET, POST and COOKIE variables. ， However it was overseen, that the rfc1867 file upload code within ， PHP also registers global variables, which can be used by an ， attacker to overwrite the $GLOBALS array by simply sending a ， multipart/form-data POST request containing a fileupload field ， with the name 'GLOBALS'. ， Until now it was not realised, how dangerous the problem is. This ， is also one of the reasons why all PHP <= 4.3.10 packages shipped ， with various distributions are still vulnerable to the normal ， $GLOBALS overwrite, which was fixed in PHP 4.3.11. ， Describing the impact of $GLOBALS overwrite vulnerabilities and ， why it does not only affect installations, where register_globals ， is turned on, why it allows remote code execution in a lot of ， PHP applications and why this is also a threat for applications ， that allow local file includes and are running in a SAFE_MODE or ， open_basedir environment is out of the scope of this advisory. ， The interested reader is advised to read the following article, ， that describes this \"new\" bugclass a bit more detailed, with ， examples. ， Finally it should be noted that users of our Hardening-Patch for ， PHP are not affected if they run the at least version from ， September."
}