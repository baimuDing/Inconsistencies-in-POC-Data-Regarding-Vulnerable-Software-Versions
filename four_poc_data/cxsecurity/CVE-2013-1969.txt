{
    "text": "vul_name : libxml2 Multiple Use-After-Free Vulnerabilities ， vul_cve : CVE-2013-1969 ， vul_poc : 1 ) An use-after-free error in \"htmlParseChunk (  ) \" can be exploited to ， dereference already freed memory. ， 2 ) Two use-after-free errors in \"xmldecl_done (  ) \" can be exploited to ， dereference already freed memory. ， The vulnerabilities are reported in version 2.9.0. Other versions may also be ， affected. ， Commit :  ，  [ 1 ]  :  ， Agostino Sarubbo ， Gentoo Linux Developer ， diff -git a/HTMLparser.c b/HTMLparser.c ， index a533f37.6b83654 100644 ， - a/HTMLparser.c ， + b/HTMLparser.c ， -6054 , 6 +6054 , 8 htmlParseChunk ( htmlParserCtxtPtr ctxt , const char * chunk , int size ,  ，  ( in->raw ! = NULL ) { ， int nbchars ;  ， + size_t base = xmlBufGetInputBase ( in->buffer , ctxt->input )  ;  ， + size_t current = ctxt->input->cur - ctxt->input->base ;  ， nbchars = xmlCharEncInput ( in )  ;  ， -6061 , 6 +6063 , 7 htmlParseChunk ( htmlParserCtxtPtr ctxt , const char * chunk , int size ,  ， \"encoder error\\n\" , NULL , NULL )  ;  ， } ， + xmlBufSetInputBaseCur ( in->buffer , ctxt->input , base , current )  ;  ， } ， } ， } ， diff -git a/parser.c b/parser.c ， index 31f90d6.1c99051 100644 ， - a/parser.c ， + b/parser.c ， -12126 , 7 +12126 , 7 xmldecl_done :  ， remain = 0 ;  ， } ， } ， - res =xmlParserInputBufferPush ( ctxt->input->buf , size , chunk )  ;  ， + res = xmlParserInputBufferPush ( ctxt->input->buf , size , chunk )  ;  ， ctxt->errNo = XML_PARSER_EOF ;  ， ctxt->disableSAX = 1 ;  ， -12143 , 6 +12143 , 8 xmldecl_done :  ，  ( in->raw ! = NULL ) { ， int nbchars ;  ， + size_t base = xmlBufGetInputBase ( in->buffer , ctxt->input )  ;  ， + size_t current = ctxt->input->cur - ctxt->input->base ;  ， nbchars = xmlCharEncInput ( in )  ;  ， -12151 , 6 +12153 , 7 xmldecl_done :  ， \"xmlParseChunk : encoder error\\n\" )  ;  ， } ， + xmlBufSetInputBaseCur ( in->buffer , ctxt->input , base , current )  ;  ， } ， } ， } ， -12190 , 7 +12193 , 14 xmldecl_done :  ， } ，  ( ctxt->input->buf ! = NULL ) { ， + size_t base = xmlBufGetInputBase ( ctxt->input->buf->buffer ,  ， + ctxt->input )  ;  ， + size_t current = ctxt->input->cur - ctxt->input->base ;  ， + ， xmlParserInputBufferPush ( ctxt->input->buf , 1 , \"\\r\" )  ;  ， + ， + xmlBufSetInputBaseCur ( ctxt->input->buf->buffer , ctxt->input ,  ， + base , current )  ;  ， }",
    "time": "2013.04.20"
}