{
    "text": "vul_url : ， vul_name : PHProjekt (Remote) Include Vulnerabilities ， vul_date : 2006.10.03 ， vul_credit_name : Stefan Esser (sesser hardened-php net) ， vul_risk : High ， vul_local : No ， vul_remote : Yes ， vul_cve : CVE-2006-5123 ， vul_cwe : CWE-Other ， vul_poc : -BEGIN PGP SIGNED MESSAGE- ， Hash: SHA1 ， Hardened-PHP Project ， www.hardened-php.net ， -= Security Advisory =- ， Advisory: PHProjekt (Remote) Include Vulnerabilities ， Release Date: 2006/09/29 ， Last Modified: 2006/09/29 ， Author: Stefan Esser [sesser (at) hardened-php (dot) net [email concealed] ， Application: PHProjekt 5.1.1 ， Severity: An unverified path may allow an attacker to inject ， and execute arbitrary PHP code ， Risk: Critical ， Vendor Status: Vendor has a released an updated version ， Overview: ， Quote from ， \"PHProjekt is a modular application for the coordination of group ， activities and to share informations and document via intranet and ， internet. Components of PHProjekt: Group calendar, project ， management, time card system, file management, contact manager, ， mail client and 9 other modules .(feature list). ， PHProjekt supports many protocols like ldap, soap and webdav and is ， available for 36 languages and 7 databases.\" ， While searching for applications that are vulnerable to a new class ， of vulnerabilities inside PHP applications we took a quick look ， into the current PHProjekt source code and discovered that a (remote) ， include vulnerability had been (re)introduced. ， By overwriting a variable with user input it is possible to inject ， and execute arbitrary PHP code. Overwriting this variable is possible ， regardless of the register_globals setting. ， It is recommended to install our Suhosin ( ， PHP extension, because it is the only solution that stops 100% of ， all URL includes. Please note that allow_url_fopen is NOT a 100% ， protection because it does NOT stop all URL types. ， Details: ， PHProjekt includes several files from different paths. In earlier ， versions it was possible to overwrite the base path variable ， $path_pre from the outside and use it to include arbitrary files ， or URLs. This vulnerability had been fixed by checking the content ， of $path_pre and bailing out of the PHP script in case of an ， attack. ， Unfortunately the code within PHProjekt was moved around, which ， resulted in $lib_path and $lang_path beeing filles before the ， request variables are extracted into the global namespace by the ， PHP script. (This globalisation is done by the code of PHProjekt ， and has nothing todo with PHP's register_globals feature). ， Because of this construction it is possible to include arbitrary ， PHP files by filling $lib_path or $lang_path through f.e. the URL. ， This vulnerability was now fixed by modifying all include paths ， to use constants instead of variables, because constants cannot ， be overwritten once they are set."
}