{
    "text": "vul_name : OpenCart <= 1.5.6.4 ( cart.php ) PHP Object Injection Vulnerability ， vul_cve : CVE-2014-3990 ， vul_poc : OpenCart <= 1.5.6.4 ( cart.php ) PHP Object Injection Vulnerability ， & # 8226 ; Software Link :  ， & # 8226 ; Affected Versions :  ， Version 1.5.6.4 and prior versions. ， & # 8226 ; Vulnerability Description :  ， The vulnerable code is located in the & # 8220 ; Cart : getProducts (  ) & # 8221 ; method defined in /system/library/cart.php :  ， foreach (  $ this->session->data [ 'cart' ] as $ key => $ quantity ) { ，  $ product = explode ( ' : ' ,  $ key )  ;  ，  $ product_id = $ product [ 0 ]  ;  ，  $ stock = true ;  ， / Options ，  $ options = unserialize ( base64_decode (  $ product [ 1 ]  )  ;  ， } else { ，  $ options = array (  )  ;  ， } ， The vulnerability exists because this method uses the & # 8220 ; unserialize (  ) & # 8221 ; function with the key values of the array stored into the & # 8220 ; data [ cart ] & # 8221 ; session variable without a proper validation. Such values might be manipulated by an unauthenticated attacker via the $ _POST [ 'quantity' ] parameter during an & # 8220 ; update& # 8221 ; request. This can be exploited to inject arbitrary PHP objects into the application scope , and could allow an attacker to conduct Server-Side Request Forgery ( SSRF ) attacks by abusing the destructor method of the & # 8220 ; DBMySQLi& # 8220 ; class and possibly other attacks leveraging magic methods of classes defined in third-party extensions. ， NOTE : if OpenCart is running on PHP before version 5.3.23 or 5.4.13 this vulnerability could also be exploited to carry out XML External Entity ( XE ) attacks , which in turn might allow arbitrary command execution if the PHP & # 8220 ; expect& # 8220 ; extension is installed.",
    "time": "2014.11.30"
}