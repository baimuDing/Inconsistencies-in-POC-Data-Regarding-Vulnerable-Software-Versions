{
    "text": "vul_name : PHP 5.3.8 Multiple vulnerabilities ， vul_cve : CVE-2011-4153 ， vul_poc :  [ PHP 5.3.8 Multiple vulnerabilities ]  ， Author : Maksymilian Arciemowicz ， Website :  ， Date : 14.01.2012 ， CVE :  ， CVE-2011-4153 ( zend_strndup )  ， Original link :  ，  [ - 1. Multiple NULL Pointer Dereference with zend_strndup (  )  [ CVE-2011-4153 ] - ]  ， As we can see in zend_strndup (  )  ， -zend_alloca.c- ， ZEND_API char * zend_strndup ( const char * s , uint length )  ， { ， char * p ;  ， p = ( char *  ) malloc ( length+1 )  ;  ， } ， memcpy ( p , s , length )  ;  ， } ， p [ length ] = 0 ;  ， } ， -zend_alloca.c- ， zend_strndup (  ) may return NULL ， in php code , many calls to zend_strndup (  ) dosen't checks returned values. In result , places like :  ， -zend_builtin_functions.c- ， ZEND_FUNCTION ( define )  ， { ， char * name ;  ， int name_len ;  ， zval * val ;  ， zval * val_free = NULL ;  ， zend_bool non_cs = 0 ;  ， int case_sensitive = CONST_CS ;  ， zend_constant c ;  ， } ， . ， c.flags = case_sensitive ; / * non persistent * / ， c.name = zend_strndup ( name , name_len )  ; <= MAY RETURN NULL ， c.name_len = name_len+1 ;  ， c.module_number = PHP_USER_CONSTANT ;  ， RETURN_TRUE ;  ， } else { ， RETURN_FALSE ;  ， } ， } ， -zend_builtin_functions.c- ， -PoC code- ，  [ cx @ 82 /www ]  $ ulimit -a ， socket buffer size ( bytes , -b ) unlimited ， core file size ( blocks , -c ) unlimited ， data seg size ( kbytes , -d ) 524288 ， file size ( blocks , -f ) unlimited ， max locked memory ( kbytes , -l ) unlimited ， max memory size ( kbytes , -m ) 40000 ， open files ( -n ) 11095 ， pipe size ( 512 bytes , -p ) 1 ， stack size ( kbytes , -s ) 65536 ， cpu time ( seconds , -t ) unlimited ， max user processes ( -u ) 5547 ， virtual memory ( kbytes , -v ) 40000 ， swap size ( kbytes , -w ) unlimited ，  [ cx @ 82 /www ]  $ cat define.php",
    "time": "2012.01.14"
}