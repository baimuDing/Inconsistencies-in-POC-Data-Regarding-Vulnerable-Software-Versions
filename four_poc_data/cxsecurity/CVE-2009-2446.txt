{
    "text": "vul_name : MySQL <= 5.0.45 post auth format string vulnerability ， vul_cve : CVE-2009-2446 ， vul_poc : MySQL ( tested : Version 5.0.45 on CentOS ( Linux ) Format String Vulnerability ， MySQL General Available ( GA ) Release is vulnerable. ， Latest MySQL Version is not vulnerable since the bug if ifdef'ed off. ， from mysql-5.0.75 source ( mysql-5.0.75.tar.gz ) in the file ， libmysqld/sql_parse.cc ， this source code is also included in mysql-4.0.0 , mysql versions >= ， 4.0.0 are affected. ， function prototype : write ( THD * thd , enumenum_server_command command ,  ， const char * format , . )  ， function call : write ( thd , command , packet )  ;  ， on line 2084 :  ， case COM_CREATE_DB : / QQ : To be removed ， { ， char * db=thd->strdup ( packet )  ,  * alias ;  ， HA_CREATE_INFO create_info ;  ， statistic_increment ( thd->status_var.com_stat [ SQLCOM_CREATE_DB ]  ,  ， &LOCK_status )  ;  ， / null test to handle EOM ， { ， my_error ( ER_WRONG_DB_NAME , MYF ( 0 )  , db ? db : \"NULL\" )  ;  ， } ，  [ 1 ] mysql_log.write ( thd , command , packet )  ;  ， bzero ( &create_info , sizeof ( create_info )  ;  ， mysql_create_db ( thd ,  ( lower_case_table_names = 2 ? alias : db )  ,  ， &create_info , 0 )  ;  ， } ， line 2105 :  ， case COM_DROP_DB : / QQ : To be removed ， { ， statistic_increment ( thd->status_var.com_stat [ SQLCOM_DROP_DB ]  ,  ， &LOCK_status )  ;  ， char * db=thd->strdup ( packet )  ;  ， / * null test to handle EOM * / ， { ， my_error ( ER_WRONG_DB_NAME , MYF ( 0 )  , db ? db : \"NULL\" )  ;  ， } ， { ， my_message ( ER_LOCK_OR_ACTIVE_TRANSACTION ,  ， ER ( ER_LOCK_OR_ACTIVE_TRANSACTION )  , MYF ( 0 )  ;  ， } ，  [ 2 ] mysql_log.write ( thd , command , db )  ;  ， mysql_rm_db ( thd , db , 0 , 0 )  ;  ， } ， at [ 1 ] and [ 2 ] there is a call to mysql_log.write (  ) without ， format string specifiers leading to a format string bug. ， authentication is required. ， COM_CREATE_DB and COM_DROP_DB are \"legacy\" code. Recent clients ， does not use this functions to create and drop databases. ， Older clients do. Even Newest GA version of mysqld is able to handle ， the requests though. ， mysql logging has to be enabled. it seems acls are enforced , so ， create db or drop db privs may be required , though untested. ， -> my.cnf at [ mysqld ] log=/var/log/mysql.log for example ， PROOF OF CONCEPT WHICH CRASHES MYSQLD FOLLOWS ， MYSQLD RESTARTS IMMEDIATELY ， CAUSE : SIGNAL SEGV ， -snip-",
    "time": "2009.07.10"
}