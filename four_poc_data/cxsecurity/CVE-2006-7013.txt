{
    "text": "vul_name : SMF 1.0.7 and lower plus 1.1rc2 and lower - IP spoofing vulnerability/IP ban evasion vulnerability ， vul_cve : CVE-2006-7013 ， vul_poc : = ， Advisory : SMF 1.0.7 and lower plus 1.1rc2 and lower - IP spoofing ， vulnerability/IP ban evasion vulnerability ， Release Date : June 02 , 2006 ， Application : SMF ， Version : SMF 1.0.7 and previous versions , SMF1.1rc2 and lower ， Platform : PHP ， Vendor URL :  ， Author : Jessica Hope ( jessicasaulhope ( at ) googlemail ( dot ) com [ email concealed ]  )  ， Overview ， The IP detection section of SMF's code allows for someone to spoof the ， X-Forwarded-For header. ， SMF trusts this value over the IP address reported in general. ， This allows an attacker to login and post using IP's that are not theirs ,  ， making it impossible for the Administrator of the SMF forum to ban the user. ， Discussion ， There's code in QueryString.php that starts :  ， elseif (  ! empty (  $ _SERVER [ 'HTTP_X_FORWARDED_FOR' ]  )  ， { ， / If there are commas , get the last one. probably. ， { ，  $ ips = array_reverse ( explode ( ' , ' ,  $ _SERVER [ 'HTTP_X_FORWARDED_FOR' ]  )  ;  ， / Go through each IP. ， foreach (  $ ips as $ i => $ ip )  ， { ， / Make sure it's in a valid range. ，  $ ip )  ! = 0 )  ， / Otherwise , we've got an IP !  ，  $ _SERVER [ 'REMOTE_ADDR' ] = trim (  $ ip )  ;  ， } ， } ， / Otherwise just use the only one. ， elseif ( preg_match ( ' ~ ^ ( 0 | 10 | 172\\.16 | 192\\.168 | 255 | 127\\.0 ) \\. | unknown )  ~ ' ,  ，  $ _SERVER [ 'HTTP_X_FORWARDED_FOR' ]  ) = 0 )  ，  $ _SERVER [ 'REMOTE_ADDR' ] = $ _SERVER [ 'HTTP_X_FORWARDED_FOR' ]  ;  ， } ， This code is used to obtain the users IP address. However , if ， X-Forwarded-For HTTP header has been provided ,  ， it will take the last IP address from the X-Forwared-For header and ， blindly trust it to be the real IP address. ， The problem is that the X-Forwarded-For HTTP header is easily forgable ， via a number of methods. ， For example , if the X-Forwarded-For header was set :  ， X-Forwarded-For : 1.2.3.4 ， the SMF application trusts 1.2.3.4 to be their IP address , and will ， reflect this fact when the user does anything that SMF logs ,  ， such as posting to the forum.This makes it possible for a user to set ， the X-Forwareded-For IP to that of another user in",
    "time": "2007.02.17"
}