{
    "text": "vul_name : PHP 5.6.5 DateTime Use-After-Free ， vul_cve : CVE-2015-0273 ， vul_poc :  # Use After Free Vulnerability in unserialize (  ) with DateTime *  [ CVE-2015-0273 ]  ， Taoguang Chen < [  @ chtg ]  ( - Write Date :  ， 2015.1.29 - Release Date : 2015.2.20 ， > A use-after-free vulnerability was discovered in unserialize (  ) with DateTime/DateTimeZone/DateInterval/DatePeriod objects's _wakeup (  ) magic method that can be abused for leaking arbitrary memory blocks or execute arbitrary code remotely. ， Affected Versions ， Affected is PHP 5.6 < 5.6.6 ， Affected is PHP 5.5 < 5.5.22 ， Affected is PHP 5.4 < 5.4.38 ， Credits ， This vulnerability was disclosed by Taoguang Chen. ， Description ， ` ， static int php_date_initialize_from_hash ( php_date_obj dateobj ,  ， HashTable * myht )  ， { ， zval * z_date ;  ， zval * z_timezone ;  ， zval * z_timezone_type ;  ， zval tmp_obj ;  ， timelib_tzinfo * tzi ;  ， php_timezone_obj * tzobj ;  ， z_date = zend_hash_str_find ( myht , \"date\" , sizeof ( \"data\" ) -1 )  ;  ， convert_to_string ( z_date )  ;  ， z_timezone_type = zend_hash_str_find ( myht , \"timezone_type\" ,  ， sizeof ( \"timezone_type\" ) -1 )  ;  ， convert_to_long ( z_timezone_type )  ;  ， z_timezone = zend_hash_str_find ( myht , \"timezone\" , sizeof ( \"timezone\" ) -1 )  ;  ， convert_to_string ( z_timezone )  ;  ， . ， static int php_date_timezone_initialize_from_hash ( zval return_value ,  ， php_timezone_obj tzobj , HashTable * myht TSRMLS_DC )  ， { ， zval z_timezone = NULL ;  ， zval z_timezone_type = NULL ;  ， &z_timezone_type ) = SUCCESS ) { ， convert_to_long (  * z_timezone_type )  ;  ， TSRMLS_CC ) { ， } ， } ， } ， } ， ` ， The convert_to_long (  ) leads to the ZVAL and all its children is freed ， from memory. However the unserialize (  ) code will still allow to use R :  ， or r : to set references to that already freed memory. There is a use ， after free vulnerability , and allows to execute arbitrary code. ， Proof of Concept Exploit ， The PoC works on standard MacOSX 10.10.2 installation of PHP 5.5.14. ， `",
    "time": "2015.02.24"
}