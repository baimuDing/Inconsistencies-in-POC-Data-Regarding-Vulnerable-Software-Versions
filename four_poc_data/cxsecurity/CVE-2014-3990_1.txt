{
    "text": "vul_name : OpenCart <= 1.5.6.4 ( cart.php ) PHP Object Injection Vulnerability ， vul_cve : CVE-2014-3990 ， vul_poc : - ， OpenCart <= 1.5.6.4 ( cart.php ) PHP Object Injection Vulnerability ，  [ - ] Software Link :  ，  [ - ] Affected Versions :  ， Version 1.5.6.4 and prior versions. ，  [ - ] Vulnerability Description :  ， The vulnerable code is located in the \"Cart : getProducts (  ) \" method defined in /system/library/cart.php :  ， 23. foreach (  $ this->session->data [ 'cart' ] as $ key => $ quantity ) { ， 24. $ product = explode ( ' : ' ,  $ key )  ;  ， 25. $ product_id = $ product [ 0 ]  ;  ， 26. $ stock = true ;  ， 27. ， 28. / Options ， 29. if (  ! empty (  $ product [ 1 ]  ) { ， 30. $ options = unserialize ( base64_decode (  $ product [ 1 ]  )  ;  ， 31. } else { ， 32. $ options = array (  )  ;  ， 33. } ， The vulnerability exists because this method uses the \"unserialize (  ) \" function with the key values of the ， array stored into the \"data [ 'cart' ] \" session variable without a proper validation. Such values might be ， manipulated by an unauthenticated attacker via the $ _POST [ 'quantity' ] parameter during an \"update\" request. ， This can be exploited to inject arbitrary PHP objects into the application scope , and could allow an attacker ， to conduct Server-Side Request Forgery ( SSRF ) attacks by abusing the destructor method of the \"DBMySQLi\" ， class and possibly other attacks leveraging magic methods of classes defined in third-party extensions. ， NOTE : if OpenCart is running on PHP before version 5.3.23 or 5.4.13 this vulnerability ， could also be exploited to carry out XML External Entity ( XE ) attacks , which in turn ， might allow arbitrary command execution if the PHP \"expect\" extension is installed.",
    "time": "2014.07.15"
}