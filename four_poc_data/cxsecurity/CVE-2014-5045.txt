{
    "text": "vul_name : Linux Kernel 3.15.7 fs/namei.c memory consumption and use-after-free ， vul_cve : CVE-2014-5045 ， vul_poc : fs : umount on symlink leaks mnt count ， Currently umount on symlink blocks following umount :  ， /vz is separate mount ，  # ls /vz/ -al | grep test ， drwxr-xr-x. 2 root root 4096 Jul 19 01 : 14 testdir ， lrwxrwxrwx. 1 root root 11 Jul 19 01 : 16 testlink -> /vz/testdir ，  # umount -l /vz/testlink ， umount : /vz/testlink : not mounted ( expected )  ，  # lsof /vz ，  # umount /vz ， umount : /vz : device is busy. ( unexpected )  ， In this case mountpoint_last (  ) gets an extra refcount on path->mnt ， diff -git a/fs/namei.c b/fs/namei.c ， index 985c6f3.9eb787e 100644 ， - a/fs/namei.c ， + b/fs/namei.c ， -2256 , 9 +2256 , 10 done :  ， goto out ;  ， } ， path->dentry = dentry ;  ， - path->mnt = mntget ( nd->path.mnt )  ;  ， + path->mnt = nd->path.mnt ;  ， + mntget ( path->mnt )  ;  ， follow_mount ( path )  ;  ， error = 0 ;  ， out : ",
    "time": "2014.08.03"
}