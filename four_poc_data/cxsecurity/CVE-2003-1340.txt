{
    "text": "vul_name : Php-Nuke : users and admins password hashes vulnerability ， vul_cve : CVE-2003-1340 ， vul_poc : BUGSMAN : serving security from Italy since.hem.well , about 1 year ， Object : users & admins password hash retrieving ， Tested on Php-Nuke 5.6 e 6.5 ， Vulnerable versions : I've never seen a patch for this so potentially all versions could be vulnerable. ， Description :  ， An attacker can obtain password hashes for users and admins , using a particular SQL injection with cookies. ， An incredible amount of sites are vulnerable to these attacks. ， Note : Since the SQL injection works with cookies , this problem is not prevented by turning GPC_magic_quotes ， on. ， ><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>< ， USER HASH :  ， To get the password hash of an user , the attacker just needs a valid account. ， The attacker visits www.victimsite.com/modules.php?name=Your_Account sending a spoofed user cookie crafted ， in this way :  ， uid should be : ' or ( uname='username_to_hack' and pass like 'a%' ) or uname = 'valid_username ， uname should be : username_to_hack ， pass should be : valid_password ， Next stepis to examine the result page. If the page is the login page ( the one with textboxes ) it means that ， the hash of the password to crack is really LIKE 'a%' and the attacker can go on with the next character. ， If the page is the details page for the username_to_hack , then it's time to try LIKE 'B%'. ， In max 512 guesses the attacker has the hash of username_to_hack and now it is possible to create a spoofed ， cookie to be recognized as username_to_hack. ， ><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>< ， ADMIN HASH :  ， To get the password hash of an admin , the attacker only needs to know the name of that admin , and needs that ， the Web_Links module should be active and with at least one link :  ， NOTE : The attacker doesn't need a valid account , and can exploit the bug even if the Web_Links module is ， active only for registered members. ， The attacker visits www.victimsite.com/modules.php?name=Web_Links&l_op=viewlink&cid=2 ， sending a spoofed admin cookie crafted in this way :  ， aid should be : admin_to_hack' and pwd like 'a% ， pwd should be : anything you want ， Now the attacker examine the page : if the links have the Edit links active , it means the password hash is ， really LIKE 'a%' so go on with next character , otherwise go on with LIKE 'b%' ， NOTE : This trick works with some modification , with l_op=MostPopular and l_op=NewLinksDate too. ， With the hash the attacker can spoof a cookie and get into the admin section of the site. ， IMPORTANT NOTE : it is not really a problem to obtain the name of an admin , since the name of the God admin ， can be obtained just using this exploit with different injections. So what the attacker REALLY needs is the ， Web_Links module active and with at least one link ! AND NOTHING MORE !  ， ><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>< ， QUICK-AND-DIRTY FIX :  ， Since I contacted Francisco Burzi , but I didn't get any response I post a quick-and-dirty fix right out of ， my brain :  )  ， DISCLAIMER : I TAKE NO RESPONSABILITY FOR ANY KIND OF DAMAGE OR MISWORKING OF THE SITE CAUSED BY MY FIXES. ， THESE ARE NOT OFFICIAL PHP-NUKE FIXES SO APPLY THEM AT YOUR OWN RISK !  ， ANOTHER NOTE : I FIX MY PHP-NUKE THIS WAY AND IT WORKS , IT SHOULD WORK FOR YOU TOO. ， FIXING USER EXPLOIT :  ， in file /mainfile.php , in function is_user , before the line :  ， add this line :  ，  $ uid=addslashes (  $ uid )  ;  ， FIXING ADMIN EXPLOIT :  ， in file /modules/Web_Links/index.php , in functions NewLinksDate , MostPopular and viewlink ， before the line :  ，  $ admin=explode ( \" : \" ,  $ admin )  ;  ， add this line :  ，  $ admin=addslashes (  $ admin )  ;  ， then change this line :  ，  $ result3=sql_query ( \"select radminlink , radminsuper from \". $ prefix.\"_authors where aid =' $ aid'\" , dbi )  ;  ， and make it look like this one :  ，  $ result3=sql_query ( \"select radminlink , radminsuper from \". $ prefix.\"_authors where aid=' $ aid' and ， pwd=' $ admin [ 1 ] '\" , dbi )  ;  ， NOTE : YOU HAVE TO DO THIS FOR ALL THE 3 FUNCTIONS LISTED BEFORE !  ， ><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>< ， ARE YOU WEAK? ， Here you can find two php pages that you can use to find out if your site is vulnerable to this attack. Just ， upload the pages on the webserver running php-nuke in the same directory for your config.php and open them. ， NOTE : THESE SCRIPT ARE VERY POOR-CODED , AND I DO NOT ASSURE THAT THEIR ， RESPONSE IS RIGHT ! THEY WORKED FOR ME AND I HOPE THEY WORK FOR YOU TOO ! SORRY FOR THE POOR CODING BUT THE ， SCRIPTS WERE MADE IN HALF AN HOUR :  )  ， NOTE : BEFORE YOU EXECUTE THE SCRIPT , BE SURE TO PERSONALIZE THE VALUES WHERE INDICATED !  ， This one is to check the user vulnerability :  ， ><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><",
    "time": "2007.10.01"
}