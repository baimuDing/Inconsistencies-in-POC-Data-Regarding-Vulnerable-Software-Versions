{
    "text": "vul_name : Linux kernel ipv6 BUG_ON in fib6_add_rt2node (  )  ， vul_cve : CVE-2013-4125 ， vul_poc : If two router advertisment speaker announce seperate default ， gateways with infinite timeout the kernel currently packs these ， routes together into an ecmp route set. If one of the RA speaker ， now changes the advertised expiration to a lower value and a third ， route with infinite timeout pops up we end up with a BUG_ON. ， Remote attacker could use this flaw to crash the system. ， Fixed by :  ， Introduced by :  ， Introduced in upstream version : v3.7-rc1 ， Acknowledgements :  ， Red Hat would like to thank Hannes Frederic Sowa for reporting ， this issue. ， diff -git a/net/ipv6/ip6_fib.c b/net/ipv6/ip6_fib.c ， index 192dd1a.5fc9c7a 100644 ， - a/net/ipv6/ip6_fib.c ， + b/net/ipv6/ip6_fib.c ， -632 , 6 +632 , 12 insert_above :  ， } ， +static inline bool rt6_qualify_for_ecmp ( struct rt6_info * rt )  ， +{ ， + return ( rt->rt6i_flags & ( RTF_GATEWAY | RTF_ADDRCONF | RTF_DYNAMIC ) = ， + RTF_GATEWAY ;  ， +} ， + ，  * Insert routing information in a node. ， -646 , 6 +652 , 7 static int fib6_add_rt2node ( struct fib6_node * fn , struct rt6_info * rt ,  ， int add = (  ! info->nlh |  ，  ( info->nlh->nlmsg_flags & NLM_F_CREATE )  ;  ， int found = 0 ;  ， + bool rt_can_ecmp = rt6_qualify_for_ecmp ( rt )  ;  ， ins = &fn->leaf ;  ， -691 , 9 +698 , 8 static int fib6_add_rt2node ( struct fib6_node * fn , struct rt6_info * rt ,  ，  * To avoid long list , we only had siblings if the ，  * route have a gateway. ， - if ( rt->rt6i_flags & RTF_GATEWAY ， - !  ( rt->rt6i_flags & RTF_EXPIRES )  ， - !  ( iter->rt6i_flags & RTF_EXPIRES )  ， + if ( rt_can_ecmp ， + rt6_qualify_for_ecmp ( iter )  ， rt->rt6i_nsiblings+ ;  ， } ， -715 , 7 +721 , 8 static int fib6_add_rt2node ( struct fib6_node * fn , struct rt6_info * rt ,  ， / * Find the first route that have the same metric * / ， sibling = fn->leaf ;  ， - if ( sibling->rt6i_metric = rt->rt6i_metric ) { ， + if ( sibling->rt6i_metric = rt->rt6i_metric ， + rt6_qualify_for_ecmp ( sibling ) { ， list_add_tail ( &rt->rt6i_siblings ,  ， &sibling->rt6i_siblings )  ; ",
    "time": "2013-07-15 / 2013-07-16"
}