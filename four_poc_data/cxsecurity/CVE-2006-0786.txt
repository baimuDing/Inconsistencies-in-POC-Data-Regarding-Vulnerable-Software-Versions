{
    "text": "vul_name : PHPKIT >= 1.6.1r2 arbitrary local/remote inclusion ( unproperly patched in previous versions )  ， vul_cve : CVE-2006-0786 ， vul_poc : - PHPKit <= v.1.6.1 release 2 remote code execution - ， software :  ， site : www.phpkit.de ， description : a Content Management / homepage / community building software ， written in PHP language ， vulnerable code in include.php at line 558/579 :  ， . ，  $ path_filename=pkDIRPUBLIC. ( substr (  $ path , -4 ) ='.php' ? substr ( basename (  $ path )  , 0 , -4 )  :  $ path ) .pkEXT ;  ， { ， include (  $ path_filename )  ;  ， } ，  [  *  ] elseif ( filecheck (  $ path ) strstr ( strtolower (  $ path )  , '.php' )  ! strstr ( strtolower (  $ path )  , ' ! strstr ( strtolower (  $ path )  , ' ! strstr ( strtolower (  $ path )  , 'ftp : /' )  ! strstr (  $ path , \"./\" )  ， { ， include (  $ path )  ;  ， } ， elseif (  ! strstr ( strtolower (  $ file )  , ' filecheck (  $ file )  ! strstr (  $ file , \"./\" ) file_extension (  $ file )  ! ='php' )  ， { ，  $ site_body.=implode ( ' , file (  $ file )  ;  ， } ， elseif (  ! empty (  $ src )  ， { ，  $ src=pkEntities (  $ src )  ;  ， eval ( \" $ site_body.=\".getTemplate ( \"site_iframe\" ) .\" ; \" )  ;  ， } ， pkEvent ( 'page_not_found' )  ;  ， . ， and in inc/func/default.php at line 355-362 :  ， . ， { ， fclose (  $ fp )  ;  ， } ， . ， \"path\" var is not properly sanitized before to be used to include files from ， local resources. Look carefully at [  *  ]  : script checks if \"path\" is ， an existing and readable file , it must not contain \" \"ftp : /\" url ， wrappers and \"./\" chars , it must contain the \".php\" extension. ， This checks can be easily overrided to include files from local and external ， resources , poc :  ， char :  ，  ( about this : strstr (  ) function find \".php\" extension , but fopen (  ) and include (  )  ， do not consider any char after a null char )  ， regardless of any php.ini settings you can include an arbitrary php file from ， local resources :  ， also , since fopen (  ) and include (  ) functions support Samba and FTP secure url ， wrappers , if allow_url_fopen = On , you can include a php file from external ， resources , poc :  ， from a samba server :  ， from a ftp secure server ( this should works if php is compiled in support for ， OpenSSL )  ， t/shell.php",
    "time": "2006.02.17"
}