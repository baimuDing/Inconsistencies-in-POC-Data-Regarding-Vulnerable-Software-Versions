{
    "text": "Cc : Red Hat Product Security <secalert @ .hat.com> ,  ， Paolo Bonzini <pbonzini @ .hat.com> ， Subject : KVM SYSENTER emulation vulnerability - CVE-2015-0239 ， Linux 2.6.32 - 3.18 that runs KVM may enable a malicious guest process to ， crash the guest OS or launch a privilege escalation attack on the guest. The ， attack can be launched by tricking the hypervisor to emulate a SYSENTER ， instruction in 16-bit mode , if the guest OS does not initialize the SYSENTER ， MSRs. KVM does not check under these conditions that the selector ， IA32_SYSENTER_CS is not zero , and does not generate a # GP exception as real ， hardware does. Instead , it sets the guest instruction pointer to zero and ， changes the code privilege level ( CPL ) to zero ( privileged ) . Note that the ， attack can only be issued under very certain conditions ( see the details ， below ) . Windows and distro Linux guest OSes should be safe. ， The bug existed since the introduction of SYSENTER emulation ( em_sysenter ， function on recent Linux releases )  , in commit ， 8c60435261deaefeb53ce3222d04d7d5bea81296 , which is present in Linux 2.6.32 ， - 3.18. ， To fix the bug , you can apply the following patch - ， http : /permalink.gmane.org/gmane.linux.kernel.commits.head/502245 ， There are no known exploits of the vulnerability. Red-hat assigned ， CVE-2015-0239 for this vulnerability. ， Details :  ， The success of such an attack and its results depend on the guest OS. It is ， inapplicable if the guest OS initializes the SYSENTER MSRs , as Linux usually ， does. If the MSRs were not initialized , it can be used to crash the guest OS ， or for privilege escalation. However , it cannot be used for privilege ， escalation if the guest cannot access the first memory page , whose virtual ， address is zero. ， As a result of these limitations the attack is only possible in when the ， guest uses certain OSes , for instance , Linux which was built without ， CONFIG_IA32_EMULATION ( support for legacy 32-bit programs ) or FreeBSD. In ， these systems , guest DoS is possible. Privilege escalation attack requires ， that in addition guest processes would be able to access address zero. For ， Linux guest , this requirement means the the kernel parameter ， vm.mmap_min_addr is set to zero. ， An attack can be launched on an SMP guest , using guest code that tricks KVM ， into emulating the SYSENTER instruction. The attached PoC does just that. It ， first writes a UD2 instruction , causing a # UD exception and a subsequent ， VM-exit , and then tries from another thread to rewrite the UD2 instruction ， with SYSENTER just before KVM emulates the instruction. The PoC is not fully ， automatic since dealing with signals in 16-bit code is annoying. The",
    "time": "Tue, 27 Jan 2015 14:17:22 +0200"
}