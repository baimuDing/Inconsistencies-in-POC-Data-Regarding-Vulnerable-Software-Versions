{
    "text": "Date: Tue, 12 Sep 2017 12:03:32 +0000 ， From: Xen.org security team <security@.org> ， To: xen-announce@.ts.xen.org, xen-devel@.ts.xen.org, ， xen-users@.ts.xen.org, oss-security@.ts.openwall.com ， CC: Xen.org security team <security-team-members@.org> ， Subject: Xen Security Advisory 232 (CVE-2017-14318) - Missing check for ， grant table ， -BEGIN PGP SIGNED MESSAGE- ， Hash: SHA256 ， Xen Security Advisory CVE-2017-14318 / XSA-232 ， version 4 ， Missing check for grant table ， UPDATES IN VERSION 4 ， Added metadata file ， Public release. ， ISSUE DESCRIPTION ， The function `_gnttab_cache_flush` handles GNTTABOP_cache_flush grant ， table operations. It checks to see if the calling domain is the owner ， of the page that is to be operated on. If it is not, the owner's grant ， table is checked to see if a grant mapping to the calling domain ， exists for the page in question. ， However, the function does not check to see if the owning domain ， actually has a grant table or not. Some special domains, such as ， `DOMID_XEN`, `DOMID_IO` and `DOMID_COW` are created without grant ， tables. Hence, if _gnttab_cache_flush operates on a page owned by ， these special domains, it will attempt to dereference a null pointer ， in the domain struct. ， IMPACT ， The guest can get Xen to dereference a NULL pointer. ， For ARM guests and x86 PV guests on systems with SMAP enabled, this will ， cause a host crash (denial-of-service). ， For x86 PV guests on systems without SMAP enabled, an attacker can map ， a crafted grant structure at virtual address 0. This can be leveraged ， to increment an arbitrary virtual address, which can then probably be ， leveraged into a full privilege escalation. ， VULNERABLE SYSTEMS ， All versions of Xen since Xen 4.5 are vulnerable. ， x86 HVM guests do not expose the vulnerability. ， ARM guests and x86 PV guests on systems with SMAP enabled are only ， vulnerable to a Denial-of-Service (host crash). ， x86 PV guests on systems without SMAP running are vulnerable to a ， privilege escalation."
}