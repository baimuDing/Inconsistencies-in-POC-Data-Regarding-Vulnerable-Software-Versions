{
    "text": "Cc : \"Zach W\" <kestrel @ .linux.us> ， Subject : Re : Re : Asus wireless routers Global buffer overflow and Stack buffer overflow in networkmap ， Use CVE-2017-11344 and CVE-2017-11345 . ， GbigMao. ， Subject : Re :  [ oss-security ] Asus wireless routers Global buffer overflow and Stack buffer overflow in networkmap ， Is this different from CVE-2017-6548? ， Zach W. ， On 7/12/17 12 : 52 AM , wrote :  ， > Global buffer overflow ， > [ Vulnerability ]  :  ， > Global buffer overflow in networkmap ， > [ Exploitation ]  :  ， > Can write data at any address in heap ， > [ Vendor of Product ]  :  ， > Asus wireless router ， > [ Affected Products and firmware version ]  :  ， > Asuswrt-Merlin , all the firmware and the latest firmware is 380.66_6 ， > RT-AC5300 , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT_AC1900P , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-AC68U , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-AC68P , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-AC88U , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-AC66U , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-AC66U_B1 , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-AC58U , all the firmware , and the latest firmware is 3.0.0.4.380.7485 ， > RT-AC56U , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-AC55U , all the firmware , and the latest firmware is 3.0.0.4.380.7378 ， > RT-AC52U , all the firmware , and the latest firmware is 3.0.0.4.380.4180 ， > RT-AC51U , all the firmware , and the latest firmware is 3.0.0.4.380.7378 ， > RT-N18U , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-N66U , all the firmware , and the latest firmware is 3.0.0.4.380.7378 ， > RT-N56U , all the firmware , and the latest firmware is 3.0.0.4.378.7177 ， > RT-AC3200 , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT-AC3100 , all the firmware , and the latest firmware is 3.0.0.4.380.7743 ， > RT_AC1200GU , all the firmware , and the latest firmware is 3.0.0.4.380.5577 ， > RT_AC1200G , all the firmware , and the latest firmware is 3.0.0.4.380.3167 ， > RT-AC1200 , all the firmware , and the latest firmware is 3.0.0.4.380.9880 ， > RT-AC53 , all the firmware , and the latest firmware is 3.0.0.4.380.9883 ， > RT-N12HP , all the firmware , and the latest firmware is 3.0.0.4.380.2943 ， > RT-N12HP_B1 , all the firmware , and the latest firmware is 3.0.0.4.380.3479 ， > RT-N12D1 , all the firmware , and the latest firmware is 3.0.0.4.380.7378 ， > RT-N12+ , all the firmware , and the latest firmware is 3.0.0.4.380.7378 ， > RT_N12+_PRO , all the firmware , and the latest firmware is 3.0.0.4.380.9880 ， > RT-N16 , all the firmware , and the latest firmware is 3.0.0.4.380.7378 ， > RT-N300 , all the firmware , and the latest firmware is 3.0.0.4.380.7378 ， > [ Attack Type ]  :  ， > Remote ， > [ Can Cause Denial of Service? ]  :  ， > yes ， > [ Reference ]  :  ， > https : /github.com/RMerl/asuswrt-merlin/blob/master/release/src/router/networkmap/function.c # L903-L1032 ， > http : /asuswrt.lostrealm.ca/ ， > https : /www.asus.com/Networking/RTN12HP_B1/HelpDesk_Download/ ( chose the others can download the firmware sourcecode )  ， > https : /www.asus.com/Networking/Wireless-Routers-Products/ ， > [ Discoverer ]  :  ， > Tianfeng Guan , pkav of Sichuan Silent Information Technology Company Ltd , http : /www.silence.com.cn/ ， > [ Affected components ]  :  ， > Affected executable application : networkmap ， > Affected source code file : \\release\\src\\router\\networkmap\\function.c ， > Affected function : store_description ( char * msg )  ， > [ Vulnerability description ]  :  ， > When the function process_device_repsonse of networkmap is parsing the ， > SSDP answer from a device and the SSDP answer has indicated the location like :  ， > HTTP/1.1 200 OK ， > Location : HTTP : /host : port/path ， > If the \"HTTP : /host : port/path\" is valid , the networkmap will get the ， > device descirption xml by accessing \"HTTP : /host : port/path\" , and it will use ， > the function store_description to store the device descirption information ， > to global sturct device_info. ， > In the function store_description , there's no limit to the variable s_num ,  ， > so that it can cause the global sturct device_info overflow when copy the ， > data from tmp to description.service [ s_num ] .url . ， > [ Vulnerability details ]  :  ， > In the \\release\\src\\router\\networkmap\\function.c ,  ， > It define the global struct device_info description and the function store_description :  ， > . ， > struct device_info description ;  ， > . ， > void store_description ( char * msg )  ， > { ， > . ， > int s_num = 0 ;  ， > . ， > while ( p ! = NULL & p < body )  ， > { ， > . ， > switch ( type )  ， > { ， > . ， > case 7 :  ， > strlcpy ( description.service [ s_num ] .url , tmp , sizeof ( description.service [ s_num ] .url )  ;  ， > NMP_DEBUG_F ( \"service %d url = %s\\n\" , s_num , tmp )  ;  ， > s_num+ ;  ， > break ;  ， > } ， > } ， > . ， > } ， > You can see that the s_num variable is incremented in case 7 ,  ， > But in the while ( p ! = NULL & p < body )  , it never check the s_num variable. ， > And in the \\release\\src\\router\\networkmap\\networkmap.h , it define the struct device_info :  ， > .",
    "time": "Mon, 17 Jul 2017 11:54:49 +0800"
}