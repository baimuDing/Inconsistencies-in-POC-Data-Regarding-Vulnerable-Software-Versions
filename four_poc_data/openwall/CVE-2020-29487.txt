{
    "text": "Date: Tue, 15 Dec 2020 12:20:26 +0000 ， From: Xen.org security team <security@.org> ， To: xen-announce@.ts.xen.org, xen-devel@.ts.xen.org, ， xen-users@.ts.xen.org, oss-security@.ts.openwall.com ， CC: Xen.org security team <security-team-members@.org> ， Subject: Xen Security Advisory 354 v4 (CVE-2020-29487) - XAPI: ， guest-triggered excessive memory usage ， -BEGIN PGP SIGNED MESSAGE- ， Hash: SHA256 ， Xen Security Advisory CVE-2020-29487 / XSA-354 ， version 4 ， XAPI: guest-triggered excessive memory usage ， UPDATES IN VERSION 4 ， Public release. ， ISSUE DESCRIPTION ， Certain xenstore keys provide feedback from the guest, and are therefore ， watched by toolstack. Specifically, keys are watched by xenopsd, and ， data are forward via RPC through message-switch to xapi. ， The watching logic in xenopsd sends one RPC update containing all data, ， any time any single xenstore key is updated, and therefore has O(N^2) ， time complexity. Furthermore, message-switch retains recent (currently ， 128) RPC messages for diagnostic purposes, yielding O(M*N) space ， complexity. ， The quantity of memory a single guest can monopolise is bounded by ， xenstored quota, but the quota is fairly large. It is believed to be in ， excess of 1G per malicious guest. ， In practice this manifests as a host denial of service, either through ， message-switch thrashing against swap, or OOM'ing entirely, depending on ， dom0's configuration. ， This series introduces quotas in xenopsd to limit the quantity of keys ， which result in RPC traffic. ， IMPACT ， A buggy or malicious guest can cause unreasonable memory usage in dom0, ， resulting in a host denial of service. ， VULNERABLE SYSTEMS ， All versions of XAPI are vulnerable. ， Systems which are not using the XAPI toolstack are not vulnerable."
}