{
    "text": "Subject : CVE-2021-41174 Grafana XSS vulnerability ， Today we are releasing Grafana 8.2.3. This patch release includes an ， important security fix for an issue that affects all Grafana versions from ， 8.0.0-beta1. ，  [ Grafana Cloud ]  ( https : /grafana.com/cloud ) instances have already been ， patched and an audit did not find any usage of this attack vector. [ Grafana ， Enterprise ]  ( https : /grafana.com/products/enterprise ) customers were ， provided with updated binaries under embargo. ，  # CVE-2021-41174 XSS vulnerability on unauthenticated pages ，  # Summary ， CVSS Score : 6.9 Medium ， CVSS :  [ CVSS : 3.0/AV : N/AC : H/PR : N/UI : R/S : C/C : L/I : H/A : N/E : U/RL : O/RC : R/CR : L/MAV : N/MAC : H/MPR : N/MUI : R/MS : C/MC : N/MI : H/MA : L ]  (  ， https : /www.first.org/cvss/calculator/3.0 # CVSS : 3.0/AV : N/AC : H/PR : N/UI : R/S : C/C : L/I : H/A : N/E : U/RL : O/RC : R/CR : L/MAV : N/MAC : H/MPR : N/MUI : R/MS : C/MC : N/MI : H/MA : L ， We received a security report to security @ .fana.com on 2021-10-21 about a ， vulnerability in Grafana regarding the XSS vulnerability. ， It was later identified as affecting Grafana versions from 8.0.0-beta1 to ， 8.2.2. [ CVE-2021-41174 ]  (  ， https : /cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41174 ) has been ， assigned to this vulnerability. ，  # Impact ， If an attacker is able to convince a victim to visit a URL referencing a ， vulnerable page , arbitrary JavaScript content may be executed within the ， context of the victim's browser. ， The user visiting the malicious link must be unauthenticated and the link ， must be for a page that contains the login button in the menu bar. ， There are two ways an unauthenticated user can open a page in Grafana that ， contains the login button :  ， - Anonymous authentication is enabled. This means all pages in Grafana ， would be open for the attack. ， - The link is to an unauthenticated page. The following pages are ， vulnerable :  ， - `/dashboard-solo/snapshot/ * ` ， - `/dashboard/snapshot/ * ` ， - `/invite/ : code` ， The url has to be crafted to exploit AngularJS rendering and contain the ， interpolation binding for AngularJS expressions. AngularJS uses double ， curly braces for interpolation binding : { } ， An example of an expression would be :  ， `{constructor.constructor ( alert ( 1 )  (  ) }`. This can be included in the ， link URL like this :  ， https : /play.grafana.org/dashboard/snapshot/%7B%7Bconstructor.constructor ( 'alert ( 1 ) ' )  (  ) %7D%7D?orgId=1 ， When the user follows the link and the page renders , the login button will ， contain the original link with a query parameter to force a redirect to the ， login page. The URL is not validated and the AngularJS rendering engine ， will execute the JavaScript expression contained in the URL. ，  # Attack audit ， We can not guarantee that the below will identify all attacks , so if you ， find something using the audit process described below , you should consider ， doing a full assessment. ，  # Through reverse proxy/load balancer logs ， To determine if your Grafana installation has been exploited for this ， vulnerability , search through your reverse proxy/load balancer access logs ， invoke JavaScript code. For example , this could be code that attempts to ， show a fake login page or to steal browser or session data. The [ OWASP ， cheat sheet ]  (  ， https : /cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html )  ， has several examples of XSS attacks. ，  # Through the Grafana Enterprise audit feature ， If you enabled Log web requests in your configuration with ， `router_logging = true` , look for requests where `path` contains `{` ， followed by something that would invoke JavaScript code. ，  # Patched versions ， Release 8.2.3 :  ， - [ Download Grafana 8.2.3 ]  ( https : /grafana.com/grafana/download/8.2.3 )  ， - [ Release notes ]  (  ， https : /grafana.com/docs/grafana/latest/release-notes/release-notes-8-2-3/ )  ，  # Solutions and mitigations ， Download and install the appropriate patch for your version of Grafana. ，  [ Grafana Cloud ]  ( https : /grafana.com/cloud ) instances have already been ， patched , and [ Grafana Enterprise ]  ( https : /grafana.com/products/enterprise )  ， customers were provided with updated binaries under embargo.",
    "time": "Wed, 3 Nov 2021 15:24:55 +0100"
}