{
    "text": "Date: Tue, 15 Aug 2017 12:05:53 +0000 ， From: Xen.org security team <security@.org> ， To: xen-announce@.ts.xen.org, xen-devel@.ts.xen.org, ， xen-users@.ts.xen.org, oss-security@.ts.openwall.com ， CC: Xen.org security team <security-team-members@.org> ， Subject: Xen Security Advisory 228 (CVE-2017-12136) - grant_table: Race ， conditions with maptrack free list handling ， -BEGIN PGP SIGNED MESSAGE- ， Hash: SHA256 ， Xen Security Advisory CVE-2017-12136 / XSA-228 ， version 3 ， grant_table: Race conditions with maptrack free list handling ， UPDATES IN VERSION 3 ， Public release. ， ISSUE DESCRIPTION ， The grant table code in Xen has a bespoke semi-lockfree allocator for ， recording grant mappings (\"maptrack\" entries). This allocator has a ， race which allows the free list to be corrupted. ， Specifically: the code for removing an entry from the free list, prior ， to use, assumes (without locking) that if inspecting head item shows ， that it is not the tail, it will continue to not be the tail of the ， list if it is later found to be still the head and removed with ， cmpxchg. But the entry might have been removed and replaced, with the ， result that it might be the tail by then. (The invariants for the ， semi-lockfree data structure were never formally documented.) ， Additionally, a stolen entry is put on the free list with an incorrect ， link field, which will very likely corrupt the list. ， IMPACT ， A malicious guest administrator can crash the host, and can probably ， escalate their privilege to that of the host. ， VULNERABLE SYSTEMS ， Xen 4.6 and later are vulnerable. ， Xen 4.5 and earlier are not vulnerable."
}