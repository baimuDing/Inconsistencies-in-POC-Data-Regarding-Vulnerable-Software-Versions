{
    "text": "Subject : Authorization bypass and symlink attack in multipathd ( CVE-2022-41974 ， and CVE-2022-41973 )  ， Qualys Security Advisory ， Leeloo Multipath : Authorization bypass and symlink attack in multipathd ，  ( CVE-2022-41974 and CVE-2022-41973 )  ， Contents ， Summary ， CVE-2022-41974 : Authorization bypass ， CVE-2022-41973 : Symlink attack ， Acknowledgments ， Timeline ， Summary ， We discovered two local vulnerabilities ( an authorization bypass and a ， symlink attack ) in multipathd , a daemon that is running as root in the ， default installation of ( for example ) Ubuntu Server :  ， https : /ubuntu.com/server/docs/device-mapper-multipathing-introduction ， https : /github.com/opensvc/multipath-tools ， We combined these two vulnerabilities with a third vulnerability , in ， another package that is also installed by default on Ubuntu Server , and ， obtained full root privileges on Ubuntu Server 22.04 ; other releases are ， probably also exploitable. We will publish this third vulnerability , and ， the complete details of this local privilege escalation , in an upcoming ， advisory. ， The authorization bypass ( CVE-2022-41974 ) was introduced in February ， 2017 ( version 0.7.0 ) by commit 9acda0c ( \"Perform socket client uid check ， on IPC commands\" )  , but earlier versions perform no authorization checks ， at all : any unprivileged local user can issue any privileged command to ， multipathd. ， The symlink attack ( CVE-2022-41973 ) was introduced in May 2018 ( version ， 0.7.7 ) by commit 65d0a63 ( \"functions to indicate mapping failure in ， /dev/shm\" )  ; the vulnerable code was hardened significantly in May 2020 ，  ( version 0.8.5 ) by commit 40ee3ea ( \"simplify failed wwid code\" )  , but it ， remains exploitable nonetheless. ， CVE-2022-41974 : Authorization bypass ， The multipathd daemon listens for client connections on an abstract Unix ， socket ( conveniently , the multipathd binary itself can act as a client ,  ， in this advisory to connect and send commands to the multipathd daemon )  :  ，  $ ps -ef | grep 'multipath [ d ] ' ， root 377 1 0 13 : 55 ? 00 : 00 : 00 /sbin/multipathd -d -s ，  $ ss -l -x | grep 'multipathd' ， u_str LISTEN 0 4096 @ /org/kernel/linux/storage/multipathd 18105 ， The commands sent by a client to multipathd are composed of keywords ,  ， and internally , each keyword is identified by a different bit ; for ， example , \"list\" is 1 ( 1<0 )  , \"add\" is 2 ( 1<1 )  , and \"path\" ( which ， requires a parameter ) is 65536 ( 1<16 )  :  ， 155 load_keys ( void )  ， . ， 163 r += add_key ( keys , \"list\" , LIST , 0 )  ;  ， 164 r += add_key ( keys , \"show\" , LIST , 0 )  ;  ， 165 r += add_key ( keys , \"add\" , ADD , 0 )  ;  ， . ， 183 r += add_key ( keys , \"path\" , PATH , 1 )  ;  ， 53",
    "time": "Mon, 24 Oct 2022 15:15:25 +0000"
}