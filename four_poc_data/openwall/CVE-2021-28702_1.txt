{
    "text": "xen-users @ .ts.xen.org , oss-security @ .ts.openwall.com ， CC : Xen.org security team <security-team-members @ .org> ， Subject : Xen Security Advisory 386 v2 ( CVE-2021-28702 ) - PCI devices with ， RMRRs not deassigned correctly ， -BEGIN PGP SIGNED MESSAGE- ， Hash : SHA256 ， Xen Security Advisory CVE-2021-28702 / XSA-386 ， version 2 ， PCI devices with RMRRs not deassigned correctly ， UPDATES IN VERSION 2 ， Updated/corrected information about vulnerable versions. ， Upstream Xen 4.12 is not affected. ， There is no harm from applying the patch to an unaffected version. ， ISSUE DESCRIPTION ， Certain PCI devices in a system might be assigned Reserved Memory ， Regions ( specified via Reserved Memory Region Reporting , \"RMRR\" ) . ， These are typically used for platform tasks such as legacy USB ， emulation. ， If such a device is passed through to a guest , then on guest shutdown ， the device is not properly deassigned. The IOMMU configuration for ， these devices which are not properly deassigned ends up pointing to a ， freed data structure , including the IO Pagetables. ， Subsequent DMA or interrupts from the device will have unpredictable ， behaviour , ranging from IOMMU faults to memory corruption. ， This bug has existed since at least Xen 4.4 But it was previously ， masked by a tangentially-related misbehaviour ; that misbehaviour was ， corrected in f591755823a7 ， IOMMU/PCI : don't let domain cleanup continue when device de-assignment failed ， which was backported to supported stable branches. ， IMPACT ， Administrators of guests which have been assigned RMRR-using PCI ， devices can cause denial of service and other problems , possibly ， including escalation of privilege. ， VULNERABLE SYSTEMS ， For stable Xen releases : 4.13.4 , 4.14.3 and 4.15.1 are vulnerable. ， Other versions of Xen released by the Xen Project are not affected. ， For Xen git branches : the HEADs of 4.13 and later ( including ， xen-unstable ) were vulnerable , up until 2021-10-05 ( when the patch in ， this advisory was committed ) . 4.12 and earlier are not affected. ， In detail : code that has the following patch applied , is vulnerable :  ， IOMMU/PCI : don't let domain cleanup continue when device de-assignment failed ， That patch is currently in upstream stable branches 4.13 onwards and ， was included in the most recent stable point releases of each Xen version. ， Other downstream Xen builds may be affected if that patch was backported. ， Only Intel x86 systems are affected. AMD x86 systems , and Arm ， systems , are all unaffected. ， Only systems using PCI passthrough are affected. ( And then , only if ， the assigned devices have RMRRs , but whether a device advertises RMRRs ， is not easy to discern. ) ",
    "time": "Thu, 07 Oct 2021 14:41:16 +0000"
}