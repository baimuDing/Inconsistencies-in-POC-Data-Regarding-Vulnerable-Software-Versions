{
    "text": "Date: Tue, 16 May 2023 15:14:41 +0000 ， From: Xen.org security team <security@.org> ， To: xen-announce@.ts.xen.org, xen-devel@.ts.xen.org, ， xen-users@.ts.xen.org, oss-security@.ts.openwall.com ， CC: Xen.org security team <security-team-members@.org> ， Subject: Xen Security Advisory 431 v1 (CVE-2022-42336) - Mishandling of ， guest SSBD selection on AMD hardware ， -BEGIN PGP SIGNED MESSAGE- ， Hash: SHA256 ， Xen Security Advisory CVE-2022-42336 / XSA-431 ， Mishandling of guest SSBD selection on AMD hardware ， ISSUE DESCRIPTION ， The current logic to set SSBD on AMD Family 17h and Hygon Family 18h ， processors requires that the setting of SSBD is coordinated at a core ， level, as the setting is shared between threads. Logic was introduced ， to keep track of how many threads require SSBD active in order to ， coordinate it, such logic relies on using a per-core counter of threads ， that have SSBD active. ， When running on the mentioned hardware, it's possible for a guest to ， under or overflow the thread counter, because each write to ， VIRT_SPEC_CTRL.SSBD by the guest gets propagated to the helper that does ， the per-core active accounting. Underflowing the counter causes the ， value to get saturated, and thus attempts for guests running on the same ， core to set SSBD won't have effect because the hypervisor assumes it's ， already active. ， IMPACT ， An attacker with control over a guest can mislead other guests into ， observing SSBD active when it is not. ， VULNERABLE SYSTEMS ， Only Xen version 4.17 is vulnerable. ， Only x86 AMD systems are vulnerable. The vulnerability can be leveraged ， by and affects only HVM guests."
}