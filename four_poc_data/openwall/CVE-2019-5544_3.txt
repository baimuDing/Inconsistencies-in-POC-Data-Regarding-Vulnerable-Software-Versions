{
    "text": "CC : VMware Security Response Center <security @ .are.com> ， Subject : CVE-2019-5544 openslp 1.2.1 , 2.0.0 heap overflow vulnerability ， openslp has a heap overflow vulnerability that when exploited may result ， in memory corruption and a crash of slpd or in remote code execution. ， CVE-2019-5544 has been assigned to this issue. ， Below you may find :  ， - a copy of the affected code with comments indicating the problem. ， - patches for openslp versions 1.2.1 and 2.0.0 ， VMware would like to thank the 360Vulcan team working with the 2019 ， Tianfu Cup Pwn Contest for reporting this issue to us. ， VMware Security Response Center ， = CODE SNIPPET = ， slpd_process.c ， static int ProcessSrvRqst ( SLPMessage * message , SLPBuffer * sendbuf ,  ， int errorcode )  ， { ， . ， { ， { ， / * urlentry is the url from the db result * / ， urlentry = db->urlarray [ i ]  ;  ， size += urlentry->urllen + 6 ; / * 1 byte for reserved * / <= ( 1 ) here size plus urllen ， / * 2 bytes for lifetime * / ， / * 2 bytes for urllen * / ， / * 1 byte for authcount * / ，  # ifdef ENABLE_SLPv2_SECURITY ， / * make room to include the authblock that was asked for * / ， & message->body.srvrqst.spistrlen )  ， { ， { ， urlentry->autharray [ j ] .spistr ,  ， message->body.srvrqst.spistrlen ,  ， message->body.srvrqst.spistr ) = 0 )  ， { ， authblock = & ( urlentry->autharray [ j ]  )  ;  ， size += authblock->length ;  ， } ， } ， } ，  # endif ， } ， } ， / * reallocate the result buffer * / ， result = SLPBufferRealloc ( result , size )  ; / <= ( 2 ) here use size to malloc a buffer ， { ， errorcode = SLP_ERROR_INTERNAL_ERROR ;  ， goto FINISHED ;  ， } ， / * add the header * / ， / * version * / ，  * result->curpos+ = 2 ;  ， / * function id * / ，  * result->curpos+ = SLP_FUNCT_SRVRPLY ;  ， / * length * / ， PutUINT24 ( &result->curpos , size )  ;  ， / * flags * / ， PutUINT16 ( &result->curpos ,  ( size > ( size_t ) G_SlpdProperty.MTU? ， SLP_FLAG_OVERFLOW : 0 )  ;  ， / * ext offset * / ， PutUINT24 ( &result->curpos , 0 )  ;  ， / * xid * / ， PutUINT16 ( &result->curpos , message->header.xid )  ;  ， / * lang tag len * / ， PutUINT16 ( &result->curpos , message->header.langtaglen )  ;  ， / * lang tag * / ， memcpy ( result->curpos , message->header.langtag ,  ， message->header.langtaglen )  ;  ， result->curpos += message->header.langtaglen ;  ， / * add rest of the SrvRply * / ， / * error code * / ， PutUINT16 ( &result->curpos , errorcode )  ;  ， { ， / * urlentry count * / ， PutUINT16 ( &result->curpos , db->urlcount )  ;  ， { ， / * urlentry is the url from the db result * / ， urlentry = db->urlarray [ i ]  ;  ，  # ifdef ENABLE_SLPv1 ， { ， / * url-entry reserved * / ，  * result->curpos+ = 0 ;  ， / * url-entry lifetime * / ， PutUINT16 ( &result->curpos , urlentry->lifetime )  ;  ， / * url-entry urllen * / ， PutUINT16 ( &result->curpos , urlentry->urllen )  ;  ， / * url-entry url * / ， memcpy ( result->curpos , urlentry->url , urlentry->urllen )  ;  ， result->curpos += urlentry->urllen ;  ， / * url-entry auths * / ，  * result->curpos+ = 0 ;  ， } ，  # endif ， { ， / * Use an opaque copy if available ( and authentication is ，  * not being used ) . ， / * TRICKY : Fix up the lifetime. * / ， TO_UINT16 ( urlentry->opaque + 1 , urlentry->lifetime )  ;  ， memcpy ( result->curpos , urlentry->opaque , urlentry->opaquelen )  ; / <= ( 3 ) opaquelen could be bigger than urllen , lead to heap overflow ， result->curpos += urlentry->opaquelen ;  ， } ， } ， } ， PutUINT16 ( &result->curpos , 0 )  ; / * set urlentry count to 0 * / ， FINISHED :  ， SLPDDatabaseSrvRqstEnd ( db )  ;  ，  * sendbuf = result ;  ， } ， = /CODE SNIPPET = ， = PATCH FOR OPENSLP 1.2.1 = ， diff -ur openslp-1.2.1.orig/common/slp_buffer.c openslp-1.2.1/common/slp_buffer.c ， - openslp-1.2.1.orig/common/slp_buffer.c 2005-02-07 21 : 32 : 58.000000000 -0800 ， + openslp-1.2.1/common/slp_buffer.c 2019-11-26 21 : 58 : 26.000000000 -0800 ，  @ -47 , 6 +47 , 12 @  ， +/ * Copyright ( c ) 2019 VMware , Inc. ， + * SPDX-License-Identifier : BSD-3-Clause ， + * This file is provided under the BSD-3-Clause license. ， + * See COPYING file for more details and other copyrights ， + * that may apply. ， + * /",
    "time": "Fri, 6 Dec 2019 05:25:10 +0000"
}