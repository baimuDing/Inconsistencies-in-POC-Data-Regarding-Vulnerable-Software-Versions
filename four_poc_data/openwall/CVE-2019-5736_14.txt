{
    "text": "Cc : Aleksa Sarai <cyphar @ .har.com> , dev @ .ncontainers.org ,  ， Christian Brauner <christian.brauner @ .ntu.com> ， Subject : Re : CVE-2019-5736 : runc container breakout ( all versions )  ， On Tue , Feb 12 , 2019 at 12 : 05 : 20AM +1100 , Aleksa Sarai wrote :  ， > The vulnerability allows a malicious container to ( with minimal user ， > interaction ) overwrite the host runc binary and thus gain root-level ， > code execution on the host. The level of user interaction is being able ， > to run any command ( it doesn't matter if the command is not ， > attacker-controlled ) as root within a container in either of these ， > contexts :  ， > * Creating a new container using an attacker-controlled image. ， > * Attaching ( docker exec ) into an existing container which the ， > attacker had previous write access to. ，  [ . ]  ， > = IMPACT ON OTHER PROJECTS = ， > It should be noted that upon further investigation I've discovered that ， > LXC has a similar vulnerability , and they have also pushed a similar ， > patch [ 2 ] which we co-developed. LXC is a bit harder to exploit , but the ， > same fundamental flaw exists. ， > After some discussion with the systemd-nspawn folks , it appears that ， > they aren't vulnerable ( because their method of attaching to a container ， > uses a different method to LXC and runc ) . ， > I have been contacted by folks from Apache Mesos who said they were also ， > vulnerable ( I believe just using the exploit code that will be ， > provided ) . It is quite likely that most container runtimes are ， > vulnerable to this flaw , unless they took very strange mitigations ， > before-hand. ， While runc , LXC , and maybe other projects fix CVE-2019-5736 in userspace ,  ， Virtuozzo/OpenVZ 7 has just released a kernel fix instead - please see ， the forwarded message below. Following links from there , I found the ， following description of the issue in context of Virtuozzo and OpenVZ :  ， Security vulnerability : potential breakage of container isolation via symlinks to /proc/self/exe ， Affected products :  ，  * Virtuozzo 7 Update 8 and older ，  * OpenVZ 7 ， Not affected :  ，  * Virtuozzo Infrastructure Platform 2.5 ，  * Virtuozzo 6 and earlier versions ，  * OpenVZ 6 ， 1. Overview ， It was discovered that a malicious user inside a Virtuozzo container could ， potentially overwrite \"vzctl\" binary on the host. The attacker could replace ， executables in that container with symlinks to /proc/self/exe. After that ,  ， \"vzctl exec\" called from the host to run one of such executables would try to ， run the host's \"vzctl\" there instead. If the attacker managed to intercept ， that , they would be able to change the contents of the host's \"vzctl\" binary. ， CVSS v3 score : 7.2 ( AV : L/AC : H/PR : L/UI : R/S : C/C : N/I : H/A : H )  ， The issue is similar to CVE-2019-5736 , but affects \"vzctl\" rather than \"runc\". ， I was curious about the kernel fix. It doesn't appear to be in the ， public git repository yet , where the latest is ， 3.10.0-862.20.2.vz7.73.25 , whereas the fixed version is .27. So I ， downloaded the .src.rpm and found what I think is the fix in there :  ，  * Mon Feb 11 2019 Konstantin Khorenko <khorenko @ .tuozzo.com> [ 3.10.0-862.20.2.vz7.73.27 ]  ， - proc/self/exe link validation ( Vasily Averin )  [ PSBM-91042 ]  ， - a/fs/proc/base.c ， + b/fs/proc/base.c ，  [ . ]  ，  @ -1617 , 6 +1749 , 26 @ static const struct file_operations ， proc_pid_set_comm_operations = { ， .release = single_release ,  ， } ;  ， + # if CONFIG_VE ， +",
    "time": "Tue, 12 Feb 2019 17:36:06 +0100"
}