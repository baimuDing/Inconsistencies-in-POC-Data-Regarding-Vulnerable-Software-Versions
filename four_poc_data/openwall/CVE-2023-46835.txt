{
    "text": "Date: Tue, 14 Nov 2023 14:00:50 +0000 ， From: Xen.org security team <security@.org> ， To: xen-announce@.ts.xen.org, xen-devel@.ts.xen.org, ， xen-users@.ts.xen.org, oss-security@.ts.openwall.com ， CC: Xen.org security team <security-team-members@.org> ， Subject: Xen Security Advisory 445 v3 (CVE-2023-46835) - x86/AMD: mismatch ， in IOMMU quarantine page table levels ， -BEGIN PGP SIGNED MESSAGE- ， Hash: SHA256 ， Xen Security Advisory CVE-2023-46835 / XSA-445 ， version 3 ， x86/AMD: mismatch in IOMMU quarantine page table levels ， UPDATES IN VERSION 3 ， Public release. ， ISSUE DESCRIPTION ， The current setup of the quarantine page tables assumes that the ， quarantine domain (dom_io) has been initialized with an address width ， of DEFAULT_DOMAIN_ADDRESS_WIDTH (48) and hence 4 page table levels. ， However dom_io being a PV domain gets the AMD-Vi IOMMU page tables ， levels based on the maximum (hot pluggable) RAM address, and hence on ， systems with no RAM above the 512GB mark only 3 page-table levels are ， configured in the IOMMU. ， On systems without RAM above the 512GB boundary ， amd_iommu_quarantine_init() will setup page tables for the scratch ， page with 4 levels, while the IOMMU will be configured to use 3 levels ， only, resulting in the last page table directory (PDE) effectively ， becoming a page table entry (PTE), and hence a device in quarantine ， mode gaining write access to the page destined to be a PDE. ， Due to this page table level mismatch, the sink page the device gets ， read/write access to is no longer cleared between device assignment, ， possibly leading to data leaks. ， IMPACT ， A device in quarantine mode can access data from previous quarantine ， page table usages, possibly leaking data used by previous domains that ， also had the device assigned. ， VULNERABLE SYSTEMS ， All Xen versions supporting PCI passthrough are affected. ， Only x86 AMD systems with IOMMU hardware are vulnerable. ， Only x86 guests which have physical devices passed through to them can ， leverage the vulnerability."
}