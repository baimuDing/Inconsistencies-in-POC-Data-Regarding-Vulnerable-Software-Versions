{
    "text": "title : Android Media Integer Overflow  ， detail : An integer overflow in the BnAudioPolicyService : onTransact function in frameworks can be exploited to achieve media_server permission. All versions below Lollipop 5.1 are affected.  ， cve : advisories | CVE-2015-1530  ，  ， desc :  #   ，  ，  # QIHU 360 SOFTWARE CO. LIMITED http : /www.360safe.com/  ，   ，  ，  # CVE ID : CVE-2015-1530  ，  # Product : Android  ，  # Vendor : Google  ，  # Subject : An integer overflow in Android media could be exploited to get  ， media_server permission  ，  # Effect : Gain privileges or cause a denial of service  ，  # Author : Guang Gong  ，  # Date : March 11th 2015  ，   ， Introduction  ，  ， An Integer overflow in the BnAudioPolicyService : onTransact function in  ， frameworks <http : /androidxref.com/4.4.4_r1/xref/frameworks/>/av  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/>/media  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/>/libmedia  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/>/  ， IAudioPolicyService.cpp  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp>  ， in Android through 5.0 allow attackers to gain privileges or cause a denial  ， of service ( memory corruption ) via vectors that trigger a large number of  ， count value.  ， Affected Android version  ，  ， all versions below Lollipop 5.1  ， Patches  ，  ， Android Bug id 18226810  ， https : /android.googlesource.com/platform/frameworks/av/+/e360f0f6cad290f69e07fd3a20dcf11a1dbc4160  ， Description  ，  ， The vulnerable code is as follows.  ， http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 661  ， case QUERY_DEFAULT_PRE_PROCESSING  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # QUERY_DEFAULT_PRE_PROCESSING> :   ， {  ， 656  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 656>  ， CHECK_INTERFACE  ， <http : /androidxref.com/4.4.4_r1/s?defs=CHECK_INTERFACE&project=frameworks> (   ， IAudioPolicyService  ， <http : /androidxref.com/4.4.4_r1/s?defs=IAudioPolicyService&project=frameworks>  ，  , data <http : /androidxref.com/4.4.4_r1/s?defs=data&project=frameworks> ,   ， reply <http : /androidxref.com/4.4.4_r1/s?defs=reply&project=frameworks> )  ;   ， 657  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 657>  ， int audioSession  ， <http : /androidxref.com/4.4.4_r1/s?refs=audioSession&project=frameworks> =  ， data <http : /androidxref.com/4.4.4_r1/s?defs=data&project=frameworks>.  ， readInt32  ， <http : /androidxref.com/4.4.4_r1/s?defs=readInt32&project=frameworks> (  )  ;   ， 658  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 658>  ， uint32_t  ， <http : /androidxref.com/4.4.4_r1/s?defs=uint32_t&project=frameworks> count  ， <http : /androidxref.com/4.4.4_r1/s?refs=count&project=frameworks> = data  ， <http : /androidxref.com/4.4.4_r1/s?defs=data&project=frameworks>.readInt32  ， <http : /androidxref.com/4.4.4_r1/s?defs=readInt32&project=frameworks> (  )  ;   ， 659  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 659>  ， uint32_t  ， <http : /androidxref.com/4.4.4_r1/s?defs=uint32_t&project=frameworks>  ， retCount  ， <http : /androidxref.com/4.4.4_r1/s?refs=retCount&project=frameworks> = count  ， <http : /androidxref.com/4.4.4_r1/s?defs=count&project=frameworks> ;   ， 660  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 660>  ， effect_descriptor_t  ， <http : /androidxref.com/4.4.4_r1/s?defs=effect_descriptor_t&project=frameworks>  ，  * descriptors  ， <http : /androidxref.com/4.4.4_r1/s?refs=descriptors&project=frameworks> =  ， 661  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 661>  ，  ( effect_descriptor_t  ， <http : /androidxref.com/4.4.4_r1/s?defs=effect_descriptor_t&project=frameworks>  ，  *  ) new char [ count  ， <http : /androidxref.com/4.4.4_r1/s?defs=count&project=frameworks> * sizeof (   ， effect_descriptor_t  ， <http : /androidxref.com/4.4.4_r1/s?defs=effect_descriptor_t&project=frameworks>  ，  )  ]  ; ->count can be set to any value by binder client ,   ， which can cause integer overflow and when write to this buffer , heap  ， corruption will happen.  ， 662  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 662>  ， status_t  ， <http : /androidxref.com/4.4.4_r1/s?defs=status_t&project=frameworks> status  ， <http : /androidxref.com/4.4.4_r1/s?refs=status&project=frameworks> =  ， queryDefaultPreProcessing  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # queryDefaultPreProcessing>  ，  ( audioSession  ， <http : /androidxref.com/4.4.4_r1/s?defs=audioSession&project=frameworks> ,   ， descriptors  ， <http : /androidxref.com/4.4.4_r1/s?defs=descriptors&project=frameworks> , &  ， retCount  ， <http : /androidxref.com/4.4.4_r1/s?defs=retCount&project=frameworks> )  ;   ， 663  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 663>  ， reply  ， <http : /androidxref.com/4.4.4_r1/s?defs=reply&project=frameworks>->  ， writeInt32  ， <http : /androidxref.com/4.4.4_r1/s?defs=writeInt32&project=frameworks> (   ， status <http : /androidxref.com/4.4.4_r1/s?defs=status&project=frameworks> )  ;   ， 664  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 664>  ，  ， <http : /androidxref.com/4.4.4_r1/s?defs=status&project=frameworks> ! =  ， NO_ERROR  ， <http : /androidxref.com/4.4.4_r1/s?defs=NO_ERROR&project=frameworks> &  ， status <http : /androidxref.com/4.4.4_r1/s?defs=status&project=frameworks> ! =  ， NO_MEMORY  ， <http : /androidxref.com/4.4.4_r1/s?defs=NO_MEMORY&project=frameworks> ) {  ， 665  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 665>  ， retCount  ， <http : /androidxref.com/4.4.4_r1/s?defs=retCount&project=frameworks> = 0 ;   ， 666  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 666>  ， }  ， 667  ， <http : /androidxref.com/4.4.4_r1/xref/frameworks/av/media/libmedia/IAudioPolicyService.cpp # 667>  ， reply  ， <http : /androidxref.com/4.4.4_r1/s?defs=reply&project=frameworks>->  ， writeInt32  ， <http : /androidxref.com/4.4.4_r1/s?defs=writeInt32&project=frameworks> (   ， retCount  ， <http : /androidxref.com/4.4.4_r1/s?defs=retCount&project=frameworks> )  ;   ， Attack vector  ，  ， A normal Apps can corrupt the heap in mediaserver by this vulnerabilities.  ， the PoC of corrupting the heap is as follows",
    "time": "Mar 12, 2015"
}