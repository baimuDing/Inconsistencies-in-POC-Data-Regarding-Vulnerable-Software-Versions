{
    "text": "title : Solarwinds Orion Service SQL Injection  ， detail : Various remote SQL injection vulnerabilities exist in the core Orion service used in most of the Solarwinds products. Affected products include Network Performance Monitor below version 11.5 , NetFlow Traffic Analyzer below version 4.1 , Network Configuration Manager below version 7.3.2 , IP Address Manager below version 4.3 , User Device Tracker below version 3.2 , VoIP  ， cve : advisories | CVE-2014-9566  ，  ， desc : I found a couple SQL injection vulnerabilities in the core Orion service  ， used in most of the Solarwinds products ( SAM , IPAM , NPM , NCM , etc ) . This  ， service provides a consistent configuration and authentication layer across  ， the products.  ， To be exact , the vulnerable applications and versions are :   ， Network Performance Monitor - < 11.5  ， NetFlow Traffic Analyzer - < 4.1  ， Network Configuration Manager - < 7.3.2  ， IP Address Manager - < 4.3  ， User Device Tracker - < 3.2  ， VoIP & Network Quality Manager - < 4.2  ， Server & Application Monitor - < 6.2  ， Web Performance Monitor - < 2.2  ， At first glance , the injections are only available to admins , as the  ， requests used are on the Manage Accounts page. However , it seems there is  ， no real ACL check on the GetAccounts and GetAccountGroups endpoints of the  ， AccountManagement.asmx service , which means that even authenticating as  ， Guest allows for exploitation. By default , the Guest account has no  ， password and is enabled.  ， On both the GetAccounts and GetAccountGroups endpoints , the 'sort' and  ， 'dir' parameters are susceptible to boolean-/time-based , and stacked  ， injections. By capturing the AJAX requests made by an admin user to these  ， endpoints , authenticating as Guest and replacing the admin cookie with the  ， Guest cookie , you can still make a successful request , and thus a  ， successful exploitation vector for any authenticated user.  ， Being a stacked injection , this becomes a privilege escalation at the very  ， least , as an attacker is able to insert their own admin user. A pull  ， request for a Metasploit module which should achieve this on any product  ， using the Orion service as the core authentication management system , using  ， the GetAccounts endpoint , has been made (   ， https : /github.com/rapid7/metasploit-framework/pull/4836 ) . By default , the  ， module attempts to authenticate as the Guest user with a blank password ,   ， then exploit the SQL injection to insert a new admin with a blank password.  ， I am not sure if the non-trial versions allow you to specify your own SQL  ， server , but the trials install a SQL Server Express instance. The SQL user  ， that the application uses is not an administrator , and the xp_cmd_shell  ， stored procedure is unavailable.  ， Within the GetAccounts endpoint : ",
    "time": "Mar 3, 2015"
}