{
    "text": "title : Dolibarr 7.0.0 Admin Panel Remote Code Execution  ， detail : Dolibarr version 7.0.0 suffers from a remote code execution vulnerability.  ， cve : advisories | CVE-2018-10092  ，  ， desc :  #  [ CVE-2018-10092 ] Dolibarr admin panel authenticated Remote Code  ， Execution ( RCE ) vulnerability  ，  # Description  ， Dolibarr is an \"Open Source ERP & CRM for Business\" used by many  ， companies worldwide.  ， It is available through [ GitHub ]  ( https : /github.com/Dolibarr/dolibarr )   ， or as distribution packages ( e.g .deb package ) .  ，  * Threat *   ， By tricking a logged-in admin into clicking a malicious link , or by  ， getting admin privileges in some other way , a remote attacker can  ， achieve remote code execution ( RCE ) on the target server.  ，  * Expectation *   ， User input should be filtered to avoid arbitrary OS command injection.  ， Arbitrary external commands should be defined in a configuration file  ， which is not editable by an ERP user.  ，  # Vulnerability type  ，  * CVE ID *  : CVE-2018-10092  ，  * Access Vector *  : remote  ，  * Security Risk *  : high  ，  * Vulnerability *  : CWE-78  ，  * CVSS Base Score *  : 9.0  ，  * CVSS Vector String *  : CVSS : 3.0/AV : N/AC : L/PR : L/UI : R/S : C/C : H/I : H/A : H  ，  # Details  ， The admin panel allows to define an antivirus command and parameters ,   ， which are run every time a file is uploaded and scanned.  ， However , it is possible for an authenticated user to specify an  ， arbitrary command to be run instead of the antivirus scanner. The  ， injected command would be triggered after uploading a file to scan ,   ， which effectively leads to executing arbitrary code on the server.  ， The command to be run is stored in the config variables  ， `MAIN_ANTIVIRUS_COMMAND` and `MAIN_ANTIVIRUS_PARAM` , which can be set by  ， the admin through the Web interface.  ， Then , when a file is uploaded by a user , the function  ， `dol_move_uploaded_file (  ) ` ( defined in `files.lib.php` ) is called :   ， `php  ，  ，  $ disablevirusscan=0 ,  $ uploaderrorcode=0 ,  $ nohook=0 ,  $ varfiles='addedfile' )   ， {  ， . snip .  ， / If we need to make a virus scan  ，  ， {  ，  $ checkvirusarray=dolCheckVirus (  $ src_file )  ;   ，  ， {  ， dol_syslog ( 'Files.lib : dol_move_uploaded_file File  ， \"'. $ src_file.'\" ( target name \"'. $ dest_file.'\" ) KO with antivirus :   ， result='. $ result.' errors='.join ( ' , ' ,  $ checkvirusarray )  , LOG_WARNING )  ;   ，  ， '.join ( ' , ' ,  $ checkvirusarray )  ;   ， }  ， }  ， . snip .  ，  ， }  ， `  ， Which calls `dolCheckVirus (  ) ` :   ， `php  ，  ， {  ， global $ conf ;   ，  ， {  ，  ， require_once DOL_DOCUMENT_ROOT.'/core/class/antivir.class.php' ;   ， }  ，  $ antivir=new AntiVir (  $ db )  ;   ，  $ result = $ antivir->dol_avscan_file (  $ src_file )  ;   ，  ， {  ，  $ reterrors= $ antivir->errors ;   ，  ， }  ， }  ，  ， }  ， `  ， Which in turn calls `dol_avscan_file (  ) ` ( defined in  ， `antivir.class.php` )  , where the return value of `getCliCommand (  ) ` is",
    "time": "May 27, 2018"
}