{
    "text": "title : Apache MyFaces 2.x Cross Site Request Forgery  ， detail : Apache MyFaces versions 2.2.13 and below , 2.3.7 and below , 2.3-next-M4 and below , and 2.1 and below suffer from a cross site request forgery vulnerability.  ， cve : advisories | CVE-2021-26296  ，  ， desc :  ~   ，  ~ Ceritude Securiy Advisory - CSA-2021-001 ~   ，  ， PRODUCT : Apache MyFaces  ， VENDOR : The Apache Software Foundation  ， SEVERITY : High  ， AFFECTED VERSION : <= 2.2.13 , <= 2.3.7 , <= 2.3-next-M4 , <= 2.1 branches  ， IDENTIFIERS : CVE-2021-26296  ， PATCH VERSION : 2.2.14 , 2.3.8 , 2.3-next-M5 , 3.0.0  ， FOUND BY : Wolfgang Ettlinger , Certitude Lab  ，  ， Introduction  ，  ， Apache MyFaces is an open-source implementation of JSF. During a quick  ， evaluation , Certitude found that the default CSRF protection of Apache MyFaces  ， was insufficient as the CSRF tokens the framework generates can be guessed by  ， an attacker.  ， Moreover , the patch provided by the Apache MyFaces maintainers affects the way  ， channel tokens for websocket communication are generated. It is unclear ,   ， whether this change fixes a vulnerability.  ， Vulnerability Overview  ，  ， Applications that employ the MyFaces JSF framework transmit a parameter  ， \"javax.faces.ViewState\" with every state-modifying request. Though not  ， intended for CSRF protection , in the default configuration this parameter  ， prevents trivial attacks , as it is sufficiently long and tied to a single  ， session.  ， However , by default , this value is generated using the insecure random number  ， generator `java.util.Random`. An attacker can therefore obtain a ViewState  ， parameter from the application and , based on this value , predict the random  ， part of ViewState parameters subsequently issued to other users. Besides the  ， random string , the ViewState parameter contains a sequence number. As the  ， initial value of the per-session sequence counter is 1 , an attacker can very  ， easily guess this value.  ， As the ViewState parameter is the sole CSRF protection , knowledge of this  ， value allows an attacker to conduct CSRF attacks.  ， When Apache MyFaces is used in client-side saving mode , the ViewState  ， parameter is insufficient to protect against CSRF. Instead , pages that require  ， protection against CSRF can be marked as \"protected-pages\". For these pages ,   ， Apache MyFaces requires CSRF token for each request ( \"javax.faces.Token\" ) . By  ， default , the CSRF token too is generated using `java.util.Random` , thus  ， allowing an attacker to bypass the CSRF protection.  ， NOTE : Besides the ViewState parameter and the CSRF token , Apache MyFaces also  ， introduced a cryptographically secure random number generator for the  ， websocket channel token. Certitude has not verified if this change fixes a  ， vulnerability.  ， Proof of Concept  ，  ， By default , the class  ， `org.apache.myfaces.application.viewstate.RandomKeyFactory` is used to",
    "time": "Feb 20, 2021"
}