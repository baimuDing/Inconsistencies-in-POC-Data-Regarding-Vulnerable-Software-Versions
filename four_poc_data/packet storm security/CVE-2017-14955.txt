{
    "text": "title : Check_mk 1.2.8p25 save_users (  ) Race Condition  ， detail : Check_mk versions 1.2.8p25 and below suffer from a save_users (  ) race condition that leads to sensitive information disclosure.  ， cve : advisories | CVE-2017-14955  ，  ， desc : RCE Security Advisory  ， https : /www.rcesecurity.com  ， 1. ADVISORY INFORMATION  ，  ， Product : Check_mk  ， Vendor URL : https : /mathias-kettner.de/check_mk.html  ， Type : Race Condition [ CWE-362 ]   ， Date found : 2017-09-21  ， Date published : 2017-10-18  ， CVSSv3 Score : 7.5 ( CVSS : 3.0/AV : N/AC : L/PR : N/UI : N/S : U/C : H/I : N/A : N )   ， CVE : CVE-2017-14955  ， 2. CREDITS  ，  ， This vulnerability was discovered and researched by Julien Ahrens from  ， RCE Security.  ， 3. VERSIONS AFFECTED  ，  ， Check_mk v1.2.8p25  ， Check_mk v1.2.8p25 Enterprise  ， older versions may be affected too.  ， 4. INTRODUCTION  ，  ， Check_MK is comprehensive IT monitoring solution in the tradition of Nagios.  ， Check_MK is available as Raw Edition , which is 100% pure open source , and as  ， Enterprise Edition with a lot of additional features and professional support.  ，  ( from the vendor's homepage )   ， 5. VULNERABILITY DETAILS  ，  ， Check_mk is vulnerable to an unauthenticated information disclosure through a  ， race condition during the authentication process when trying to authenticate  ， with a valid username and an invalid password.  ， On a failed login , the application calls the function save_users (  )  , which  ， performs two os.rename operations on the files \"contacts.mk.new\" and  ， \"users.mk.new\" ( see /packages/check_mk/check_mk-1.2.8p25/web/htdocs/userdb.py )  :   ，  [ . ]   ，  # Check_MK's monitoring contacts  ， filename = root_dir + \"contacts.mk.new\"  ， out = create_user_file ( filename , \"w\" )   ， out.write ( \" # Written by Multisite UserDB\\n # encoding : utf-8\\n\\n\" )   ， out.write ( \"contacts.update ( \\n%s\\n ) \\n\" % pprint.pformat ( contacts )   ， out.close (  )   ， os.rename ( filename , filename [  : -4 ]  )   ，  # Users with passwords for Multisite  ， filename = multisite_dir + \"users.mk.new\"  ， make_nagios_directory ( multisite_dir )   ， out = create_user_file ( filename , \"w\" )   ， out.write ( \" # Written by Multisite UserDB\\n # encoding : utf-8\\n\\n\" )   ， out.write ( \"multisite_users = \\n%s\\n\" % pprint.pformat ( users )   ， out.close (  )   ， os.rename ( filename , filename [  : -4 ]  )   ，  [ . ]   ， When sending many concurrent authentication requests with an existing/valid  ， username , such as :   ， POST /check_mk/login.py HTTP/1.1  ， Host : localhost",
    "time": "Oct 19, 2017"
}