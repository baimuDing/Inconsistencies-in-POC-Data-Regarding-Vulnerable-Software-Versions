{
    "text": "date_time:Feb 18, 2019 ， title:Digi TransPort LR54 Restricted Shell Escape  ， detail:Digi TransPort LR54 suffers from a restricted shell bypass vulnerability that gets a root shell.  ， cve:advisories | CVE-2018-20162  ， date_time:Feb 18, 2019  ， desc:-BEGIN PGP SIGNED MESSAGE-  ， Hash: SHA512  ， CVE-2018-20162: Digi TransPort LR54 Restricted Shell Escape  ，  ， The Digi TransPort LR54 is a high speed LTE router commonly used by industry,  ， infrastructure, retail and public transportation.  ， It supports running python scripts in a restricted sandbox, and has a custom  ， shell accessible over SSH which is subjected to the same restrictions. The  ， underlying OS is inaccessible to the administrator.  ， Iave found a way to break out of the sandbox and obtaining a root shell by  ， exploiting the way the cli handles command line arguments when executing python  ， scripts:  ， When an interactive python process receives a SIGINT (trough CTRL-C), arguments  ， to the script are not properly escaped when passed to the interactive CLIas  ， error logging handler. This allows an attacker to execute arbitrary commands as  ， root.  ， To exploit this vulnerability, an attacker needs to have interactive CLI access  ， with asupera privileges. A user with this access level is enabled by default on  ， the device.  ， Vulnerable  ，  ， Digi Transport LR54 (and maybe related products like WR64 and WR54)  ， Firmware Version : 4.4.0.26 10/29/2018 21:14:06  ， Firmware Version : 4.3.2.24 09/06/2018 00:58:34  ， And maybe earlier versions  ， Migitation  ，  ， Users should upgrade to firmware version 4.5.1.4 or newer.  ， Proof of Concept  ，  ， 1. Upload sleep.py to the LR54 using scp or sftp, containing:"
}