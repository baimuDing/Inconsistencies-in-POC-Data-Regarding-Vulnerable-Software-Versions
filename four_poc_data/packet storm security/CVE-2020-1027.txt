{
    "text": "title : Windows sxs ! CNodeFactory : XMLParser_Element_doc_assembly_assemblyIdentity Heap Buffer Overflow  ， detail : A heap buffer overflow issue exists in Windows 11 and earlier versions. A malicious application may be able to execute arbitrary code with SYSTEM privileges.  ， cve : advisories | CVE-2020-1027 , CVE-2022-22026  ，  ， desc : Windows : Heap buffer overflow in sxs ! CNodeFactory : XMLParser_Element_doc_assembly_assemblyIdentity  ，  # SUMMARY  ， A heap buffer overflow issue exists in Windows 11 and earlier versions. A malicious application may be able to execute arbitrary code with SYSTEM privileges.  ，  # VULNERABILITY DETAILS  ， In 2020 , Project Zero reported a heap buffer overflow in application manifest parsing [ 1 ] . The `MaximumLength` field in one of the `UNICODE_STRING` parameters of the `BaseSrvSxsCreateActivationContextFromMessage` CSR routine wasn't properly validated , and was later used by `XMLParser_Element_doc_assembly_assemblyIdentity` as the maximum size of a `memcpy` destination buffer. The fix added an extra `CsrValidateMessageBuffer` call to `BaseSrvSxsCreateActivationContextFromMessage`.  ， We've just discovered that `BaseSrvSxsCreateActivationContextFromMessage` is not the only CSR routine that can reach `XMLParser_Element_doc_assembly_assemblyIdentity`. An attacker can trigger the same buffer overflow via `BaseSrvSxsCreateProcess`.  ， 1. https : /googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2020/CVE-2020-1027.html  ，  # VERSION  ， Windows 11 12H2 ( OS Build 22000.593 )   ， Windows 10 12H2 ( OS Build 19044.1586 )   ，  # REPRODUCTION CASE  ， 1 ) Enable page heap verification for csrss.exe :   ， `  ， gflags /p /enable csrss.exe /full  ， `  ， 2 ) Restart the machine.  ， 3 ) Compile and run :   ， `  ，  # pragma comment ( lib , \"ntdll\" ) ",
    "time": "Aug 12, 2022"
}