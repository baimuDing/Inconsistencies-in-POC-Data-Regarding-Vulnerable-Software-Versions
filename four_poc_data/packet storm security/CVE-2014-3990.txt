{
    "text": "title : OpenCart 1.5.6.4 PHP Object Injection  ， detail : OpenCart versions 1.5.6.4 and below suffer from a PHP objection injection vulnerability.  ， cve : advisories | CVE-2014-3990  ，  ， desc : -  ， OpenCart <= 1.5.6.4 ( cart.php ) PHP Object Injection Vulnerability  ，  ，  [ - ] Software Link :   ， http : /www.opencart.com/  ，  [ - ] Affected Versions :   ， Version 1.5.6.4 and prior versions.  ，  [ - ] Vulnerability Description :   ， The vulnerable code is located in the \"Cart : getProducts (  ) \" method defined in /system/library/cart.php :   ， 23. foreach (  $ this->session->data [ 'cart' ] as $ key => $ quantity ) {  ， 24. $ product = explode ( ' : ' ,  $ key )  ;   ， 25. $ product_id = $ product [ 0 ]  ;   ， 26. $ stock = true ;   ， 27.  ， 28. / Options  ， 29. if (  ! empty (  $ product [ 1 ]  ) {  ， 30. $ options = unserialize ( base64_decode (  $ product [ 1 ]  )  ;   ， 31. } else {  ， 32. $ options = array (  )  ;   ， 33. }  ， The vulnerability exists because this method uses the \"unserialize (  ) \" function with the key values of the  ， array stored into the \"data [ 'cart' ] \" session variable without a proper validation. Such values might be  ， manipulated by an unauthenticated attacker via the $ _POST [ 'quantity' ] parameter during an \"update\" request.  ， This can be exploited to inject arbitrary PHP objects into the application scope , and could allow an attacker  ， to conduct Server-Side Request Forgery ( SSRF ) attacks by abusing the destructor method of the \"DBMySQLi\"  ， class and possibly other attacks leveraging magic methods of classes defined in third-party extensions.  ， NOTE : if OpenCart is running on PHP before version 5.3.23 or 5.4.13 this vulnerability  ， could also be exploited to carry out XML External Entity ( XE ) attacks , which in turn  ， might allow arbitrary command execution if the PHP \"expect\" extension is installed.  ，  [ - ] Solution :   ， Update to version 1.5.6.5 when will be released or apply this patch : http : /git.io/F3dGoA",
    "time": "Jul 14, 2014"
}