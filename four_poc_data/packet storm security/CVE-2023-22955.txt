{
    "text": "title : AudioCodes VoIP Phones Insufficient Firmware Validation  ， detail : AudioCodes VoIP Phones with firmware versions greater than or equal to 3.4.4.1000 have been found to have validation of firmware images that only consists of simple checksum checks for different firmware components.  ， cve : advisories | CVE-2023-22955  ，  ， desc : -BEGIN PGP SIGNED MESSAGE-  ， Hash : SHA512  ， Advisory ID : SYSS-2022-055  ， Product : AudioCodes VoIP Phones  ， Manufacturer : AudioCodes Ltd.  ， Affected Version ( s )  : Firmware Versions >= 3.4.4.1000  ， Tested Version ( s )  : Firmware Version 3.4.4.1000  ， Vulnerability Type : Missing Immutable Root of Trust in Hardware ( CWE-1326 )   ， Risk Level : Medium  ， Solution Status : Open  ， Manufacturer Notification : 2022-11-14  ， Solution Date : N.A.  ， Public Disclosure : 2023-08-10  ， CVE Reference : CVE-2023-22955  ， Authors of Advisory : Matthias Deeg , SySS GmbH  ， Moritz Abrell , SySS GmbH  ，  ， Overview :   ， AudioCodes VoIP phones are modern desk phones which are used for the  ， operation in enterprise environments.  ， The manufacturer describes the product as follows ( see [ 1 ]  )  :   ， \"The AudioCodes 400HD series of IP phones is a range of easy-to-use ,   ， feature-rich desktop devices for the service provider hosted services ,   ， enterprise IP telephony and contact center markets. Based on the same  ， advanced , field-proven underlying technology as our other VoIP products ,   ， AudioCodes high quality IP phones enable systems integrators and end  ， customers to build end-to-end VoIP solutions.\"  ， Due to insufficient firmware validation , an attacker can store  ， malicious firmware on AudioCodes IP phones.  ，  ， Vulnerability Details :   ， By analyzing the firmware image and update mechanism of AudioCodes IP  ， phones , it was identified that parsing and verification of the firmware  ， image is done by the ELF executable \"flasher\" which is executed from  ， the script \"run_ramfs_for_upgrade.sh\" located at the path  ， \"/home/ipphone/scripts/\".  ， When analyzing the software tool \"flasher\" , SySS found out that the  ， validation of firmware images only consists of simple checksum checks for  ， different firmware components.  ， Thus , by knowing how to calculate and where to store the required checksums  ，  ， AudioCodes IP phones.  ，  ， Proof of Concept ( PoC )  :   ， An AudioCodes IP phone's firmware image file contains an image header  ， followed by different sections , e.g. :   ， 1. Firmware image header  ， 2. bootloader.img  ， 3. rootfs.ext4  ， 4. phone.img  ， 5. section.map  ， 6. flasher  ， 7. release  ， 8. end.section  ， Each section starts with the 4 magic bytes \"0xBB 0xBB 0xBB 0xBB\"  ， followed by a 4-byte section header size field ( \"0x60 0x00 0x00 x00\" )   ， and other metadata like length fields and a checksum at the offset  ， 0x50. This checksum is calculated by adding up all bytes of the section  ， data starting at the section offset 0x60.  ， As a proof of concept , a manipulated firmware image file was created in  ， which an additional user with root privileges was added in the  ， \"rootfs.ext4\" section. After recalculating the checksum and updating  ， the section header with its checksum , the manipulated firmware image  ， could be successfully uploaded and installed on an AudioCodes IP phone.  ， To automate this task , a simple Python script has been developed to  ， deal with AudioCodes IP phone firmware images.  ， The following output exemplarily shows how a modified firmware image  ，  ，  # > python3 audiocodes-firmware-tool.py -i AudioCodes_UCC450HD_3.4.6.604.1.img -u  ， AudioCodes Firmware Tool v0.3 by Matthias Deeg - SySS GmbH ( c ) 2022  ，  ， Image infos  ，  ， Hardware : C450HD  ， Software : UC_3.4.6.604.1  ， Version : 25 ( 0x19 )   ， Number of sections : 4  ， Header length : 112 ( 0x70 )   ， Checksum : 0x00000877  ， Calculated checksum : 0x00000877  ， Attribute : 7 ( 0x00000007 )   ， Date : 2021-12-13_09 : 07 : 38  ， CE5 : 0  ，  ， Section name : bootloader.img  ， Section checksum : 0x0247D1A3  ， Calculated checksum : 0x0247D1A3  ， Data size ( 8-byte aligned )  : 423992 ( 0x67838 )   ， Data size : 423992 ( 0x67838 )   ，  ， Section name : rootfs.ext4  ， Section checksum : 0x78EF3E3D  ， Calculated checksum : 0x78EF3E6D  ， Data size ( 8-byte aligned )  : 134238208 ( 0x8005000 )   ， Data size : 134238208 ( 0x8005000 )   ，  ，  [ . ]   ，  [  *  ] Saved updated firmware image to AudioCodes_UCC450HD_3.4.6.604.1.img.new  ，  ， Solution :   ， Not yet fixed.",
    "time": "Aug 16, 2023"
}