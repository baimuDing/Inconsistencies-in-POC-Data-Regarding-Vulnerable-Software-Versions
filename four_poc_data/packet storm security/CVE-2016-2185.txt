{
    "text": "title : Linux ati_remote2 Null Pointer Dereference  ， detail : Linux kernel version 3.10.0-229.20.1.el7.x86_64 crashes on presentation of a buggy USB device requiring the ati_remote2 driver.  ， cve : advisories | CVE-2016-2185  ，  ， desc : OS-S Security Advisory 2016-18  ， Linux ati_remote2 multiple Nullpointer Dereferences  ， Date : March 4th , 2016  ， Authors : Sergej Schumilo , Hendrik Schwartke , Ralf Spenneberg  ， CVE : not yet assigned  ， CVSS : 4.9 ( AV : L/AC : L/Au : N/C : N/I : N/A : C )   ， Title : Multiple Local RedHat Enterprise Linux DoS RHEL 7.1 Kernel crashes on  ， invalid USB device descriptors ( ati_remote2 driver )   ， Severity : Critical. The Kernel panics. A reboot is required.  ， Ease of Exploitation : Trivial  ， Vulnerability type : Wrong input validation  ， Products : RHEL 7.1 including all updates  ， Kernel-Version : 3.10.0-229.20.1.el7.x86_64 ( for debugging-purposes we used the  ， CentOS Kernel kernel-debuginfo-3.10.0-229.14.1.el7 )   ， Vendor : Red Hat  ， Vendor contacted : November , 12th 2015  ， PDF of advisory : https : /os-s.net/advisories/OSS-2016-18_ati_remote2.pdf  ， Abstract :   ， The Kernel 3.10.0-229.20.1.el7.x86_64 crashes on presentation of a buggy USB  ， device requiring the ati_remote2 driver  ， Detailed product description :   ， We confirmed the bug on the following system :   ， RHEL 7.1  ， Kernel 3.10.0-229.20.1.el7.x86_64  ， Further products or kernel versions have not been tested.  ， How reproducible : Always  ， Actual results : Kernel crashes.  ， Description :   ， These bugs were found using the USB-fuzzing framework vUSBf from Sergej  ， Schumilo  ，  ( github.com/schumilo ) using the following device descriptors :   ，  [  *  ] Device-Descriptor # 1  ， bLength : 0x12  ， bDescriptorType : 0x1  ， bcdUSB : 0x200  ， bDeviceClass : 0xff  ， bDeviceSubClass : 0x0  ， bDeviceProtocol : 0x0  ， bMaxPacketSize : 0x40  ， idVendor : 0x471  ， idProduct : 0x602  ， bcdDevice : 0x100  ， iManufacturer : 0x1  ， iProduct : 0x2  ， iSerialNumbers : 0x3  ， bNumConfigurations : 0x1  ， This is the configuration descriptor containing only one interface descriptor.  ， The ati_remote2 driver assumes that there will be at least two interface-  ， descriptors with associated endpoint-descriptors.  ， Since the ati_remote2 driver is expecting a second interface descriptor , the  ， driver tries to dereference a null-pointer.  ， This results in a crash of the system.  ， The null-pointer dereference happens in usb_driver_claim_interface (  ) because  ， the ati_remote2 driver passes in the second parameter a null-pointer :   ，  ，  $ nm ati_remote2.ko.debug | grep ati_remote2_probe  ， 0000000000001300 t ati_remote2_probe  ，  $ addr2line -e ati_remote2.ko.debug 1399  ， /usr/src/debug/kernel-3.10.0-229.14.1.el7/linux-3.10.0-229.14.1.el7.x86_64/drivers/input/misc/ati_remote2.c : 825  ，  ，  * CentOS-Kernel linux-3.10.0-229.14.1.el7  ，  ( drivers/input/misc/ati_remote2.c )   ， .  ， 820 ar2->intf [ 0 ] = interface ;   ， 821 ar2->ep [ 0 ] = &alt->endpoint [ 0 ] .desc ;   ， 822  ， 823 ar2->intf [ 1 ] = usb_ifnum_to_if ( udev , 1 )  ; / * <- usb_ifnum_to_if returns a  ， null-pointer if there is only one interface configured * /  ， 824 r = usb_driver_claim_interface ( &ati_remote2_driver , ar2->intf [ 1 ]  , ar2 )  ;   ， / * the second parameter is obviously a null-pointer which crashes the system  ，  ， 825 if ( r )   ， 826 goto fail1 ;   ， 827 alt = ar2->intf [ 1 ] ->cur_altsetting ;   ， .  ，  ，  [  *  ] Configuration-Descriptor  ， bLength : 0x9  ， bDescriptorType : 0x2  ， wTotalLength : 0x27  ， bNumInterfaces : 0x1  ， bConfigurationValue : 0x1  ， iConfiguration : 0x0  ， bmAttributes : 0x0  ， bMaxPower : 0x31  ，  [  *  ] Interface-Descriptor  ， bLength : 0x9  ， bDescriptorType : 0x4  ， bInterfaceNumber : 0x0  ， bAlternateSetting : 0x0  ， bNumEndpoints : 0x0  ， bInterfaceClass : 0x0  ， bInterfaceSubClass : 0x0  ， bInterfaceProtocol : 0x0  ，  [  *  ] Device-Descriptor # 2  ， bLength : 0x12  ， bDescriptorType : 0x1  ， bcdUSB : 0x200  ， bDeviceClass : 0xff  ， bDeviceSubClass : 0x0  ， bDeviceProtocol : 0x0  ， bMaxPacketSize : 0x40  ， idVendor : 0x471  ， idProduct : 0x602  ， bcdDevice : 0x100  ， iManufacturer : 0x1  ， iProduct : 0x2  ， iSerialNumbers : 0x3  ， bNumConfigurations : 0x1  ， This is the configuration descriptor containing two interface-descriptors.  ， The ati_remote2 driver assumes that there will be at least two interface-  ， descriptors with associated endpoint-descriptors.  ， If one of them contains a zero-value for bNumEndpoints or no endpoint-  ， descriptor is configured for the corresponding interface-descriptor , the  ， ati_remote2 driver tries to dereference a null-pointer and the kernel crashes :   ，  ，  $ nm ati_remote2.ko.debug | grep ati_remote2_probe  ， 0000000000001300 t ati_remote2_probe  ，  $ addr2line -e ati_remote2.ko.debug 13ff  ， /usr/src/debug/kernel-3.10.0-229.14.1.el7/linux-3.10.0-229.14.1.el7.x86_64/drivers/input/misc/ati_remote2.c : 646  ，  ，  * CentOS-Kernel linux-3.10.0-229.14.1.el7  ，  ( drivers/input/misc/ati_remote2.c )   ， .  ， 632 static int ati_remote2_urb_init ( struct ati_remote2 * ar2 )   ， 633 {  ， .  ， 646 pipe = usb_rcvintpipe ( udev , ar2->ep [ i ] ->bEndpointAddress )  ; / * null-pointer  ， derference * /  ， 647 maxp = usb_maxpacket ( udev , pipe , usb_pipeout ( pipe )  ;   ， .  ， 820 ar2->intf [ 0 ] = interface ;   ， 821 ar2->ep [ 0 ] = &alt->endpoint [ 0 ] .desc ; / * <- possible null-pointer  ，  ( interface-0 )  * /  ， 822  ， 823 ar2->intf [ 1 ] = usb_ifnum_to_if ( udev , 1 )  ;   ， 824 r = usb_driver_claim_interface ( &ati_remote2_driver , ar2->intf [ 1 ]  , ar2 )  ;   ， 825 if ( r )   ， 826 goto fail1 ;   ， 827 alt = ar2->intf [ 1 ] ->cur_altsetting ;   ， 828 ar2->ep [ 1 ] = &alt->endpoint [ 0 ] .desc ; / * <- possible null-pointer  ，  ( interface-1 )  * /  ， .  ，  ，  [  *  ] Configuration-Descriptor  ， bLength : 0x9  ， bDescriptorType : 0x2  ， wTotalLength : 0x27  ， bNumInterfaces : 0x1  ， bConfigurationValue : 0x1  ， iConfiguration : 0x0  ， bmAttributes : 0x0  ， bMaxPower : 0x31  ，  [  *  ] Interface-Descriptor  ， bLength : 0x9  ， bDescriptorType : 0x4  ， bInterfaceNumber : 0x0  ， bAlternateSetting : 0x0  ， bNumEndpoints : 0x0 malicious value for interface-0  ， bInterfaceClass : 0x0  ， bInterfaceSubClass : 0x0  ， bInterfaceProtocol : 0x0  ，  [  *  ] Endpoint-Descriptor :   ， bLength : 0x7  ， bDescriptorType : 0x5",
    "time": "Mar 12, 2016"
}