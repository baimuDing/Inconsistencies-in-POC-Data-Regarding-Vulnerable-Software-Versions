{
    "text": "title : Solaris 10 dtprintinfo / libXm / libXpm Security Issues  ， detail : Multiple vulnerabilities have been discovered across Common Desktop Environment version 1.6 , Motif version 2.1 , and X.Org libXpm versions prior to 3.5.15 on Oracle Solaris 10 that can be chained together to achieve root.  ， cve : advisories | CVE-2022-46285  ，  ， desc : - [ HNS-2022-01 - HN Security Advisory - https : /security.humanativaspa.it/  ，  * Title : Multiple vulnerabilities in Solaris dtprintinfo and libXm/libXpm  ，  * Products : Common Desktop Environment 1.6 , Motif 2.1 , X.Org libXpm < 3.5.15  ，  * OS : Oracle Solaris 10 ( CPU January 2021 )   ，  * Author : Marco Ivaldi <marco.ivaldi @ hnsecurity.it>  ，  * Date : 2023-01-18  ，  * Oracle vulnerability tracking numbers :   ，  * S1597707 - Arbitrary printer name injection  ，  * S1597724 - Heap memory disclosure via long printer names  ，  * S1597711 - Memory corruption via malformed icon files  ，  * S1597730 - Stack-based buffer overflow in libXm ParseColors  ，  * CVE IDs :   ，  * CVE-2022-46285 - Infinite loop on unclosed comments in X.Org libXpm  ，  * Advisory URLs :   ，  * https : /github.com/hnsecurity/vulns/blob/main/HNS-2022-01-dtprintinfo.txt  ，  * https : /lists.x.org/archives/xorg-announce/2023-January/003312.html  ，  * https : /lists.x.org/archives/xorg-announce/2023-January/003313.html  ，  * Exploit URLs :   ，  * https : /github.com/0xdea/exploits/blob/master/solaris/raptor_dtprintlibXmas.c  ， - [ 0 - Table of contents  ， 1 - Summary  ， 2 - Vulnerabilities  ， 2.1 - Arbitrary printer name injection  ， 2.2 - Heap memory disclosure via long printer names  ， 2.3 - Memory corruption via malformed icon files  ， 2.4 - Stack-based buffer overflow in libXm ParseColors (  )   ， 3 - Analysis  ， 3.1 - Printer name injection and heap memory disclosure  ， 3.2 - Memory corruption via malformed icon files  ， 4 - Exploitation  ， 5 - Affected products  ， 6 - Remediation  ， 7 - Disclosure timeline  ， 8 - References  ， - [ 1 - Summary  ， \"What has been will be again ,   ， what has been done will be done again ;   ， there is nothing new under the Sun.\"  ， - Ecclesiastes 1 : 9  ， We have identified multiple security vulnerabilities that are exploitable  ， via the the setuid-root dtprintinfo binary from the Common Desktop  ， Environment ( CDE ) distributed with Oracle Solaris 10 ( CPU January 2021 )  :   ，  * A bug in the parser of the lpstat external command invoked by dtprintinfo  ， to list the names of available printers allows low-privileged local users  ， to inject arbitrary printer names via the $ HOME/.printers file.  ，  * Printer name injection allows low-privileged local users to manipulate  ， the control flow of the target program and disclose memory contents.  ， Based on our analysis , this bug does not seem to be directly exploitable  ， to achieve arbitrary code execution. However , we recommend treating it as  ， a potential security vulnerability and fix it as such.  ，  * The ability to inject arbitrary printer names opens other attack vectors  ， that otherwise would not be available on systems without configured  ， printers. As an example , we discovered multiple icon parsing bugs in the  ， Motif library libXm that cause memory corruption.  ， We demonstrated the possibility to exploit one of these memory corruption  ， bugs , a stack-based buffer overflow in the ParseColors (  ) function of libXm ,   ， to achieve local privilege escalation to root on Solaris 10.  ， - [ 2 - Vulnerabilities  ， Following our last CDE vulnerability disclosures [ 1 ]  , Oracle kindly shared  ， with us a copy of their then current Solaris 10 security patch set ( CPU  ， January 2021 )  , so that we could install it in our lab and verify the fixes  ，  ， In addition to verifying these fixes , we decided to take a closer look at  ， the dtprintinfo program distributed with CDE , because of its complexity and  ， its impressive historical record of high-impact vulnerabilities [ 2 ] . These  ， are the results of our research.  ， - [ 2.1 - Arbitrary printer name injection  ， After fruitlessly spending a few days reversing and auditing the patched  ， version of dtprintinfo , we came up with the idea of using the poor man's  ， fuzzer below to quickly check for the presence of flaws in the parsing of",
    "time": "Jan 20, 2023"
}