{
    "text": "title : Microsoft Windows Containers DP API Cryptography Flaw  ， detail : Microsoft Windows Containers suffers from a DP API design flaw where encryption keys are shared and reused between images.  ， cve : advisories | CVE-2021-1645  ，  ， desc :  ~   ，  ~ Certitude Security Advisory - CSA-2021-002 ~   ，  ， PRODUCT : Windows Containers  ， VENDOR : Microsoft  ， SEVERITY : High  ， AFFECTED VERSION : Windows 10 , Windows Server  ， IDENTIFIERS : CVE-2021-1645  ， PATCH VERSION : KB4598229 , KB4598230 , KB4598242 , KB4598243  ， FOUND BY : Marc Nimmerrichter , Certitude Lab  ，  ， Introduction  ，  ， Windows containers is a feature that extends the container concept well-known  ， from Linux environments to Windows. Just like containers on Linux , Windows  ， containers utilize a shared kernel but container processes are somewhat  ， isolated from one another.  ， The Windows Data Protection API ( DP API ) allows applications to encrypt  ， arbitrary data. An application does not have to manage keys , but instead , any  ， data can be passed to the API , which then returns an encrypted blob.  ， Similarly , an application can pass a previously encrypted blob to DP API to  ， retrieve the plain text. The cryptographic key used for these encryption  ， operations is either tied to the user context or is unique to a machine.  ， There was a design issue with DP API in containers which resulted in DP API  ， using the same key in all containers. Additionally , these keys were public in  ， base-image layers published by Microsoft.  ， Organizations using DP API inside containers should apply patches to Windows  ， and use the latest base images. However , the fix causes a design change , which  ， might render the use of DP API difficult for many use-cases.  ， Vulnerability Overview  ，  ， The vulnerability described applies to both , user- and machine-key DP API  ， encryption within Windows Docker containers. In our description we will use  ， machine key encryption , but the same issue exists if data is encrypted with  ， the user-key.  ， Normally , a machine key is tied to a ( virtual- ) machine. Therefore , a machine  ， is not able to decrypt data encrypted by an application on another machine.  ， However , due to a design issue , DP API machine keys used in containers came  ， from the container images. Since Windows docker images are based on the same  ， base images , the DP API keys of containers were identical. As the base image  ， is public , the DP API keys were public too !   ， Therefore , DP API operations performed by any Windows container application  ， were ineffective , as the encryption key that was used is public. Organizations  ， that used DP API in Windows Docker containers and relied on it to store  ， encrypted data in a potentially insecure location , should consider this data  ， as compromised.",
    "time": "Mar 16, 2021"
}