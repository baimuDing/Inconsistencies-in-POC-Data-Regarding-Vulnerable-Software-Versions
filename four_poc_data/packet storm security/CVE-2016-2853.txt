{
    "text": "title : AUFS ( Ubuntu 15.10 ) Privilege Escalation  ， detail : AUFS ( Ubuntu 15.10 ) suffers from an allow_userns fuse/xattr user namespaces privilege escalation vulnerability.  ， cve : advisories | CVE-2016-2853 , CVE-2016-2854  ，  ， desc : Source : http : /www.halfdog.net/Security/2016/AufsPrivilegeEscalationInUserNamespaces/  ，   ，  # Introduction  ，   ， Problem description : Aufs is a union filesystem to mix content of different underlying filesystems , e.g. read-only medium with r/w RAM-fs. That is also allowed in user namespaces when module was loaded with allow_userns option. Due to different bugs , aufs in a crafted USERNS allows privilege escalation , which is a problem on systems enabling unprivileged USERNS by default , e.g. Ubuntu Wily. All the issues mentioned here were discovered after performing similar analysis on overlayfs , another USERNS enabled union filesystem.  ， For a system to be exposed , unprivileged USERNS has to be available and AUFS support enabled for it by loading the aufs module with the appropriate option : modprobe aufs allow_userns.  ，   ，  # AUFS Over Fuse : Loss of Nosuid  ，   ， Method : Fuse filesystem can be mounted by unprivileged users with the help of the fusermount SUID program. Fuse then can simulate files of any type , mode , UID but they are only visible to the user mounting the filesystem and lose all SUID properties. Those files can be exposed using aufs including the problematic SUID properties. The basic exploitation sequence is :   ，   ， - Mount fuse filesystem exposing crafted SUID binary  ， - Create USERNS  ， - Mount aufs on top of fuse  ， - Execute the SUID binary via aufs from outside the namespace  ，   ， The issue can then be demonstrated using :   ，   ， SuidExec ( http : /www.halfdog.net/Misc/Utils/SuidExec.c )   ， FuseMinimal ( http : /www.halfdog.net/Security/2016/AufsPrivilegeEscalationInUserNamespaces/FuseMinimal.c )   ， UserNamespaceExec ( http : /www.halfdog.net/Misc/Utils/UserNamespaceExec.c )   ，   ， test $ mkdir fuse mnt work  ， test $ mv SuidExec RealFile  ， test $ ./FuseMinimal fuse",
    "time": "Apr 1, 2017"
}