{
    "text": "title : Linux cypress_m8 Null Pointer Dereference  ， detail : Linux kernel version 3.10.0-229.20.1.el7.x86_64 crashes on presentation of a buggy USB device which requires the requiring the cypress_m8 driver.  ， cve : advisories | CVE-2016-3137  ，  ， desc : OS-S Security Advisory 2016-07  ， Linux cypress_m8 Nullpointer Dereference  ， Date : March 4th , 2016  ， Authors : Sergej Schumilo , Hendrik Schwartke , Ralf Spenneberg  ， CVE : not yet assigned  ， CVSS : 4.9 ( AV : L/AC : L/Au : N/C : N/I : N/A : C )   ， Title : Local RedHat Enterprise Linux DoS RHEL 7.1 Kernel crashes on invalid  ， USB device descriptors ( cypress_m8 driver )   ， Severity : Critical. The Kernel panics. A reboot is required.  ， Ease of Exploitation : Trivial  ， Vulnerability type : Wrong input validation  ， Products : RHEL 7.1 including all updates  ， Kernel-Version : 3.10.0-229.20.1.el7.x86_64 ( for debugging-purposes we used the  ， CentOS Kernel kernel-debuginfo-3.10.0-229.14.1.el7 )   ， Vendor : Red Hat  ， Vendor contacted : November , 12th 2015  ， PDF of Advisory : https : /os-s.net/advisories/OSS-2016-07_cypress_m8.pdf  ， Abstract :   ， The Kernel 3.10.0-229.20.1.el7.x86_64 crashes on presentation of a buggy USB  ， device which requires the requiring the cypress_m8 driver.  ， Detailed product description :   ， We confirmed the bug on the following system :   ， RHEL 7.1  ， Kernel 3.10.0-229.20.1.el7.x86_64  ， Further products or kernel versions have not been tested.  ， How reproducible : Always  ， Actual results : Kernel crashes.  ， Description :   ， The bug was found using the USB-fuzzing framework vUSBf from Sergej Schumilo  ，  ( github.com/schumilo ) using the following device descriptor :   ，  [  *  ] Device-Descriptor  ， bLength : 0x12  ， bDescriptorType : 0x1  ， bcdUSB : 0x200  ， bDeviceClass : 0x3  ， bDeviceSubClass : 0x0  ， bDeviceProtocol : 0x0  ， bMaxPacketSize : 0x40  ， idVendor : 0x4b4  ， idProduct : 0x5500  ， bcdDevice : 0x100  ， iManufacturer : 0x1  ， iProduct : 0x2  ， iSerialNumbers : 0x3  ， bNumConfigurations : 0x1  ， This is the configuration descriptor containing only one interrupt-endpoint-  ， descriptor ( IN-direction ) .  ， The cypress_m8 driver assumes that there will be at least two endpoint-  ， descriptors configured for interrupt-transfer and each used for one direction.  ， Since there is no sanity check , it is possible that the kernel tries to  ， dereference a null-pointer.  ， This results in a crash of the system.  ，  ，  $ nm cypress_m8.ko.debug | grep cypress_generic_port_probe  ， 00000000000008d0 t cypress_generic_port_probe  ，  $ addr2line -e cypress_m8.ko.debug 0x9D0  ， /usr/src/debug/kernel-3.10.0-229.14.1.el7/linux-3.10.0-229.14.1.el7.x86_64/drivers/usb/serial/cypress_m8.c : 488  ，  ，  * CentOS-Kernel linux-3.10.0-229.14.1.el7 ( drivers/usb/serial/cypress_m8.c )   ， .  ， 482 if ( interval > 0 ) {  ， 483 priv->write_urb_interval = interval ;   ， 484 priv->read_urb_interval = interval ;   ， 485 dev_dbg ( &port->dev , \"%s - read & write intervals forced to %d\\n\" ,   ， 486 _func_ , interval )  ;   ， 487 } else {  ， 488 priv->write_urb_interval = port->interrupt_out_urb->interval ; / *   ， possible null-pointer dereference * /  ， 489 priv->read_urb_interval = port->interrupt_in_urb->interval ; / *   ， possible null-pointer dereference * /  ， 490 dev_dbg ( &port->dev , \"%s - intervals : read=%d write=%d\\n\" ,   ， 491 _func_ , priv->read_urb_interval ,   ， 492 priv->write_urb_interval )  ;   ， 493 }  ， .  ，  ，  [  *  ] Configuration-Descriptor  ， bLength : 0x9  ， bDescriptorType : 0x2  ， wTotalLength : 0x27  ， bNumInterfaces : 0x1  ， bConfigurationValue : 0x1  ， iConfiguration : 0x0  ， bmAttributes : 0x0  ， bMaxPower : 0x31  ，  [  *  ] Interface-Descriptor  ， bLength : 0x9  ， bDescriptorType : 0x4  ， bInterfaceNumber : 0x0  ， bAlternateSetting : 0x0  ， bNumEndpoints : 0x3  ， bInterfaceClass : 0x0  ， bInterfaceSubClass : 0x0  ， bInterfaceProtocol : 0x0  ，  [  *  ] Endpoint-Descriptor :   ， bLength : 0x7  ， bDescriptorType : 0x5",
    "time": "Mar 9, 2016"
}