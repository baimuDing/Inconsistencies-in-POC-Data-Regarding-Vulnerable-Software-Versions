{
    "text": "date_time:Jan 30, 2020 ， title:TrendMicro Anti-Threat Toolkit Improper Fix  ， detail:The fix that was applied to address a code execution vulnerability in Trend Micro Anti-Threat Toolkit (ATTK) was insufficient.  ， cve:advisories | CVE-2019-20358, CVE-2019-9491  ， date_time:Jan 30, 2020  ， desc:Hi @ll,  ， on September 29, 2019, John Page reported a remote code execution  ， with escalation of privilege in TrendMicro's Anti-Threat Toolkit  ， to its vendor.  ， TrendMicro assigned CVE-2019-9491 to this vulnerability and told  ， the reporter, his dog and the world on October 18, 2019, that they  ， had fixed the vulnerable product.  ， See <https:/success.trendmicro.com/solution/000149878>,  ， <https:/seclists.org/fulldisclosure/2019/Oct/42> and  ， <http:/hyp3rlinx.altervista.org/advisories/TREND-MICRO-ANTI-THREAT-TOOLKIT-(ATTK)-REMOTE-CODE-EXECUTION.txt>  ， TrendMicro's claim was but wrong, the vulnerability was NOT FIXED!  ， The files attk_ScanCleanOffline_gui_x86.exe, attk_collector_cli_x86.exe,  ， attk_ScanCleanOffline_gui_x64.exe and attk_collector_cli_x64.exe  ， offered on <https:/spnsupport.trendmicro.com/> were STILL vulnerable,  ， as was their payload!  ， Vulnerability #1:  ，  ， On a fully patched Windows 7 SP1, the executable self-extractors  ， attk_ScanCleanOffline_gui_x86.exe, attk_collector_cli_x86.exe,  ， attk_ScanCleanOffline_gui_x64.exe and attk_collector_cli_x64.exe  ， loaded and executed at least the following DLLs from their  ， \"application directory\", typically the user's \"Downloads\" folder  ， %USERPROFILE%\\Downloads\\, instead from Windows' \"system directory\"  ， %SystemRoot%\\System32\\  ， VERSION.dll, IPHLPAPI.dll, WINNSI.dll, WINHTTP.dll, WEBIO.dll,  ， DHCPCSVC.dll, CRYPTSP.dll, BCRYPT.dll, NCRYPT.dll, DNSAPI.dll,  ， RASADHLP.dll, PROPSYS.dll, APPHELP.dll  ， On other versions of Windows this list varied, but some DLLs were  ， ALWAYS loaded from the \"application directory\"!  ， This BEGINNER's error is well-known and well-documented since MORE  ， than 20 years:  ， see <https:/capec.mitre.org/data/definitions/471.html>,  ， <https:/cwe.mitre.org/data/definitions/426.html>,  ， <https:/cwe.mitre.org/data/definitions/427.html>,  ， <https:/blogs.msdn.microsoft.com/david_leblanc/2008/02/20/dll-preloading-attacks/>,  ， <https:/insights.sei.cmu.edu/cert/2008/09/carpet-bombing-and-directory-poisoning.html>,  ， <http:/www.binaryplanting.com/index.htm>,  ， <https:/attack.mitre.org/wiki/Technique/T1073>,  ， <https:/skanthak.homepage.t-online.de/sentinel.html>,  ， <https:/skanthak.homepage.t-online.de/verifier.html>,  ， <https:/skanthak.homepage.t-online.de/!execute.html>,  ， <https:/skanthak.homepage.t-online.de/minesweeper.html>"
}