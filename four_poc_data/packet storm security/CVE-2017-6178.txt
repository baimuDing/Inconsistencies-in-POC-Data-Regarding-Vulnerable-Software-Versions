{
    "text": "title : USBPcap 1.1.0.0 Privilege Escalation  ， detail : USBPcap version 1.1.0.0 suffers from a privilege escalation vulnerability.  ， cve : advisories | CVE-2017-6178  ，  ， desc : / *   ，   ， Exploit Title - USBPcap Null Pointer Dereference Privilege Escalation  ， Date - 07th March 2017  ， Discovered by - Parvez Anwar (  @ parvezghh )   ， Vendor Homepage - http : /desowin.org/usbpcap/  ， Tested Version - 1.1.0.0 ( USB Packet capture for Windows bundled with WireShark 2.2.5 )   ， Driver Version - 1.1.0.0 - USBPcap.sys  ， Tested on OS - 32bit Windows 7 SP1  ， CVE ID - CVE-2017-6178  ， Vendor fix url - not yet  ， Fixed Version - 0day  ， Fixed driver ver - 0day  ，   ，   ， USBPcap.sys  ，   ，  ， .text : 992AF494 loc_992AF494 :   ， .text : 992AF494 mov ecx ,  [ edi+8 ]  ; DeviceObject  ， .text : 992AF494  ， .text : 992AF497 inc byte ptr [ esi+23h ]   ， .text : 992AF49A add dword ptr [ esi+60h ]  , 24h  ， .text : 992AF49E mov edx , esi ; Irp  ， .text : 992AF4A0 call ds : IofCallDriver ; IofCallDriver function called without validating values !   ， .text : 992AF4A6 push 18h ; RemlockSize  ， .text : 992AF4A8 push esi ; Tag  ， .text : 992AF4A9 push ebx ; RemoveLock  ， .text : 992AF4AA mov edi , eax  ， .text : 992AF4AC call ds : IoReleaseRemoveLockEx  ， .text : 992AF4B2 mov eax , edi  ，   ，   ，   ， kd> u nt ! IofCallDriver  ， .  ， .  ， .  ， 82a7111b eb0c jmp nt ! IofCallDriver+0x63 ( 82a71129 )   ， 82a7111d 8b4608 mov eax , dword ptr [ esi+8 ] ds : 0023 : 00000008=? <- null pointer dereference  ， 82a71120 52 push edx  ， 82a71121 0fb6c9 movzx ecx , cl  ， 82a71124 56 push esi  ， 82a71125 ff548838 call dword ptr [ eax+ecx * 4+38h ] <- control flow of execution  ， 82a71129 5e pop esi  ， 82a7112a 59 pop ecx  ， 82a7112b 5d pop ebp  ， 82a7112c c3 ret",
    "time": "Mar 9, 2017"
}