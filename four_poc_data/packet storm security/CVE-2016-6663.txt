{
    "text": "date_time:Nov 2, 2016 ， title:MySQL / MariaDB / PerconaDB Privilege Escalation / Race Condition  ， detail:An independent research has revealed a race condition vulnerability which affects MySQL, MariaDB and PerconaDB databases. The vulnerability can allow a local system user with access to the affected database in the context of a low-privileged account (CREATE/INSERT/SELECT grants) to escalate their privileges and execute arbitrary code as the database system user (typically 'mysql').  ， cve:advisories | CVE-2016-6663  ， date_time:Nov 2, 2016  ， desc:=  ， - Release date: 01.11.2016  ， - Discovered by: Dawid Golunski  ， - Severity: Critical  ， - CVE-2016-6663 / OCVE-2016-5616  ， - http:/legalhackers.com  ，  ， I. VULNERABILITY  ，  ， MySQL / MariaDB / PerconaDB - Privilege Escalation / Race Condition  ， MariaDB  ， < 5.5.52  ， < 10.1.18  ， < 10.0.28  ， MySQL  ， <= 5.5.51  ， <= 5.6.32  ， <= 5.7.14  ， Percona Server  ， < 5.5.51-38.2  ， < 5.6.32-78-1  ， < 5.7.14-8  ， Percona XtraDB Cluster  ， < 5.6.32-25.17  ， < 5.7.14-26.17  ， < 5.5.41-37.0  ， II. BACKGROUND  ，  ， MySQL:  ， \"MySQL is the world's most popular open source database.  ， Whether you are a fast growing web property, technology ISV or large  ， enterprise, MySQL can cost-effectively help you deliver high performance,  ， scalable database applications.\"  ， \"Many of the world's largest and fastest-growing organizations including  ， Facebook, Google, Adobe, Alcatel Lucent and Zappos rely on MySQL to save time  ， and money powering their high-volume Web sites, business-critical systems and  ， packaged software.\"  ， http:/www.mysql.com/products/  ， http:/www.mysql.com/why-mysql/  ，  ， MariaDB:  ， \"MariaDB is one of the most popular database servers in the world.  ， It's made by the original developers of MySQL and guaranteed to stay open source.  ， Notable users include Wikipedia, WordPress.com and Google.  ， MariaDB turns data into structured information in a wide array of applications,  ， ranging from banking to websites. It is an enhanced, drop-in replacement for MySQL.  ， MariaDB is used because it is fast, scalable and robust, with a rich ecosystem of  ， storage engines, plugins and many other tools make it very versatile for a wide  ， variety of use cases.\"  ， https:/mariadb.org/about/  ，  ， PerconaDB:  ， \"Percona Server for MySQLAA(r) is a free, fully compatible, enhanced, open source  ， drop-in replacement for MySQL that provides superior performance, scalability  ， and instrumentation.  ， With over 3,000,000 downloads, Percona Server's self-tuning algorithms and support  ，  ， https:/www.percona.com/software/mysql-database/percona-server  ， III. INTRODUCTION  ，  ， An independent research has revealed a race condition vulnerability which is  ， present in MySQl, MariaDB and PerconaDB databases.  ， The vulnerability can allow a local system user with access to the affected  ， database in the context of a low-privileged account (CREATE/INSERT/SELECT grants)  ， to escalate their privileges and execute arbitrary code as the database system  ， user (typically 'mysql').  ， Successful exploitation would allow an attacker to gain access to all of the  ， databases stored on the affected database server.  ， The obtained level of access upon the exploitation, could be chained with  ， the other privilege escalation vulnerabilities discovered by the author of  ， this advisory (CVE-2016-6662 and CVE-2016-6664) to further escalate privileges  ， from mysql user to root user and thus allow attackers to fully compromise the  ， target server.  ， IV. DESCRIPTION  ，  ， Table locations  ，  ， MySQL-based databases allow users with CREATE table privilege to optionally  ， specify a disk path of the directory where the table will be stored via a DATA  ， DIRECTORY parameter in the CREATE statement.  ， Users who have access to a database account with CREATE grant could create a  ， table under a directory that they can control. For example:  ， attacker@debian:~$ mkdir /tmp/disktable  ， attacker@debian:~$ chmod 777 /tmp/disktable/  ， attacker@debian:~$ ls -ld /tmp/disktable/  ， drwxrwxrwx 2 attacker attacker 4096 Oct 28 10:53 /tmp/disktable/  ， A user could then place a table within the directory with the following SQL  ， statement:  ， mysql> CREATE TABLE poctab1 (txt varchar(50) engine = 'MyISAM' data directory '/tmp/disktable';"
}