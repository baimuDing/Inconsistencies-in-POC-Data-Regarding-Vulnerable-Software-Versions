{
    "text": "title : Android 4.3 Superuser Root Privilege Escalation  ， detail : The Superuser package for Android 4.3 allows a user to spawn /system/xbin/su with manipulated environment variables to execute code as root.  ， cve : advisories | CVE-2013-6770  ，  ， desc : Current releases of the CyanogenMod/ClockWorkMod/Koush Superuser  ， package may allow restricted local users to execute arbitrary commands  ， as root in certain , non-default device configurations.  ， Android 4.3 introduced the concept of \"restricted profiles , \" created  ， through the Settings -> Users menu. A restricted profile can be  ， configured to allow access to only a minimal set of applications , and  ， has extremely limited abilities to change settings on the device.  ， This is often used to enforce parental controls , or to protect shared  ， devices set up in public places. The OS requires an unlock code to be  ， entered in order to access the owner's profile to administer the  ， system.  ， /system/xbin/su is a setuid root executable , and any user may invoke  ， it in client mode ( \"su -c 'foo'\" or just \"su\" )  , or in daemon mode ( \"su  ， -daemon\" ) . In either mode of operation , the user who invokes this  ， program has the ability to manipulate its environment variables , file  ， descriptors , signals , rlimits , tty/stdin/stdout/stderr , and possibly  ， other items. By adding new entries at the front of the PATH for  ， commonly-executed root commands , then re-invoking \"su -daemon\" , an  ， attacker may be able to hijack legitimate root sessions subsequently  ， started by other applications on the device.  ， \"su -daemon\" is normally started up very early in the boot process ,   ， as root , from /init.superuser.rc ( CM ) or from  ， /system/etc/install-recovery.sh ( other ROMs ) . The fact that  ， unprivileged users are allowed to restart the daemon later , under EUID  ， 0 , appears to be an oversight.  ， Successful exploitation requires a number of conditions to be met :   ， - The attacker must have ADB shell access , e.g. over USB. This is  ， disabled by default , and normally restricted to trusted ADB clients  ， whose RSA key fingerprints have been accepted by the device  ， administrator. Root access via ADB ( i.e. Settings -> Developer  ， Options -> Root access -> Apps and ADB ) is not required. Note that  ， ADB shell access is typically considered a security risk , even in the  ， absence of this problem.  ， - The attacker must have a way to assume a non-shell ( non-2000 )  ,   ， suid-capable Linux UID in order to prevent /system/xbin/su from  ， creating infinitely recursive connections to itself through the daemon  ， client UID check in main (  ) . One way to do this would involve  ， uploading an app with the \"debuggable\" flag and using  ， /system/bin/run-as to assume this UID. \"adb install\" can probably  ， used for this purpose. However , due to a bug in Android 4.3's  ， \"run-as\" implementation [ 1 ]  , this does not currently work. This bug  ， was fixed in Android 4.4 , so CM11 will probably be able to satisfy  ， this requirement.  ， - The device owner must have granted root permissions to one or more  ， applications via Superuser. The restricted profile does not need to  ， be able to run this app from the launcher.",
    "time": "Nov 14, 2013"
}